(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var vt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ux(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function zx(t){if(t.__esModule)return t;var s=t.default;if(typeof s=="function"){var r=function a(){return this instanceof a?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};r.prototype=s.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(a){var n=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return t[a]}})}),r}var pu={exports:{}},fl={},fu={exports:{}},se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Va=Symbol.for("react.element"),qx=Symbol.for("react.portal"),Bx=Symbol.for("react.fragment"),Vx=Symbol.for("react.strict_mode"),Wx=Symbol.for("react.profiler"),Hx=Symbol.for("react.provider"),Jx=Symbol.for("react.context"),Qx=Symbol.for("react.forward_ref"),Gx=Symbol.for("react.suspense"),Kx=Symbol.for("react.memo"),Xx=Symbol.for("react.lazy"),Rc=Symbol.iterator;function Zx(t){return t===null||typeof t!="object"?null:(t=Rc&&t[Rc]||t["@@iterator"],typeof t=="function"?t:null)}var gu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},yu=Object.assign,bu={};function Ur(t,s,r){this.props=t,this.context=s,this.refs=bu,this.updater=r||gu}Ur.prototype.isReactComponent={};Ur.prototype.setState=function(t,s){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,s,"setState")};Ur.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function vu(){}vu.prototype=Ur.prototype;function Ao(t,s,r){this.props=t,this.context=s,this.refs=bu,this.updater=r||gu}var Po=Ao.prototype=new vu;Po.constructor=Ao;yu(Po,Ur.prototype);Po.isPureReactComponent=!0;var Oc=Array.isArray,ju=Object.prototype.hasOwnProperty,Mo={current:null},wu={key:!0,ref:!0,__self:!0,__source:!0};function Nu(t,s,r){var a,n={},l=null,i=null;if(s!=null)for(a in s.ref!==void 0&&(i=s.ref),s.key!==void 0&&(l=""+s.key),s)ju.call(s,a)&&!wu.hasOwnProperty(a)&&(n[a]=s[a]);var d=arguments.length-2;if(d===1)n.children=r;else if(1<d){for(var o=Array(d),u=0;u<d;u++)o[u]=arguments[u+2];n.children=o}if(t&&t.defaultProps)for(a in d=t.defaultProps,d)n[a]===void 0&&(n[a]=d[a]);return{$$typeof:Va,type:t,key:l,ref:i,props:n,_owner:Mo.current}}function Yx(t,s){return{$$typeof:Va,type:t.type,key:s,ref:t.ref,props:t.props,_owner:t._owner}}function Do(t){return typeof t=="object"&&t!==null&&t.$$typeof===Va}function ep(t){var s={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return s[r]})}var $c=/\/+/g;function $l(t,s){return typeof t=="object"&&t!==null&&t.key!=null?ep(""+t.key):s.toString(36)}function Sn(t,s,r,a,n){var l=typeof t;(l==="undefined"||l==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(l){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Va:case qx:i=!0}}if(i)return i=t,n=n(i),t=a===""?"."+$l(i,0):a,Oc(n)?(r="",t!=null&&(r=t.replace($c,"$&/")+"/"),Sn(n,s,r,"",function(u){return u})):n!=null&&(Do(n)&&(n=Yx(n,r+(!n.key||i&&i.key===n.key?"":(""+n.key).replace($c,"$&/")+"/")+t)),s.push(n)),1;if(i=0,a=a===""?".":a+":",Oc(t))for(var d=0;d<t.length;d++){l=t[d];var o=a+$l(l,d);i+=Sn(l,s,r,o,n)}else if(o=Zx(t),typeof o=="function")for(t=o.call(t),d=0;!(l=t.next()).done;)l=l.value,o=a+$l(l,d++),i+=Sn(l,s,r,o,n);else if(l==="object")throw s=String(t),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return i}function tn(t,s,r){if(t==null)return t;var a=[],n=0;return Sn(t,a,"","",function(l){return s.call(r,l,n++)}),a}function tp(t){if(t._status===-1){var s=t._result;s=s(),s.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=s)}if(t._status===1)return t._result.default;throw t._result}var Ye={current:null},Cn={transition:null},sp={ReactCurrentDispatcher:Ye,ReactCurrentBatchConfig:Cn,ReactCurrentOwner:Mo};function _u(){throw Error("act(...) is not supported in production builds of React.")}se.Children={map:tn,forEach:function(t,s,r){tn(t,function(){s.apply(this,arguments)},r)},count:function(t){var s=0;return tn(t,function(){s++}),s},toArray:function(t){return tn(t,function(s){return s})||[]},only:function(t){if(!Do(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};se.Component=Ur;se.Fragment=Bx;se.Profiler=Wx;se.PureComponent=Ao;se.StrictMode=Vx;se.Suspense=Gx;se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sp;se.act=_u;se.cloneElement=function(t,s,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var a=yu({},t.props),n=t.key,l=t.ref,i=t._owner;if(s!=null){if(s.ref!==void 0&&(l=s.ref,i=Mo.current),s.key!==void 0&&(n=""+s.key),t.type&&t.type.defaultProps)var d=t.type.defaultProps;for(o in s)ju.call(s,o)&&!wu.hasOwnProperty(o)&&(a[o]=s[o]===void 0&&d!==void 0?d[o]:s[o])}var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){d=Array(o);for(var u=0;u<o;u++)d[u]=arguments[u+2];a.children=d}return{$$typeof:Va,type:t.type,key:n,ref:l,props:a,_owner:i}};se.createContext=function(t){return t={$$typeof:Jx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Hx,_context:t},t.Consumer=t};se.createElement=Nu;se.createFactory=function(t){var s=Nu.bind(null,t);return s.type=t,s};se.createRef=function(){return{current:null}};se.forwardRef=function(t){return{$$typeof:Qx,render:t}};se.isValidElement=Do;se.lazy=function(t){return{$$typeof:Xx,_payload:{_status:-1,_result:t},_init:tp}};se.memo=function(t,s){return{$$typeof:Kx,type:t,compare:s===void 0?null:s}};se.startTransition=function(t){var s=Cn.transition;Cn.transition={};try{t()}finally{Cn.transition=s}};se.unstable_act=_u;se.useCallback=function(t,s){return Ye.current.useCallback(t,s)};se.useContext=function(t){return Ye.current.useContext(t)};se.useDebugValue=function(){};se.useDeferredValue=function(t){return Ye.current.useDeferredValue(t)};se.useEffect=function(t,s){return Ye.current.useEffect(t,s)};se.useId=function(){return Ye.current.useId()};se.useImperativeHandle=function(t,s,r){return Ye.current.useImperativeHandle(t,s,r)};se.useInsertionEffect=function(t,s){return Ye.current.useInsertionEffect(t,s)};se.useLayoutEffect=function(t,s){return Ye.current.useLayoutEffect(t,s)};se.useMemo=function(t,s){return Ye.current.useMemo(t,s)};se.useReducer=function(t,s,r){return Ye.current.useReducer(t,s,r)};se.useRef=function(t){return Ye.current.useRef(t)};se.useState=function(t){return Ye.current.useState(t)};se.useSyncExternalStore=function(t,s,r){return Ye.current.useSyncExternalStore(t,s,r)};se.useTransition=function(){return Ye.current.useTransition()};se.version="18.3.1";fu.exports=se;var p=fu.exports;const De=Ux(p);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rp=p,ap=Symbol.for("react.element"),np=Symbol.for("react.fragment"),lp=Object.prototype.hasOwnProperty,ip=rp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,op={key:!0,ref:!0,__self:!0,__source:!0};function ku(t,s,r){var a,n={},l=null,i=null;r!==void 0&&(l=""+r),s.key!==void 0&&(l=""+s.key),s.ref!==void 0&&(i=s.ref);for(a in s)lp.call(s,a)&&!op.hasOwnProperty(a)&&(n[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)n[a]===void 0&&(n[a]=s[a]);return{$$typeof:ap,type:t,key:l,ref:i,props:n,_owner:ip.current}}fl.Fragment=np;fl.jsx=ku;fl.jsxs=ku;pu.exports=fl;var e=pu.exports,Su={exports:{}},ht={},Cu={exports:{}},Eu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function s(C,U){var P=C.length;C.push(U);e:for(;0<P;){var V=P-1>>>1,D=C[V];if(0<n(D,U))C[V]=U,C[P]=D,P=V;else break e}}function r(C){return C.length===0?null:C[0]}function a(C){if(C.length===0)return null;var U=C[0],P=C.pop();if(P!==U){C[0]=P;e:for(var V=0,D=C.length,B=D>>>1;V<B;){var $=2*(V+1)-1,W=C[$],L=$+1,K=C[L];if(0>n(W,P))L<D&&0>n(K,W)?(C[V]=K,C[L]=P,V=L):(C[V]=W,C[$]=P,V=$);else if(L<D&&0>n(K,P))C[V]=K,C[L]=P,V=L;else break e}}return U}function n(C,U){var P=C.sortIndex-U.sortIndex;return P!==0?P:C.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var i=Date,d=i.now();t.unstable_now=function(){return i.now()-d}}var o=[],u=[],c=1,x=null,m=3,f=!1,y=!1,N=!1,k=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function h(C){for(var U=r(u);U!==null;){if(U.callback===null)a(u);else if(U.startTime<=C)a(u),U.sortIndex=U.expirationTime,s(o,U);else break;U=r(u)}}function g(C){if(N=!1,h(C),!y)if(r(o)!==null)y=!0,E(w);else{var U=r(u);U!==null&&q(g,U.startTime-C)}}function w(C,U){y=!1,N&&(N=!1,b(_),_=-1),f=!0;var P=m;try{for(h(U),x=r(o);x!==null&&(!(x.expirationTime>U)||C&&!O());){var V=x.callback;if(typeof V=="function"){x.callback=null,m=x.priorityLevel;var D=V(x.expirationTime<=U);U=t.unstable_now(),typeof D=="function"?x.callback=D:x===r(o)&&a(o),h(U)}else a(o);x=r(o)}if(x!==null)var B=!0;else{var $=r(u);$!==null&&q(g,$.startTime-U),B=!1}return B}finally{x=null,m=P,f=!1}}var S=!1,j=null,_=-1,M=5,R=-1;function O(){return!(t.unstable_now()-R<M)}function I(){if(j!==null){var C=t.unstable_now();R=C;var U=!0;try{U=j(!0,C)}finally{U?A():(S=!1,j=null)}}else S=!1}var A;if(typeof v=="function")A=function(){v(I)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,Q=F.port2;F.port1.onmessage=I,A=function(){Q.postMessage(null)}}else A=function(){k(I,0)};function E(C){j=C,S||(S=!0,A())}function q(C,U){_=k(function(){C(t.unstable_now())},U)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(C){C.callback=null},t.unstable_continueExecution=function(){y||f||(y=!0,E(w))},t.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<C?Math.floor(1e3/C):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(o)},t.unstable_next=function(C){switch(m){case 1:case 2:case 3:var U=3;break;default:U=m}var P=m;m=U;try{return C()}finally{m=P}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(C,U){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var P=m;m=C;try{return U()}finally{m=P}},t.unstable_scheduleCallback=function(C,U,P){var V=t.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?V+P:V):P=V,C){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=P+D,C={id:c++,callback:U,priorityLevel:C,startTime:P,expirationTime:D,sortIndex:-1},P>V?(C.sortIndex=P,s(u,C),r(o)===null&&C===r(u)&&(N?(b(_),_=-1):N=!0,q(g,P-V))):(C.sortIndex=D,s(o,C),y||f||(y=!0,E(w))),C},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(C){var U=m;return function(){var P=m;m=U;try{return C.apply(this,arguments)}finally{m=P}}}})(Eu);Cu.exports=Eu;var cp=Cu.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dp=p,mt=cp;function H(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)s+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Tu=new Set,ja={};function Xs(t,s){Pr(t,s),Pr(t+"Capture",s)}function Pr(t,s){for(ja[t]=s,t=0;t<s.length;t++)Tu.add(s[t])}var Xt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vi=Object.prototype.hasOwnProperty,up=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Fc={},Uc={};function mp(t){return vi.call(Uc,t)?!0:vi.call(Fc,t)?!1:up.test(t)?Uc[t]=!0:(Fc[t]=!0,!1)}function hp(t,s,r,a){if(r!==null&&r.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return a?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function xp(t,s,r,a){if(s===null||typeof s>"u"||hp(t,s,r,a))return!0;if(a)return!1;if(r!==null)switch(r.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function et(t,s,r,a,n,l,i){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=a,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=t,this.type=s,this.sanitizeURL=l,this.removeEmptyString=i}var ze={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ze[t]=new et(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];ze[s]=new et(s,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ze[t]=new et(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ze[t]=new et(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ze[t]=new et(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ze[t]=new et(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ze[t]=new et(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ze[t]=new et(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ze[t]=new et(t,5,!1,t.toLowerCase(),null,!1,!1)});var Io=/[\-:]([a-z])/g;function Lo(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(Io,Lo);ze[s]=new et(s,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(Io,Lo);ze[s]=new et(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(Io,Lo);ze[s]=new et(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ze[t]=new et(t,1,!1,t.toLowerCase(),null,!1,!1)});ze.xlinkHref=new et("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ze[t]=new et(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ro(t,s,r,a){var n=ze.hasOwnProperty(s)?ze[s]:null;(n!==null?n.type!==0:a||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(xp(s,r,n,a)&&(r=null),a||n===null?mp(s)&&(r===null?t.removeAttribute(s):t.setAttribute(s,""+r)):n.mustUseProperty?t[n.propertyName]=r===null?n.type===3?!1:"":r:(s=n.attributeName,a=n.attributeNamespace,r===null?t.removeAttribute(s):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,a?t.setAttributeNS(a,s,r):t.setAttribute(s,r))))}var ts=dp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sn=Symbol.for("react.element"),mr=Symbol.for("react.portal"),hr=Symbol.for("react.fragment"),Oo=Symbol.for("react.strict_mode"),ji=Symbol.for("react.profiler"),Au=Symbol.for("react.provider"),Pu=Symbol.for("react.context"),$o=Symbol.for("react.forward_ref"),wi=Symbol.for("react.suspense"),Ni=Symbol.for("react.suspense_list"),Fo=Symbol.for("react.memo"),ls=Symbol.for("react.lazy"),Mu=Symbol.for("react.offscreen"),zc=Symbol.iterator;function Jr(t){return t===null||typeof t!="object"?null:(t=zc&&t[zc]||t["@@iterator"],typeof t=="function"?t:null)}var je=Object.assign,Fl;function aa(t){if(Fl===void 0)try{throw Error()}catch(r){var s=r.stack.trim().match(/\n( *(at )?)/);Fl=s&&s[1]||""}return`
`+Fl+t}var Ul=!1;function zl(t,s){if(!t||Ul)return"";Ul=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(u){var a=u}Reflect.construct(t,[],s)}else{try{s.call()}catch(u){a=u}t.call(s.prototype)}else{try{throw Error()}catch(u){a=u}t()}}catch(u){if(u&&a&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),l=a.stack.split(`
`),i=n.length-1,d=l.length-1;1<=i&&0<=d&&n[i]!==l[d];)d--;for(;1<=i&&0<=d;i--,d--)if(n[i]!==l[d]){if(i!==1||d!==1)do if(i--,d--,0>d||n[i]!==l[d]){var o=`
`+n[i].replace(" at new "," at ");return t.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",t.displayName)),o}while(1<=i&&0<=d);break}}}finally{Ul=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?aa(t):""}function pp(t){switch(t.tag){case 5:return aa(t.type);case 16:return aa("Lazy");case 13:return aa("Suspense");case 19:return aa("SuspenseList");case 0:case 2:case 15:return t=zl(t.type,!1),t;case 11:return t=zl(t.type.render,!1),t;case 1:return t=zl(t.type,!0),t;default:return""}}function _i(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case hr:return"Fragment";case mr:return"Portal";case ji:return"Profiler";case Oo:return"StrictMode";case wi:return"Suspense";case Ni:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Pu:return(t.displayName||"Context")+".Consumer";case Au:return(t._context.displayName||"Context")+".Provider";case $o:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Fo:return s=t.displayName||null,s!==null?s:_i(t.type)||"Memo";case ls:s=t._payload,t=t._init;try{return _i(t(s))}catch{}}return null}function fp(t){var s=t.type;switch(t.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=s.render,t=t.displayName||t.name||"",s.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _i(s);case 8:return s===Oo?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function ws(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Du(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function gp(t){var s=Du(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),a=""+t[s];if(!t.hasOwnProperty(s)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,l=r.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return n.call(this)},set:function(i){a=""+i,l.call(this,i)}}),Object.defineProperty(t,s,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(i){a=""+i},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function rn(t){t._valueTracker||(t._valueTracker=gp(t))}function Iu(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var r=s.getValue(),a="";return t&&(a=Du(t)?t.checked?"true":"false":t.value),t=a,t!==r?(s.setValue(t),!0):!1}function Fn(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ki(t,s){var r=s.checked;return je({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function qc(t,s){var r=s.defaultValue==null?"":s.defaultValue,a=s.checked!=null?s.checked:s.defaultChecked;r=ws(s.value!=null?s.value:r),t._wrapperState={initialChecked:a,initialValue:r,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function Lu(t,s){s=s.checked,s!=null&&Ro(t,"checked",s,!1)}function Si(t,s){Lu(t,s);var r=ws(s.value),a=s.type;if(r!=null)a==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(a==="submit"||a==="reset"){t.removeAttribute("value");return}s.hasOwnProperty("value")?Ci(t,s.type,r):s.hasOwnProperty("defaultValue")&&Ci(t,s.type,ws(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(t.defaultChecked=!!s.defaultChecked)}function Bc(t,s,r){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var a=s.type;if(!(a!=="submit"&&a!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+t._wrapperState.initialValue,r||s===t.value||(t.value=s),t.defaultValue=s}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Ci(t,s,r){(s!=="number"||Fn(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var na=Array.isArray;function kr(t,s,r,a){if(t=t.options,s){s={};for(var n=0;n<r.length;n++)s["$"+r[n]]=!0;for(r=0;r<t.length;r++)n=s.hasOwnProperty("$"+t[r].value),t[r].selected!==n&&(t[r].selected=n),n&&a&&(t[r].defaultSelected=!0)}else{for(r=""+ws(r),s=null,n=0;n<t.length;n++){if(t[n].value===r){t[n].selected=!0,a&&(t[n].defaultSelected=!0);return}s!==null||t[n].disabled||(s=t[n])}s!==null&&(s.selected=!0)}}function Ei(t,s){if(s.dangerouslySetInnerHTML!=null)throw Error(H(91));return je({},s,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Vc(t,s){var r=s.value;if(r==null){if(r=s.children,s=s.defaultValue,r!=null){if(s!=null)throw Error(H(92));if(na(r)){if(1<r.length)throw Error(H(93));r=r[0]}s=r}s==null&&(s=""),r=s}t._wrapperState={initialValue:ws(r)}}function Ru(t,s){var r=ws(s.value),a=ws(s.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),s.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),a!=null&&(t.defaultValue=""+a)}function Wc(t){var s=t.textContent;s===t._wrapperState.initialValue&&s!==""&&s!==null&&(t.value=s)}function Ou(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ti(t,s){return t==null||t==="http://www.w3.org/1999/xhtml"?Ou(s):t==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var an,$u=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,r,a,n){MSApp.execUnsafeLocalFunction(function(){return t(s,r,a,n)})}:t}(function(t,s){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=s;else{for(an=an||document.createElement("div"),an.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=an.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;s.firstChild;)t.appendChild(s.firstChild)}});function wa(t,s){if(s){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=s;return}}t.textContent=s}var ca={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yp=["Webkit","ms","Moz","O"];Object.keys(ca).forEach(function(t){yp.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),ca[s]=ca[t]})});function Fu(t,s,r){return s==null||typeof s=="boolean"||s===""?"":r||typeof s!="number"||s===0||ca.hasOwnProperty(t)&&ca[t]?(""+s).trim():s+"px"}function Uu(t,s){t=t.style;for(var r in s)if(s.hasOwnProperty(r)){var a=r.indexOf("--")===0,n=Fu(r,s[r],a);r==="float"&&(r="cssFloat"),a?t.setProperty(r,n):t[r]=n}}var bp=je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ai(t,s){if(s){if(bp[t]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(H(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(H(61))}if(s.style!=null&&typeof s.style!="object")throw Error(H(62))}}function Pi(t,s){if(t.indexOf("-")===-1)return typeof s.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mi=null;function Uo(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Di=null,Sr=null,Cr=null;function Hc(t){if(t=Ja(t)){if(typeof Di!="function")throw Error(H(280));var s=t.stateNode;s&&(s=jl(s),Di(t.stateNode,t.type,s))}}function zu(t){Sr?Cr?Cr.push(t):Cr=[t]:Sr=t}function qu(){if(Sr){var t=Sr,s=Cr;if(Cr=Sr=null,Hc(t),s)for(t=0;t<s.length;t++)Hc(s[t])}}function Bu(t,s){return t(s)}function Vu(){}var ql=!1;function Wu(t,s,r){if(ql)return t(s,r);ql=!0;try{return Bu(t,s,r)}finally{ql=!1,(Sr!==null||Cr!==null)&&(Vu(),qu())}}function Na(t,s){var r=t.stateNode;if(r===null)return null;var a=jl(r);if(a===null)return null;r=a[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(t=t.type,a=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!a;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(H(231,s,typeof r));return r}var Ii=!1;if(Xt)try{var Qr={};Object.defineProperty(Qr,"passive",{get:function(){Ii=!0}}),window.addEventListener("test",Qr,Qr),window.removeEventListener("test",Qr,Qr)}catch{Ii=!1}function vp(t,s,r,a,n,l,i,d,o){var u=Array.prototype.slice.call(arguments,3);try{s.apply(r,u)}catch(c){this.onError(c)}}var da=!1,Un=null,zn=!1,Li=null,jp={onError:function(t){da=!0,Un=t}};function wp(t,s,r,a,n,l,i,d,o){da=!1,Un=null,vp.apply(jp,arguments)}function Np(t,s,r,a,n,l,i,d,o){if(wp.apply(this,arguments),da){if(da){var u=Un;da=!1,Un=null}else throw Error(H(198));zn||(zn=!0,Li=u)}}function Zs(t){var s=t,r=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,s.flags&4098&&(r=s.return),t=s.return;while(t)}return s.tag===3?r:null}function Hu(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function Jc(t){if(Zs(t)!==t)throw Error(H(188))}function _p(t){var s=t.alternate;if(!s){if(s=Zs(t),s===null)throw Error(H(188));return s!==t?null:t}for(var r=t,a=s;;){var n=r.return;if(n===null)break;var l=n.alternate;if(l===null){if(a=n.return,a!==null){r=a;continue}break}if(n.child===l.child){for(l=n.child;l;){if(l===r)return Jc(n),t;if(l===a)return Jc(n),s;l=l.sibling}throw Error(H(188))}if(r.return!==a.return)r=n,a=l;else{for(var i=!1,d=n.child;d;){if(d===r){i=!0,r=n,a=l;break}if(d===a){i=!0,a=n,r=l;break}d=d.sibling}if(!i){for(d=l.child;d;){if(d===r){i=!0,r=l,a=n;break}if(d===a){i=!0,a=l,r=n;break}d=d.sibling}if(!i)throw Error(H(189))}}if(r.alternate!==a)throw Error(H(190))}if(r.tag!==3)throw Error(H(188));return r.stateNode.current===r?t:s}function Ju(t){return t=_p(t),t!==null?Qu(t):null}function Qu(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var s=Qu(t);if(s!==null)return s;t=t.sibling}return null}var Gu=mt.unstable_scheduleCallback,Qc=mt.unstable_cancelCallback,kp=mt.unstable_shouldYield,Sp=mt.unstable_requestPaint,Ce=mt.unstable_now,Cp=mt.unstable_getCurrentPriorityLevel,zo=mt.unstable_ImmediatePriority,Ku=mt.unstable_UserBlockingPriority,qn=mt.unstable_NormalPriority,Ep=mt.unstable_LowPriority,Xu=mt.unstable_IdlePriority,gl=null,Ot=null;function Tp(t){if(Ot&&typeof Ot.onCommitFiberRoot=="function")try{Ot.onCommitFiberRoot(gl,t,void 0,(t.current.flags&128)===128)}catch{}}var At=Math.clz32?Math.clz32:Mp,Ap=Math.log,Pp=Math.LN2;function Mp(t){return t>>>=0,t===0?32:31-(Ap(t)/Pp|0)|0}var nn=64,ln=4194304;function la(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Bn(t,s){var r=t.pendingLanes;if(r===0)return 0;var a=0,n=t.suspendedLanes,l=t.pingedLanes,i=r&268435455;if(i!==0){var d=i&~n;d!==0?a=la(d):(l&=i,l!==0&&(a=la(l)))}else i=r&~n,i!==0?a=la(i):l!==0&&(a=la(l));if(a===0)return 0;if(s!==0&&s!==a&&!(s&n)&&(n=a&-a,l=s&-s,n>=l||n===16&&(l&4194240)!==0))return s;if(a&4&&(a|=r&16),s=t.entangledLanes,s!==0)for(t=t.entanglements,s&=a;0<s;)r=31-At(s),n=1<<r,a|=t[r],s&=~n;return a}function Dp(t,s){switch(t){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ip(t,s){for(var r=t.suspendedLanes,a=t.pingedLanes,n=t.expirationTimes,l=t.pendingLanes;0<l;){var i=31-At(l),d=1<<i,o=n[i];o===-1?(!(d&r)||d&a)&&(n[i]=Dp(d,s)):o<=s&&(t.expiredLanes|=d),l&=~d}}function Ri(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Zu(){var t=nn;return nn<<=1,!(nn&4194240)&&(nn=64),t}function Bl(t){for(var s=[],r=0;31>r;r++)s.push(t);return s}function Wa(t,s,r){t.pendingLanes|=s,s!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,s=31-At(s),t[s]=r}function Lp(t,s){var r=t.pendingLanes&~s;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=s,t.mutableReadLanes&=s,t.entangledLanes&=s,s=t.entanglements;var a=t.eventTimes;for(t=t.expirationTimes;0<r;){var n=31-At(r),l=1<<n;s[n]=0,a[n]=-1,t[n]=-1,r&=~l}}function qo(t,s){var r=t.entangledLanes|=s;for(t=t.entanglements;r;){var a=31-At(r),n=1<<a;n&s|t[a]&s&&(t[a]|=s),r&=~n}}var ce=0;function Yu(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var em,Bo,tm,sm,rm,Oi=!1,on=[],xs=null,ps=null,fs=null,_a=new Map,ka=new Map,os=[],Rp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gc(t,s){switch(t){case"focusin":case"focusout":xs=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":fs=null;break;case"pointerover":case"pointerout":_a.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":ka.delete(s.pointerId)}}function Gr(t,s,r,a,n,l){return t===null||t.nativeEvent!==l?(t={blockedOn:s,domEventName:r,eventSystemFlags:a,nativeEvent:l,targetContainers:[n]},s!==null&&(s=Ja(s),s!==null&&Bo(s)),t):(t.eventSystemFlags|=a,s=t.targetContainers,n!==null&&s.indexOf(n)===-1&&s.push(n),t)}function Op(t,s,r,a,n){switch(s){case"focusin":return xs=Gr(xs,t,s,r,a,n),!0;case"dragenter":return ps=Gr(ps,t,s,r,a,n),!0;case"mouseover":return fs=Gr(fs,t,s,r,a,n),!0;case"pointerover":var l=n.pointerId;return _a.set(l,Gr(_a.get(l)||null,t,s,r,a,n)),!0;case"gotpointercapture":return l=n.pointerId,ka.set(l,Gr(ka.get(l)||null,t,s,r,a,n)),!0}return!1}function am(t){var s=Os(t.target);if(s!==null){var r=Zs(s);if(r!==null){if(s=r.tag,s===13){if(s=Hu(r),s!==null){t.blockedOn=s,rm(t.priority,function(){tm(r)});return}}else if(s===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function En(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var r=$i(t.domEventName,t.eventSystemFlags,s[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var a=new r.constructor(r.type,r);Mi=a,r.target.dispatchEvent(a),Mi=null}else return s=Ja(r),s!==null&&Bo(s),t.blockedOn=r,!1;s.shift()}return!0}function Kc(t,s,r){En(t)&&r.delete(s)}function $p(){Oi=!1,xs!==null&&En(xs)&&(xs=null),ps!==null&&En(ps)&&(ps=null),fs!==null&&En(fs)&&(fs=null),_a.forEach(Kc),ka.forEach(Kc)}function Kr(t,s){t.blockedOn===s&&(t.blockedOn=null,Oi||(Oi=!0,mt.unstable_scheduleCallback(mt.unstable_NormalPriority,$p)))}function Sa(t){function s(n){return Kr(n,t)}if(0<on.length){Kr(on[0],t);for(var r=1;r<on.length;r++){var a=on[r];a.blockedOn===t&&(a.blockedOn=null)}}for(xs!==null&&Kr(xs,t),ps!==null&&Kr(ps,t),fs!==null&&Kr(fs,t),_a.forEach(s),ka.forEach(s),r=0;r<os.length;r++)a=os[r],a.blockedOn===t&&(a.blockedOn=null);for(;0<os.length&&(r=os[0],r.blockedOn===null);)am(r),r.blockedOn===null&&os.shift()}var Er=ts.ReactCurrentBatchConfig,Vn=!0;function Fp(t,s,r,a){var n=ce,l=Er.transition;Er.transition=null;try{ce=1,Vo(t,s,r,a)}finally{ce=n,Er.transition=l}}function Up(t,s,r,a){var n=ce,l=Er.transition;Er.transition=null;try{ce=4,Vo(t,s,r,a)}finally{ce=n,Er.transition=l}}function Vo(t,s,r,a){if(Vn){var n=$i(t,s,r,a);if(n===null)Yl(t,s,a,Wn,r),Gc(t,a);else if(Op(n,t,s,r,a))a.stopPropagation();else if(Gc(t,a),s&4&&-1<Rp.indexOf(t)){for(;n!==null;){var l=Ja(n);if(l!==null&&em(l),l=$i(t,s,r,a),l===null&&Yl(t,s,a,Wn,r),l===n)break;n=l}n!==null&&a.stopPropagation()}else Yl(t,s,a,null,r)}}var Wn=null;function $i(t,s,r,a){if(Wn=null,t=Uo(a),t=Os(t),t!==null)if(s=Zs(t),s===null)t=null;else if(r=s.tag,r===13){if(t=Hu(s),t!==null)return t;t=null}else if(r===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null);return Wn=t,null}function nm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Cp()){case zo:return 1;case Ku:return 4;case qn:case Ep:return 16;case Xu:return 536870912;default:return 16}default:return 16}}var us=null,Wo=null,Tn=null;function lm(){if(Tn)return Tn;var t,s=Wo,r=s.length,a,n="value"in us?us.value:us.textContent,l=n.length;for(t=0;t<r&&s[t]===n[t];t++);var i=r-t;for(a=1;a<=i&&s[r-a]===n[l-a];a++);return Tn=n.slice(t,1<a?1-a:void 0)}function An(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function cn(){return!0}function Xc(){return!1}function xt(t){function s(r,a,n,l,i){this._reactName=r,this._targetInst=n,this.type=a,this.nativeEvent=l,this.target=i,this.currentTarget=null;for(var d in t)t.hasOwnProperty(d)&&(r=t[d],this[d]=r?r(l):l[d]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?cn:Xc,this.isPropagationStopped=Xc,this}return je(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=cn)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=cn)},persist:function(){},isPersistent:cn}),s}var zr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ho=xt(zr),Ha=je({},zr,{view:0,detail:0}),zp=xt(Ha),Vl,Wl,Xr,yl=je({},Ha,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jo,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Xr&&(Xr&&t.type==="mousemove"?(Vl=t.screenX-Xr.screenX,Wl=t.screenY-Xr.screenY):Wl=Vl=0,Xr=t),Vl)},movementY:function(t){return"movementY"in t?t.movementY:Wl}}),Zc=xt(yl),qp=je({},yl,{dataTransfer:0}),Bp=xt(qp),Vp=je({},Ha,{relatedTarget:0}),Hl=xt(Vp),Wp=je({},zr,{animationName:0,elapsedTime:0,pseudoElement:0}),Hp=xt(Wp),Jp=je({},zr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Qp=xt(Jp),Gp=je({},zr,{data:0}),Yc=xt(Gp),Kp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yp(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=Zp[t])?!!s[t]:!1}function Jo(){return Yp}var e0=je({},Ha,{key:function(t){if(t.key){var s=Kp[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=An(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Xp[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jo,charCode:function(t){return t.type==="keypress"?An(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?An(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),t0=xt(e0),s0=je({},yl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ed=xt(s0),r0=je({},Ha,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jo}),a0=xt(r0),n0=je({},zr,{propertyName:0,elapsedTime:0,pseudoElement:0}),l0=xt(n0),i0=je({},yl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),o0=xt(i0),c0=[9,13,27,32],Qo=Xt&&"CompositionEvent"in window,ua=null;Xt&&"documentMode"in document&&(ua=document.documentMode);var d0=Xt&&"TextEvent"in window&&!ua,im=Xt&&(!Qo||ua&&8<ua&&11>=ua),td=" ",sd=!1;function om(t,s){switch(t){case"keyup":return c0.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var xr=!1;function u0(t,s){switch(t){case"compositionend":return cm(s);case"keypress":return s.which!==32?null:(sd=!0,td);case"textInput":return t=s.data,t===td&&sd?null:t;default:return null}}function m0(t,s){if(xr)return t==="compositionend"||!Qo&&om(t,s)?(t=lm(),Tn=Wo=us=null,xr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return im&&s.locale!=="ko"?null:s.data;default:return null}}var h0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rd(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!h0[t.type]:s==="textarea"}function dm(t,s,r,a){zu(a),s=Hn(s,"onChange"),0<s.length&&(r=new Ho("onChange","change",null,r,a),t.push({event:r,listeners:s}))}var ma=null,Ca=null;function x0(t){jm(t,0)}function bl(t){var s=gr(t);if(Iu(s))return t}function p0(t,s){if(t==="change")return s}var um=!1;if(Xt){var Jl;if(Xt){var Ql="oninput"in document;if(!Ql){var ad=document.createElement("div");ad.setAttribute("oninput","return;"),Ql=typeof ad.oninput=="function"}Jl=Ql}else Jl=!1;um=Jl&&(!document.documentMode||9<document.documentMode)}function nd(){ma&&(ma.detachEvent("onpropertychange",mm),Ca=ma=null)}function mm(t){if(t.propertyName==="value"&&bl(Ca)){var s=[];dm(s,Ca,t,Uo(t)),Wu(x0,s)}}function f0(t,s,r){t==="focusin"?(nd(),ma=s,Ca=r,ma.attachEvent("onpropertychange",mm)):t==="focusout"&&nd()}function g0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return bl(Ca)}function y0(t,s){if(t==="click")return bl(s)}function b0(t,s){if(t==="input"||t==="change")return bl(s)}function v0(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Mt=typeof Object.is=="function"?Object.is:v0;function Ea(t,s){if(Mt(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var r=Object.keys(t),a=Object.keys(s);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var n=r[a];if(!vi.call(s,n)||!Mt(t[n],s[n]))return!1}return!0}function ld(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function id(t,s){var r=ld(t);t=0;for(var a;r;){if(r.nodeType===3){if(a=t+r.textContent.length,t<=s&&a>=s)return{node:r,offset:s-t};t=a}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ld(r)}}function hm(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?hm(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function xm(){for(var t=window,s=Fn();s instanceof t.HTMLIFrameElement;){try{var r=typeof s.contentWindow.location.href=="string"}catch{r=!1}if(r)t=s.contentWindow;else break;s=Fn(t.document)}return s}function Go(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}function j0(t){var s=xm(),r=t.focusedElem,a=t.selectionRange;if(s!==r&&r&&r.ownerDocument&&hm(r.ownerDocument.documentElement,r)){if(a!==null&&Go(r)){if(s=a.start,t=a.end,t===void 0&&(t=s),"selectionStart"in r)r.selectionStart=s,r.selectionEnd=Math.min(t,r.value.length);else if(t=(s=r.ownerDocument||document)&&s.defaultView||window,t.getSelection){t=t.getSelection();var n=r.textContent.length,l=Math.min(a.start,n);a=a.end===void 0?l:Math.min(a.end,n),!t.extend&&l>a&&(n=a,a=l,l=n),n=id(r,l);var i=id(r,a);n&&i&&(t.rangeCount!==1||t.anchorNode!==n.node||t.anchorOffset!==n.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(s=s.createRange(),s.setStart(n.node,n.offset),t.removeAllRanges(),l>a?(t.addRange(s),t.extend(i.node,i.offset)):(s.setEnd(i.node,i.offset),t.addRange(s)))}}for(s=[],t=r;t=t.parentNode;)t.nodeType===1&&s.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<s.length;r++)t=s[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var w0=Xt&&"documentMode"in document&&11>=document.documentMode,pr=null,Fi=null,ha=null,Ui=!1;function od(t,s,r){var a=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ui||pr==null||pr!==Fn(a)||(a=pr,"selectionStart"in a&&Go(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),ha&&Ea(ha,a)||(ha=a,a=Hn(Fi,"onSelect"),0<a.length&&(s=new Ho("onSelect","select",null,s,r),t.push({event:s,listeners:a}),s.target=pr)))}function dn(t,s){var r={};return r[t.toLowerCase()]=s.toLowerCase(),r["Webkit"+t]="webkit"+s,r["Moz"+t]="moz"+s,r}var fr={animationend:dn("Animation","AnimationEnd"),animationiteration:dn("Animation","AnimationIteration"),animationstart:dn("Animation","AnimationStart"),transitionend:dn("Transition","TransitionEnd")},Gl={},pm={};Xt&&(pm=document.createElement("div").style,"AnimationEvent"in window||(delete fr.animationend.animation,delete fr.animationiteration.animation,delete fr.animationstart.animation),"TransitionEvent"in window||delete fr.transitionend.transition);function vl(t){if(Gl[t])return Gl[t];if(!fr[t])return t;var s=fr[t],r;for(r in s)if(s.hasOwnProperty(r)&&r in pm)return Gl[t]=s[r];return t}var fm=vl("animationend"),gm=vl("animationiteration"),ym=vl("animationstart"),bm=vl("transitionend"),vm=new Map,cd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ks(t,s){vm.set(t,s),Xs(s,[t])}for(var Kl=0;Kl<cd.length;Kl++){var Xl=cd[Kl],N0=Xl.toLowerCase(),_0=Xl[0].toUpperCase()+Xl.slice(1);ks(N0,"on"+_0)}ks(fm,"onAnimationEnd");ks(gm,"onAnimationIteration");ks(ym,"onAnimationStart");ks("dblclick","onDoubleClick");ks("focusin","onFocus");ks("focusout","onBlur");ks(bm,"onTransitionEnd");Pr("onMouseEnter",["mouseout","mouseover"]);Pr("onMouseLeave",["mouseout","mouseover"]);Pr("onPointerEnter",["pointerout","pointerover"]);Pr("onPointerLeave",["pointerout","pointerover"]);Xs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ia="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),k0=new Set("cancel close invalid load scroll toggle".split(" ").concat(ia));function dd(t,s,r){var a=t.type||"unknown-event";t.currentTarget=r,Np(a,s,void 0,t),t.currentTarget=null}function jm(t,s){s=(s&4)!==0;for(var r=0;r<t.length;r++){var a=t[r],n=a.event;a=a.listeners;e:{var l=void 0;if(s)for(var i=a.length-1;0<=i;i--){var d=a[i],o=d.instance,u=d.currentTarget;if(d=d.listener,o!==l&&n.isPropagationStopped())break e;dd(n,d,u),l=o}else for(i=0;i<a.length;i++){if(d=a[i],o=d.instance,u=d.currentTarget,d=d.listener,o!==l&&n.isPropagationStopped())break e;dd(n,d,u),l=o}}}if(zn)throw t=Li,zn=!1,Li=null,t}function he(t,s){var r=s[Wi];r===void 0&&(r=s[Wi]=new Set);var a=t+"__bubble";r.has(a)||(wm(s,t,2,!1),r.add(a))}function Zl(t,s,r){var a=0;s&&(a|=4),wm(r,t,a,s)}var un="_reactListening"+Math.random().toString(36).slice(2);function Ta(t){if(!t[un]){t[un]=!0,Tu.forEach(function(r){r!=="selectionchange"&&(k0.has(r)||Zl(r,!1,t),Zl(r,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[un]||(s[un]=!0,Zl("selectionchange",!1,s))}}function wm(t,s,r,a){switch(nm(s)){case 1:var n=Fp;break;case 4:n=Up;break;default:n=Vo}r=n.bind(null,s,r,t),n=void 0,!Ii||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(n=!0),a?n!==void 0?t.addEventListener(s,r,{capture:!0,passive:n}):t.addEventListener(s,r,!0):n!==void 0?t.addEventListener(s,r,{passive:n}):t.addEventListener(s,r,!1)}function Yl(t,s,r,a,n){var l=a;if(!(s&1)&&!(s&2)&&a!==null)e:for(;;){if(a===null)return;var i=a.tag;if(i===3||i===4){var d=a.stateNode.containerInfo;if(d===n||d.nodeType===8&&d.parentNode===n)break;if(i===4)for(i=a.return;i!==null;){var o=i.tag;if((o===3||o===4)&&(o=i.stateNode.containerInfo,o===n||o.nodeType===8&&o.parentNode===n))return;i=i.return}for(;d!==null;){if(i=Os(d),i===null)return;if(o=i.tag,o===5||o===6){a=l=i;continue e}d=d.parentNode}}a=a.return}Wu(function(){var u=l,c=Uo(r),x=[];e:{var m=vm.get(t);if(m!==void 0){var f=Ho,y=t;switch(t){case"keypress":if(An(r)===0)break e;case"keydown":case"keyup":f=t0;break;case"focusin":y="focus",f=Hl;break;case"focusout":y="blur",f=Hl;break;case"beforeblur":case"afterblur":f=Hl;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Zc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Bp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=a0;break;case fm:case gm:case ym:f=Hp;break;case bm:f=l0;break;case"scroll":f=zp;break;case"wheel":f=o0;break;case"copy":case"cut":case"paste":f=Qp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=ed}var N=(s&4)!==0,k=!N&&t==="scroll",b=N?m!==null?m+"Capture":null:m;N=[];for(var v=u,h;v!==null;){h=v;var g=h.stateNode;if(h.tag===5&&g!==null&&(h=g,b!==null&&(g=Na(v,b),g!=null&&N.push(Aa(v,g,h)))),k)break;v=v.return}0<N.length&&(m=new f(m,y,null,r,c),x.push({event:m,listeners:N}))}}if(!(s&7)){e:{if(m=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",m&&r!==Mi&&(y=r.relatedTarget||r.fromElement)&&(Os(y)||y[Zt]))break e;if((f||m)&&(m=c.window===c?c:(m=c.ownerDocument)?m.defaultView||m.parentWindow:window,f?(y=r.relatedTarget||r.toElement,f=u,y=y?Os(y):null,y!==null&&(k=Zs(y),y!==k||y.tag!==5&&y.tag!==6)&&(y=null)):(f=null,y=u),f!==y)){if(N=Zc,g="onMouseLeave",b="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(N=ed,g="onPointerLeave",b="onPointerEnter",v="pointer"),k=f==null?m:gr(f),h=y==null?m:gr(y),m=new N(g,v+"leave",f,r,c),m.target=k,m.relatedTarget=h,g=null,Os(c)===u&&(N=new N(b,v+"enter",y,r,c),N.target=h,N.relatedTarget=k,g=N),k=g,f&&y)t:{for(N=f,b=y,v=0,h=N;h;h=ar(h))v++;for(h=0,g=b;g;g=ar(g))h++;for(;0<v-h;)N=ar(N),v--;for(;0<h-v;)b=ar(b),h--;for(;v--;){if(N===b||b!==null&&N===b.alternate)break t;N=ar(N),b=ar(b)}N=null}else N=null;f!==null&&ud(x,m,f,N,!1),y!==null&&k!==null&&ud(x,k,y,N,!0)}}e:{if(m=u?gr(u):window,f=m.nodeName&&m.nodeName.toLowerCase(),f==="select"||f==="input"&&m.type==="file")var w=p0;else if(rd(m))if(um)w=b0;else{w=g0;var S=f0}else(f=m.nodeName)&&f.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(w=y0);if(w&&(w=w(t,u))){dm(x,w,r,c);break e}S&&S(t,m,u),t==="focusout"&&(S=m._wrapperState)&&S.controlled&&m.type==="number"&&Ci(m,"number",m.value)}switch(S=u?gr(u):window,t){case"focusin":(rd(S)||S.contentEditable==="true")&&(pr=S,Fi=u,ha=null);break;case"focusout":ha=Fi=pr=null;break;case"mousedown":Ui=!0;break;case"contextmenu":case"mouseup":case"dragend":Ui=!1,od(x,r,c);break;case"selectionchange":if(w0)break;case"keydown":case"keyup":od(x,r,c)}var j;if(Qo)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else xr?om(t,r)&&(_="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(_="onCompositionStart");_&&(im&&r.locale!=="ko"&&(xr||_!=="onCompositionStart"?_==="onCompositionEnd"&&xr&&(j=lm()):(us=c,Wo="value"in us?us.value:us.textContent,xr=!0)),S=Hn(u,_),0<S.length&&(_=new Yc(_,t,null,r,c),x.push({event:_,listeners:S}),j?_.data=j:(j=cm(r),j!==null&&(_.data=j)))),(j=d0?u0(t,r):m0(t,r))&&(u=Hn(u,"onBeforeInput"),0<u.length&&(c=new Yc("onBeforeInput","beforeinput",null,r,c),x.push({event:c,listeners:u}),c.data=j))}jm(x,s)})}function Aa(t,s,r){return{instance:t,listener:s,currentTarget:r}}function Hn(t,s){for(var r=s+"Capture",a=[];t!==null;){var n=t,l=n.stateNode;n.tag===5&&l!==null&&(n=l,l=Na(t,r),l!=null&&a.unshift(Aa(t,l,n)),l=Na(t,s),l!=null&&a.push(Aa(t,l,n))),t=t.return}return a}function ar(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ud(t,s,r,a,n){for(var l=s._reactName,i=[];r!==null&&r!==a;){var d=r,o=d.alternate,u=d.stateNode;if(o!==null&&o===a)break;d.tag===5&&u!==null&&(d=u,n?(o=Na(r,l),o!=null&&i.unshift(Aa(r,o,d))):n||(o=Na(r,l),o!=null&&i.push(Aa(r,o,d)))),r=r.return}i.length!==0&&t.push({event:s,listeners:i})}var S0=/\r\n?/g,C0=/\u0000|\uFFFD/g;function md(t){return(typeof t=="string"?t:""+t).replace(S0,`
`).replace(C0,"")}function mn(t,s,r){if(s=md(s),md(t)!==s&&r)throw Error(H(425))}function Jn(){}var zi=null,qi=null;function Bi(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Vi=typeof setTimeout=="function"?setTimeout:void 0,E0=typeof clearTimeout=="function"?clearTimeout:void 0,hd=typeof Promise=="function"?Promise:void 0,T0=typeof queueMicrotask=="function"?queueMicrotask:typeof hd<"u"?function(t){return hd.resolve(null).then(t).catch(A0)}:Vi;function A0(t){setTimeout(function(){throw t})}function ei(t,s){var r=s,a=0;do{var n=r.nextSibling;if(t.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(a===0){t.removeChild(n),Sa(s);return}a--}else r!=="$"&&r!=="$?"&&r!=="$!"||a++;r=n}while(r);Sa(s)}function gs(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return t}function xd(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(s===0)return t;s--}else r==="/$"&&s++}t=t.previousSibling}return null}var qr=Math.random().toString(36).slice(2),Rt="__reactFiber$"+qr,Pa="__reactProps$"+qr,Zt="__reactContainer$"+qr,Wi="__reactEvents$"+qr,P0="__reactListeners$"+qr,M0="__reactHandles$"+qr;function Os(t){var s=t[Rt];if(s)return s;for(var r=t.parentNode;r;){if(s=r[Zt]||r[Rt]){if(r=s.alternate,s.child!==null||r!==null&&r.child!==null)for(t=xd(t);t!==null;){if(r=t[Rt])return r;t=xd(t)}return s}t=r,r=t.parentNode}return null}function Ja(t){return t=t[Rt]||t[Zt],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function gr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function jl(t){return t[Pa]||null}var Hi=[],yr=-1;function Ss(t){return{current:t}}function pe(t){0>yr||(t.current=Hi[yr],Hi[yr]=null,yr--)}function me(t,s){yr++,Hi[yr]=t.current,t.current=s}var Ns={},Je=Ss(Ns),at=Ss(!1),Bs=Ns;function Mr(t,s){var r=t.type.contextTypes;if(!r)return Ns;var a=t.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===s)return a.__reactInternalMemoizedMaskedChildContext;var n={},l;for(l in r)n[l]=s[l];return a&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=n),n}function nt(t){return t=t.childContextTypes,t!=null}function Qn(){pe(at),pe(Je)}function pd(t,s,r){if(Je.current!==Ns)throw Error(H(168));me(Je,s),me(at,r)}function Nm(t,s,r){var a=t.stateNode;if(s=s.childContextTypes,typeof a.getChildContext!="function")return r;a=a.getChildContext();for(var n in a)if(!(n in s))throw Error(H(108,fp(t)||"Unknown",n));return je({},r,a)}function Gn(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ns,Bs=Je.current,me(Je,t),me(at,at.current),!0}function fd(t,s,r){var a=t.stateNode;if(!a)throw Error(H(169));r?(t=Nm(t,s,Bs),a.__reactInternalMemoizedMergedChildContext=t,pe(at),pe(Je),me(Je,t)):pe(at),me(at,r)}var Ht=null,wl=!1,ti=!1;function _m(t){Ht===null?Ht=[t]:Ht.push(t)}function D0(t){wl=!0,_m(t)}function Cs(){if(!ti&&Ht!==null){ti=!0;var t=0,s=ce;try{var r=Ht;for(ce=1;t<r.length;t++){var a=r[t];do a=a(!0);while(a!==null)}Ht=null,wl=!1}catch(n){throw Ht!==null&&(Ht=Ht.slice(t+1)),Gu(zo,Cs),n}finally{ce=s,ti=!1}}return null}var br=[],vr=0,Kn=null,Xn=0,ft=[],gt=0,Vs=null,Jt=1,Qt="";function Ms(t,s){br[vr++]=Xn,br[vr++]=Kn,Kn=t,Xn=s}function km(t,s,r){ft[gt++]=Jt,ft[gt++]=Qt,ft[gt++]=Vs,Vs=t;var a=Jt;t=Qt;var n=32-At(a)-1;a&=~(1<<n),r+=1;var l=32-At(s)+n;if(30<l){var i=n-n%5;l=(a&(1<<i)-1).toString(32),a>>=i,n-=i,Jt=1<<32-At(s)+n|r<<n|a,Qt=l+t}else Jt=1<<l|r<<n|a,Qt=t}function Ko(t){t.return!==null&&(Ms(t,1),km(t,1,0))}function Xo(t){for(;t===Kn;)Kn=br[--vr],br[vr]=null,Xn=br[--vr],br[vr]=null;for(;t===Vs;)Vs=ft[--gt],ft[gt]=null,Qt=ft[--gt],ft[gt]=null,Jt=ft[--gt],ft[gt]=null}var ut=null,dt=null,fe=!1,Tt=null;function Sm(t,s){var r=yt(5,null,null,0);r.elementType="DELETED",r.stateNode=s,r.return=t,s=t.deletions,s===null?(t.deletions=[r],t.flags|=16):s.push(r)}function gd(t,s){switch(t.tag){case 5:var r=t.type;return s=s.nodeType!==1||r.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(t.stateNode=s,ut=t,dt=gs(s.firstChild),!0):!1;case 6:return s=t.pendingProps===""||s.nodeType!==3?null:s,s!==null?(t.stateNode=s,ut=t,dt=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(r=Vs!==null?{id:Jt,overflow:Qt}:null,t.memoizedState={dehydrated:s,treeContext:r,retryLane:1073741824},r=yt(18,null,null,0),r.stateNode=s,r.return=t,t.child=r,ut=t,dt=null,!0):!1;default:return!1}}function Ji(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Qi(t){if(fe){var s=dt;if(s){var r=s;if(!gd(t,s)){if(Ji(t))throw Error(H(418));s=gs(r.nextSibling);var a=ut;s&&gd(t,s)?Sm(a,r):(t.flags=t.flags&-4097|2,fe=!1,ut=t)}}else{if(Ji(t))throw Error(H(418));t.flags=t.flags&-4097|2,fe=!1,ut=t}}}function yd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ut=t}function hn(t){if(t!==ut)return!1;if(!fe)return yd(t),fe=!0,!1;var s;if((s=t.tag!==3)&&!(s=t.tag!==5)&&(s=t.type,s=s!=="head"&&s!=="body"&&!Bi(t.type,t.memoizedProps)),s&&(s=dt)){if(Ji(t))throw Cm(),Error(H(418));for(;s;)Sm(t,s),s=gs(s.nextSibling)}if(yd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(s===0){dt=gs(t.nextSibling);break e}s--}else r!=="$"&&r!=="$!"&&r!=="$?"||s++}t=t.nextSibling}dt=null}}else dt=ut?gs(t.stateNode.nextSibling):null;return!0}function Cm(){for(var t=dt;t;)t=gs(t.nextSibling)}function Dr(){dt=ut=null,fe=!1}function Zo(t){Tt===null?Tt=[t]:Tt.push(t)}var I0=ts.ReactCurrentBatchConfig;function Zr(t,s,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(H(309));var a=r.stateNode}if(!a)throw Error(H(147,t));var n=a,l=""+t;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===l?s.ref:(s=function(i){var d=n.refs;i===null?delete d[l]:d[l]=i},s._stringRef=l,s)}if(typeof t!="string")throw Error(H(284));if(!r._owner)throw Error(H(290,t))}return t}function xn(t,s){throw t=Object.prototype.toString.call(s),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t))}function bd(t){var s=t._init;return s(t._payload)}function Em(t){function s(b,v){if(t){var h=b.deletions;h===null?(b.deletions=[v],b.flags|=16):h.push(v)}}function r(b,v){if(!t)return null;for(;v!==null;)s(b,v),v=v.sibling;return null}function a(b,v){for(b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function n(b,v){return b=js(b,v),b.index=0,b.sibling=null,b}function l(b,v,h){return b.index=h,t?(h=b.alternate,h!==null?(h=h.index,h<v?(b.flags|=2,v):h):(b.flags|=2,v)):(b.flags|=1048576,v)}function i(b){return t&&b.alternate===null&&(b.flags|=2),b}function d(b,v,h,g){return v===null||v.tag!==6?(v=oi(h,b.mode,g),v.return=b,v):(v=n(v,h),v.return=b,v)}function o(b,v,h,g){var w=h.type;return w===hr?c(b,v,h.props.children,g,h.key):v!==null&&(v.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===ls&&bd(w)===v.type)?(g=n(v,h.props),g.ref=Zr(b,v,h),g.return=b,g):(g=On(h.type,h.key,h.props,null,b.mode,g),g.ref=Zr(b,v,h),g.return=b,g)}function u(b,v,h,g){return v===null||v.tag!==4||v.stateNode.containerInfo!==h.containerInfo||v.stateNode.implementation!==h.implementation?(v=ci(h,b.mode,g),v.return=b,v):(v=n(v,h.children||[]),v.return=b,v)}function c(b,v,h,g,w){return v===null||v.tag!==7?(v=zs(h,b.mode,g,w),v.return=b,v):(v=n(v,h),v.return=b,v)}function x(b,v,h){if(typeof v=="string"&&v!==""||typeof v=="number")return v=oi(""+v,b.mode,h),v.return=b,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case sn:return h=On(v.type,v.key,v.props,null,b.mode,h),h.ref=Zr(b,null,v),h.return=b,h;case mr:return v=ci(v,b.mode,h),v.return=b,v;case ls:var g=v._init;return x(b,g(v._payload),h)}if(na(v)||Jr(v))return v=zs(v,b.mode,h,null),v.return=b,v;xn(b,v)}return null}function m(b,v,h,g){var w=v!==null?v.key:null;if(typeof h=="string"&&h!==""||typeof h=="number")return w!==null?null:d(b,v,""+h,g);if(typeof h=="object"&&h!==null){switch(h.$$typeof){case sn:return h.key===w?o(b,v,h,g):null;case mr:return h.key===w?u(b,v,h,g):null;case ls:return w=h._init,m(b,v,w(h._payload),g)}if(na(h)||Jr(h))return w!==null?null:c(b,v,h,g,null);xn(b,h)}return null}function f(b,v,h,g,w){if(typeof g=="string"&&g!==""||typeof g=="number")return b=b.get(h)||null,d(v,b,""+g,w);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case sn:return b=b.get(g.key===null?h:g.key)||null,o(v,b,g,w);case mr:return b=b.get(g.key===null?h:g.key)||null,u(v,b,g,w);case ls:var S=g._init;return f(b,v,h,S(g._payload),w)}if(na(g)||Jr(g))return b=b.get(h)||null,c(v,b,g,w,null);xn(v,g)}return null}function y(b,v,h,g){for(var w=null,S=null,j=v,_=v=0,M=null;j!==null&&_<h.length;_++){j.index>_?(M=j,j=null):M=j.sibling;var R=m(b,j,h[_],g);if(R===null){j===null&&(j=M);break}t&&j&&R.alternate===null&&s(b,j),v=l(R,v,_),S===null?w=R:S.sibling=R,S=R,j=M}if(_===h.length)return r(b,j),fe&&Ms(b,_),w;if(j===null){for(;_<h.length;_++)j=x(b,h[_],g),j!==null&&(v=l(j,v,_),S===null?w=j:S.sibling=j,S=j);return fe&&Ms(b,_),w}for(j=a(b,j);_<h.length;_++)M=f(j,b,_,h[_],g),M!==null&&(t&&M.alternate!==null&&j.delete(M.key===null?_:M.key),v=l(M,v,_),S===null?w=M:S.sibling=M,S=M);return t&&j.forEach(function(O){return s(b,O)}),fe&&Ms(b,_),w}function N(b,v,h,g){var w=Jr(h);if(typeof w!="function")throw Error(H(150));if(h=w.call(h),h==null)throw Error(H(151));for(var S=w=null,j=v,_=v=0,M=null,R=h.next();j!==null&&!R.done;_++,R=h.next()){j.index>_?(M=j,j=null):M=j.sibling;var O=m(b,j,R.value,g);if(O===null){j===null&&(j=M);break}t&&j&&O.alternate===null&&s(b,j),v=l(O,v,_),S===null?w=O:S.sibling=O,S=O,j=M}if(R.done)return r(b,j),fe&&Ms(b,_),w;if(j===null){for(;!R.done;_++,R=h.next())R=x(b,R.value,g),R!==null&&(v=l(R,v,_),S===null?w=R:S.sibling=R,S=R);return fe&&Ms(b,_),w}for(j=a(b,j);!R.done;_++,R=h.next())R=f(j,b,_,R.value,g),R!==null&&(t&&R.alternate!==null&&j.delete(R.key===null?_:R.key),v=l(R,v,_),S===null?w=R:S.sibling=R,S=R);return t&&j.forEach(function(I){return s(b,I)}),fe&&Ms(b,_),w}function k(b,v,h,g){if(typeof h=="object"&&h!==null&&h.type===hr&&h.key===null&&(h=h.props.children),typeof h=="object"&&h!==null){switch(h.$$typeof){case sn:e:{for(var w=h.key,S=v;S!==null;){if(S.key===w){if(w=h.type,w===hr){if(S.tag===7){r(b,S.sibling),v=n(S,h.props.children),v.return=b,b=v;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===ls&&bd(w)===S.type){r(b,S.sibling),v=n(S,h.props),v.ref=Zr(b,S,h),v.return=b,b=v;break e}r(b,S);break}else s(b,S);S=S.sibling}h.type===hr?(v=zs(h.props.children,b.mode,g,h.key),v.return=b,b=v):(g=On(h.type,h.key,h.props,null,b.mode,g),g.ref=Zr(b,v,h),g.return=b,b=g)}return i(b);case mr:e:{for(S=h.key;v!==null;){if(v.key===S)if(v.tag===4&&v.stateNode.containerInfo===h.containerInfo&&v.stateNode.implementation===h.implementation){r(b,v.sibling),v=n(v,h.children||[]),v.return=b,b=v;break e}else{r(b,v);break}else s(b,v);v=v.sibling}v=ci(h,b.mode,g),v.return=b,b=v}return i(b);case ls:return S=h._init,k(b,v,S(h._payload),g)}if(na(h))return y(b,v,h,g);if(Jr(h))return N(b,v,h,g);xn(b,h)}return typeof h=="string"&&h!==""||typeof h=="number"?(h=""+h,v!==null&&v.tag===6?(r(b,v.sibling),v=n(v,h),v.return=b,b=v):(r(b,v),v=oi(h,b.mode,g),v.return=b,b=v),i(b)):r(b,v)}return k}var Ir=Em(!0),Tm=Em(!1),Zn=Ss(null),Yn=null,jr=null,Yo=null;function ec(){Yo=jr=Yn=null}function tc(t){var s=Zn.current;pe(Zn),t._currentValue=s}function Gi(t,s,r){for(;t!==null;){var a=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,a!==null&&(a.childLanes|=s)):a!==null&&(a.childLanes&s)!==s&&(a.childLanes|=s),t===r)break;t=t.return}}function Tr(t,s){Yn=t,Yo=jr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&s&&(rt=!0),t.firstContext=null)}function jt(t){var s=t._currentValue;if(Yo!==t)if(t={context:t,memoizedValue:s,next:null},jr===null){if(Yn===null)throw Error(H(308));jr=t,Yn.dependencies={lanes:0,firstContext:t}}else jr=jr.next=t;return s}var $s=null;function sc(t){$s===null?$s=[t]:$s.push(t)}function Am(t,s,r,a){var n=s.interleaved;return n===null?(r.next=r,sc(s)):(r.next=n.next,n.next=r),s.interleaved=r,Yt(t,a)}function Yt(t,s){t.lanes|=s;var r=t.alternate;for(r!==null&&(r.lanes|=s),r=t,t=t.return;t!==null;)t.childLanes|=s,r=t.alternate,r!==null&&(r.childLanes|=s),r=t,t=t.return;return r.tag===3?r.stateNode:null}var is=!1;function rc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pm(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Gt(t,s){return{eventTime:t,lane:s,tag:0,payload:null,callback:null,next:null}}function ys(t,s,r){var a=t.updateQueue;if(a===null)return null;if(a=a.shared,ne&2){var n=a.pending;return n===null?s.next=s:(s.next=n.next,n.next=s),a.pending=s,Yt(t,r)}return n=a.interleaved,n===null?(s.next=s,sc(a)):(s.next=n.next,n.next=s),a.interleaved=s,Yt(t,r)}function Pn(t,s,r){if(s=s.updateQueue,s!==null&&(s=s.shared,(r&4194240)!==0)){var a=s.lanes;a&=t.pendingLanes,r|=a,s.lanes=r,qo(t,r)}}function vd(t,s){var r=t.updateQueue,a=t.alternate;if(a!==null&&(a=a.updateQueue,r===a)){var n=null,l=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};l===null?n=l=i:l=l.next=i,r=r.next}while(r!==null);l===null?n=l=s:l=l.next=s}else n=l=s;r={baseState:a.baseState,firstBaseUpdate:n,lastBaseUpdate:l,shared:a.shared,effects:a.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=s:t.next=s,r.lastBaseUpdate=s}function el(t,s,r,a){var n=t.updateQueue;is=!1;var l=n.firstBaseUpdate,i=n.lastBaseUpdate,d=n.shared.pending;if(d!==null){n.shared.pending=null;var o=d,u=o.next;o.next=null,i===null?l=u:i.next=u,i=o;var c=t.alternate;c!==null&&(c=c.updateQueue,d=c.lastBaseUpdate,d!==i&&(d===null?c.firstBaseUpdate=u:d.next=u,c.lastBaseUpdate=o))}if(l!==null){var x=n.baseState;i=0,c=u=o=null,d=l;do{var m=d.lane,f=d.eventTime;if((a&m)===m){c!==null&&(c=c.next={eventTime:f,lane:0,tag:d.tag,payload:d.payload,callback:d.callback,next:null});e:{var y=t,N=d;switch(m=s,f=r,N.tag){case 1:if(y=N.payload,typeof y=="function"){x=y.call(f,x,m);break e}x=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=N.payload,m=typeof y=="function"?y.call(f,x,m):y,m==null)break e;x=je({},x,m);break e;case 2:is=!0}}d.callback!==null&&d.lane!==0&&(t.flags|=64,m=n.effects,m===null?n.effects=[d]:m.push(d))}else f={eventTime:f,lane:m,tag:d.tag,payload:d.payload,callback:d.callback,next:null},c===null?(u=c=f,o=x):c=c.next=f,i|=m;if(d=d.next,d===null){if(d=n.shared.pending,d===null)break;m=d,d=m.next,m.next=null,n.lastBaseUpdate=m,n.shared.pending=null}}while(!0);if(c===null&&(o=x),n.baseState=o,n.firstBaseUpdate=u,n.lastBaseUpdate=c,s=n.shared.interleaved,s!==null){n=s;do i|=n.lane,n=n.next;while(n!==s)}else l===null&&(n.shared.lanes=0);Hs|=i,t.lanes=i,t.memoizedState=x}}function jd(t,s,r){if(t=s.effects,s.effects=null,t!==null)for(s=0;s<t.length;s++){var a=t[s],n=a.callback;if(n!==null){if(a.callback=null,a=r,typeof n!="function")throw Error(H(191,n));n.call(a)}}}var Qa={},$t=Ss(Qa),Ma=Ss(Qa),Da=Ss(Qa);function Fs(t){if(t===Qa)throw Error(H(174));return t}function ac(t,s){switch(me(Da,s),me(Ma,t),me($t,Qa),t=s.nodeType,t){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Ti(null,"");break;default:t=t===8?s.parentNode:s,s=t.namespaceURI||null,t=t.tagName,s=Ti(s,t)}pe($t),me($t,s)}function Lr(){pe($t),pe(Ma),pe(Da)}function Mm(t){Fs(Da.current);var s=Fs($t.current),r=Ti(s,t.type);s!==r&&(me(Ma,t),me($t,r))}function nc(t){Ma.current===t&&(pe($t),pe(Ma))}var be=Ss(0);function tl(t){for(var s=t;s!==null;){if(s.tag===13){var r=s.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var si=[];function lc(){for(var t=0;t<si.length;t++)si[t]._workInProgressVersionPrimary=null;si.length=0}var Mn=ts.ReactCurrentDispatcher,ri=ts.ReactCurrentBatchConfig,Ws=0,ve=null,Ie=null,Re=null,sl=!1,xa=!1,Ia=0,L0=0;function Ve(){throw Error(H(321))}function ic(t,s){if(s===null)return!1;for(var r=0;r<s.length&&r<t.length;r++)if(!Mt(t[r],s[r]))return!1;return!0}function oc(t,s,r,a,n,l){if(Ws=l,ve=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Mn.current=t===null||t.memoizedState===null?F0:U0,t=r(a,n),xa){l=0;do{if(xa=!1,Ia=0,25<=l)throw Error(H(301));l+=1,Re=Ie=null,s.updateQueue=null,Mn.current=z0,t=r(a,n)}while(xa)}if(Mn.current=rl,s=Ie!==null&&Ie.next!==null,Ws=0,Re=Ie=ve=null,sl=!1,s)throw Error(H(300));return t}function cc(){var t=Ia!==0;return Ia=0,t}function It(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Re===null?ve.memoizedState=Re=t:Re=Re.next=t,Re}function wt(){if(Ie===null){var t=ve.alternate;t=t!==null?t.memoizedState:null}else t=Ie.next;var s=Re===null?ve.memoizedState:Re.next;if(s!==null)Re=s,Ie=t;else{if(t===null)throw Error(H(310));Ie=t,t={memoizedState:Ie.memoizedState,baseState:Ie.baseState,baseQueue:Ie.baseQueue,queue:Ie.queue,next:null},Re===null?ve.memoizedState=Re=t:Re=Re.next=t}return Re}function La(t,s){return typeof s=="function"?s(t):s}function ai(t){var s=wt(),r=s.queue;if(r===null)throw Error(H(311));r.lastRenderedReducer=t;var a=Ie,n=a.baseQueue,l=r.pending;if(l!==null){if(n!==null){var i=n.next;n.next=l.next,l.next=i}a.baseQueue=n=l,r.pending=null}if(n!==null){l=n.next,a=a.baseState;var d=i=null,o=null,u=l;do{var c=u.lane;if((Ws&c)===c)o!==null&&(o=o.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),a=u.hasEagerState?u.eagerState:t(a,u.action);else{var x={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};o===null?(d=o=x,i=a):o=o.next=x,ve.lanes|=c,Hs|=c}u=u.next}while(u!==null&&u!==l);o===null?i=a:o.next=d,Mt(a,s.memoizedState)||(rt=!0),s.memoizedState=a,s.baseState=i,s.baseQueue=o,r.lastRenderedState=a}if(t=r.interleaved,t!==null){n=t;do l=n.lane,ve.lanes|=l,Hs|=l,n=n.next;while(n!==t)}else n===null&&(r.lanes=0);return[s.memoizedState,r.dispatch]}function ni(t){var s=wt(),r=s.queue;if(r===null)throw Error(H(311));r.lastRenderedReducer=t;var a=r.dispatch,n=r.pending,l=s.memoizedState;if(n!==null){r.pending=null;var i=n=n.next;do l=t(l,i.action),i=i.next;while(i!==n);Mt(l,s.memoizedState)||(rt=!0),s.memoizedState=l,s.baseQueue===null&&(s.baseState=l),r.lastRenderedState=l}return[l,a]}function Dm(){}function Im(t,s){var r=ve,a=wt(),n=s(),l=!Mt(a.memoizedState,n);if(l&&(a.memoizedState=n,rt=!0),a=a.queue,dc(Om.bind(null,r,a,t),[t]),a.getSnapshot!==s||l||Re!==null&&Re.memoizedState.tag&1){if(r.flags|=2048,Ra(9,Rm.bind(null,r,a,n,s),void 0,null),Oe===null)throw Error(H(349));Ws&30||Lm(r,s,n)}return n}function Lm(t,s,r){t.flags|=16384,t={getSnapshot:s,value:r},s=ve.updateQueue,s===null?(s={lastEffect:null,stores:null},ve.updateQueue=s,s.stores=[t]):(r=s.stores,r===null?s.stores=[t]:r.push(t))}function Rm(t,s,r,a){s.value=r,s.getSnapshot=a,$m(s)&&Fm(t)}function Om(t,s,r){return r(function(){$m(s)&&Fm(t)})}function $m(t){var s=t.getSnapshot;t=t.value;try{var r=s();return!Mt(t,r)}catch{return!0}}function Fm(t){var s=Yt(t,1);s!==null&&Pt(s,t,1,-1)}function wd(t){var s=It();return typeof t=="function"&&(t=t()),s.memoizedState=s.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:La,lastRenderedState:t},s.queue=t,t=t.dispatch=$0.bind(null,ve,t),[s.memoizedState,t]}function Ra(t,s,r,a){return t={tag:t,create:s,destroy:r,deps:a,next:null},s=ve.updateQueue,s===null?(s={lastEffect:null,stores:null},ve.updateQueue=s,s.lastEffect=t.next=t):(r=s.lastEffect,r===null?s.lastEffect=t.next=t:(a=r.next,r.next=t,t.next=a,s.lastEffect=t)),t}function Um(){return wt().memoizedState}function Dn(t,s,r,a){var n=It();ve.flags|=t,n.memoizedState=Ra(1|s,r,void 0,a===void 0?null:a)}function Nl(t,s,r,a){var n=wt();a=a===void 0?null:a;var l=void 0;if(Ie!==null){var i=Ie.memoizedState;if(l=i.destroy,a!==null&&ic(a,i.deps)){n.memoizedState=Ra(s,r,l,a);return}}ve.flags|=t,n.memoizedState=Ra(1|s,r,l,a)}function Nd(t,s){return Dn(8390656,8,t,s)}function dc(t,s){return Nl(2048,8,t,s)}function zm(t,s){return Nl(4,2,t,s)}function qm(t,s){return Nl(4,4,t,s)}function Bm(t,s){if(typeof s=="function")return t=t(),s(t),function(){s(null)};if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function Vm(t,s,r){return r=r!=null?r.concat([t]):null,Nl(4,4,Bm.bind(null,s,t),r)}function uc(){}function Wm(t,s){var r=wt();s=s===void 0?null:s;var a=r.memoizedState;return a!==null&&s!==null&&ic(s,a[1])?a[0]:(r.memoizedState=[t,s],t)}function Hm(t,s){var r=wt();s=s===void 0?null:s;var a=r.memoizedState;return a!==null&&s!==null&&ic(s,a[1])?a[0]:(t=t(),r.memoizedState=[t,s],t)}function Jm(t,s,r){return Ws&21?(Mt(r,s)||(r=Zu(),ve.lanes|=r,Hs|=r,t.baseState=!0),s):(t.baseState&&(t.baseState=!1,rt=!0),t.memoizedState=r)}function R0(t,s){var r=ce;ce=r!==0&&4>r?r:4,t(!0);var a=ri.transition;ri.transition={};try{t(!1),s()}finally{ce=r,ri.transition=a}}function Qm(){return wt().memoizedState}function O0(t,s,r){var a=vs(t);if(r={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null},Gm(t))Km(s,r);else if(r=Am(t,s,r,a),r!==null){var n=Ke();Pt(r,t,a,n),Xm(r,s,a)}}function $0(t,s,r){var a=vs(t),n={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null};if(Gm(t))Km(s,n);else{var l=t.alternate;if(t.lanes===0&&(l===null||l.lanes===0)&&(l=s.lastRenderedReducer,l!==null))try{var i=s.lastRenderedState,d=l(i,r);if(n.hasEagerState=!0,n.eagerState=d,Mt(d,i)){var o=s.interleaved;o===null?(n.next=n,sc(s)):(n.next=o.next,o.next=n),s.interleaved=n;return}}catch{}finally{}r=Am(t,s,n,a),r!==null&&(n=Ke(),Pt(r,t,a,n),Xm(r,s,a))}}function Gm(t){var s=t.alternate;return t===ve||s!==null&&s===ve}function Km(t,s){xa=sl=!0;var r=t.pending;r===null?s.next=s:(s.next=r.next,r.next=s),t.pending=s}function Xm(t,s,r){if(r&4194240){var a=s.lanes;a&=t.pendingLanes,r|=a,s.lanes=r,qo(t,r)}}var rl={readContext:jt,useCallback:Ve,useContext:Ve,useEffect:Ve,useImperativeHandle:Ve,useInsertionEffect:Ve,useLayoutEffect:Ve,useMemo:Ve,useReducer:Ve,useRef:Ve,useState:Ve,useDebugValue:Ve,useDeferredValue:Ve,useTransition:Ve,useMutableSource:Ve,useSyncExternalStore:Ve,useId:Ve,unstable_isNewReconciler:!1},F0={readContext:jt,useCallback:function(t,s){return It().memoizedState=[t,s===void 0?null:s],t},useContext:jt,useEffect:Nd,useImperativeHandle:function(t,s,r){return r=r!=null?r.concat([t]):null,Dn(4194308,4,Bm.bind(null,s,t),r)},useLayoutEffect:function(t,s){return Dn(4194308,4,t,s)},useInsertionEffect:function(t,s){return Dn(4,2,t,s)},useMemo:function(t,s){var r=It();return s=s===void 0?null:s,t=t(),r.memoizedState=[t,s],t},useReducer:function(t,s,r){var a=It();return s=r!==void 0?r(s):s,a.memoizedState=a.baseState=s,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:s},a.queue=t,t=t.dispatch=O0.bind(null,ve,t),[a.memoizedState,t]},useRef:function(t){var s=It();return t={current:t},s.memoizedState=t},useState:wd,useDebugValue:uc,useDeferredValue:function(t){return It().memoizedState=t},useTransition:function(){var t=wd(!1),s=t[0];return t=R0.bind(null,t[1]),It().memoizedState=t,[s,t]},useMutableSource:function(){},useSyncExternalStore:function(t,s,r){var a=ve,n=It();if(fe){if(r===void 0)throw Error(H(407));r=r()}else{if(r=s(),Oe===null)throw Error(H(349));Ws&30||Lm(a,s,r)}n.memoizedState=r;var l={value:r,getSnapshot:s};return n.queue=l,Nd(Om.bind(null,a,l,t),[t]),a.flags|=2048,Ra(9,Rm.bind(null,a,l,r,s),void 0,null),r},useId:function(){var t=It(),s=Oe.identifierPrefix;if(fe){var r=Qt,a=Jt;r=(a&~(1<<32-At(a)-1)).toString(32)+r,s=":"+s+"R"+r,r=Ia++,0<r&&(s+="H"+r.toString(32)),s+=":"}else r=L0++,s=":"+s+"r"+r.toString(32)+":";return t.memoizedState=s},unstable_isNewReconciler:!1},U0={readContext:jt,useCallback:Wm,useContext:jt,useEffect:dc,useImperativeHandle:Vm,useInsertionEffect:zm,useLayoutEffect:qm,useMemo:Hm,useReducer:ai,useRef:Um,useState:function(){return ai(La)},useDebugValue:uc,useDeferredValue:function(t){var s=wt();return Jm(s,Ie.memoizedState,t)},useTransition:function(){var t=ai(La)[0],s=wt().memoizedState;return[t,s]},useMutableSource:Dm,useSyncExternalStore:Im,useId:Qm,unstable_isNewReconciler:!1},z0={readContext:jt,useCallback:Wm,useContext:jt,useEffect:dc,useImperativeHandle:Vm,useInsertionEffect:zm,useLayoutEffect:qm,useMemo:Hm,useReducer:ni,useRef:Um,useState:function(){return ni(La)},useDebugValue:uc,useDeferredValue:function(t){var s=wt();return Ie===null?s.memoizedState=t:Jm(s,Ie.memoizedState,t)},useTransition:function(){var t=ni(La)[0],s=wt().memoizedState;return[t,s]},useMutableSource:Dm,useSyncExternalStore:Im,useId:Qm,unstable_isNewReconciler:!1};function St(t,s){if(t&&t.defaultProps){s=je({},s),t=t.defaultProps;for(var r in t)s[r]===void 0&&(s[r]=t[r]);return s}return s}function Ki(t,s,r,a){s=t.memoizedState,r=r(a,s),r=r==null?s:je({},s,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var _l={isMounted:function(t){return(t=t._reactInternals)?Zs(t)===t:!1},enqueueSetState:function(t,s,r){t=t._reactInternals;var a=Ke(),n=vs(t),l=Gt(a,n);l.payload=s,r!=null&&(l.callback=r),s=ys(t,l,n),s!==null&&(Pt(s,t,n,a),Pn(s,t,n))},enqueueReplaceState:function(t,s,r){t=t._reactInternals;var a=Ke(),n=vs(t),l=Gt(a,n);l.tag=1,l.payload=s,r!=null&&(l.callback=r),s=ys(t,l,n),s!==null&&(Pt(s,t,n,a),Pn(s,t,n))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var r=Ke(),a=vs(t),n=Gt(r,a);n.tag=2,s!=null&&(n.callback=s),s=ys(t,n,a),s!==null&&(Pt(s,t,a,r),Pn(s,t,a))}};function _d(t,s,r,a,n,l,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(a,l,i):s.prototype&&s.prototype.isPureReactComponent?!Ea(r,a)||!Ea(n,l):!0}function Zm(t,s,r){var a=!1,n=Ns,l=s.contextType;return typeof l=="object"&&l!==null?l=jt(l):(n=nt(s)?Bs:Je.current,a=s.contextTypes,l=(a=a!=null)?Mr(t,n):Ns),s=new s(r,l),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=_l,t.stateNode=s,s._reactInternals=t,a&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=l),s}function kd(t,s,r,a){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(r,a),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(r,a),s.state!==t&&_l.enqueueReplaceState(s,s.state,null)}function Xi(t,s,r,a){var n=t.stateNode;n.props=r,n.state=t.memoizedState,n.refs={},rc(t);var l=s.contextType;typeof l=="object"&&l!==null?n.context=jt(l):(l=nt(s)?Bs:Je.current,n.context=Mr(t,l)),n.state=t.memoizedState,l=s.getDerivedStateFromProps,typeof l=="function"&&(Ki(t,s,l,r),n.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(s=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),s!==n.state&&_l.enqueueReplaceState(n,n.state,null),el(t,r,n,a),n.state=t.memoizedState),typeof n.componentDidMount=="function"&&(t.flags|=4194308)}function Rr(t,s){try{var r="",a=s;do r+=pp(a),a=a.return;while(a);var n=r}catch(l){n=`
Error generating stack: `+l.message+`
`+l.stack}return{value:t,source:s,stack:n,digest:null}}function li(t,s,r){return{value:t,source:null,stack:r??null,digest:s??null}}function Zi(t,s){try{console.error(s.value)}catch(r){setTimeout(function(){throw r})}}var q0=typeof WeakMap=="function"?WeakMap:Map;function Ym(t,s,r){r=Gt(-1,r),r.tag=3,r.payload={element:null};var a=s.value;return r.callback=function(){nl||(nl=!0,oo=a),Zi(t,s)},r}function eh(t,s,r){r=Gt(-1,r),r.tag=3;var a=t.type.getDerivedStateFromError;if(typeof a=="function"){var n=s.value;r.payload=function(){return a(n)},r.callback=function(){Zi(t,s)}}var l=t.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(r.callback=function(){Zi(t,s),typeof a!="function"&&(bs===null?bs=new Set([this]):bs.add(this));var i=s.stack;this.componentDidCatch(s.value,{componentStack:i!==null?i:""})}),r}function Sd(t,s,r){var a=t.pingCache;if(a===null){a=t.pingCache=new q0;var n=new Set;a.set(s,n)}else n=a.get(s),n===void 0&&(n=new Set,a.set(s,n));n.has(r)||(n.add(r),t=sf.bind(null,t,s,r),s.then(t,t))}function Cd(t){do{var s;if((s=t.tag===13)&&(s=t.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return t;t=t.return}while(t!==null);return null}function Ed(t,s,r,a,n){return t.mode&1?(t.flags|=65536,t.lanes=n,t):(t===s?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(s=Gt(-1,1),s.tag=2,ys(r,s,1))),r.lanes|=1),t)}var B0=ts.ReactCurrentOwner,rt=!1;function Ge(t,s,r,a){s.child=t===null?Tm(s,null,r,a):Ir(s,t.child,r,a)}function Td(t,s,r,a,n){r=r.render;var l=s.ref;return Tr(s,n),a=oc(t,s,r,a,l,n),r=cc(),t!==null&&!rt?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~n,es(t,s,n)):(fe&&r&&Ko(s),s.flags|=1,Ge(t,s,a,n),s.child)}function Ad(t,s,r,a,n){if(t===null){var l=r.type;return typeof l=="function"&&!bc(l)&&l.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(s.tag=15,s.type=l,th(t,s,l,a,n)):(t=On(r.type,null,a,s,s.mode,n),t.ref=s.ref,t.return=s,s.child=t)}if(l=t.child,!(t.lanes&n)){var i=l.memoizedProps;if(r=r.compare,r=r!==null?r:Ea,r(i,a)&&t.ref===s.ref)return es(t,s,n)}return s.flags|=1,t=js(l,a),t.ref=s.ref,t.return=s,s.child=t}function th(t,s,r,a,n){if(t!==null){var l=t.memoizedProps;if(Ea(l,a)&&t.ref===s.ref)if(rt=!1,s.pendingProps=a=l,(t.lanes&n)!==0)t.flags&131072&&(rt=!0);else return s.lanes=t.lanes,es(t,s,n)}return Yi(t,s,r,a,n)}function sh(t,s,r){var a=s.pendingProps,n=a.children,l=t!==null?t.memoizedState:null;if(a.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},me(Nr,ot),ot|=r;else{if(!(r&1073741824))return t=l!==null?l.baseLanes|r:r,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:t,cachePool:null,transitions:null},s.updateQueue=null,me(Nr,ot),ot|=t,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=l!==null?l.baseLanes:r,me(Nr,ot),ot|=a}else l!==null?(a=l.baseLanes|r,s.memoizedState=null):a=r,me(Nr,ot),ot|=a;return Ge(t,s,n,r),s.child}function rh(t,s){var r=s.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(s.flags|=512,s.flags|=2097152)}function Yi(t,s,r,a,n){var l=nt(r)?Bs:Je.current;return l=Mr(s,l),Tr(s,n),r=oc(t,s,r,a,l,n),a=cc(),t!==null&&!rt?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~n,es(t,s,n)):(fe&&a&&Ko(s),s.flags|=1,Ge(t,s,r,n),s.child)}function Pd(t,s,r,a,n){if(nt(r)){var l=!0;Gn(s)}else l=!1;if(Tr(s,n),s.stateNode===null)In(t,s),Zm(s,r,a),Xi(s,r,a,n),a=!0;else if(t===null){var i=s.stateNode,d=s.memoizedProps;i.props=d;var o=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=jt(u):(u=nt(r)?Bs:Je.current,u=Mr(s,u));var c=r.getDerivedStateFromProps,x=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";x||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(d!==a||o!==u)&&kd(s,i,a,u),is=!1;var m=s.memoizedState;i.state=m,el(s,a,i,n),o=s.memoizedState,d!==a||m!==o||at.current||is?(typeof c=="function"&&(Ki(s,r,c,a),o=s.memoizedState),(d=is||_d(s,r,d,a,m,o,u))?(x||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(s.flags|=4194308)):(typeof i.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=a,s.memoizedState=o),i.props=a,i.state=o,i.context=u,a=d):(typeof i.componentDidMount=="function"&&(s.flags|=4194308),a=!1)}else{i=s.stateNode,Pm(t,s),d=s.memoizedProps,u=s.type===s.elementType?d:St(s.type,d),i.props=u,x=s.pendingProps,m=i.context,o=r.contextType,typeof o=="object"&&o!==null?o=jt(o):(o=nt(r)?Bs:Je.current,o=Mr(s,o));var f=r.getDerivedStateFromProps;(c=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(d!==x||m!==o)&&kd(s,i,a,o),is=!1,m=s.memoizedState,i.state=m,el(s,a,i,n);var y=s.memoizedState;d!==x||m!==y||at.current||is?(typeof f=="function"&&(Ki(s,r,f,a),y=s.memoizedState),(u=is||_d(s,r,u,a,m,y,o)||!1)?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(a,y,o),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(a,y,o)),typeof i.componentDidUpdate=="function"&&(s.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof i.componentDidUpdate!="function"||d===t.memoizedProps&&m===t.memoizedState||(s.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||d===t.memoizedProps&&m===t.memoizedState||(s.flags|=1024),s.memoizedProps=a,s.memoizedState=y),i.props=a,i.state=y,i.context=o,a=u):(typeof i.componentDidUpdate!="function"||d===t.memoizedProps&&m===t.memoizedState||(s.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||d===t.memoizedProps&&m===t.memoizedState||(s.flags|=1024),a=!1)}return eo(t,s,r,a,l,n)}function eo(t,s,r,a,n,l){rh(t,s);var i=(s.flags&128)!==0;if(!a&&!i)return n&&fd(s,r,!1),es(t,s,l);a=s.stateNode,B0.current=s;var d=i&&typeof r.getDerivedStateFromError!="function"?null:a.render();return s.flags|=1,t!==null&&i?(s.child=Ir(s,t.child,null,l),s.child=Ir(s,null,d,l)):Ge(t,s,d,l),s.memoizedState=a.state,n&&fd(s,r,!0),s.child}function ah(t){var s=t.stateNode;s.pendingContext?pd(t,s.pendingContext,s.pendingContext!==s.context):s.context&&pd(t,s.context,!1),ac(t,s.containerInfo)}function Md(t,s,r,a,n){return Dr(),Zo(n),s.flags|=256,Ge(t,s,r,a),s.child}var to={dehydrated:null,treeContext:null,retryLane:0};function so(t){return{baseLanes:t,cachePool:null,transitions:null}}function nh(t,s,r){var a=s.pendingProps,n=be.current,l=!1,i=(s.flags&128)!==0,d;if((d=i)||(d=t!==null&&t.memoizedState===null?!1:(n&2)!==0),d?(l=!0,s.flags&=-129):(t===null||t.memoizedState!==null)&&(n|=1),me(be,n&1),t===null)return Qi(s),t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(s.mode&1?t.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(i=a.children,t=a.fallback,l?(a=s.mode,l=s.child,i={mode:"hidden",children:i},!(a&1)&&l!==null?(l.childLanes=0,l.pendingProps=i):l=Cl(i,a,0,null),t=zs(t,a,r,null),l.return=s,t.return=s,l.sibling=t,s.child=l,s.child.memoizedState=so(r),s.memoizedState=to,t):mc(s,i));if(n=t.memoizedState,n!==null&&(d=n.dehydrated,d!==null))return V0(t,s,i,a,d,n,r);if(l){l=a.fallback,i=s.mode,n=t.child,d=n.sibling;var o={mode:"hidden",children:a.children};return!(i&1)&&s.child!==n?(a=s.child,a.childLanes=0,a.pendingProps=o,s.deletions=null):(a=js(n,o),a.subtreeFlags=n.subtreeFlags&14680064),d!==null?l=js(d,l):(l=zs(l,i,r,null),l.flags|=2),l.return=s,a.return=s,a.sibling=l,s.child=a,a=l,l=s.child,i=t.child.memoizedState,i=i===null?so(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},l.memoizedState=i,l.childLanes=t.childLanes&~r,s.memoizedState=to,a}return l=t.child,t=l.sibling,a=js(l,{mode:"visible",children:a.children}),!(s.mode&1)&&(a.lanes=r),a.return=s,a.sibling=null,t!==null&&(r=s.deletions,r===null?(s.deletions=[t],s.flags|=16):r.push(t)),s.child=a,s.memoizedState=null,a}function mc(t,s){return s=Cl({mode:"visible",children:s},t.mode,0,null),s.return=t,t.child=s}function pn(t,s,r,a){return a!==null&&Zo(a),Ir(s,t.child,null,r),t=mc(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function V0(t,s,r,a,n,l,i){if(r)return s.flags&256?(s.flags&=-257,a=li(Error(H(422))),pn(t,s,i,a)):s.memoizedState!==null?(s.child=t.child,s.flags|=128,null):(l=a.fallback,n=s.mode,a=Cl({mode:"visible",children:a.children},n,0,null),l=zs(l,n,i,null),l.flags|=2,a.return=s,l.return=s,a.sibling=l,s.child=a,s.mode&1&&Ir(s,t.child,null,i),s.child.memoizedState=so(i),s.memoizedState=to,l);if(!(s.mode&1))return pn(t,s,i,null);if(n.data==="$!"){if(a=n.nextSibling&&n.nextSibling.dataset,a)var d=a.dgst;return a=d,l=Error(H(419)),a=li(l,a,void 0),pn(t,s,i,a)}if(d=(i&t.childLanes)!==0,rt||d){if(a=Oe,a!==null){switch(i&-i){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(a.suspendedLanes|i)?0:n,n!==0&&n!==l.retryLane&&(l.retryLane=n,Yt(t,n),Pt(a,t,n,-1))}return yc(),a=li(Error(H(421))),pn(t,s,i,a)}return n.data==="$?"?(s.flags|=128,s.child=t.child,s=rf.bind(null,t),n._reactRetry=s,null):(t=l.treeContext,dt=gs(n.nextSibling),ut=s,fe=!0,Tt=null,t!==null&&(ft[gt++]=Jt,ft[gt++]=Qt,ft[gt++]=Vs,Jt=t.id,Qt=t.overflow,Vs=s),s=mc(s,a.children),s.flags|=4096,s)}function Dd(t,s,r){t.lanes|=s;var a=t.alternate;a!==null&&(a.lanes|=s),Gi(t.return,s,r)}function ii(t,s,r,a,n){var l=t.memoizedState;l===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:n}:(l.isBackwards=s,l.rendering=null,l.renderingStartTime=0,l.last=a,l.tail=r,l.tailMode=n)}function lh(t,s,r){var a=s.pendingProps,n=a.revealOrder,l=a.tail;if(Ge(t,s,a.children,r),a=be.current,a&2)a=a&1|2,s.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Dd(t,r,s);else if(t.tag===19)Dd(t,r,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}a&=1}if(me(be,a),!(s.mode&1))s.memoizedState=null;else switch(n){case"forwards":for(r=s.child,n=null;r!==null;)t=r.alternate,t!==null&&tl(t)===null&&(n=r),r=r.sibling;r=n,r===null?(n=s.child,s.child=null):(n=r.sibling,r.sibling=null),ii(s,!1,n,r,l);break;case"backwards":for(r=null,n=s.child,s.child=null;n!==null;){if(t=n.alternate,t!==null&&tl(t)===null){s.child=n;break}t=n.sibling,n.sibling=r,r=n,n=t}ii(s,!0,r,null,l);break;case"together":ii(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function In(t,s){!(s.mode&1)&&t!==null&&(t.alternate=null,s.alternate=null,s.flags|=2)}function es(t,s,r){if(t!==null&&(s.dependencies=t.dependencies),Hs|=s.lanes,!(r&s.childLanes))return null;if(t!==null&&s.child!==t.child)throw Error(H(153));if(s.child!==null){for(t=s.child,r=js(t,t.pendingProps),s.child=r,r.return=s;t.sibling!==null;)t=t.sibling,r=r.sibling=js(t,t.pendingProps),r.return=s;r.sibling=null}return s.child}function W0(t,s,r){switch(s.tag){case 3:ah(s),Dr();break;case 5:Mm(s);break;case 1:nt(s.type)&&Gn(s);break;case 4:ac(s,s.stateNode.containerInfo);break;case 10:var a=s.type._context,n=s.memoizedProps.value;me(Zn,a._currentValue),a._currentValue=n;break;case 13:if(a=s.memoizedState,a!==null)return a.dehydrated!==null?(me(be,be.current&1),s.flags|=128,null):r&s.child.childLanes?nh(t,s,r):(me(be,be.current&1),t=es(t,s,r),t!==null?t.sibling:null);me(be,be.current&1);break;case 19:if(a=(r&s.childLanes)!==0,t.flags&128){if(a)return lh(t,s,r);s.flags|=128}if(n=s.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),me(be,be.current),a)break;return null;case 22:case 23:return s.lanes=0,sh(t,s,r)}return es(t,s,r)}var ih,ro,oh,ch;ih=function(t,s){for(var r=s.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ro=function(){};oh=function(t,s,r,a){var n=t.memoizedProps;if(n!==a){t=s.stateNode,Fs($t.current);var l=null;switch(r){case"input":n=ki(t,n),a=ki(t,a),l=[];break;case"select":n=je({},n,{value:void 0}),a=je({},a,{value:void 0}),l=[];break;case"textarea":n=Ei(t,n),a=Ei(t,a),l=[];break;default:typeof n.onClick!="function"&&typeof a.onClick=="function"&&(t.onclick=Jn)}Ai(r,a);var i;r=null;for(u in n)if(!a.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var d=n[u];for(i in d)d.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ja.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in a){var o=a[u];if(d=n!=null?n[u]:void 0,a.hasOwnProperty(u)&&o!==d&&(o!=null||d!=null))if(u==="style")if(d){for(i in d)!d.hasOwnProperty(i)||o&&o.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in o)o.hasOwnProperty(i)&&d[i]!==o[i]&&(r||(r={}),r[i]=o[i])}else r||(l||(l=[]),l.push(u,r)),r=o;else u==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,d=d?d.__html:void 0,o!=null&&d!==o&&(l=l||[]).push(u,o)):u==="children"?typeof o!="string"&&typeof o!="number"||(l=l||[]).push(u,""+o):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ja.hasOwnProperty(u)?(o!=null&&u==="onScroll"&&he("scroll",t),l||d===o||(l=[])):(l=l||[]).push(u,o))}r&&(l=l||[]).push("style",r);var u=l;(s.updateQueue=u)&&(s.flags|=4)}};ch=function(t,s,r,a){r!==a&&(s.flags|=4)};function Yr(t,s){if(!fe)switch(t.tailMode){case"hidden":s=t.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:a.sibling=null}}function We(t){var s=t.alternate!==null&&t.alternate.child===t.child,r=0,a=0;if(s)for(var n=t.child;n!==null;)r|=n.lanes|n.childLanes,a|=n.subtreeFlags&14680064,a|=n.flags&14680064,n.return=t,n=n.sibling;else for(n=t.child;n!==null;)r|=n.lanes|n.childLanes,a|=n.subtreeFlags,a|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=a,t.childLanes=r,s}function H0(t,s,r){var a=s.pendingProps;switch(Xo(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return We(s),null;case 1:return nt(s.type)&&Qn(),We(s),null;case 3:return a=s.stateNode,Lr(),pe(at),pe(Je),lc(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(t===null||t.child===null)&&(hn(s)?s.flags|=4:t===null||t.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Tt!==null&&(mo(Tt),Tt=null))),ro(t,s),We(s),null;case 5:nc(s);var n=Fs(Da.current);if(r=s.type,t!==null&&s.stateNode!=null)oh(t,s,r,a,n),t.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!a){if(s.stateNode===null)throw Error(H(166));return We(s),null}if(t=Fs($t.current),hn(s)){a=s.stateNode,r=s.type;var l=s.memoizedProps;switch(a[Rt]=s,a[Pa]=l,t=(s.mode&1)!==0,r){case"dialog":he("cancel",a),he("close",a);break;case"iframe":case"object":case"embed":he("load",a);break;case"video":case"audio":for(n=0;n<ia.length;n++)he(ia[n],a);break;case"source":he("error",a);break;case"img":case"image":case"link":he("error",a),he("load",a);break;case"details":he("toggle",a);break;case"input":qc(a,l),he("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!l.multiple},he("invalid",a);break;case"textarea":Vc(a,l),he("invalid",a)}Ai(r,l),n=null;for(var i in l)if(l.hasOwnProperty(i)){var d=l[i];i==="children"?typeof d=="string"?a.textContent!==d&&(l.suppressHydrationWarning!==!0&&mn(a.textContent,d,t),n=["children",d]):typeof d=="number"&&a.textContent!==""+d&&(l.suppressHydrationWarning!==!0&&mn(a.textContent,d,t),n=["children",""+d]):ja.hasOwnProperty(i)&&d!=null&&i==="onScroll"&&he("scroll",a)}switch(r){case"input":rn(a),Bc(a,l,!0);break;case"textarea":rn(a),Wc(a);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(a.onclick=Jn)}a=n,s.updateQueue=a,a!==null&&(s.flags|=4)}else{i=n.nodeType===9?n:n.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Ou(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof a.is=="string"?t=i.createElement(r,{is:a.is}):(t=i.createElement(r),r==="select"&&(i=t,a.multiple?i.multiple=!0:a.size&&(i.size=a.size))):t=i.createElementNS(t,r),t[Rt]=s,t[Pa]=a,ih(t,s,!1,!1),s.stateNode=t;e:{switch(i=Pi(r,a),r){case"dialog":he("cancel",t),he("close",t),n=a;break;case"iframe":case"object":case"embed":he("load",t),n=a;break;case"video":case"audio":for(n=0;n<ia.length;n++)he(ia[n],t);n=a;break;case"source":he("error",t),n=a;break;case"img":case"image":case"link":he("error",t),he("load",t),n=a;break;case"details":he("toggle",t),n=a;break;case"input":qc(t,a),n=ki(t,a),he("invalid",t);break;case"option":n=a;break;case"select":t._wrapperState={wasMultiple:!!a.multiple},n=je({},a,{value:void 0}),he("invalid",t);break;case"textarea":Vc(t,a),n=Ei(t,a),he("invalid",t);break;default:n=a}Ai(r,n),d=n;for(l in d)if(d.hasOwnProperty(l)){var o=d[l];l==="style"?Uu(t,o):l==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,o!=null&&$u(t,o)):l==="children"?typeof o=="string"?(r!=="textarea"||o!=="")&&wa(t,o):typeof o=="number"&&wa(t,""+o):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(ja.hasOwnProperty(l)?o!=null&&l==="onScroll"&&he("scroll",t):o!=null&&Ro(t,l,o,i))}switch(r){case"input":rn(t),Bc(t,a,!1);break;case"textarea":rn(t),Wc(t);break;case"option":a.value!=null&&t.setAttribute("value",""+ws(a.value));break;case"select":t.multiple=!!a.multiple,l=a.value,l!=null?kr(t,!!a.multiple,l,!1):a.defaultValue!=null&&kr(t,!!a.multiple,a.defaultValue,!0);break;default:typeof n.onClick=="function"&&(t.onclick=Jn)}switch(r){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return We(s),null;case 6:if(t&&s.stateNode!=null)ch(t,s,t.memoizedProps,a);else{if(typeof a!="string"&&s.stateNode===null)throw Error(H(166));if(r=Fs(Da.current),Fs($t.current),hn(s)){if(a=s.stateNode,r=s.memoizedProps,a[Rt]=s,(l=a.nodeValue!==r)&&(t=ut,t!==null))switch(t.tag){case 3:mn(a.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&mn(a.nodeValue,r,(t.mode&1)!==0)}l&&(s.flags|=4)}else a=(r.nodeType===9?r:r.ownerDocument).createTextNode(a),a[Rt]=s,s.stateNode=a}return We(s),null;case 13:if(pe(be),a=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(fe&&dt!==null&&s.mode&1&&!(s.flags&128))Cm(),Dr(),s.flags|=98560,l=!1;else if(l=hn(s),a!==null&&a.dehydrated!==null){if(t===null){if(!l)throw Error(H(318));if(l=s.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(H(317));l[Rt]=s}else Dr(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;We(s),l=!1}else Tt!==null&&(mo(Tt),Tt=null),l=!0;if(!l)return s.flags&65536?s:null}return s.flags&128?(s.lanes=r,s):(a=a!==null,a!==(t!==null&&t.memoizedState!==null)&&a&&(s.child.flags|=8192,s.mode&1&&(t===null||be.current&1?Le===0&&(Le=3):yc())),s.updateQueue!==null&&(s.flags|=4),We(s),null);case 4:return Lr(),ro(t,s),t===null&&Ta(s.stateNode.containerInfo),We(s),null;case 10:return tc(s.type._context),We(s),null;case 17:return nt(s.type)&&Qn(),We(s),null;case 19:if(pe(be),l=s.memoizedState,l===null)return We(s),null;if(a=(s.flags&128)!==0,i=l.rendering,i===null)if(a)Yr(l,!1);else{if(Le!==0||t!==null&&t.flags&128)for(t=s.child;t!==null;){if(i=tl(t),i!==null){for(s.flags|=128,Yr(l,!1),a=i.updateQueue,a!==null&&(s.updateQueue=a,s.flags|=4),s.subtreeFlags=0,a=r,r=s.child;r!==null;)l=r,t=a,l.flags&=14680066,i=l.alternate,i===null?(l.childLanes=0,l.lanes=t,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,l.type=i.type,t=i.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return me(be,be.current&1|2),s.child}t=t.sibling}l.tail!==null&&Ce()>Or&&(s.flags|=128,a=!0,Yr(l,!1),s.lanes=4194304)}else{if(!a)if(t=tl(i),t!==null){if(s.flags|=128,a=!0,r=t.updateQueue,r!==null&&(s.updateQueue=r,s.flags|=4),Yr(l,!0),l.tail===null&&l.tailMode==="hidden"&&!i.alternate&&!fe)return We(s),null}else 2*Ce()-l.renderingStartTime>Or&&r!==1073741824&&(s.flags|=128,a=!0,Yr(l,!1),s.lanes=4194304);l.isBackwards?(i.sibling=s.child,s.child=i):(r=l.last,r!==null?r.sibling=i:s.child=i,l.last=i)}return l.tail!==null?(s=l.tail,l.rendering=s,l.tail=s.sibling,l.renderingStartTime=Ce(),s.sibling=null,r=be.current,me(be,a?r&1|2:r&1),s):(We(s),null);case 22:case 23:return gc(),a=s.memoizedState!==null,t!==null&&t.memoizedState!==null!==a&&(s.flags|=8192),a&&s.mode&1?ot&1073741824&&(We(s),s.subtreeFlags&6&&(s.flags|=8192)):We(s),null;case 24:return null;case 25:return null}throw Error(H(156,s.tag))}function J0(t,s){switch(Xo(s),s.tag){case 1:return nt(s.type)&&Qn(),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return Lr(),pe(at),pe(Je),lc(),t=s.flags,t&65536&&!(t&128)?(s.flags=t&-65537|128,s):null;case 5:return nc(s),null;case 13:if(pe(be),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(H(340));Dr()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return pe(be),null;case 4:return Lr(),null;case 10:return tc(s.type._context),null;case 22:case 23:return gc(),null;case 24:return null;default:return null}}var fn=!1,He=!1,Q0=typeof WeakSet=="function"?WeakSet:Set,G=null;function wr(t,s){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(a){_e(t,s,a)}else r.current=null}function ao(t,s,r){try{r()}catch(a){_e(t,s,a)}}var Id=!1;function G0(t,s){if(zi=Vn,t=xm(),Go(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var a=r.getSelection&&r.getSelection();if(a&&a.rangeCount!==0){r=a.anchorNode;var n=a.anchorOffset,l=a.focusNode;a=a.focusOffset;try{r.nodeType,l.nodeType}catch{r=null;break e}var i=0,d=-1,o=-1,u=0,c=0,x=t,m=null;t:for(;;){for(var f;x!==r||n!==0&&x.nodeType!==3||(d=i+n),x!==l||a!==0&&x.nodeType!==3||(o=i+a),x.nodeType===3&&(i+=x.nodeValue.length),(f=x.firstChild)!==null;)m=x,x=f;for(;;){if(x===t)break t;if(m===r&&++u===n&&(d=i),m===l&&++c===a&&(o=i),(f=x.nextSibling)!==null)break;x=m,m=x.parentNode}x=f}r=d===-1||o===-1?null:{start:d,end:o}}else r=null}r=r||{start:0,end:0}}else r=null;for(qi={focusedElem:t,selectionRange:r},Vn=!1,G=s;G!==null;)if(s=G,t=s.child,(s.subtreeFlags&1028)!==0&&t!==null)t.return=s,G=t;else for(;G!==null;){s=G;try{var y=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var N=y.memoizedProps,k=y.memoizedState,b=s.stateNode,v=b.getSnapshotBeforeUpdate(s.elementType===s.type?N:St(s.type,N),k);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var h=s.stateNode.containerInfo;h.nodeType===1?h.textContent="":h.nodeType===9&&h.documentElement&&h.removeChild(h.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(g){_e(s,s.return,g)}if(t=s.sibling,t!==null){t.return=s.return,G=t;break}G=s.return}return y=Id,Id=!1,y}function pa(t,s,r){var a=s.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var n=a=a.next;do{if((n.tag&t)===t){var l=n.destroy;n.destroy=void 0,l!==void 0&&ao(s,r,l)}n=n.next}while(n!==a)}}function kl(t,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var a=r.create;r.destroy=a()}r=r.next}while(r!==s)}}function no(t){var s=t.ref;if(s!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof s=="function"?s(t):s.current=t}}function dh(t){var s=t.alternate;s!==null&&(t.alternate=null,dh(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&(delete s[Rt],delete s[Pa],delete s[Wi],delete s[P0],delete s[M0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function uh(t){return t.tag===5||t.tag===3||t.tag===4}function Ld(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||uh(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function lo(t,s,r){var a=t.tag;if(a===5||a===6)t=t.stateNode,s?r.nodeType===8?r.parentNode.insertBefore(t,s):r.insertBefore(t,s):(r.nodeType===8?(s=r.parentNode,s.insertBefore(t,r)):(s=r,s.appendChild(t)),r=r._reactRootContainer,r!=null||s.onclick!==null||(s.onclick=Jn));else if(a!==4&&(t=t.child,t!==null))for(lo(t,s,r),t=t.sibling;t!==null;)lo(t,s,r),t=t.sibling}function io(t,s,r){var a=t.tag;if(a===5||a===6)t=t.stateNode,s?r.insertBefore(t,s):r.appendChild(t);else if(a!==4&&(t=t.child,t!==null))for(io(t,s,r),t=t.sibling;t!==null;)io(t,s,r),t=t.sibling}var $e=null,Ct=!1;function rs(t,s,r){for(r=r.child;r!==null;)mh(t,s,r),r=r.sibling}function mh(t,s,r){if(Ot&&typeof Ot.onCommitFiberUnmount=="function")try{Ot.onCommitFiberUnmount(gl,r)}catch{}switch(r.tag){case 5:He||wr(r,s);case 6:var a=$e,n=Ct;$e=null,rs(t,s,r),$e=a,Ct=n,$e!==null&&(Ct?(t=$e,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):$e.removeChild(r.stateNode));break;case 18:$e!==null&&(Ct?(t=$e,r=r.stateNode,t.nodeType===8?ei(t.parentNode,r):t.nodeType===1&&ei(t,r),Sa(t)):ei($e,r.stateNode));break;case 4:a=$e,n=Ct,$e=r.stateNode.containerInfo,Ct=!0,rs(t,s,r),$e=a,Ct=n;break;case 0:case 11:case 14:case 15:if(!He&&(a=r.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){n=a=a.next;do{var l=n,i=l.destroy;l=l.tag,i!==void 0&&(l&2||l&4)&&ao(r,s,i),n=n.next}while(n!==a)}rs(t,s,r);break;case 1:if(!He&&(wr(r,s),a=r.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=r.memoizedProps,a.state=r.memoizedState,a.componentWillUnmount()}catch(d){_e(r,s,d)}rs(t,s,r);break;case 21:rs(t,s,r);break;case 22:r.mode&1?(He=(a=He)||r.memoizedState!==null,rs(t,s,r),He=a):rs(t,s,r);break;default:rs(t,s,r)}}function Rd(t){var s=t.updateQueue;if(s!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Q0),s.forEach(function(a){var n=af.bind(null,t,a);r.has(a)||(r.add(a),a.then(n,n))})}}function _t(t,s){var r=s.deletions;if(r!==null)for(var a=0;a<r.length;a++){var n=r[a];try{var l=t,i=s,d=i;e:for(;d!==null;){switch(d.tag){case 5:$e=d.stateNode,Ct=!1;break e;case 3:$e=d.stateNode.containerInfo,Ct=!0;break e;case 4:$e=d.stateNode.containerInfo,Ct=!0;break e}d=d.return}if($e===null)throw Error(H(160));mh(l,i,n),$e=null,Ct=!1;var o=n.alternate;o!==null&&(o.return=null),n.return=null}catch(u){_e(n,s,u)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)hh(s,t),s=s.sibling}function hh(t,s){var r=t.alternate,a=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(_t(s,t),Dt(t),a&4){try{pa(3,t,t.return),kl(3,t)}catch(N){_e(t,t.return,N)}try{pa(5,t,t.return)}catch(N){_e(t,t.return,N)}}break;case 1:_t(s,t),Dt(t),a&512&&r!==null&&wr(r,r.return);break;case 5:if(_t(s,t),Dt(t),a&512&&r!==null&&wr(r,r.return),t.flags&32){var n=t.stateNode;try{wa(n,"")}catch(N){_e(t,t.return,N)}}if(a&4&&(n=t.stateNode,n!=null)){var l=t.memoizedProps,i=r!==null?r.memoizedProps:l,d=t.type,o=t.updateQueue;if(t.updateQueue=null,o!==null)try{d==="input"&&l.type==="radio"&&l.name!=null&&Lu(n,l),Pi(d,i);var u=Pi(d,l);for(i=0;i<o.length;i+=2){var c=o[i],x=o[i+1];c==="style"?Uu(n,x):c==="dangerouslySetInnerHTML"?$u(n,x):c==="children"?wa(n,x):Ro(n,c,x,u)}switch(d){case"input":Si(n,l);break;case"textarea":Ru(n,l);break;case"select":var m=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!l.multiple;var f=l.value;f!=null?kr(n,!!l.multiple,f,!1):m!==!!l.multiple&&(l.defaultValue!=null?kr(n,!!l.multiple,l.defaultValue,!0):kr(n,!!l.multiple,l.multiple?[]:"",!1))}n[Pa]=l}catch(N){_e(t,t.return,N)}}break;case 6:if(_t(s,t),Dt(t),a&4){if(t.stateNode===null)throw Error(H(162));n=t.stateNode,l=t.memoizedProps;try{n.nodeValue=l}catch(N){_e(t,t.return,N)}}break;case 3:if(_t(s,t),Dt(t),a&4&&r!==null&&r.memoizedState.isDehydrated)try{Sa(s.containerInfo)}catch(N){_e(t,t.return,N)}break;case 4:_t(s,t),Dt(t);break;case 13:_t(s,t),Dt(t),n=t.child,n.flags&8192&&(l=n.memoizedState!==null,n.stateNode.isHidden=l,!l||n.alternate!==null&&n.alternate.memoizedState!==null||(pc=Ce())),a&4&&Rd(t);break;case 22:if(c=r!==null&&r.memoizedState!==null,t.mode&1?(He=(u=He)||c,_t(s,t),He=u):_t(s,t),Dt(t),a&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(G=t,c=t.child;c!==null;){for(x=G=c;G!==null;){switch(m=G,f=m.child,m.tag){case 0:case 11:case 14:case 15:pa(4,m,m.return);break;case 1:wr(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){a=m,r=m.return;try{s=a,y.props=s.memoizedProps,y.state=s.memoizedState,y.componentWillUnmount()}catch(N){_e(a,r,N)}}break;case 5:wr(m,m.return);break;case 22:if(m.memoizedState!==null){$d(x);continue}}f!==null?(f.return=m,G=f):$d(x)}c=c.sibling}e:for(c=null,x=t;;){if(x.tag===5){if(c===null){c=x;try{n=x.stateNode,u?(l=n.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(d=x.stateNode,o=x.memoizedProps.style,i=o!=null&&o.hasOwnProperty("display")?o.display:null,d.style.display=Fu("display",i))}catch(N){_e(t,t.return,N)}}}else if(x.tag===6){if(c===null)try{x.stateNode.nodeValue=u?"":x.memoizedProps}catch(N){_e(t,t.return,N)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===t)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===t)break e;for(;x.sibling===null;){if(x.return===null||x.return===t)break e;c===x&&(c=null),x=x.return}c===x&&(c=null),x.sibling.return=x.return,x=x.sibling}}break;case 19:_t(s,t),Dt(t),a&4&&Rd(t);break;case 21:break;default:_t(s,t),Dt(t)}}function Dt(t){var s=t.flags;if(s&2){try{e:{for(var r=t.return;r!==null;){if(uh(r)){var a=r;break e}r=r.return}throw Error(H(160))}switch(a.tag){case 5:var n=a.stateNode;a.flags&32&&(wa(n,""),a.flags&=-33);var l=Ld(t);io(t,l,n);break;case 3:case 4:var i=a.stateNode.containerInfo,d=Ld(t);lo(t,d,i);break;default:throw Error(H(161))}}catch(o){_e(t,t.return,o)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function K0(t,s,r){G=t,xh(t)}function xh(t,s,r){for(var a=(t.mode&1)!==0;G!==null;){var n=G,l=n.child;if(n.tag===22&&a){var i=n.memoizedState!==null||fn;if(!i){var d=n.alternate,o=d!==null&&d.memoizedState!==null||He;d=fn;var u=He;if(fn=i,(He=o)&&!u)for(G=n;G!==null;)i=G,o=i.child,i.tag===22&&i.memoizedState!==null?Fd(n):o!==null?(o.return=i,G=o):Fd(n);for(;l!==null;)G=l,xh(l),l=l.sibling;G=n,fn=d,He=u}Od(t)}else n.subtreeFlags&8772&&l!==null?(l.return=n,G=l):Od(t)}}function Od(t){for(;G!==null;){var s=G;if(s.flags&8772){var r=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:He||kl(5,s);break;case 1:var a=s.stateNode;if(s.flags&4&&!He)if(r===null)a.componentDidMount();else{var n=s.elementType===s.type?r.memoizedProps:St(s.type,r.memoizedProps);a.componentDidUpdate(n,r.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var l=s.updateQueue;l!==null&&jd(s,l,a);break;case 3:var i=s.updateQueue;if(i!==null){if(r=null,s.child!==null)switch(s.child.tag){case 5:r=s.child.stateNode;break;case 1:r=s.child.stateNode}jd(s,i,r)}break;case 5:var d=s.stateNode;if(r===null&&s.flags&4){r=d;var o=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&r.focus();break;case"img":o.src&&(r.src=o.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var u=s.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var x=c.dehydrated;x!==null&&Sa(x)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}He||s.flags&512&&no(s)}catch(m){_e(s,s.return,m)}}if(s===t){G=null;break}if(r=s.sibling,r!==null){r.return=s.return,G=r;break}G=s.return}}function $d(t){for(;G!==null;){var s=G;if(s===t){G=null;break}var r=s.sibling;if(r!==null){r.return=s.return,G=r;break}G=s.return}}function Fd(t){for(;G!==null;){var s=G;try{switch(s.tag){case 0:case 11:case 15:var r=s.return;try{kl(4,s)}catch(o){_e(s,r,o)}break;case 1:var a=s.stateNode;if(typeof a.componentDidMount=="function"){var n=s.return;try{a.componentDidMount()}catch(o){_e(s,n,o)}}var l=s.return;try{no(s)}catch(o){_e(s,l,o)}break;case 5:var i=s.return;try{no(s)}catch(o){_e(s,i,o)}}}catch(o){_e(s,s.return,o)}if(s===t){G=null;break}var d=s.sibling;if(d!==null){d.return=s.return,G=d;break}G=s.return}}var X0=Math.ceil,al=ts.ReactCurrentDispatcher,hc=ts.ReactCurrentOwner,bt=ts.ReactCurrentBatchConfig,ne=0,Oe=null,Ae=null,Ue=0,ot=0,Nr=Ss(0),Le=0,Oa=null,Hs=0,Sl=0,xc=0,fa=null,tt=null,pc=0,Or=1/0,Vt=null,nl=!1,oo=null,bs=null,gn=!1,ms=null,ll=0,ga=0,co=null,Ln=-1,Rn=0;function Ke(){return ne&6?Ce():Ln!==-1?Ln:Ln=Ce()}function vs(t){return t.mode&1?ne&2&&Ue!==0?Ue&-Ue:I0.transition!==null?(Rn===0&&(Rn=Zu()),Rn):(t=ce,t!==0||(t=window.event,t=t===void 0?16:nm(t.type)),t):1}function Pt(t,s,r,a){if(50<ga)throw ga=0,co=null,Error(H(185));Wa(t,r,a),(!(ne&2)||t!==Oe)&&(t===Oe&&(!(ne&2)&&(Sl|=r),Le===4&&cs(t,Ue)),lt(t,a),r===1&&ne===0&&!(s.mode&1)&&(Or=Ce()+500,wl&&Cs()))}function lt(t,s){var r=t.callbackNode;Ip(t,s);var a=Bn(t,t===Oe?Ue:0);if(a===0)r!==null&&Qc(r),t.callbackNode=null,t.callbackPriority=0;else if(s=a&-a,t.callbackPriority!==s){if(r!=null&&Qc(r),s===1)t.tag===0?D0(Ud.bind(null,t)):_m(Ud.bind(null,t)),T0(function(){!(ne&6)&&Cs()}),r=null;else{switch(Yu(a)){case 1:r=zo;break;case 4:r=Ku;break;case 16:r=qn;break;case 536870912:r=Xu;break;default:r=qn}r=wh(r,ph.bind(null,t))}t.callbackPriority=s,t.callbackNode=r}}function ph(t,s){if(Ln=-1,Rn=0,ne&6)throw Error(H(327));var r=t.callbackNode;if(Ar()&&t.callbackNode!==r)return null;var a=Bn(t,t===Oe?Ue:0);if(a===0)return null;if(a&30||a&t.expiredLanes||s)s=il(t,a);else{s=a;var n=ne;ne|=2;var l=gh();(Oe!==t||Ue!==s)&&(Vt=null,Or=Ce()+500,Us(t,s));do try{ef();break}catch(d){fh(t,d)}while(!0);ec(),al.current=l,ne=n,Ae!==null?s=0:(Oe=null,Ue=0,s=Le)}if(s!==0){if(s===2&&(n=Ri(t),n!==0&&(a=n,s=uo(t,n))),s===1)throw r=Oa,Us(t,0),cs(t,a),lt(t,Ce()),r;if(s===6)cs(t,a);else{if(n=t.current.alternate,!(a&30)&&!Z0(n)&&(s=il(t,a),s===2&&(l=Ri(t),l!==0&&(a=l,s=uo(t,l))),s===1))throw r=Oa,Us(t,0),cs(t,a),lt(t,Ce()),r;switch(t.finishedWork=n,t.finishedLanes=a,s){case 0:case 1:throw Error(H(345));case 2:Ds(t,tt,Vt);break;case 3:if(cs(t,a),(a&130023424)===a&&(s=pc+500-Ce(),10<s)){if(Bn(t,0)!==0)break;if(n=t.suspendedLanes,(n&a)!==a){Ke(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=Vi(Ds.bind(null,t,tt,Vt),s);break}Ds(t,tt,Vt);break;case 4:if(cs(t,a),(a&4194240)===a)break;for(s=t.eventTimes,n=-1;0<a;){var i=31-At(a);l=1<<i,i=s[i],i>n&&(n=i),a&=~l}if(a=n,a=Ce()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*X0(a/1960))-a,10<a){t.timeoutHandle=Vi(Ds.bind(null,t,tt,Vt),a);break}Ds(t,tt,Vt);break;case 5:Ds(t,tt,Vt);break;default:throw Error(H(329))}}}return lt(t,Ce()),t.callbackNode===r?ph.bind(null,t):null}function uo(t,s){var r=fa;return t.current.memoizedState.isDehydrated&&(Us(t,s).flags|=256),t=il(t,s),t!==2&&(s=tt,tt=r,s!==null&&mo(s)),t}function mo(t){tt===null?tt=t:tt.push.apply(tt,t)}function Z0(t){for(var s=t;;){if(s.flags&16384){var r=s.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var a=0;a<r.length;a++){var n=r[a],l=n.getSnapshot;n=n.value;try{if(!Mt(l(),n))return!1}catch{return!1}}}if(r=s.child,s.subtreeFlags&16384&&r!==null)r.return=s,s=r;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function cs(t,s){for(s&=~xc,s&=~Sl,t.suspendedLanes|=s,t.pingedLanes&=~s,t=t.expirationTimes;0<s;){var r=31-At(s),a=1<<r;t[r]=-1,s&=~a}}function Ud(t){if(ne&6)throw Error(H(327));Ar();var s=Bn(t,0);if(!(s&1))return lt(t,Ce()),null;var r=il(t,s);if(t.tag!==0&&r===2){var a=Ri(t);a!==0&&(s=a,r=uo(t,a))}if(r===1)throw r=Oa,Us(t,0),cs(t,s),lt(t,Ce()),r;if(r===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=s,Ds(t,tt,Vt),lt(t,Ce()),null}function fc(t,s){var r=ne;ne|=1;try{return t(s)}finally{ne=r,ne===0&&(Or=Ce()+500,wl&&Cs())}}function Js(t){ms!==null&&ms.tag===0&&!(ne&6)&&Ar();var s=ne;ne|=1;var r=bt.transition,a=ce;try{if(bt.transition=null,ce=1,t)return t()}finally{ce=a,bt.transition=r,ne=s,!(ne&6)&&Cs()}}function gc(){ot=Nr.current,pe(Nr)}function Us(t,s){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,E0(r)),Ae!==null)for(r=Ae.return;r!==null;){var a=r;switch(Xo(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&Qn();break;case 3:Lr(),pe(at),pe(Je),lc();break;case 5:nc(a);break;case 4:Lr();break;case 13:pe(be);break;case 19:pe(be);break;case 10:tc(a.type._context);break;case 22:case 23:gc()}r=r.return}if(Oe=t,Ae=t=js(t.current,null),Ue=ot=s,Le=0,Oa=null,xc=Sl=Hs=0,tt=fa=null,$s!==null){for(s=0;s<$s.length;s++)if(r=$s[s],a=r.interleaved,a!==null){r.interleaved=null;var n=a.next,l=r.pending;if(l!==null){var i=l.next;l.next=n,a.next=i}r.pending=a}$s=null}return t}function fh(t,s){do{var r=Ae;try{if(ec(),Mn.current=rl,sl){for(var a=ve.memoizedState;a!==null;){var n=a.queue;n!==null&&(n.pending=null),a=a.next}sl=!1}if(Ws=0,Re=Ie=ve=null,xa=!1,Ia=0,hc.current=null,r===null||r.return===null){Le=1,Oa=s,Ae=null;break}e:{var l=t,i=r.return,d=r,o=s;if(s=Ue,d.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){var u=o,c=d,x=c.tag;if(!(c.mode&1)&&(x===0||x===11||x===15)){var m=c.alternate;m?(c.updateQueue=m.updateQueue,c.memoizedState=m.memoizedState,c.lanes=m.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=Cd(i);if(f!==null){f.flags&=-257,Ed(f,i,d,l,s),f.mode&1&&Sd(l,u,s),s=f,o=u;var y=s.updateQueue;if(y===null){var N=new Set;N.add(o),s.updateQueue=N}else y.add(o);break e}else{if(!(s&1)){Sd(l,u,s),yc();break e}o=Error(H(426))}}else if(fe&&d.mode&1){var k=Cd(i);if(k!==null){!(k.flags&65536)&&(k.flags|=256),Ed(k,i,d,l,s),Zo(Rr(o,d));break e}}l=o=Rr(o,d),Le!==4&&(Le=2),fa===null?fa=[l]:fa.push(l),l=i;do{switch(l.tag){case 3:l.flags|=65536,s&=-s,l.lanes|=s;var b=Ym(l,o,s);vd(l,b);break e;case 1:d=o;var v=l.type,h=l.stateNode;if(!(l.flags&128)&&(typeof v.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(bs===null||!bs.has(h)))){l.flags|=65536,s&=-s,l.lanes|=s;var g=eh(l,d,s);vd(l,g);break e}}l=l.return}while(l!==null)}bh(r)}catch(w){s=w,Ae===r&&r!==null&&(Ae=r=r.return);continue}break}while(!0)}function gh(){var t=al.current;return al.current=rl,t===null?rl:t}function yc(){(Le===0||Le===3||Le===2)&&(Le=4),Oe===null||!(Hs&268435455)&&!(Sl&268435455)||cs(Oe,Ue)}function il(t,s){var r=ne;ne|=2;var a=gh();(Oe!==t||Ue!==s)&&(Vt=null,Us(t,s));do try{Y0();break}catch(n){fh(t,n)}while(!0);if(ec(),ne=r,al.current=a,Ae!==null)throw Error(H(261));return Oe=null,Ue=0,Le}function Y0(){for(;Ae!==null;)yh(Ae)}function ef(){for(;Ae!==null&&!kp();)yh(Ae)}function yh(t){var s=jh(t.alternate,t,ot);t.memoizedProps=t.pendingProps,s===null?bh(t):Ae=s,hc.current=null}function bh(t){var s=t;do{var r=s.alternate;if(t=s.return,s.flags&32768){if(r=J0(r,s),r!==null){r.flags&=32767,Ae=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Le=6,Ae=null;return}}else if(r=H0(r,s,ot),r!==null){Ae=r;return}if(s=s.sibling,s!==null){Ae=s;return}Ae=s=t}while(s!==null);Le===0&&(Le=5)}function Ds(t,s,r){var a=ce,n=bt.transition;try{bt.transition=null,ce=1,tf(t,s,r,a)}finally{bt.transition=n,ce=a}return null}function tf(t,s,r,a){do Ar();while(ms!==null);if(ne&6)throw Error(H(327));r=t.finishedWork;var n=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var l=r.lanes|r.childLanes;if(Lp(t,l),t===Oe&&(Ae=Oe=null,Ue=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||gn||(gn=!0,wh(qn,function(){return Ar(),null})),l=(r.flags&15990)!==0,r.subtreeFlags&15990||l){l=bt.transition,bt.transition=null;var i=ce;ce=1;var d=ne;ne|=4,hc.current=null,G0(t,r),hh(r,t),j0(qi),Vn=!!zi,qi=zi=null,t.current=r,K0(r),Sp(),ne=d,ce=i,bt.transition=l}else t.current=r;if(gn&&(gn=!1,ms=t,ll=n),l=t.pendingLanes,l===0&&(bs=null),Tp(r.stateNode),lt(t,Ce()),s!==null)for(a=t.onRecoverableError,r=0;r<s.length;r++)n=s[r],a(n.value,{componentStack:n.stack,digest:n.digest});if(nl)throw nl=!1,t=oo,oo=null,t;return ll&1&&t.tag!==0&&Ar(),l=t.pendingLanes,l&1?t===co?ga++:(ga=0,co=t):ga=0,Cs(),null}function Ar(){if(ms!==null){var t=Yu(ll),s=bt.transition,r=ce;try{if(bt.transition=null,ce=16>t?16:t,ms===null)var a=!1;else{if(t=ms,ms=null,ll=0,ne&6)throw Error(H(331));var n=ne;for(ne|=4,G=t.current;G!==null;){var l=G,i=l.child;if(G.flags&16){var d=l.deletions;if(d!==null){for(var o=0;o<d.length;o++){var u=d[o];for(G=u;G!==null;){var c=G;switch(c.tag){case 0:case 11:case 15:pa(8,c,l)}var x=c.child;if(x!==null)x.return=c,G=x;else for(;G!==null;){c=G;var m=c.sibling,f=c.return;if(dh(c),c===u){G=null;break}if(m!==null){m.return=f,G=m;break}G=f}}}var y=l.alternate;if(y!==null){var N=y.child;if(N!==null){y.child=null;do{var k=N.sibling;N.sibling=null,N=k}while(N!==null)}}G=l}}if(l.subtreeFlags&2064&&i!==null)i.return=l,G=i;else e:for(;G!==null;){if(l=G,l.flags&2048)switch(l.tag){case 0:case 11:case 15:pa(9,l,l.return)}var b=l.sibling;if(b!==null){b.return=l.return,G=b;break e}G=l.return}}var v=t.current;for(G=v;G!==null;){i=G;var h=i.child;if(i.subtreeFlags&2064&&h!==null)h.return=i,G=h;else e:for(i=v;G!==null;){if(d=G,d.flags&2048)try{switch(d.tag){case 0:case 11:case 15:kl(9,d)}}catch(w){_e(d,d.return,w)}if(d===i){G=null;break e}var g=d.sibling;if(g!==null){g.return=d.return,G=g;break e}G=d.return}}if(ne=n,Cs(),Ot&&typeof Ot.onPostCommitFiberRoot=="function")try{Ot.onPostCommitFiberRoot(gl,t)}catch{}a=!0}return a}finally{ce=r,bt.transition=s}}return!1}function zd(t,s,r){s=Rr(r,s),s=Ym(t,s,1),t=ys(t,s,1),s=Ke(),t!==null&&(Wa(t,1,s),lt(t,s))}function _e(t,s,r){if(t.tag===3)zd(t,t,r);else for(;s!==null;){if(s.tag===3){zd(s,t,r);break}else if(s.tag===1){var a=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(bs===null||!bs.has(a))){t=Rr(r,t),t=eh(s,t,1),s=ys(s,t,1),t=Ke(),s!==null&&(Wa(s,1,t),lt(s,t));break}}s=s.return}}function sf(t,s,r){var a=t.pingCache;a!==null&&a.delete(s),s=Ke(),t.pingedLanes|=t.suspendedLanes&r,Oe===t&&(Ue&r)===r&&(Le===4||Le===3&&(Ue&130023424)===Ue&&500>Ce()-pc?Us(t,0):xc|=r),lt(t,s)}function vh(t,s){s===0&&(t.mode&1?(s=ln,ln<<=1,!(ln&130023424)&&(ln=4194304)):s=1);var r=Ke();t=Yt(t,s),t!==null&&(Wa(t,s,r),lt(t,r))}function rf(t){var s=t.memoizedState,r=0;s!==null&&(r=s.retryLane),vh(t,r)}function af(t,s){var r=0;switch(t.tag){case 13:var a=t.stateNode,n=t.memoizedState;n!==null&&(r=n.retryLane);break;case 19:a=t.stateNode;break;default:throw Error(H(314))}a!==null&&a.delete(s),vh(t,r)}var jh;jh=function(t,s,r){if(t!==null)if(t.memoizedProps!==s.pendingProps||at.current)rt=!0;else{if(!(t.lanes&r)&&!(s.flags&128))return rt=!1,W0(t,s,r);rt=!!(t.flags&131072)}else rt=!1,fe&&s.flags&1048576&&km(s,Xn,s.index);switch(s.lanes=0,s.tag){case 2:var a=s.type;In(t,s),t=s.pendingProps;var n=Mr(s,Je.current);Tr(s,r),n=oc(null,s,a,t,n,r);var l=cc();return s.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,nt(a)?(l=!0,Gn(s)):l=!1,s.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,rc(s),n.updater=_l,s.stateNode=n,n._reactInternals=s,Xi(s,a,t,r),s=eo(null,s,a,!0,l,r)):(s.tag=0,fe&&l&&Ko(s),Ge(null,s,n,r),s=s.child),s;case 16:a=s.elementType;e:{switch(In(t,s),t=s.pendingProps,n=a._init,a=n(a._payload),s.type=a,n=s.tag=lf(a),t=St(a,t),n){case 0:s=Yi(null,s,a,t,r);break e;case 1:s=Pd(null,s,a,t,r);break e;case 11:s=Td(null,s,a,t,r);break e;case 14:s=Ad(null,s,a,St(a.type,t),r);break e}throw Error(H(306,a,""))}return s;case 0:return a=s.type,n=s.pendingProps,n=s.elementType===a?n:St(a,n),Yi(t,s,a,n,r);case 1:return a=s.type,n=s.pendingProps,n=s.elementType===a?n:St(a,n),Pd(t,s,a,n,r);case 3:e:{if(ah(s),t===null)throw Error(H(387));a=s.pendingProps,l=s.memoizedState,n=l.element,Pm(t,s),el(s,a,null,r);var i=s.memoizedState;if(a=i.element,l.isDehydrated)if(l={element:a,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},s.updateQueue.baseState=l,s.memoizedState=l,s.flags&256){n=Rr(Error(H(423)),s),s=Md(t,s,a,r,n);break e}else if(a!==n){n=Rr(Error(H(424)),s),s=Md(t,s,a,r,n);break e}else for(dt=gs(s.stateNode.containerInfo.firstChild),ut=s,fe=!0,Tt=null,r=Tm(s,null,a,r),s.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Dr(),a===n){s=es(t,s,r);break e}Ge(t,s,a,r)}s=s.child}return s;case 5:return Mm(s),t===null&&Qi(s),a=s.type,n=s.pendingProps,l=t!==null?t.memoizedProps:null,i=n.children,Bi(a,n)?i=null:l!==null&&Bi(a,l)&&(s.flags|=32),rh(t,s),Ge(t,s,i,r),s.child;case 6:return t===null&&Qi(s),null;case 13:return nh(t,s,r);case 4:return ac(s,s.stateNode.containerInfo),a=s.pendingProps,t===null?s.child=Ir(s,null,a,r):Ge(t,s,a,r),s.child;case 11:return a=s.type,n=s.pendingProps,n=s.elementType===a?n:St(a,n),Td(t,s,a,n,r);case 7:return Ge(t,s,s.pendingProps,r),s.child;case 8:return Ge(t,s,s.pendingProps.children,r),s.child;case 12:return Ge(t,s,s.pendingProps.children,r),s.child;case 10:e:{if(a=s.type._context,n=s.pendingProps,l=s.memoizedProps,i=n.value,me(Zn,a._currentValue),a._currentValue=i,l!==null)if(Mt(l.value,i)){if(l.children===n.children&&!at.current){s=es(t,s,r);break e}}else for(l=s.child,l!==null&&(l.return=s);l!==null;){var d=l.dependencies;if(d!==null){i=l.child;for(var o=d.firstContext;o!==null;){if(o.context===a){if(l.tag===1){o=Gt(-1,r&-r),o.tag=2;var u=l.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?o.next=o:(o.next=c.next,c.next=o),u.pending=o}}l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),Gi(l.return,r,s),d.lanes|=r;break}o=o.next}}else if(l.tag===10)i=l.type===s.type?null:l.child;else if(l.tag===18){if(i=l.return,i===null)throw Error(H(341));i.lanes|=r,d=i.alternate,d!==null&&(d.lanes|=r),Gi(i,r,s),i=l.sibling}else i=l.child;if(i!==null)i.return=l;else for(i=l;i!==null;){if(i===s){i=null;break}if(l=i.sibling,l!==null){l.return=i.return,i=l;break}i=i.return}l=i}Ge(t,s,n.children,r),s=s.child}return s;case 9:return n=s.type,a=s.pendingProps.children,Tr(s,r),n=jt(n),a=a(n),s.flags|=1,Ge(t,s,a,r),s.child;case 14:return a=s.type,n=St(a,s.pendingProps),n=St(a.type,n),Ad(t,s,a,n,r);case 15:return th(t,s,s.type,s.pendingProps,r);case 17:return a=s.type,n=s.pendingProps,n=s.elementType===a?n:St(a,n),In(t,s),s.tag=1,nt(a)?(t=!0,Gn(s)):t=!1,Tr(s,r),Zm(s,a,n),Xi(s,a,n,r),eo(null,s,a,!0,t,r);case 19:return lh(t,s,r);case 22:return sh(t,s,r)}throw Error(H(156,s.tag))};function wh(t,s){return Gu(t,s)}function nf(t,s,r,a){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yt(t,s,r,a){return new nf(t,s,r,a)}function bc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function lf(t){if(typeof t=="function")return bc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$o)return 11;if(t===Fo)return 14}return 2}function js(t,s){var r=t.alternate;return r===null?(r=yt(t.tag,s,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=s,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,s=t.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function On(t,s,r,a,n,l){var i=2;if(a=t,typeof t=="function")bc(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case hr:return zs(r.children,n,l,s);case Oo:i=8,n|=8;break;case ji:return t=yt(12,r,s,n|2),t.elementType=ji,t.lanes=l,t;case wi:return t=yt(13,r,s,n),t.elementType=wi,t.lanes=l,t;case Ni:return t=yt(19,r,s,n),t.elementType=Ni,t.lanes=l,t;case Mu:return Cl(r,n,l,s);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Au:i=10;break e;case Pu:i=9;break e;case $o:i=11;break e;case Fo:i=14;break e;case ls:i=16,a=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return s=yt(i,r,s,n),s.elementType=t,s.type=a,s.lanes=l,s}function zs(t,s,r,a){return t=yt(7,t,a,s),t.lanes=r,t}function Cl(t,s,r,a){return t=yt(22,t,a,s),t.elementType=Mu,t.lanes=r,t.stateNode={isHidden:!1},t}function oi(t,s,r){return t=yt(6,t,null,s),t.lanes=r,t}function ci(t,s,r){return s=yt(4,t.children!==null?t.children:[],t.key,s),s.lanes=r,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}function of(t,s,r,a,n){this.tag=s,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bl(0),this.expirationTimes=Bl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bl(0),this.identifierPrefix=a,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function vc(t,s,r,a,n,l,i,d,o){return t=new of(t,s,r,d,o),s===1?(s=1,l===!0&&(s|=8)):s=0,l=yt(3,null,null,s),t.current=l,l.stateNode=t,l.memoizedState={element:a,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},rc(l),t}function cf(t,s,r){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mr,key:a==null?null:""+a,children:t,containerInfo:s,implementation:r}}function Nh(t){if(!t)return Ns;t=t._reactInternals;e:{if(Zs(t)!==t||t.tag!==1)throw Error(H(170));var s=t;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(nt(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(H(171))}if(t.tag===1){var r=t.type;if(nt(r))return Nm(t,r,s)}return s}function _h(t,s,r,a,n,l,i,d,o){return t=vc(r,a,!0,t,n,l,i,d,o),t.context=Nh(null),r=t.current,a=Ke(),n=vs(r),l=Gt(a,n),l.callback=s??null,ys(r,l,n),t.current.lanes=n,Wa(t,n,a),lt(t,a),t}function El(t,s,r,a){var n=s.current,l=Ke(),i=vs(n);return r=Nh(r),s.context===null?s.context=r:s.pendingContext=r,s=Gt(l,i),s.payload={element:t},a=a===void 0?null:a,a!==null&&(s.callback=a),t=ys(n,s,i),t!==null&&(Pt(t,n,i,l),Pn(t,n,i)),i}function ol(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function qd(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<s?r:s}}function jc(t,s){qd(t,s),(t=t.alternate)&&qd(t,s)}function df(){return null}var kh=typeof reportError=="function"?reportError:function(t){console.error(t)};function wc(t){this._internalRoot=t}Tl.prototype.render=wc.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(H(409));El(t,s,null,null)};Tl.prototype.unmount=wc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;Js(function(){El(null,t,null,null)}),s[Zt]=null}};function Tl(t){this._internalRoot=t}Tl.prototype.unstable_scheduleHydration=function(t){if(t){var s=sm();t={blockedOn:null,target:t,priority:s};for(var r=0;r<os.length&&s!==0&&s<os[r].priority;r++);os.splice(r,0,t),r===0&&am(t)}};function Nc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Al(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Bd(){}function uf(t,s,r,a,n){if(n){if(typeof a=="function"){var l=a;a=function(){var u=ol(i);l.call(u)}}var i=_h(s,a,t,0,null,!1,!1,"",Bd);return t._reactRootContainer=i,t[Zt]=i.current,Ta(t.nodeType===8?t.parentNode:t),Js(),i}for(;n=t.lastChild;)t.removeChild(n);if(typeof a=="function"){var d=a;a=function(){var u=ol(o);d.call(u)}}var o=vc(t,0,!1,null,null,!1,!1,"",Bd);return t._reactRootContainer=o,t[Zt]=o.current,Ta(t.nodeType===8?t.parentNode:t),Js(function(){El(s,o,r,a)}),o}function Pl(t,s,r,a,n){var l=r._reactRootContainer;if(l){var i=l;if(typeof n=="function"){var d=n;n=function(){var o=ol(i);d.call(o)}}El(s,i,t,n)}else i=uf(r,s,t,n,a);return ol(i)}em=function(t){switch(t.tag){case 3:var s=t.stateNode;if(s.current.memoizedState.isDehydrated){var r=la(s.pendingLanes);r!==0&&(qo(s,r|1),lt(s,Ce()),!(ne&6)&&(Or=Ce()+500,Cs()))}break;case 13:Js(function(){var a=Yt(t,1);if(a!==null){var n=Ke();Pt(a,t,1,n)}}),jc(t,1)}};Bo=function(t){if(t.tag===13){var s=Yt(t,134217728);if(s!==null){var r=Ke();Pt(s,t,134217728,r)}jc(t,134217728)}};tm=function(t){if(t.tag===13){var s=vs(t),r=Yt(t,s);if(r!==null){var a=Ke();Pt(r,t,s,a)}jc(t,s)}};sm=function(){return ce};rm=function(t,s){var r=ce;try{return ce=t,s()}finally{ce=r}};Di=function(t,s,r){switch(s){case"input":if(Si(t,r),s=r.name,r.type==="radio"&&s!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<r.length;s++){var a=r[s];if(a!==t&&a.form===t.form){var n=jl(a);if(!n)throw Error(H(90));Iu(a),Si(a,n)}}}break;case"textarea":Ru(t,r);break;case"select":s=r.value,s!=null&&kr(t,!!r.multiple,s,!1)}};Bu=fc;Vu=Js;var mf={usingClientEntryPoint:!1,Events:[Ja,gr,jl,zu,qu,fc]},ea={findFiberByHostInstance:Os,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hf={bundleType:ea.bundleType,version:ea.version,rendererPackageName:ea.rendererPackageName,rendererConfig:ea.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ts.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ju(t),t===null?null:t.stateNode},findFiberByHostInstance:ea.findFiberByHostInstance||df,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yn=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yn.isDisabled&&yn.supportsFiber)try{gl=yn.inject(hf),Ot=yn}catch{}}ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mf;ht.createPortal=function(t,s){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Nc(s))throw Error(H(200));return cf(t,s,null,r)};ht.createRoot=function(t,s){if(!Nc(t))throw Error(H(299));var r=!1,a="",n=kh;return s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(a=s.identifierPrefix),s.onRecoverableError!==void 0&&(n=s.onRecoverableError)),s=vc(t,1,!1,null,null,r,!1,a,n),t[Zt]=s.current,Ta(t.nodeType===8?t.parentNode:t),new wc(s)};ht.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=Ju(s),t=t===null?null:t.stateNode,t};ht.flushSync=function(t){return Js(t)};ht.hydrate=function(t,s,r){if(!Al(s))throw Error(H(200));return Pl(null,t,s,!0,r)};ht.hydrateRoot=function(t,s,r){if(!Nc(t))throw Error(H(405));var a=r!=null&&r.hydratedSources||null,n=!1,l="",i=kh;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(l=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),s=_h(s,null,t,1,r??null,n,!1,l,i),t[Zt]=s.current,Ta(t),a)for(t=0;t<a.length;t++)r=a[t],n=r._getVersion,n=n(r._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[r,n]:s.mutableSourceEagerHydrationData.push(r,n);return new Tl(s)};ht.render=function(t,s,r){if(!Al(s))throw Error(H(200));return Pl(null,t,s,!1,r)};ht.unmountComponentAtNode=function(t){if(!Al(t))throw Error(H(40));return t._reactRootContainer?(Js(function(){Pl(null,null,t,!1,function(){t._reactRootContainer=null,t[Zt]=null})}),!0):!1};ht.unstable_batchedUpdates=fc;ht.unstable_renderSubtreeIntoContainer=function(t,s,r,a){if(!Al(r))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return Pl(t,s,r,!1,a)};ht.version="18.3.1-next-f1338f8080-20240426";function Sh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Sh)}catch(t){console.error(t)}}Sh(),Su.exports=ht;var xf=Su.exports,Ch,Vd=xf;Ch=Vd.createRoot,Vd.hydrateRoot;const pf="modulepreload",ff=function(t){return"/"+t},Wd={},Ga=function(s,r,a){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),d=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.allSettled(r.map(o=>{if(o=ff(o),o in Wd)return;Wd[o]=!0;const u=o.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${c}`))return;const x=document.createElement("link");if(x.rel=u?"stylesheet":pf,u||(x.as="script"),x.crossOrigin="",x.href=o,d&&x.setAttribute("nonce",d),document.head.appendChild(x),u)return new Promise((m,f)=>{x.addEventListener("load",m),x.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})}))}function l(i){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=i,window.dispatchEvent(d),!d.defaultPrevented)throw i}return n.then(i=>{for(const d of i||[])d.status==="rejected"&&l(d.reason);return s().catch(l)})},gf=t=>{let s;return t?s=t:typeof fetch>"u"?s=(...r)=>Ga(async()=>{const{default:a}=await Promise.resolve().then(()=>Br);return{default:a}},void 0).then(({default:a})=>a(...r)):s=fetch,(...r)=>s(...r)};class _c extends Error{constructor(s,r="FunctionsError",a){super(s),this.name=r,this.context=a}}class yf extends _c{constructor(s){super("Failed to send a request to the Edge Function","FunctionsFetchError",s)}}class Hd extends _c{constructor(s){super("Relay Error invoking the Edge Function","FunctionsRelayError",s)}}class Jd extends _c{constructor(s){super("Edge Function returned a non-2xx status code","FunctionsHttpError",s)}}var ho;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ho||(ho={}));var bf=function(t,s,r,a){function n(l){return l instanceof r?l:new r(function(i){i(l)})}return new(r||(r=Promise))(function(l,i){function d(c){try{u(a.next(c))}catch(x){i(x)}}function o(c){try{u(a.throw(c))}catch(x){i(x)}}function u(c){c.done?l(c.value):n(c.value).then(d,o)}u((a=a.apply(t,s||[])).next())})};class vf{constructor(s,{headers:r={},customFetch:a,region:n=ho.Any}={}){this.url=s,this.headers=r,this.region=n,this.fetch=gf(a)}setAuth(s){this.headers.Authorization=`Bearer ${s}`}invoke(s,r={}){var a;return bf(this,void 0,void 0,function*(){try{const{headers:n,method:l,body:i}=r;let d={},{region:o}=r;o||(o=this.region);const u=new URL(`${this.url}/${s}`);o&&o!=="any"&&(d["x-region"]=o,u.searchParams.set("forceFunctionRegion",o));let c;i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",c=i):typeof i=="string"?(d["Content-Type"]="text/plain",c=i):typeof FormData<"u"&&i instanceof FormData?c=i:(d["Content-Type"]="application/json",c=JSON.stringify(i)));const x=yield this.fetch(u.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),n),body:c}).catch(N=>{throw new yf(N)}),m=x.headers.get("x-relay-error");if(m&&m==="true")throw new Hd(x);if(!x.ok)throw new Jd(x);let f=((a=x.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),y;return f==="application/json"?y=yield x.json():f==="application/octet-stream"?y=yield x.blob():f==="text/event-stream"?y=x:f==="multipart/form-data"?y=yield x.formData():y=yield x.text(),{data:y,error:null,response:x}}catch(n){return{data:null,error:n,response:n instanceof Jd||n instanceof Hd?n.context:void 0}}})}}var st={},kc={},Ml={},Ka={},Dl={},Il={},jf=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},$r=jf();const wf=$r.fetch,Eh=$r.fetch.bind($r),Th=$r.Headers,Nf=$r.Request,_f=$r.Response,Br=Object.freeze(Object.defineProperty({__proto__:null,Headers:Th,Request:Nf,Response:_f,default:Eh,fetch:wf},Symbol.toStringTag,{value:"Module"})),kf=zx(Br);var Ll={};Object.defineProperty(Ll,"__esModule",{value:!0});let Sf=class extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}};Ll.default=Sf;var Ah=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Il,"__esModule",{value:!0});const Cf=Ah(kf),Ef=Ah(Ll);let Tf=class{constructor(s){var r,a;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(r=s.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=s.signal,this.isMaybeSingle=(a=s.isMaybeSingle)!==null&&a!==void 0?a:!1,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=Cf.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,r){return this.headers=new Headers(this.headers),this.headers.set(s,r),this}then(s,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let n=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var i,d,o,u;let c=null,x=null,m=null,f=l.status,y=l.statusText;if(l.ok){if(this.method!=="HEAD"){const v=await l.text();v===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?x=v:x=JSON.parse(v))}const k=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),b=(o=l.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");k&&b&&b.length>1&&(m=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(c={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,m=null,f=406,y="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const k=await l.text();try{c=JSON.parse(k),Array.isArray(c)&&l.status===404&&(x=[],c=null,f=200,y="OK")}catch{l.status===404&&k===""?(f=204,y="No Content"):c={message:k}}if(c&&this.isMaybeSingle&&(!((u=c==null?void 0:c.details)===null||u===void 0)&&u.includes("0 rows"))&&(c=null,f=200,y="OK"),c&&this.shouldThrowOnError)throw new Ef.default(c)}return{error:c,data:x,count:m,status:f,statusText:y}});return this.shouldThrowOnError||(n=n.catch(l=>{var i,d,o;return{error:{message:`${(i=l==null?void 0:l.name)!==null&&i!==void 0?i:"FetchError"}: ${l==null?void 0:l.message}`,details:`${(d=l==null?void 0:l.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(o=l==null?void 0:l.code)!==null&&o!==void 0?o:""}`},data:null,count:null,status:0,statusText:""}})),n.then(s,r)}returns(){return this}overrideTypes(){return this}};Il.default=Tf;var Af=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Dl,"__esModule",{value:!0});const Pf=Af(Il);let Mf=class extends Pf.default{select(s){let r=!1;const a=(s??"*").split("").map(n=>/\s/.test(n)&&!r?"":(n==='"'&&(r=!r),n)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:r=!0,nullsFirst:a,foreignTable:n,referencedTable:l=n}={}){const i=l?`${l}.order`:"order",d=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${d?`${d},`:""}${s}.${r?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:r,referencedTable:a=r}={}){const n=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(n,`${s}`),this}range(s,r,{foreignTable:a,referencedTable:n=a}={}){const l=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(l,`${s}`),this.url.searchParams.set(i,`${r-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:r=!1,settings:a=!1,buffers:n=!1,wal:l=!1,format:i="text"}={}){var d;const o=[s?"analyze":null,r?"verbose":null,a?"settings":null,n?"buffers":null,l?"wal":null].filter(Boolean).join("|"),u=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${u}"; options=${o};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}};Dl.default=Mf;var Df=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ka,"__esModule",{value:!0});const If=Df(Dl);let Lf=class extends If.default{eq(s,r){return this.url.searchParams.append(s,`eq.${r}`),this}neq(s,r){return this.url.searchParams.append(s,`neq.${r}`),this}gt(s,r){return this.url.searchParams.append(s,`gt.${r}`),this}gte(s,r){return this.url.searchParams.append(s,`gte.${r}`),this}lt(s,r){return this.url.searchParams.append(s,`lt.${r}`),this}lte(s,r){return this.url.searchParams.append(s,`lte.${r}`),this}like(s,r){return this.url.searchParams.append(s,`like.${r}`),this}likeAllOf(s,r){return this.url.searchParams.append(s,`like(all).{${r.join(",")}}`),this}likeAnyOf(s,r){return this.url.searchParams.append(s,`like(any).{${r.join(",")}}`),this}ilike(s,r){return this.url.searchParams.append(s,`ilike.${r}`),this}ilikeAllOf(s,r){return this.url.searchParams.append(s,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(s,r){return this.url.searchParams.append(s,`ilike(any).{${r.join(",")}}`),this}is(s,r){return this.url.searchParams.append(s,`is.${r}`),this}in(s,r){const a=Array.from(new Set(r)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(s,`in.(${a})`),this}contains(s,r){return typeof r=="string"?this.url.searchParams.append(s,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(s,`cs.{${r.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(r)}`),this}containedBy(s,r){return typeof r=="string"?this.url.searchParams.append(s,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(s,`cd.{${r.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(r)}`),this}rangeGt(s,r){return this.url.searchParams.append(s,`sr.${r}`),this}rangeGte(s,r){return this.url.searchParams.append(s,`nxl.${r}`),this}rangeLt(s,r){return this.url.searchParams.append(s,`sl.${r}`),this}rangeLte(s,r){return this.url.searchParams.append(s,`nxr.${r}`),this}rangeAdjacent(s,r){return this.url.searchParams.append(s,`adj.${r}`),this}overlaps(s,r){return typeof r=="string"?this.url.searchParams.append(s,`ov.${r}`):this.url.searchParams.append(s,`ov.{${r.join(",")}}`),this}textSearch(s,r,{config:a,type:n}={}){let l="";n==="plain"?l="pl":n==="phrase"?l="ph":n==="websearch"&&(l="w");const i=a===void 0?"":`(${a})`;return this.url.searchParams.append(s,`${l}fts${i}.${r}`),this}match(s){return Object.entries(s).forEach(([r,a])=>{this.url.searchParams.append(r,`eq.${a}`)}),this}not(s,r,a){return this.url.searchParams.append(s,`not.${r}.${a}`),this}or(s,{foreignTable:r,referencedTable:a=r}={}){const n=a?`${a}.or`:"or";return this.url.searchParams.append(n,`(${s})`),this}filter(s,r,a){return this.url.searchParams.append(s,`${r}.${a}`),this}};Ka.default=Lf;var Rf=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ml,"__esModule",{value:!0});const ta=Rf(Ka);let Of=class{constructor(s,{headers:r={},schema:a,fetch:n}){this.url=s,this.headers=new Headers(r),this.schema=a,this.fetch=n}select(s,{head:r=!1,count:a}={}){const n=r?"HEAD":"GET";let l=!1;const i=(s??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",i),a&&this.headers.append("Prefer",`count=${a}`),new ta.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:r,defaultToNull:a=!0}={}){var n;const l="POST";if(r&&this.headers.append("Prefer",`count=${r}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const i=s.reduce((d,o)=>d.concat(Object.keys(o)),[]);if(i.length>0){const d=[...new Set(i)].map(o=>`"${o}"`);this.url.searchParams.set("columns",d.join(","))}}return new ta.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(s,{onConflict:r,ignoreDuplicates:a=!1,count:n,defaultToNull:l=!0}={}){var i;const d="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),n&&this.headers.append("Prefer",`count=${n}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const o=s.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(o.length>0){const u=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new ta.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(s,{count:r}={}){var a;const n="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new ta.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:s}={}){var r;const a="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new ta.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Ml.default=Of;var Ph=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(kc,"__esModule",{value:!0});const $f=Ph(Ml),Ff=Ph(Ka);let Uf=class Mh{constructor(s,{headers:r={},schema:a,fetch:n}={}){this.url=s,this.headers=new Headers(r),this.schemaName=a,this.fetch=n}from(s){const r=new URL(`${this.url}/${s}`);return new $f.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new Mh(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,r={},{head:a=!1,get:n=!1,count:l}={}){var i;let d;const o=new URL(`${this.url}/rpc/${s}`);let u;a||n?(d=a?"HEAD":"GET",Object.entries(r).filter(([x,m])=>m!==void 0).map(([x,m])=>[x,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([x,m])=>{o.searchParams.append(x,m)})):(d="POST",u=r);const c=new Headers(this.headers);return l&&c.set("Prefer",`count=${l}`),new Ff.default({method:d,url:o,headers:c,schema:this.schemaName,body:u,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};kc.default=Uf;var Vr=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(st,"__esModule",{value:!0});st.PostgrestError=st.PostgrestBuilder=st.PostgrestTransformBuilder=st.PostgrestFilterBuilder=st.PostgrestQueryBuilder=st.PostgrestClient=void 0;const Dh=Vr(kc);st.PostgrestClient=Dh.default;const Ih=Vr(Ml);st.PostgrestQueryBuilder=Ih.default;const Lh=Vr(Ka);st.PostgrestFilterBuilder=Lh.default;const Rh=Vr(Dl);st.PostgrestTransformBuilder=Rh.default;const Oh=Vr(Il);st.PostgrestBuilder=Oh.default;const $h=Vr(Ll);st.PostgrestError=$h.default;var zf=st.default={PostgrestClient:Dh.default,PostgrestQueryBuilder:Ih.default,PostgrestFilterBuilder:Lh.default,PostgrestTransformBuilder:Rh.default,PostgrestBuilder:Oh.default,PostgrestError:$h.default};const{PostgrestClient:qf,PostgrestQueryBuilder:Vv,PostgrestFilterBuilder:Wv,PostgrestTransformBuilder:Hv,PostgrestBuilder:Jv,PostgrestError:Qv}=zf;class Bf{static detectEnvironment(){var s;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((s=navigator.userAgent)===null||s===void 0)&&s.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,n=parseInt(a.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const s=this.detectEnvironment();if(s.constructor)return s.constructor;let r=s.error||"WebSocket not supported in this environment.";throw s.workaround&&(r+=`

Suggested solution: ${s.workaround}`),new Error(r)}static createWebSocket(s,r){const a=this.getWebSocketConstructor();return new a(s,r)}static isWebSocketSupported(){try{const s=this.detectEnvironment();return s.type==="native"||s.type==="ws"}catch{return!1}}}const Vf="2.15.5",Wf=`realtime-js/${Vf}`,Hf="1.0.0",xo=1e4,Jf=1e3,Qf=100;var ya;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ya||(ya={}));var Pe;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Pe||(Pe={}));var Et;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Et||(Et={}));var po;(function(t){t.websocket="websocket"})(po||(po={}));var Ls;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ls||(Ls={}));class Gf{constructor(){this.HEADER_LENGTH=1}decode(s,r){return s.constructor===ArrayBuffer?r(this._binaryDecode(s)):r(typeof s=="string"?JSON.parse(s):{})}_binaryDecode(s){const r=new DataView(s),a=new TextDecoder;return this._decodeBroadcast(s,r,a)}_decodeBroadcast(s,r,a){const n=r.getUint8(1),l=r.getUint8(2);let i=this.HEADER_LENGTH+2;const d=a.decode(s.slice(i,i+n));i=i+n;const o=a.decode(s.slice(i,i+l));i=i+l;const u=JSON.parse(a.decode(s.slice(i,s.byteLength)));return{ref:null,topic:d,event:o,payload:u}}}class Fh{constructor(s,r){this.callback=s,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=s,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var de;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(de||(de={}));const Qd=(t,s,r={})=>{var a;const n=(a=r.skipTypes)!==null&&a!==void 0?a:[];return Object.keys(s).reduce((l,i)=>(l[i]=Kf(i,t,s,n),l),{})},Kf=(t,s,r,a)=>{const n=s.find(d=>d.name===t),l=n==null?void 0:n.type,i=r[t];return l&&!a.includes(l)?Uh(l,i):fo(i)},Uh=(t,s)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return eg(s,r)}switch(t){case de.bool:return Xf(s);case de.float4:case de.float8:case de.int2:case de.int4:case de.int8:case de.numeric:case de.oid:return Zf(s);case de.json:case de.jsonb:return Yf(s);case de.timestamp:return tg(s);case de.abstime:case de.date:case de.daterange:case de.int4range:case de.int8range:case de.money:case de.reltime:case de.text:case de.time:case de.timestamptz:case de.timetz:case de.tsrange:case de.tstzrange:return fo(s);default:return fo(s)}},fo=t=>t,Xf=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Zf=t=>{if(typeof t=="string"){const s=parseFloat(t);if(!Number.isNaN(s))return s}return t},Yf=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(s){return console.log(`JSON parse error: ${s}`),t}return t},eg=(t,s)=>{if(typeof t!="string")return t;const r=t.length-1,a=t[r];if(t[0]==="{"&&a==="}"){let l;const i=t.slice(1,r);try{l=JSON.parse("["+i+"]")}catch{l=i?i.split(","):[]}return l.map(d=>Uh(s,d))}return t},tg=t=>typeof t=="string"?t.replace(" ","T"):t,zh=t=>{let s=t;return s=s.replace(/^ws/i,"http"),s=s.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),s.replace(/\/+$/,"")+"/api/broadcast"};class di{constructor(s,r,a={},n=xo){this.channel=s,this.event=r,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(s){this.timeout=s,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(s){this.payload=Object.assign(Object.assign({},this.payload),s)}receive(s,r){var a;return this._hasReceived(s)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:s,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const s=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},s),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(s,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:s,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:s,response:r}){this.recHooks.filter(a=>a.status===s).forEach(a=>a.callback(r))}_hasReceived(s){return this.receivedResp&&this.receivedResp.status===s}}var Gd;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Gd||(Gd={}));class ba{constructor(s,r){this.channel=s,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:l,onLeave:i,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ba.syncState(this.state,n,l,i),this.pendingDiffs.forEach(o=>{this.state=ba.syncDiff(this.state,o,l,i)}),this.pendingDiffs=[],d()}),this.channel._on(a.diff,{},n=>{const{onJoin:l,onLeave:i,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=ba.syncDiff(this.state,n,l,i),d())}),this.onJoin((n,l,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:l,newPresences:i})}),this.onLeave((n,l,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:l,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(s,r,a,n){const l=this.cloneDeep(s),i=this.transformState(r),d={},o={};return this.map(l,(u,c)=>{i[u]||(o[u]=c)}),this.map(i,(u,c)=>{const x=l[u];if(x){const m=c.map(k=>k.presence_ref),f=x.map(k=>k.presence_ref),y=c.filter(k=>f.indexOf(k.presence_ref)<0),N=x.filter(k=>m.indexOf(k.presence_ref)<0);y.length>0&&(d[u]=y),N.length>0&&(o[u]=N)}else d[u]=c}),this.syncDiff(l,{joins:d,leaves:o},a,n)}static syncDiff(s,r,a,n){const{joins:l,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(l,(d,o)=>{var u;const c=(u=s[d])!==null&&u!==void 0?u:[];if(s[d]=this.cloneDeep(o),c.length>0){const x=s[d].map(f=>f.presence_ref),m=c.filter(f=>x.indexOf(f.presence_ref)<0);s[d].unshift(...m)}a(d,c,o)}),this.map(i,(d,o)=>{let u=s[d];if(!u)return;const c=o.map(x=>x.presence_ref);u=u.filter(x=>c.indexOf(x.presence_ref)<0),s[d]=u,n(d,u,o),u.length===0&&delete s[d]}),s}static map(s,r){return Object.getOwnPropertyNames(s).map(a=>r(a,s[a]))}static transformState(s){return s=this.cloneDeep(s),Object.getOwnPropertyNames(s).reduce((r,a)=>{const n=s[a];return"metas"in n?r[a]=n.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[a]=n,r},{})}static cloneDeep(s){return JSON.parse(JSON.stringify(s))}onJoin(s){this.caller.onJoin=s}onLeave(s){this.caller.onLeave=s}onSync(s){this.caller.onSync=s}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Kd;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Kd||(Kd={}));var va;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(va||(va={}));var Wt;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Wt||(Wt={}));class Sc{constructor(s,r={config:{}},a){this.topic=s,this.params=r,this.socket=a,this.bindings={},this.state=Pe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=s.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new di(this,Et.join,this.params,this.timeout),this.rejoinTimer=new Fh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Pe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Pe.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Pe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Pe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Pe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Et.reply,{},(n,l)=>{this._trigger(this._replyEventName(l),n)}),this.presence=new ba(this),this.broadcastEndpointURL=zh(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(s,r=this.timeout){var a,n,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Pe.closed){const{config:{broadcast:i,presence:d,private:o}}=this.params,u=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(f=>f.filter))!==null&&n!==void 0?n:[],c=!!this.bindings[va.PRESENCE]&&this.bindings[va.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,x={},m={broadcast:i,presence:Object.assign(Object.assign({},d),{enabled:c}),postgres_changes:u,private:o};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(f=>s==null?void 0:s(Wt.CHANNEL_ERROR,f)),this._onClose(()=>s==null?void 0:s(Wt.CLOSED)),this.updateJoinPayload(Object.assign({config:m},x)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var y;if(this.socket.setAuth(),f===void 0){s==null||s(Wt.SUBSCRIBED);return}else{const N=this.bindings.postgres_changes,k=(y=N==null?void 0:N.length)!==null&&y!==void 0?y:0,b=[];for(let v=0;v<k;v++){const h=N[v],{filter:{event:g,schema:w,table:S,filter:j}}=h,_=f&&f[v];if(_&&_.event===g&&_.schema===w&&_.table===S&&_.filter===j)b.push(Object.assign(Object.assign({},h),{id:_.id}));else{this.unsubscribe(),this.state=Pe.errored,s==null||s(Wt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,s&&s(Wt.SUBSCRIBED);return}}).receive("error",f=>{this.state=Pe.errored,s==null||s(Wt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{s==null||s(Wt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(s,r={}){return await this.send({type:"presence",event:"track",payload:s},r.timeout||this.timeout)}async untrack(s={}){return await this.send({type:"presence",event:"untrack"},s)}on(s,r,a){return this.state===Pe.joined&&s===va.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(s,r,a)}async send(s,r={}){var a,n;if(!this._canPush()&&s.type==="broadcast"){const{event:l,payload:i}=s,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var i,d,o;const u=this._push(s.type,s,r.timeout||this.timeout);s.type==="broadcast"&&!(!((o=(d=(i=this.params)===null||i===void 0?void 0:i.config)===null||d===void 0?void 0:d.broadcast)===null||o===void 0)&&o.ack)&&l("ok"),u.receive("ok",()=>l("ok")),u.receive("error",()=>l("error")),u.receive("timeout",()=>l("timed out"))})}updateJoinPayload(s){this.joinPush.updatePayload(s)}unsubscribe(s=this.timeout){this.state=Pe.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Et.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new di(this,Et.leave,{},s),a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(s=>s.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Pe.closed,this.bindings={}}async _fetchWithTimeout(s,r,a){const n=new AbortController,l=setTimeout(()=>n.abort(),a),i=await this.socket.fetch(s,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(l),i}_push(s,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${s}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new di(this,s,r,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(s){if(s.startTimeout(),this.pushBuffer.push(s),this.pushBuffer.length>Qf){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(s,r,a){return r}_isMember(s){return this.topic===s}_joinRef(){return this.joinPush.ref}_trigger(s,r,a){var n,l;const i=s.toLocaleLowerCase(),{close:d,error:o,leave:u,join:c}=Et;if(a&&[d,o,u,c].indexOf(i)>=0&&a!==this._joinRef())return;let m=this._onMessage(i,r,a);if(r&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var y,N,k;return((y=f.filter)===null||y===void 0?void 0:y.event)==="*"||((k=(N=f.filter)===null||N===void 0?void 0:N.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===i}).map(f=>f.callback(m,a)):(l=this.bindings[i])===null||l===void 0||l.filter(f=>{var y,N,k,b,v,h;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in f){const g=f.id,w=(y=f.filter)===null||y===void 0?void 0:y.event;return g&&((N=r.ids)===null||N===void 0?void 0:N.includes(g))&&(w==="*"||(w==null?void 0:w.toLocaleLowerCase())===((k=r.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const g=(v=(b=f==null?void 0:f.filter)===null||b===void 0?void 0:b.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return g==="*"||g===((h=r==null?void 0:r.event)===null||h===void 0?void 0:h.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===i}).map(f=>{if(typeof m=="object"&&"ids"in m){const y=m.data,{schema:N,table:k,commit_timestamp:b,type:v,errors:h}=y;m=Object.assign(Object.assign({},{schema:N,table:k,commit_timestamp:b,eventType:v,new:{},old:{},errors:h}),this._getPayloadRecords(y))}f.callback(m,a)})}_isClosed(){return this.state===Pe.closed}_isJoined(){return this.state===Pe.joined}_isJoining(){return this.state===Pe.joining}_isLeaving(){return this.state===Pe.leaving}_replyEventName(s){return`chan_reply_${s}`}_on(s,r,a){const n=s.toLocaleLowerCase(),l={type:n,filter:r,callback:a};return this.bindings[n]?this.bindings[n].push(l):this.bindings[n]=[l],this}_off(s,r){const a=s.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var l;return!(((l=n.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===a&&Sc.isEqual(n.filter,r))})),this}static isEqual(s,r){if(Object.keys(s).length!==Object.keys(r).length)return!1;for(const a in s)if(s[a]!==r[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(s){this._on(Et.close,{},s)}_onError(s){this._on(Et.error,{},r=>s(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(s=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Pe.joining,this.joinPush.resend(s))}_getPayloadRecords(s){const r={new:{},old:{}};return(s.type==="INSERT"||s.type==="UPDATE")&&(r.new=Qd(s.columns,s.record)),(s.type==="UPDATE"||s.type==="DELETE")&&(r.old=Qd(s.columns,s.old_record)),r}}const ui=()=>{},bn={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},sg=[1e3,2e3,5e3,1e4],rg=1e4,ag=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ng{constructor(s,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xo,this.transport=null,this.heartbeatIntervalMs=bn.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ui,this.ref=0,this.reconnectTimer=null,this.logger=ui,this.conn=null,this.sendBuffer=[],this.serializer=new Gf,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let l;return n?l=n:typeof fetch>"u"?l=(...i)=>Ga(async()=>{const{default:d}=await Promise.resolve().then(()=>Br);return{default:d}},void 0).then(({default:d})=>d(...i)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...i)=>l(...i)},!(!((a=r==null?void 0:r.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${s}/${po.websocket}`,this.httpEndpoint=zh(s),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Bf.createWebSocket(this.endpointURL())}catch(s){this._setConnectionState("disconnected");const r=s.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Hf}))}disconnect(s,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},s?this.conn.close(s,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(s){const r=await s.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const s=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),s}log(s,r,a){this.logger(s,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case ya.connecting:return Ls.Connecting;case ya.open:return Ls.Open;case ya.closing:return Ls.Closing;default:return Ls.Closed}}isConnected(){return this.connectionState()===Ls.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(s,r={config:{}}){const a=`realtime:${s}`,n=this.getChannels().find(l=>l.topic===a);if(n)return n;{const l=new Sc(`realtime:${s}`,r,this);return this.channels.push(l),l}}push(s){const{topic:r,event:a,payload:n,ref:l}=s,i=()=>{this.encode(s,d=>{var o;(o=this.conn)===null||o===void 0||o.send(d)})};this.log("push",`${r} ${a} (${l})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(s=null){this._authPromise=this._performAuth(s);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var s;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(s=this.conn)===null||s===void 0||s.close(Jf,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},bn.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(s){this.heartbeatCallback=s}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(s=>s()),this.sendBuffer=[])}_makeRef(){let s=this.ref+1;return s===this.ref?this.ref=0:this.ref=s,this.ref.toString()}_leaveOpenTopic(s){let r=this.channels.find(a=>a.topic===s&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${s}"`),r.unsubscribe())}_remove(s){this.channels=this.channels.filter(r=>r.topic!==s.topic)}_onConnMessage(s){this.decode(s.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:n,payload:l,ref:i}=r,d=i?`(${i})`:"",o=l.status||"";this.log("receive",`${o} ${a} ${n} ${d}`.trim(),l),this.channels.filter(u=>u._isMember(a)).forEach(u=>u._trigger(n,l,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(s){var r;s==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):s==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=s=>this._onConnError(s),this.conn.onmessage=s=>this._onConnMessage(s),this.conn.onclose=s=>this._onConnClose(s))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(s=>s.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const s=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(s),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(s){var r;this._setConnectionState("disconnected"),this.log("transport","close",s),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",s)}_onConnError(s){this._setConnectionState("disconnected"),this.log("transport",`${s}`),this._triggerChanError(),this._triggerStateCallbacks("error",s)}_triggerChanError(){this.channels.forEach(s=>s._trigger(Et.error))}_appendParams(s,r){if(Object.keys(r).length===0)return s;const a=s.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${s}${a}${n}`}_workerObjectUrl(s){let r;if(s)r=s;else{const a=new Blob([ag],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(s,r=!1){this._connectionState=s,s==="connecting"?this._wasManualDisconnect=!1:s==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(s=null){let r;s?r=s:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const n={access_token:r,version:Wf};r&&a.updateJoinPayload(n),a.joinedOnce&&a._isJoined()&&a._push(Et.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(s="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${s}`,r)})}_triggerStateCallbacks(s,r){try{this.stateChangeCallbacks[s].forEach(a=>{try{a(r)}catch(n){this.log("error",`error in ${s} callback`,n)}})}catch(a){this.log("error",`error triggering ${s} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new Fh(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},bn.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(s){var r,a,n,l,i,d,o,u,c;if(this.transport=(r=s==null?void 0:s.transport)!==null&&r!==void 0?r:null,this.timeout=(a=s==null?void 0:s.timeout)!==null&&a!==void 0?a:xo,this.heartbeatIntervalMs=(n=s==null?void 0:s.heartbeatIntervalMs)!==null&&n!==void 0?n:bn.HEARTBEAT_INTERVAL,this.worker=(l=s==null?void 0:s.worker)!==null&&l!==void 0?l:!1,this.accessToken=(i=s==null?void 0:s.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(d=s==null?void 0:s.heartbeatCallback)!==null&&d!==void 0?d:ui,s!=null&&s.params&&(this.params=s.params),s!=null&&s.logger&&(this.logger=s.logger),(s!=null&&s.logLevel||s!=null&&s.log_level)&&(this.logLevel=s.logLevel||s.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(o=s==null?void 0:s.reconnectAfterMs)!==null&&o!==void 0?o:x=>sg[x-1]||rg,this.encode=(u=s==null?void 0:s.encode)!==null&&u!==void 0?u:(x,m)=>m(JSON.stringify(x)),this.decode=(c=s==null?void 0:s.decode)!==null&&c!==void 0?c:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=s==null?void 0:s.workerUrl}}}class Cc extends Error{constructor(s){super(s),this.__isStorageError=!0,this.name="StorageError"}}function Me(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class lg extends Cc{constructor(s,r,a){super(s),this.name="StorageApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class go extends Cc{constructor(s,r){super(s),this.name="StorageUnknownError",this.originalError=r}}var ig=function(t,s,r,a){function n(l){return l instanceof r?l:new r(function(i){i(l)})}return new(r||(r=Promise))(function(l,i){function d(c){try{u(a.next(c))}catch(x){i(x)}}function o(c){try{u(a.throw(c))}catch(x){i(x)}}function u(c){c.done?l(c.value):n(c.value).then(d,o)}u((a=a.apply(t,s||[])).next())})};const qh=t=>{let s;return t?s=t:typeof fetch>"u"?s=(...r)=>Ga(async()=>{const{default:a}=await Promise.resolve().then(()=>Br);return{default:a}},void 0).then(({default:a})=>a(...r)):s=fetch,(...r)=>s(...r)},og=()=>ig(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ga(()=>Promise.resolve().then(()=>Br),void 0)).Response:Response}),yo=t=>{if(Array.isArray(t))return t.map(r=>yo(r));if(typeof t=="function"||t!==Object(t))return t;const s={};return Object.entries(t).forEach(([r,a])=>{const n=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));s[n]=yo(a)}),s},cg=t=>{if(typeof t!="object"||t===null)return!1;const s=Object.getPrototypeOf(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Ys=function(t,s,r,a){function n(l){return l instanceof r?l:new r(function(i){i(l)})}return new(r||(r=Promise))(function(l,i){function d(c){try{u(a.next(c))}catch(x){i(x)}}function o(c){try{u(a.throw(c))}catch(x){i(x)}}function u(c){c.done?l(c.value):n(c.value).then(d,o)}u((a=a.apply(t,s||[])).next())})};const mi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),dg=(t,s,r)=>Ys(void 0,void 0,void 0,function*(){const a=yield og();t instanceof a&&!(r!=null&&r.noResolveJson)?t.json().then(n=>{const l=t.status||500,i=(n==null?void 0:n.statusCode)||l+"";s(new lg(mi(n),l,i))}).catch(n=>{s(new go(mi(n),n))}):s(new go(mi(t),t))}),ug=(t,s,r,a)=>{const n={method:t,headers:(s==null?void 0:s.headers)||{}};return t==="GET"||!a?n:(cg(a)?(n.headers=Object.assign({"Content-Type":"application/json"},s==null?void 0:s.headers),n.body=JSON.stringify(a)):n.body=a,s!=null&&s.duplex&&(n.duplex=s.duplex),Object.assign(Object.assign({},n),r))};function Xa(t,s,r,a,n,l){return Ys(this,void 0,void 0,function*(){return new Promise((i,d)=>{t(r,ug(s,a,n,l)).then(o=>{if(!o.ok)throw o;return a!=null&&a.noResolveJson?o:o.json()}).then(o=>i(o)).catch(o=>dg(o,d,a))})})}function cl(t,s,r,a){return Ys(this,void 0,void 0,function*(){return Xa(t,"GET",s,r,a)})}function Lt(t,s,r,a,n){return Ys(this,void 0,void 0,function*(){return Xa(t,"POST",s,a,n,r)})}function bo(t,s,r,a,n){return Ys(this,void 0,void 0,function*(){return Xa(t,"PUT",s,a,n,r)})}function mg(t,s,r,a){return Ys(this,void 0,void 0,function*(){return Xa(t,"HEAD",s,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function Bh(t,s,r,a,n){return Ys(this,void 0,void 0,function*(){return Xa(t,"DELETE",s,a,n,r)})}var Qe=function(t,s,r,a){function n(l){return l instanceof r?l:new r(function(i){i(l)})}return new(r||(r=Promise))(function(l,i){function d(c){try{u(a.next(c))}catch(x){i(x)}}function o(c){try{u(a.throw(c))}catch(x){i(x)}}function u(c){c.done?l(c.value):n(c.value).then(d,o)}u((a=a.apply(t,s||[])).next())})};const hg={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Xd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class xg{constructor(s,r={},a,n){this.shouldThrowOnError=!1,this.url=s,this.headers=r,this.bucketId=a,this.fetch=qh(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(s,r,a,n){return Qe(this,void 0,void 0,function*(){try{let l;const i=Object.assign(Object.assign({},Xd),n);let d=Object.assign(Object.assign({},this.headers),s==="POST"&&{"x-upsert":String(i.upsert)});const o=i.metadata;typeof Blob<"u"&&a instanceof Blob?(l=new FormData,l.append("cacheControl",i.cacheControl),o&&l.append("metadata",this.encodeMetadata(o)),l.append("",a)):typeof FormData<"u"&&a instanceof FormData?(l=a,l.append("cacheControl",i.cacheControl),o&&l.append("metadata",this.encodeMetadata(o))):(l=a,d["cache-control"]=`max-age=${i.cacheControl}`,d["content-type"]=i.contentType,o&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),n!=null&&n.headers&&(d=Object.assign(Object.assign({},d),n.headers));const u=this._removeEmptyFolders(r),c=this._getFinalPath(u),x=yield(s=="PUT"?bo:Lt)(this.fetch,`${this.url}/object/${c}`,l,Object.assign({headers:d},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:x.Id,fullPath:x.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Me(l))return{data:null,error:l};throw l}})}upload(s,r,a){return Qe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",s,r,a)})}uploadToSignedUrl(s,r,a,n){return Qe(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(s),i=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${i}`);d.searchParams.set("token",r);try{let o;const u=Object.assign({upsert:Xd.upsert},n),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&a instanceof Blob?(o=new FormData,o.append("cacheControl",u.cacheControl),o.append("",a)):typeof FormData<"u"&&a instanceof FormData?(o=a,o.append("cacheControl",u.cacheControl)):(o=a,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const x=yield bo(this.fetch,d.toString(),o,{headers:c});return{data:{path:l,fullPath:x.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Me(o))return{data:null,error:o};throw o}})}createSignedUploadUrl(s,r){return Qe(this,void 0,void 0,function*(){try{let a=this._getFinalPath(s);const n=Object.assign({},this.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const l=yield Lt(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),i=new URL(this.url+l.url),d=i.searchParams.get("token");if(!d)throw new Cc("No token returned by API");return{data:{signedUrl:i.toString(),path:s,token:d},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Me(a))return{data:null,error:a};throw a}})}update(s,r,a){return Qe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",s,r,a)})}move(s,r,a){return Qe(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:s,destinationKey:r,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Me(n))return{data:null,error:n};throw n}})}copy(s,r,a){return Qe(this,void 0,void 0,function*(){try{return{data:{path:(yield Lt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:s,destinationKey:r,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Me(n))return{data:null,error:n};throw n}})}createSignedUrl(s,r,a){return Qe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(s),l=yield Lt(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const i=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${i}`)},{data:l,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Me(n))return{data:null,error:n};throw n}})}createSignedUrls(s,r,a){return Qe(this,void 0,void 0,function*(){try{const n=yield Lt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:s},{headers:this.headers}),l=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${l}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Me(n))return{data:null,error:n};throw n}})}download(s,r){return Qe(this,void 0,void 0,function*(){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=l?`?${l}`:"";try{const d=this._getFinalPath(s);return{data:yield(yield cl(this.fetch,`${this.url}/${n}/${d}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(Me(d))return{data:null,error:d};throw d}})}info(s){return Qe(this,void 0,void 0,function*(){const r=this._getFinalPath(s);try{const a=yield cl(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:yo(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Me(a))return{data:null,error:a};throw a}})}exists(s){return Qe(this,void 0,void 0,function*(){const r=this._getFinalPath(s);try{return yield mg(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Me(a)&&a instanceof go){const n=a.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:a}}throw a}})}getPublicUrl(s,r){const a=this._getFinalPath(s),n=[],l=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";l!==""&&n.push(l);const d=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});o!==""&&n.push(o);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${a}${u}`)}}}remove(s){return Qe(this,void 0,void 0,function*(){try{return{data:yield Bh(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:s},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Me(r))return{data:null,error:r};throw r}})}list(s,r,a){return Qe(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},hg),r),{prefix:s||""});return{data:yield Lt(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Me(n))return{data:null,error:n};throw n}})}listV2(s,r){return Qe(this,void 0,void 0,function*(){try{const a=Object.assign({},s);return{data:yield Lt(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Me(a))return{data:null,error:a};throw a}})}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s.replace(/^\/+/,"")}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){const r=[];return s.width&&r.push(`width=${s.width}`),s.height&&r.push(`height=${s.height}`),s.resize&&r.push(`resize=${s.resize}`),s.format&&r.push(`format=${s.format}`),s.quality&&r.push(`quality=${s.quality}`),r.join("&")}}const pg="2.12.1",fg={"X-Client-Info":`storage-js/${pg}`};var nr=function(t,s,r,a){function n(l){return l instanceof r?l:new r(function(i){i(l)})}return new(r||(r=Promise))(function(l,i){function d(c){try{u(a.next(c))}catch(x){i(x)}}function o(c){try{u(a.throw(c))}catch(x){i(x)}}function u(c){c.done?l(c.value):n(c.value).then(d,o)}u((a=a.apply(t,s||[])).next())})};class gg{constructor(s,r={},a,n){this.shouldThrowOnError=!1;const l=new URL(s);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},fg),r),this.fetch=qh(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return nr(this,void 0,void 0,function*(){try{return{data:yield cl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Me(s))return{data:null,error:s};throw s}})}getBucket(s){return nr(this,void 0,void 0,function*(){try{return{data:yield cl(this.fetch,`${this.url}/bucket/${s}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Me(r))return{data:null,error:r};throw r}})}createBucket(s,r={public:!1}){return nr(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Me(a))return{data:null,error:a};throw a}})}updateBucket(s,r){return nr(this,void 0,void 0,function*(){try{return{data:yield bo(this.fetch,`${this.url}/bucket/${s}`,{id:s,name:s,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Me(a))return{data:null,error:a};throw a}})}emptyBucket(s){return nr(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,`${this.url}/bucket/${s}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Me(r))return{data:null,error:r};throw r}})}deleteBucket(s){return nr(this,void 0,void 0,function*(){try{return{data:yield Bh(this.fetch,`${this.url}/bucket/${s}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Me(r))return{data:null,error:r};throw r}})}}class yg extends gg{constructor(s,r={},a,n){super(s,r,a,n)}from(s){return new xg(this.url,this.headers,s,this.fetch)}}const bg="2.57.4";let oa="";typeof Deno<"u"?oa="deno":typeof document<"u"?oa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?oa="react-native":oa="node";const vg={"X-Client-Info":`supabase-js-${oa}/${bg}`},jg={headers:vg},wg={schema:"public"},Ng={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},_g={};var kg=function(t,s,r,a){function n(l){return l instanceof r?l:new r(function(i){i(l)})}return new(r||(r=Promise))(function(l,i){function d(c){try{u(a.next(c))}catch(x){i(x)}}function o(c){try{u(a.throw(c))}catch(x){i(x)}}function u(c){c.done?l(c.value):n(c.value).then(d,o)}u((a=a.apply(t,s||[])).next())})};const Sg=t=>{let s;return t?s=t:typeof fetch>"u"?s=Eh:s=fetch,(...r)=>s(...r)},Cg=()=>typeof Headers>"u"?Th:Headers,Eg=(t,s,r)=>{const a=Sg(r),n=Cg();return(l,i)=>kg(void 0,void 0,void 0,function*(){var d;const o=(d=yield s())!==null&&d!==void 0?d:t;let u=new n(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${o}`),a(l,Object.assign(Object.assign({},i),{headers:u}))})};var Tg=function(t,s,r,a){function n(l){return l instanceof r?l:new r(function(i){i(l)})}return new(r||(r=Promise))(function(l,i){function d(c){try{u(a.next(c))}catch(x){i(x)}}function o(c){try{u(a.throw(c))}catch(x){i(x)}}function u(c){c.done?l(c.value):n(c.value).then(d,o)}u((a=a.apply(t,s||[])).next())})};function Ag(t){return t.endsWith("/")?t:t+"/"}function Pg(t,s){var r,a;const{db:n,auth:l,realtime:i,global:d}=t,{db:o,auth:u,realtime:c,global:x}=s,m={db:Object.assign(Object.assign({},o),n),auth:Object.assign(Object.assign({},u),l),realtime:Object.assign(Object.assign({},c),i),storage:{},global:Object.assign(Object.assign(Object.assign({},x),d),{headers:Object.assign(Object.assign({},(r=x==null?void 0:x.headers)!==null&&r!==void 0?r:{}),(a=d==null?void 0:d.headers)!==null&&a!==void 0?a:{})}),accessToken:()=>Tg(this,void 0,void 0,function*(){return""})};return t.accessToken?m.accessToken=t.accessToken:delete m.accessToken,m}function Mg(t){const s=t==null?void 0:t.trim();if(!s)throw new Error("supabaseUrl is required.");if(!s.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ag(s))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Vh="2.71.1",dr=30*1e3,vo=3,hi=vo*dr,Dg="http://localhost:9999",Ig="supabase.auth.token",Lg={"X-Client-Info":`gotrue-js/${Vh}`},jo="X-Supabase-Api-Version",Wh={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Rg=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Og=10*60*1e3;class Ec extends Error{constructor(s,r,a){super(s),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function Y(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class $g extends Ec{constructor(s,r,a){super(s,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function Fg(t){return Y(t)&&t.name==="AuthApiError"}class Hh extends Ec{constructor(s,r){super(s),this.name="AuthUnknownError",this.originalError=r}}class Es extends Ec{constructor(s,r,a,n){super(s,a,n),this.name=r,this.status=a}}class ns extends Es{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ug(t){return Y(t)&&t.name==="AuthSessionMissingError"}class vn extends Es{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class jn extends Es{constructor(s){super(s,"AuthInvalidCredentialsError",400,void 0)}}class wn extends Es{constructor(s,r=null){super(s,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function zg(t){return Y(t)&&t.name==="AuthImplicitGrantRedirectError"}class Zd extends Es{constructor(s,r=null){super(s,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wo extends Es{constructor(s,r){super(s,"AuthRetryableFetchError",r,void 0)}}function xi(t){return Y(t)&&t.name==="AuthRetryableFetchError"}class Yd extends Es{constructor(s,r,a){super(s,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class No extends Es{constructor(s){super(s,"AuthInvalidJwtError",400,"invalid_jwt")}}const dl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),eu=` 	
\r=`.split(""),qg=(()=>{const t=new Array(128);for(let s=0;s<t.length;s+=1)t[s]=-1;for(let s=0;s<eu.length;s+=1)t[eu[s].charCodeAt(0)]=-2;for(let s=0;s<dl.length;s+=1)t[dl[s].charCodeAt(0)]=s;return t})();function tu(t,s,r){if(t!==null)for(s.queue=s.queue<<8|t,s.queuedBits+=8;s.queuedBits>=6;){const a=s.queue>>s.queuedBits-6&63;r(dl[a]),s.queuedBits-=6}else if(s.queuedBits>0)for(s.queue=s.queue<<6-s.queuedBits,s.queuedBits=6;s.queuedBits>=6;){const a=s.queue>>s.queuedBits-6&63;r(dl[a]),s.queuedBits-=6}}function Jh(t,s,r){const a=qg[t];if(a>-1)for(s.queue=s.queue<<6|a,s.queuedBits+=6;s.queuedBits>=8;)r(s.queue>>s.queuedBits-8&255),s.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function su(t){const s=[],r=i=>{s.push(String.fromCodePoint(i))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},l=i=>{Wg(i,a,r)};for(let i=0;i<t.length;i+=1)Jh(t.charCodeAt(i),n,l);return s.join("")}function Bg(t,s){if(t<=127){s(t);return}else if(t<=2047){s(192|t>>6),s(128|t&63);return}else if(t<=65535){s(224|t>>12),s(128|t>>6&63),s(128|t&63);return}else if(t<=1114111){s(240|t>>18),s(128|t>>12&63),s(128|t>>6&63),s(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Vg(t,s){for(let r=0;r<t.length;r+=1){let a=t.charCodeAt(r);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}Bg(a,s)}}function Wg(t,s,r){if(s.utf8seq===0){if(t<=127){r(t);return}for(let a=1;a<6;a+=1)if(!(t>>7-a&1)){s.utf8seq=a;break}if(s.utf8seq===2)s.codepoint=t&31;else if(s.utf8seq===3)s.codepoint=t&15;else if(s.utf8seq===4)s.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");s.utf8seq-=1}else if(s.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");s.codepoint=s.codepoint<<6|t&63,s.utf8seq-=1,s.utf8seq===0&&r(s.codepoint)}}function Hg(t){const s=[],r={queue:0,queuedBits:0},a=n=>{s.push(n)};for(let n=0;n<t.length;n+=1)Jh(t.charCodeAt(n),r,a);return new Uint8Array(s)}function Jg(t){const s=[];return Vg(t,r=>s.push(r)),new Uint8Array(s)}function Qg(t){const s=[],r={queue:0,queuedBits:0},a=n=>{s.push(n)};return t.forEach(n=>tu(n,r,a)),tu(null,r,a),s.join("")}function Gg(t){return Math.round(Date.now()/1e3)+t}function Kg(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const s=Math.random()*16|0;return(t=="x"?s:s&3|8).toString(16)})}const kt=()=>typeof window<"u"&&typeof document<"u",As={tested:!1,writable:!1},Qh=()=>{if(!kt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(As.tested)return As.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),As.tested=!0,As.writable=!0}catch{As.tested=!0,As.writable=!1}return As.writable};function Xg(t){const s={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,l)=>{s[l]=n})}catch{}return r.searchParams.forEach((a,n)=>{s[n]=a}),s}const Gh=t=>{let s;return t?s=t:typeof fetch>"u"?s=(...r)=>Ga(async()=>{const{default:a}=await Promise.resolve().then(()=>Br);return{default:a}},void 0).then(({default:a})=>a(...r)):s=fetch,(...r)=>s(...r)},Zg=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",ur=async(t,s,r)=>{await t.setItem(s,JSON.stringify(r))},Ps=async(t,s)=>{const r=await t.getItem(s);if(!r)return null;try{return JSON.parse(r)}catch{return r}},as=async(t,s)=>{await t.removeItem(s)};class Rl{constructor(){this.promise=new Rl.promiseConstructor((s,r)=>{this.resolve=s,this.reject=r})}}Rl.promiseConstructor=Promise;function pi(t){const s=t.split(".");if(s.length!==3)throw new No("Invalid JWT structure");for(let a=0;a<s.length;a++)if(!Rg.test(s[a]))throw new No("JWT not in base64url format");return{header:JSON.parse(su(s[0])),payload:JSON.parse(su(s[1])),signature:Hg(s[2]),raw:{header:s[0],payload:s[1]}}}async function Yg(t){return await new Promise(s=>{setTimeout(()=>s(null),t)})}function ey(t,s){return new Promise((a,n)=>{(async()=>{for(let l=0;l<1/0;l++)try{const i=await t(l);if(!s(l,null,i)){a(i);return}}catch(i){if(!s(l,i)){n(i);return}}})()})}function ty(t){return("0"+t.toString(16)).substr(-2)}function sy(){const s=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let n="";for(let l=0;l<56;l++)n+=r.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(s),Array.from(s,ty).join("")}async function ry(t){const r=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(a);return Array.from(n).map(l=>String.fromCharCode(l)).join("")}async function ay(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await ry(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function lr(t,s,r=!1){const a=sy();let n=a;r&&(n+="/PASSWORD_RECOVERY"),await ur(t,`${s}-code-verifier`,n);const l=await ay(a);return[l,a===l?"plain":"s256"]}const ny=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ly(t){const s=t.headers.get(jo);if(!s||!s.match(ny))return null;try{return new Date(`${s}T00:00:00.0Z`)}catch{return null}}function iy(t){if(!t)throw new Error("Missing exp claim");const s=Math.floor(Date.now()/1e3);if(t<=s)throw new Error("JWT has expired")}function oy(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const cy=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ir(t){if(!cy.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function fi(){const t={};return new Proxy(t,{get:(s,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(s,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(s,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ru(t){return JSON.parse(JSON.stringify(t))}var dy=function(t,s){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&s.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(t);n<a.length;n++)s.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]]);return r};const Is=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),uy=[502,503,504];async function au(t){var s;if(!Zg(t))throw new wo(Is(t),0);if(uy.includes(t.status))throw new wo(Is(t),t.status);let r;try{r=await t.json()}catch(l){throw new Hh(Is(l),l)}let a;const n=ly(t);if(n&&n.getTime()>=Wh["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new Yd(Is(r),t.status,((s=r.weak_password)===null||s===void 0?void 0:s.reasons)||[]);if(a==="session_not_found")throw new ns}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,i)=>l&&typeof i=="string",!0))throw new Yd(Is(r),t.status,r.weak_password.reasons);throw new $g(Is(r),t.status||500,a)}const my=(t,s,r,a)=>{const n={method:t,headers:(s==null?void 0:s.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},s==null?void 0:s.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function te(t,s,r,a){var n;const l=Object.assign({},a==null?void 0:a.headers);l[jo]||(l[jo]=Wh["2024-01-01"].name),a!=null&&a.jwt&&(l.Authorization=`Bearer ${a.jwt}`);const i=(n=a==null?void 0:a.query)!==null&&n!==void 0?n:{};a!=null&&a.redirectTo&&(i.redirect_to=a.redirectTo);const d=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",o=await hy(t,s,r+d,{headers:l,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(o):{data:Object.assign({},o),error:null}}async function hy(t,s,r,a,n,l){const i=my(s,a,n,l);let d;try{d=await t(r,Object.assign({},i))}catch(o){throw console.error(o),new wo(Is(o),0)}if(d.ok||await au(d),a!=null&&a.noResolveJson)return d;try{return await d.json()}catch(o){await au(o)}}function Bt(t){var s;let r=null;gy(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Gg(t.expires_in)));const a=(s=t.user)!==null&&s!==void 0?s:t;return{data:{session:r,user:a},error:null}}function nu(t){const s=Bt(t);return!s.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(s.data.weak_password=t.weak_password),s}function ds(t){var s;return{data:{user:(s=t.user)!==null&&s!==void 0?s:t},error:null}}function xy(t){return{data:t,error:null}}function py(t){const{action_link:s,email_otp:r,hashed_token:a,redirect_to:n,verification_type:l}=t,i=dy(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:s,email_otp:r,hashed_token:a,redirect_to:n,verification_type:l},o=Object.assign({},i);return{data:{properties:d,user:o},error:null}}function fy(t){return t}function gy(t){return t.access_token&&t.refresh_token&&t.expires_in}const gi=["global","local","others"];var yy=function(t,s){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&s.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(t);n<a.length;n++)s.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]]);return r};class by{constructor({url:s="",headers:r={},fetch:a}){this.url=s,this.headers=r,this.fetch=Gh(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(s,r=gi[0]){if(gi.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${gi.join(", ")}`);try{return await te(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:s,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Y(a))return{data:null,error:a};throw a}}async inviteUserByEmail(s,r={}){try{return await te(this.fetch,"POST",`${this.url}/invite`,{body:{email:s,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ds})}catch(a){if(Y(a))return{data:{user:null},error:a};throw a}}async generateLink(s){try{const{options:r}=s,a=yy(s,["options"]),n=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(n.new_email=a==null?void 0:a.newEmail,delete n.newEmail),await te(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:py,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Y(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(s){try{return await te(this.fetch,"POST",`${this.url}/admin/users`,{body:s,headers:this.headers,xform:ds})}catch(r){if(Y(r))return{data:{user:null},error:r};throw r}}async listUsers(s){var r,a,n,l,i,d,o;try{const u={nextPage:null,lastPage:0,total:0},c=await te(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=s==null?void 0:s.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(n=s==null?void 0:s.perPage)===null||n===void 0?void 0:n.toString())!==null&&l!==void 0?l:""},xform:fy});if(c.error)throw c.error;const x=await c.json(),m=(i=c.headers.get("x-total-count"))!==null&&i!==void 0?i:0,f=(o=(d=c.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&o!==void 0?o:[];return f.length>0&&(f.forEach(y=>{const N=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(y.split(";")[1].split("=")[1]);u[`${k}Page`]=N}),u.total=parseInt(m)),{data:Object.assign(Object.assign({},x),u),error:null}}catch(u){if(Y(u))return{data:{users:[]},error:u};throw u}}async getUserById(s){ir(s);try{return await te(this.fetch,"GET",`${this.url}/admin/users/${s}`,{headers:this.headers,xform:ds})}catch(r){if(Y(r))return{data:{user:null},error:r};throw r}}async updateUserById(s,r){ir(s);try{return await te(this.fetch,"PUT",`${this.url}/admin/users/${s}`,{body:r,headers:this.headers,xform:ds})}catch(a){if(Y(a))return{data:{user:null},error:a};throw a}}async deleteUser(s,r=!1){ir(s);try{return await te(this.fetch,"DELETE",`${this.url}/admin/users/${s}`,{headers:this.headers,body:{should_soft_delete:r},xform:ds})}catch(a){if(Y(a))return{data:{user:null},error:a};throw a}}async _listFactors(s){ir(s.userId);try{const{data:r,error:a}=await te(this.fetch,"GET",`${this.url}/admin/users/${s.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:a}}catch(r){if(Y(r))return{data:null,error:r};throw r}}async _deleteFactor(s){ir(s.userId),ir(s.id);try{return{data:await te(this.fetch,"DELETE",`${this.url}/admin/users/${s.userId}/factors/${s.id}`,{headers:this.headers}),error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}}}function lu(t={}){return{getItem:s=>t[s]||null,setItem:(s,r)=>{t[s]=r},removeItem:s=>{delete t[s]}}}function vy(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const or={debug:!!(globalThis&&Qh()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Kh extends Error{constructor(s){super(s),this.isAcquireTimeout=!0}}class jy extends Kh{}async function wy(t,s,r){or.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,s);const a=new globalThis.AbortController;return s>0&&setTimeout(()=>{a.abort(),or.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},s),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,s===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){or.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{or.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(s===0)throw or.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new jy(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(or.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}vy();const Ny={url:Dg,storageKey:Ig,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Lg,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function iu(t,s,r){return await r()}const cr={};class $a{constructor(s){var r,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=$a.nextInstanceID,$a.nextInstanceID+=1,this.instanceID>0&&kt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Ny),s);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new by({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Gh(n.fetch),this.lock=n.lock||iu,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:kt()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=wy:this.lock=iu,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:Qh()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=lu(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=lu(this.memoryStorage)),kt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var s,r;return(r=(s=cr[this.storageKey])===null||s===void 0?void 0:s.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(s){cr[this.storageKey]=Object.assign(Object.assign({},cr[this.storageKey]),{jwks:s})}get jwks_cached_at(){var s,r;return(r=(s=cr[this.storageKey])===null||s===void 0?void 0:s.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(s){cr[this.storageKey]=Object.assign(Object.assign({},cr[this.storageKey]),{cachedAt:s})}_debug(...s){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Vh}) ${new Date().toISOString()}`,...s),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var s;try{const r=Xg(window.location.href);let a="none";if(this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce"),kt()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:l}=await this._getSessionFromURL(r,a);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),zg(l)){const o=(s=l.details)===null||s===void 0?void 0:s.code;if(o==="identity_already_exists"||o==="identity_not_found"||o==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:i,redirectType:d}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",d),await this._saveSession(i),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Y(r)?{error:r}:{error:new Hh("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(s){var r,a,n;try{const l=await te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=s==null?void 0:s.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=s==null?void 0:s.options)===null||n===void 0?void 0:n.captchaToken}},xform:Bt}),{data:i,error:d}=l;if(d||!i)return{data:{user:null,session:null},error:d};const o=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:u,session:o},error:null}}catch(l){if(Y(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(s){var r,a,n;try{let l;if("email"in s){const{email:c,password:x,options:m}=s;let f=null,y=null;this.flowType==="pkce"&&([f,y]=await lr(this.storage,this.storageKey)),l=await te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:c,password:x,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:f,code_challenge_method:y},xform:Bt})}else if("phone"in s){const{phone:c,password:x,options:m}=s;l=await te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:x,data:(a=m==null?void 0:m.data)!==null&&a!==void 0?a:{},channel:(n=m==null?void 0:m.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:Bt})}else throw new jn("You must provide either an email or phone number and a password");const{data:i,error:d}=l;if(d||!i)return{data:{user:null,session:null},error:d};const o=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:u,session:o},error:null}}catch(l){if(Y(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(s){try{let r;if("email"in s){const{email:l,password:i,options:d}=s;r=await te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:i,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:nu})}else if("phone"in s){const{phone:l,password:i,options:d}=s;r=await te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:i,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:nu})}else throw new jn("You must provide either an email or phone number and a password");const{data:a,error:n}=r;return n?{data:{user:null,session:null},error:n}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new vn}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(r){if(Y(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(s){var r,a,n,l;return await this._handleProviderSignIn(s.provider,{redirectTo:(r=s.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=s.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=s.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(l=s.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(s){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(s))}async signInWithWeb3(s){const{chain:r}=s;if(r==="solana")return await this.signInWithSolana(s);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(s){var r,a,n,l,i,d,o,u,c,x,m,f;let y,N;if("message"in s)y=s.message,N=s.signature;else{const{chain:k,wallet:b,statement:v,options:h}=s;let g;if(kt())if(typeof b=="object")g=b;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))g=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(h!=null&&h.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=b}const w=new URL((r=h==null?void 0:h.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in g&&g.signIn){const S=await g.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},h==null?void 0:h.signInWithSolana),{version:"1",domain:w.host,uri:w.href}),v?{statement:v}:null));let j;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")j=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)j=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)y=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),N=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in g)||typeof g.signMessage!="function"||!("publicKey"in g)||typeof g!="object"||!g.publicKey||!("toBase58"in g.publicKey)||typeof g.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${w.host} wants you to sign in with your Solana account:`,g.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${w.href}`,`Issued At: ${(n=(a=h==null?void 0:h.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((l=h==null?void 0:h.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${h.signInWithSolana.notBefore}`]:[],...!((i=h==null?void 0:h.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${h.signInWithSolana.expirationTime}`]:[],...!((d=h==null?void 0:h.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${h.signInWithSolana.chainId}`]:[],...!((o=h==null?void 0:h.signInWithSolana)===null||o===void 0)&&o.nonce?[`Nonce: ${h.signInWithSolana.nonce}`]:[],...!((u=h==null?void 0:h.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${h.signInWithSolana.requestId}`]:[],...!((x=(c=h==null?void 0:h.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||x===void 0)&&x.length?["Resources",...h.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const S=await g.signMessage(new TextEncoder().encode(y),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");N=S}}try{const{data:k,error:b}=await te(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:Qg(N)},!((m=s.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(f=s.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Bt});if(b)throw b;return!k||!k.session||!k.user?{data:{user:null,session:null},error:new vn}:(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),{data:Object.assign({},k),error:b})}catch(k){if(Y(k))return{data:{user:null,session:null},error:k};throw k}}async _exchangeCodeForSession(s){const r=await Ps(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(r??"").split("/");try{const{data:l,error:i}=await te(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:s,code_verifier:a},xform:Bt});if(await as(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new vn}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:n??null}),error:i})}catch(l){if(Y(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(s){try{const{options:r,provider:a,token:n,access_token:l,nonce:i}=s,d=await te(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:l,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Bt}),{data:o,error:u}=d;return u?{data:{user:null,session:null},error:u}:!o||!o.session||!o.user?{data:{user:null,session:null},error:new vn}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:u})}catch(r){if(Y(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(s){var r,a,n,l,i;try{if("email"in s){const{email:d,options:o}=s;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await lr(this.storage,this.storageKey));const{error:x}=await te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(r=o==null?void 0:o.data)!==null&&r!==void 0?r:{},create_user:(a=o==null?void 0:o.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:x}}if("phone"in s){const{phone:d,options:o}=s,{data:u,error:c}=await te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(n=o==null?void 0:o.data)!==null&&n!==void 0?n:{},create_user:(l=o==null?void 0:o.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken},channel:(i=o==null?void 0:o.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new jn("You must provide either an email or phone number.")}catch(d){if(Y(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(s){var r,a;try{let n,l;"options"in s&&(n=(r=s.options)===null||r===void 0?void 0:r.redirectTo,l=(a=s.options)===null||a===void 0?void 0:a.captchaToken);const{data:i,error:d}=await te(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},s),{gotrue_meta_security:{captcha_token:l}}),redirectTo:n,xform:Bt});if(d)throw d;if(!i)throw new Error("An error occurred on token verification.");const o=i.session,u=i.user;return o!=null&&o.access_token&&(await this._saveSession(o),await this._notifyAllSubscribers(s.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:u,session:o},error:null}}catch(n){if(Y(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(s){var r,a,n;try{let l=null,i=null;return this.flowType==="pkce"&&([l,i]=await lr(this.storage,this.storageKey)),await te(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in s?{provider_id:s.providerId}:null),"domain"in s?{domain:s.domain}:null),{redirect_to:(a=(r=s.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=s==null?void 0:s.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:s.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:i}),headers:this.headers,xform:xy})}catch(l){if(Y(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async s=>{const{data:{session:r},error:a}=s;if(a)throw a;if(!r)throw new ns;const{error:n}=await te(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}})}catch(s){if(Y(s))return{data:{user:null,session:null},error:s};throw s}}async resend(s){try{const r=`${this.url}/resend`;if("email"in s){const{email:a,type:n,options:l}=s,{error:i}=await te(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in s){const{phone:a,type:n,options:l}=s,{data:i,error:d}=await te(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:d}}throw new jn("You must provide either an email or phone number and a type")}catch(r){if(Y(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(s,r){this._debug("#_acquireLock","begin",s);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,s,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(s){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await s(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let s=null;const r=await Ps(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?s=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!s)return{data:{session:null},error:null};const a=s.expires_at?s.expires_at*1e3-Date.now()<hi:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",s.expires_at),!a){if(this.userStorage){const i=await Ps(this.userStorage,this.storageKey+"-user");i!=null&&i.user?s.user=i.user:s.user=fi()}if(this.storage.isServer&&s.user){let i=this.suppressGetSessionWarning;s=new Proxy(s,{get:(o,u,c)=>(!i&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(o,u,c))})}return{data:{session:s},error:null}}const{session:n,error:l}=await this._callRefreshToken(s.refresh_token);return l?{data:{session:null},error:l}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(s){return s?await this._getUser(s):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(s){try{return s?await te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:s,xform:ds}):await this._useSession(async r=>{var a,n,l;const{data:i,error:d}=r;if(d)throw d;return!(!((a=i.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ns}:await te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&l!==void 0?l:void 0,xform:ds})})}catch(r){if(Y(r))return Ug(r)&&(await this._removeSession(),await as(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(s,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(s,r))}async _updateUser(s,r={}){try{return await this._useSession(async a=>{const{data:n,error:l}=a;if(l)throw l;if(!n.session)throw new ns;const i=n.session;let d=null,o=null;this.flowType==="pkce"&&s.email!=null&&([d,o]=await lr(this.storage,this.storageKey));const{data:u,error:c}=await te(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},s),{code_challenge:d,code_challenge_method:o}),jwt:i.access_token,xform:ds});if(c)throw c;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(a){if(Y(a))return{data:{user:null},error:a};throw a}}async setSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(s))}async _setSession(s){try{if(!s.access_token||!s.refresh_token)throw new ns;const r=Date.now()/1e3;let a=r,n=!0,l=null;const{payload:i}=pi(s.access_token);if(i.exp&&(a=i.exp,n=a<=r),n){const{session:d,error:o}=await this._callRefreshToken(s.refresh_token);if(o)return{data:{user:null,session:null},error:o};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:o}=await this._getUser(s.access_token);if(o)throw o;l={access_token:s.access_token,refresh_token:s.refresh_token,user:d.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(r){if(Y(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(s))}async _refreshSession(s){try{return await this._useSession(async r=>{var a;if(!s){const{data:i,error:d}=r;if(d)throw d;s=(a=i.session)!==null&&a!==void 0?a:void 0}if(!(s!=null&&s.refresh_token))throw new ns;const{session:n,error:l}=await this._callRefreshToken(s.refresh_token);return l?{data:{user:null,session:null},error:l}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Y(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(s,r){try{if(!kt())throw new wn("No browser detected.");if(s.error||s.error_description||s.error_code)throw new wn(s.error_description||"Error in URL with unspecified error_description",{error:s.error||"unspecified_error",code:s.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Zd("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wn("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!s.code)throw new Zd("No code detected.");const{data:v,error:h}=await this._exchangeCodeForSession(s.code);if(h)throw h;const g=new URL(window.location.href);return g.searchParams.delete("code"),window.history.replaceState(window.history.state,"",g.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:l,refresh_token:i,expires_in:d,expires_at:o,token_type:u}=s;if(!l||!d||!i||!u)throw new wn("No session defined in URL");const c=Math.round(Date.now()/1e3),x=parseInt(d);let m=c+x;o&&(m=parseInt(o));const f=m-c;f*1e3<=dr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${x}s`);const y=m-x;c-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,m,c):c-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,m,c);const{data:N,error:k}=await this._getUser(l);if(k)throw k;const b={provider_token:a,provider_refresh_token:n,access_token:l,expires_in:x,expires_at:m,refresh_token:i,token_type:u,user:N.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:s.type},error:null}}catch(a){if(Y(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(s){return!!(s.access_token||s.error_description)}async _isPKCECallback(s){const r=await Ps(this.storage,`${this.storageKey}-code-verifier`);return!!(s.code&&r)}async signOut(s={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(s))}async _signOut({scope:s}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:n,error:l}=r;if(l)return{error:l};const i=(a=n.session)===null||a===void 0?void 0:a.access_token;if(i){const{error:d}=await this.admin.signOut(i,s);if(d&&!(Fg(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return s!=="others"&&(await this._removeSession(),await as(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(s){const r=Kg(),a={id:r,callback:s,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(s){return await this._useSession(async r=>{var a,n;try{const{data:{session:l},error:i}=r;if(i)throw i;await((a=this.stateChangeEmitters.get(s))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",s,"session",l)}catch(l){await((n=this.stateChangeEmitters.get(s))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",s,"error",l),console.error(l)}})}async resetPasswordForEmail(s,r={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await lr(this.storage,this.storageKey,!0));try{return await te(this.fetch,"POST",`${this.url}/recover`,{body:{email:s,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(Y(l))return{data:null,error:l};throw l}}async getUserIdentities(){var s;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(s=r.user.identities)!==null&&s!==void 0?s:[]},error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}}async linkIdentity(s){var r;try{const{data:a,error:n}=await this._useSession(async l=>{var i,d,o,u,c;const{data:x,error:m}=l;if(m)throw m;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,s.provider,{redirectTo:(i=s.options)===null||i===void 0?void 0:i.redirectTo,scopes:(d=s.options)===null||d===void 0?void 0:d.scopes,queryParams:(o=s.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:!0});return await te(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=x.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(n)throw n;return kt()&&!(!((r=s.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),{data:{provider:s.provider,url:a==null?void 0:a.url},error:null}}catch(a){if(Y(a))return{data:{provider:s.provider,url:null},error:a};throw a}}async unlinkIdentity(s){try{return await this._useSession(async r=>{var a,n;const{data:l,error:i}=r;if(i)throw i;return await te(this.fetch,"DELETE",`${this.url}/user/identities/${s.identity_id}`,{headers:this.headers,jwt:(n=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(Y(r))return{data:null,error:r};throw r}}async _refreshAccessToken(s){const r=`#_refreshAccessToken(${s.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await ey(async n=>(n>0&&await Yg(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await te(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:s},headers:this.headers,xform:Bt})),(n,l)=>{const i=200*Math.pow(2,n);return l&&xi(l)&&Date.now()+i-a<dr})}catch(a){if(this._debug(r,"error",a),Y(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(r,"end")}}_isValidSession(s){return typeof s=="object"&&s!==null&&"access_token"in s&&"refresh_token"in s&&"expires_at"in s}async _handleProviderSignIn(s,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,s,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",s,"options",r,"url",a),kt()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:s,url:a},error:null}}async _recoverAndRefresh(){var s,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await Ps(this.storage,this.storageKey);if(n&&this.userStorage){let i=await Ps(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await ur(this.userStorage,this.storageKey+"-user",i)),n.user=(s=i==null?void 0:i.user)!==null&&s!==void 0?s:fi()}else if(n&&!n.user&&!n.user){const i=await Ps(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(n.user=i.user,await as(this.storage,this.storageKey+"-user"),await ur(this.storage,this.storageKey,n)):n.user=fi()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const l=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<hi;if(this._debug(a,`session has${l?"":" not"} expired with margin of ${hi}s`),l){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),xi(i)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:d}=await this._getUser(n.access_token);!d&&(i!=null&&i.user)?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(a,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(s){var r,a;if(!s)throw new ns;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${s.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Rl;const{data:l,error:i}=await this._refreshAccessToken(s);if(i)throw i;if(!l.session)throw new ns;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={session:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(n,"error",l),Y(l)){const i={session:null,error:l};return xi(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(l),l}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(s,r,a=!0){const n=`#_notifyAllSubscribers(${s})`;this._debug(n,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:s,session:r});const l=[],i=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(s,r)}catch(o){l.push(o)}});if(await Promise.all(i),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(n,"end")}}async _saveSession(s){this._debug("#_saveSession()",s),this.suppressGetSessionWarning=!0;const r=Object.assign({},s),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await ur(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const l=ru(n);await ur(this.storage,this.storageKey,l)}else{const n=ru(r);await ur(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await as(this.storage,this.storageKey),await as(this.storage,this.storageKey+"-code-verifier"),await as(this.storage,this.storageKey+"-user"),this.userStorage&&await as(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const s=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{s&&kt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",s)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const s=setInterval(()=>this._autoRefreshTokenTick(),dr);this.autoRefreshTicker=s,s&&typeof s=="object"&&typeof s.unref=="function"?s.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(s),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const s=this.autoRefreshTicker;this.autoRefreshTicker=null,s&&clearInterval(s)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const s=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-s)/dr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${dr}ms, refresh threshold is ${vo} ticks`),n<=vo&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(s){if(s.isAcquireTimeout||s instanceof Kh)this._debug("auto refresh token tick lock not available");else throw s}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!kt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(s){console.error("_handleVisibilityChange",s)}}async _onVisibilityChanged(s){const r=`#_onVisibilityChanged(${s})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),s||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(s,r,a){const n=[`provider=${encodeURIComponent(r)}`];if(a!=null&&a.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[l,i]=await lr(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(d.toString())}if(a!=null&&a.queryParams){const l=new URLSearchParams(a.queryParams);n.push(l.toString())}return a!=null&&a.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${s}?${n.join("&")}`}async _unenroll(s){try{return await this._useSession(async r=>{var a;const{data:n,error:l}=r;return l?{data:null,error:l}:await te(this.fetch,"DELETE",`${this.url}/factors/${s.factorId}`,{headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(Y(r))return{data:null,error:r};throw r}}async _enroll(s){try{return await this._useSession(async r=>{var a,n;const{data:l,error:i}=r;if(i)return{data:null,error:i};const d=Object.assign({friendly_name:s.friendlyName,factor_type:s.factorType},s.factorType==="phone"?{phone:s.phone}:{issuer:s.issuer}),{data:o,error:u}=await te(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(a=l==null?void 0:l.session)===null||a===void 0?void 0:a.access_token});return u?{data:null,error:u}:(s.factorType==="totp"&&(!((n=o==null?void 0:o.totp)===null||n===void 0)&&n.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(r){if(Y(r))return{data:null,error:r};throw r}}async _verify(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:l}=r;if(l)return{data:null,error:l};const{data:i,error:d}=await te(this.fetch,"POST",`${this.url}/factors/${s.factorId}/verify`,{body:{code:s.code,challenge_id:s.challengeId},headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:d})})}catch(r){if(Y(r))return{data:null,error:r};throw r}})}async _challenge(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:l}=r;return l?{data:null,error:l}:await te(this.fetch,"POST",`${this.url}/factors/${s.factorId}/challenge`,{body:{channel:s.channel},headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(Y(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(s){const{data:r,error:a}=await this._challenge({factorId:s.factorId});return a?{data:null,error:a}:await this._verify({factorId:s.factorId,challengeId:r.id,code:s.code})}async _listFactors(){const{data:{user:s},error:r}=await this.getUser();if(r)return{data:null,error:r};const a=(s==null?void 0:s.factors)||[],n=a.filter(i=>i.factor_type==="totp"&&i.status==="verified"),l=a.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:a,totp:n,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async s=>{var r,a;const{data:{session:n},error:l}=s;if(l)return{data:null,error:l};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=pi(n.access_token);let d=null;i.aal&&(d=i.aal);let o=d;((a=(r=n.user.factors)===null||r===void 0?void 0:r.filter(x=>x.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(o="aal2");const c=i.amr||[];return{data:{currentLevel:d,nextLevel:o,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(s,r={keys:[]}){let a=r.keys.find(d=>d.kid===s);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(d=>d.kid===s),a&&this.jwks_cached_at+Og>n)return a;const{data:l,error:i}=await te(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=n,a=l.keys.find(d=>d.kid===s),!a)?null:a}async getClaims(s,r={}){try{let a=s;if(!a){const{data:f,error:y}=await this.getSession();if(y||!f.session)return{data:null,error:y};a=f.session.access_token}const{header:n,payload:l,signature:i,raw:{header:d,payload:o}}=pi(a);r!=null&&r.allowExpired||iy(l.exp);const u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:f}=await this.getUser(a);if(f)throw f;return{data:{claims:l,header:n,signature:i},error:null}}const c=oy(n.alg),x=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,x,i,Jg(`${d}.${o}`)))throw new No("Invalid JWT signature");return{data:{claims:l,header:n,signature:i},error:null}}catch(a){if(Y(a))return{data:null,error:a};throw a}}}$a.nextInstanceID=0;const _y=$a;class ky extends _y{constructor(s){super(s)}}var Sy=function(t,s,r,a){function n(l){return l instanceof r?l:new r(function(i){i(l)})}return new(r||(r=Promise))(function(l,i){function d(c){try{u(a.next(c))}catch(x){i(x)}}function o(c){try{u(a.throw(c))}catch(x){i(x)}}function u(c){c.done?l(c.value):n(c.value).then(d,o)}u((a=a.apply(t,s||[])).next())})};class Cy{constructor(s,r,a){var n,l,i;this.supabaseUrl=s,this.supabaseKey=r;const d=Mg(s);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const o=`sb-${d.hostname.split(".")[0]}-auth-token`,u={db:wg,realtime:_g,auth:Object.assign(Object.assign({},Ng),{storageKey:o}),global:jg},c=Pg(a??{},u);this.storageKey=(n=c.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(l=c.global.headers)!==null&&l!==void 0?l:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(x,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=c.auth)!==null&&i!==void 0?i:{},this.headers,c.global.fetch),this.fetch=Eg(r,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new qf(new URL("rest/v1",d).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new yg(this.storageUrl.href,this.headers,this.fetch,a==null?void 0:a.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new vf(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(s){return this.rest.from(s)}schema(s){return this.rest.schema(s)}rpc(s,r={},a={}){return this.rest.rpc(s,r,a)}channel(s,r={config:{}}){return this.realtime.channel(s,r)}getChannels(){return this.realtime.getChannels()}removeChannel(s){return this.realtime.removeChannel(s)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var s,r;return Sy(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:a}=yield this.auth.getSession();return(r=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:s,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:l,storageKey:i,flowType:d,lock:o,debug:u},c,x){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ky({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),c),storageKey:i,autoRefreshToken:s,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:l,flowType:d,lock:o,debug:u,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(s){return new ng(this.realtimeUrl.href,Object.assign(Object.assign({},s),{params:Object.assign({apikey:this.supabaseKey},s==null?void 0:s.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(s,r,a){(s==="TOKEN_REFRESHED"||s==="SIGNED_IN")&&this.changedAccessToken!==a?this.changedAccessToken=a:s==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Ey=(t,s,r)=>new Cy(t,s,r);function Ty(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const s=t.match(/^v(\d+)\./);return s?parseInt(s[1],10)<=18:!1}Ty()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ay="https://vnyebfjpkgqurgqxoqyv.supabase.co",Py="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo",T=Ey(Ay,Py),Xh=p.createContext(void 0);function My({children:t}){const[s,r]=p.useState(null),[a,n]=p.useState(null),[l,i]=p.useState(!0);p.useEffect(()=>{T.auth.getSession().then(({data:{session:m}})=>{r((m==null?void 0:m.user)??null),m!=null&&m.user?d(m.user.id):i(!1)});const{data:{subscription:x}}=T.auth.onAuthStateChange((m,f)=>{r((f==null?void 0:f.user)??null),f!=null&&f.user?d(f.user.id):(n(null),i(!1))});return()=>x.unsubscribe()},[]);async function d(x){try{const{data:m,error:f}=await T.from("profiles").select("*").eq("id",x).maybeSingle();if(f)throw f;n(m)}catch(m){console.error("Error loading profile:",m)}finally{i(!1)}}async function o(x,m){const{error:f}=await T.auth.signInWithPassword({email:x,password:m});if(f)throw f}async function u(x,m,f,y){const{data:N,error:k}=await T.auth.signUp({email:x,password:m});if(k)throw k;if(N.user){const{error:b}=await T.from("profiles").insert({id:N.user.id,full_name:f,email:x,role:y});if(b)throw b}}async function c(){const{error:x}=await T.auth.signOut();if(x)throw x}return e.jsx(Xh.Provider,{value:{user:s,profile:a,loading:l,signIn:o,signUp:u,signOut:c},children:t})}function qt(){const t=p.useContext(Xh);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}let sa=!1,ra=!1;function er(){const[t,s]=p.useState(ra);return p.useEffect(()=>{var l;if((l=window.google)!=null&&l.maps||ra){s(!0),ra=!0;return}if(sa){const i=setInterval(()=>{var d;(d=window.google)!=null&&d.maps&&(s(!0),ra=!0,clearInterval(i))},100);return()=>clearInterval(i)}const r="AIzaSyAecouinWdvBWMAQq255ALN7nFEL7N14_k";sa=!0;const a=document.querySelector('script[src*="maps.googleapis.com"]');a&&a.remove();const n=document.createElement("script");n.src=`https://maps.googleapis.com/maps/api/js?key=${r}&libraries=places`,n.async=!0,n.defer=!0,n.onload=()=>{s(!0),ra=!0,sa=!1},n.onerror=()=>{console.error("Failed to load Google Maps script"),sa=!1},document.head.appendChild(n)},[]),{isLoaded:t,isLoading:sa}}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Dy={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iy=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),J=(t,s)=>{const r=p.forwardRef(({color:a="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:d="",children:o,...u},c)=>p.createElement("svg",{ref:c,...Dy,width:n,height:n,stroke:a,strokeWidth:i?Number(l)*24/Number(n):l,className:["lucide",`lucide-${Iy(t)}`,d].join(" "),...u},[...s.map(([x,m])=>p.createElement(x,m)),...Array.isArray(o)?o:[o]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ly=J("Accessibility",[["circle",{cx:"16",cy:"4",r:"1",key:"1grugj"}],["path",{d:"m18 19 1-7-6 1",key:"r0i19z"}],["path",{d:"m5 8 3-3 5.5 3-2.36 3.5",key:"9ptxx2"}],["path",{d:"M4.24 14.5a5 5 0 0 0 6.88 6",key:"10kmtu"}],["path",{d:"M13.76 17.5a5 5 0 0 0-6.88-6",key:"2qq6rc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=J("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=J("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ry=J("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oy=J("Anchor",[["path",{d:"M12 22V8",key:"qkxhtm"}],["path",{d:"M5 12H2a10 10 0 0 0 20 0h-3",key:"1hv3nh"}],["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=J("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=J("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ou=J("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ul=J("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zh=J("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ml=J("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=J("Cake",[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h0.01",key:"hsw7lv"}],["path",{d:"M12 4h0.01",key:"1e3d8f"}],["path",{d:"M17 4h0.01",key:"p7cxgy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=J("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=J("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=J("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=J("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tc=J("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=J("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=J("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yh=J("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=J("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $y=J("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ex=J("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fy=J("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=J("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=J("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=J("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=J("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uy=J("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tx=J("Fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2h0a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"8ur5zv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zy=J("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sx=J("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=J("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=J("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const By=J("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=J("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vy=J("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rx=J("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ax=J("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=J("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uu=J("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nx=J("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=J("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=J("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=J("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hy=J("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lx=J("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=J("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ix=J("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=J("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=J("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=J("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hl=J("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=J("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=J("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jy=J("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=J("PlusSquare",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=J("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gy=J("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cx=J("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=J("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ky=J("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ac=J("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pc=J("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=J("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=J("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mc=J("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=J("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xy=J("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=J("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dc=J("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=J("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zy=J("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=J("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=J("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yy=J("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=J("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=J("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=J("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eb=J("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tb=J("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=J("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=J("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=J("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=J("Voicemail",[["circle",{cx:"6",cy:"12",r:"4",key:"1ehtga"}],["circle",{cx:"18",cy:"12",r:"4",key:"4vafl8"}],["line",{x1:"6",x2:"18",y1:"16",y2:"16",key:"pmt8us"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ux=J("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rb=J("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=J("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=J("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=J("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mx=J("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function nb(){const[t,s]=p.useState(!1),[r,a]=p.useState(""),[n,l]=p.useState(""),[i,d]=p.useState(""),[o,u]=p.useState("driver"),[c,x]=p.useState(""),[m,f]=p.useState(!1),{signIn:y,signUp:N}=qt();async function k(b){b.preventDefault(),x(""),f(!0);try{t?await N(r,n,i,o):await y(r,n)}catch(v){x(v instanceof Error?v.message:"An error occurred")}finally{f(!1)}}return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-cyan-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-full mb-4",children:t?e.jsx(eb,{className:"w-8 h-8 text-white"}):e.jsx(nx,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Helping Hands Transportation"}),e.jsx("p",{className:"text-gray-600",children:t?"Create your account":"Sign in to your account"})]}),e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),e.jsx("input",{type:"text",value:i,onChange:b=>d(b.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsxs("select",{value:o,onChange:b=>u(b.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"driver",children:"Driver"}),e.jsx("option",{value:"dispatcher",children:"Dispatcher"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:r,onChange:b=>a(b.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsx("input",{type:"password",value:n,onChange:b=>l(b.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),c&&e.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-3 rounded-lg text-sm",children:c}),e.jsx("button",{type:"submit",disabled:m,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Please wait...":t?"Create Account":"Sign In"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>{s(!t),x("")},className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:t?"Already have an account? Sign in":"Don't have an account? Sign up"})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Are you a member?"}),e.jsx("a",{href:"/member-portal",onClick:b=>{b.preventDefault(),window.history.pushState({},"","/member-portal"),window.dispatchEvent(new PopStateEvent("popstate"))},className:"inline-block text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Track Your Rides"})]})})]})})})}function lb({onClose:t}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Dc,{className:"w-6 h-6 text-blue-600"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Install Mobile Apps"})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Why Install?"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"Works like a native app"}),e.jsx("li",{children:"Quick access from home screen"}),e.jsx("li",{children:"Full screen experience"}),e.jsx("li",{children:"Works offline for basic features"})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"Two Apps Available"}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Driver App:"})," For drivers to view trips, update status, and communicate"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Dispatcher App:"})," For dispatchers to manage trips and assign drivers on the go"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-900 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xl",children:""})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"iPhone / iPad (iOS)"})]}),e.jsxs("div",{className:"space-y-4 ml-12",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center flex-shrink-0 font-semibold",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Open Safari Browser"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Make sure you're using Safari (not Chrome or other browsers)"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center flex-shrink-0 font-semibold",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Visit the App Page"}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1 space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Driver App:"})," ",e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:"[your-url]/driver-mobile"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Dispatcher App:"})," ",e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:"[your-url]/dispatcher-mobile"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:'Login first, then click "Mobile Mode" button to access the mobile app'})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center flex-shrink-0 font-semibold",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Tap Share Button"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(Xy,{className:"w-5 h-5 text-blue-600"})}),e.jsx("p",{className:"text-sm text-gray-600",children:"(Located at the bottom of Safari)"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center flex-shrink-0 font-semibold",children:"4"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Add to Home Screen"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(Qy,{className:"w-5 h-5 text-blue-600"})}),e.jsx("p",{className:"text-sm text-gray-600",children:'Scroll down and select "Add to Home Screen"'})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center flex-shrink-0 font-semibold",children:"5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Confirm Installation"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:'Tap "Add" in the top right corner'})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(ko,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900",children:"Done!"}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"The app icon will appear on your home screen"})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xl",children:""})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Android"})]}),e.jsxs("div",{className:"space-y-4 ml-12",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center flex-shrink-0 font-semibold",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Open Chrome Browser"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Chrome works best for Android installation"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center flex-shrink-0 font-semibold",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Visit Driver Login Page"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Navigate to: ",e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:"[your-url]/driver-login"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center flex-shrink-0 font-semibold",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Tap Menu Button"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("div",{className:"bg-green-100 p-2 rounded-lg",children:e.jsx(ix,{className:"w-5 h-5 text-green-600"})}),e.jsx("p",{className:"text-sm text-gray-600",children:"(Three dots in top right corner)"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center flex-shrink-0 font-semibold",children:"4"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Install App"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:'Select "Add to Home screen" or "Install app"'})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center flex-shrink-0 font-semibold",children:"5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Confirm Installation"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:'Tap "Install" or "Add" to confirm'})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-700 text-white rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(ko,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900",children:"Done!"}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"The app icon will appear on your home screen"})]})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Need Help?"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Contact your dispatcher if you have trouble installing the app or need your login credentials."})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 p-6",children:e.jsx("button",{onClick:t,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors",children:"Got It!"})})]})})}function ib(){const[t,s]=p.useState(""),[r,a]=p.useState(""),[n,l]=p.useState(""),[i,d]=p.useState(!1),[o,u]=p.useState(!1),{signIn:c}=qt(),x=async m=>{m.preventDefault(),l(""),d(!0);try{await c(t,r),"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(async f=>{try{await fetch("https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/update-driver-location",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"},body:JSON.stringify({latitude:f.coords.latitude,longitude:f.coords.longitude,accuracy:f.coords.accuracy,speed:f.coords.speed,heading:f.coords.heading})})}catch(y){console.error("Failed to update location:",y)}},f=>{console.error("Location permission denied:",f)})}catch{l("Invalid email or password")}finally{d(!1)}};return e.jsxs(e.Fragment,{children:[o&&e.jsx(lb,{onClose:()=>u(!1)}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"w-20 h-20 bg-blue-600 rounded-full flex items-center justify-center mb-4",children:e.jsx(Dc,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 text-center",children:"Driver Login"}),e.jsx("p",{className:"text-gray-600 text-center mt-2",children:"HealthHub NEMT"})]}),e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[n&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:n}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsx("input",{id:"email",type:"email",value:t,onChange:m=>s(m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg",placeholder:"driver@example.com",required:!0,autoComplete:"email"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsx("input",{id:"password",type:"password",value:r,onChange:m=>a(m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg",placeholder:"",required:!0,autoComplete:"current-password"})]}),e.jsx("button",{type:"submit",disabled:i,className:"w-full bg-blue-600 text-white py-4 rounded-lg font-semibold text-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:i?e.jsx("span",{children:"Signing In..."}):e.jsxs(e.Fragment,{children:[e.jsx(nx,{className:"w-5 h-5"}),e.jsx("span",{children:"Sign In"})]})})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:e.jsxs("button",{type:"button",onClick:()=>u(!0),className:"w-full text-blue-600 hover:text-blue-700 font-medium flex items-center justify-center gap-2",children:[e.jsx(Ua,{className:"w-5 h-5"}),e.jsx("span",{children:"Installation Instructions"})]})}),e.jsxs("div",{className:"mt-4 text-center space-y-2",children:[e.jsx("a",{href:"/",className:"block text-sm text-gray-600 hover:text-gray-900",children:"Dispatcher Login"}),e.jsx("a",{href:"/member-portal",onClick:m=>{m.preventDefault(),window.history.pushState({},"","/member-portal"),window.dispatchEvent(new PopStateEvent("popstate"))},className:"block text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Member Portal"})]})]}),e.jsx("div",{className:"mt-6 text-center text-white text-sm",children:e.jsx("p",{children:"Need help? Contact your dispatcher"})})]})})]})}function ob({currentView:t,onNavigate:s}){const{profile:r,signOut:a}=qt(),n=(r==null?void 0:r.role)==="dispatcher"||(r==null?void 0:r.role)==="admin",l=(r==null?void 0:r.role)==="driver";return e.jsx("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"px-2 md:px-4",children:e.jsxs("div",{className:"flex items-center justify-between h-12 md:h-16",children:[e.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 flex-shrink-0",children:[e.jsx(Fe,{className:"w-6 h-6 md:w-8 md:h-8 text-blue-600"}),e.jsx("span",{className:"text-base md:text-xl font-bold text-gray-900",children:"HH Transportation"})]}),e.jsx("div",{className:"flex-1 overflow-x-auto mx-2 md:mx-4 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:e.jsxs("div",{className:"flex gap-0.5 md:gap-1 min-w-max pb-1",children:[n&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>s("dispatch"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="dispatch"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(rx,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Dispatch"]}),e.jsxs("button",{onClick:()=>s("billing"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="billing"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(Ft,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Billing"]}),e.jsxs("button",{onClick:()=>s("payments"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="payments"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(ex,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Payment Accounts"]}),e.jsxs("button",{onClick:()=>s("payroll"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="payroll"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(rb,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Payroll"]}),e.jsxs("button",{onClick:()=>s("receptionist"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="receptionist"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(Zh,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"AI Receptionist"]}),e.jsxs("button",{onClick:()=>s("patients"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="patients"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(Ze,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Members"]}),e.jsxs("button",{onClick:()=>s("portals"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="portals"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(ml,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Portals"]}),e.jsxs("button",{onClick:()=>s("tracking"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="tracking"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(ae,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Tracking"]}),e.jsxs("button",{onClick:()=>s("scheduler"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="scheduler"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(ge,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Scheduler"]}),e.jsxs("button",{onClick:()=>s("rates"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="rates"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(Ky,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Rates"]}),e.jsxs("button",{onClick:()=>s("manual"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="manual"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(ul,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Manual"]}),e.jsxs("button",{onClick:()=>s("raven"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="raven"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(Fa,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Raven"]}),e.jsxs("button",{onClick:()=>s("sms-logs"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="sms-logs"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(Fr,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"SMS Logs"]})]}),l&&e.jsxs("button",{onClick:()=>s("driver"),className:`px-2 py-1.5 md:px-4 md:py-2 rounded-lg text-sm md:text-base font-medium transition-colors flex items-center gap-1 md:gap-2 ${t==="driver"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(Fe,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"My Trips"]})]})}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-4 flex-shrink-0",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-900",children:r==null?void 0:r.full_name}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:r==null?void 0:r.role})]}),e.jsx("button",{onClick:()=>a(),className:"p-1.5 md:p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Sign Out",children:e.jsx(Ol,{className:"w-4 h-4 md:w-5 md:h-5"})})]})]})})})}function Ya({trip:t,onClose:s,onSave:r}){const[a,n]=p.useState([]),[l,i]=p.useState([]),[d,o]=p.useState([]),[u,c]=p.useState([]),[x,m]=p.useState([]),[f,y]=p.useState([]),[N,k]=p.useState(!1),[b,v]=p.useState(""),[h,g]=p.useState(null),[w,S]=p.useState(!1),[j,_]=p.useState({full_name:"",phone:"",email:"",date_of_birth:"",gender:"",address:"",apt_suite_room:"",city:"",state:"",zip_code:"",medical_id:"",mobility_needs:"",weight:"",stairs_steps:"",covid_status:"negative",member_type:"regular",funding_source:"",space_type:"",preferred_driver:"",sms_required:!1,not_carpool:!1,private_note:"",note:""}),[M,R]=p.useState(!1),{isLoaded:O}=er(),I=p.useRef(null),A=p.useRef(null),F=p.useRef(null),Q=p.useRef(null),[E,q]=p.useState({patient_id:(t==null?void 0:t.patient_id)||"",driver_id:(t==null?void 0:t.driver_id)||"",vehicle_id:(t==null?void 0:t.vehicle_id)||"",display_name:"",contact_number:"",phone_number:"",weight:"",email:"",date_of_birth:"",gender:"",client_id:"",authorization_number:"",ipa_feca_number:"",insurance_id:(t==null?void 0:t.insurance_id)||"",primary_diagnosis:(t==null?void 0:t.primary_diagnosis)||"",trip_id:"",funding_source:(t==null?void 0:t.funding_source)||"",space_type:(t==null?void 0:t.space_type)||"",pickup_address:(t==null?void 0:t.pickup_address)||"",pickup_time:t!=null&&t.scheduled_pickup_time?new Date(t.scheduled_pickup_time).toISOString().slice(0,16):"",pickup_floor:"",pickup_room:"",pickup_facility_name:"",pickup_phone:"",service_area:(t==null?void 0:t.service_area)||"",dropoff_address:(t==null?void 0:t.dropoff_address)||"",dropoff_floor:"",dropoff_room:"",dropoff_facility_name:"",dropoff_phone:"",status:(t==null?void 0:t.status)||"scheduled",trip_type:(t==null?void 0:t.trip_type)||"round_trip",notes:(t==null?void 0:t.notes)||""});p.useEffect(()=>{C()},[]),p.useEffect(()=>{t!=null&&t.patient_id&&U(t.patient_id)},[t]),p.useEffect(()=>{O&&V()},[O]);async function C(){try{const[L,K,X,ie,Ee,qe]=await Promise.all([T.from("patients").select("*").order("full_name"),T.from("profiles").select("*").eq("role","driver"),T.from("vehicles").select("*").eq("status","available"),T.from("funding_sources").select("*").eq("status","active").order("name"),T.from("space_types").select("*").eq("status","active").order("name"),T.from("service_areas").select("*").eq("status","active").order("name")]);L.data&&n(L.data),K.data&&i(K.data),X.data&&o(X.data),ie.data&&c(ie.data),Ee.data&&m(Ee.data),qe.data&&y(qe.data)}catch(L){console.error("Error loading data:",L)}}async function U(L){try{const{data:K,error:X}=await T.from("patients").select("*").eq("id",L).maybeSingle();if(X)throw X;K&&(g(K),q(ie=>({...ie,patient_id:K.id,display_name:K.full_name||"",phone_number:K.phone||"",email:K.email||"",date_of_birth:K.date_of_birth||"",client_id:K.medical_id||""})))}catch(K){console.error("Error loading patient:",K)}}async function P(){if(!j.full_name||!j.phone){alert("Please enter at least name and phone number");return}R(!0);try{const L=[j.address,j.apt_suite_room,j.city,j.state,j.zip_code].filter(Boolean).join(", "),{data:K,error:X}=await T.from("patients").insert({full_name:j.full_name,phone:j.phone,email:j.email||null,date_of_birth:j.date_of_birth||null,gender:j.gender||null,address:L||null,medical_id:j.medical_id||null,mobility_needs:j.mobility_needs||null,status:"active"}).select().single();if(X)throw X;await C(),K&&(await U(K.id),v("")),S(!1),_({full_name:"",phone:"",email:"",date_of_birth:"",gender:"",address:"",apt_suite_room:"",city:"",state:"",zip_code:"",medical_id:"",mobility_needs:"",weight:"",stairs_steps:"",covid_status:"negative",member_type:"regular",funding_source:"",space_type:"",preferred_driver:"",sms_required:!1,not_carpool:!1,private_note:"",note:""})}catch(L){console.error("Error creating patient:",L),alert("Error creating patient")}finally{R(!1)}}function V(){var L,K;(K=(L=window.google)==null?void 0:L.maps)!=null&&K.places&&(F.current&&!I.current&&(I.current=new google.maps.places.Autocomplete(F.current,{types:["address"]}),I.current.addListener("place_changed",()=>{var ie;const X=(ie=I.current)==null?void 0:ie.getPlace();X!=null&&X.formatted_address&&q(Ee=>({...Ee,pickup_address:X.formatted_address||""}))})),Q.current&&!A.current&&(A.current=new google.maps.places.Autocomplete(Q.current,{types:["address"]}),A.current.addListener("place_changed",()=>{var ie;const X=(ie=A.current)==null?void 0:ie.getPlace();X!=null&&X.formatted_address&&q(Ee=>({...Ee,dropoff_address:X.formatted_address||""}))})))}function D(L){const K=a.find(X=>X.id===L);K&&(g(K),q(X=>({...X,patient_id:K.id,display_name:K.full_name||"",phone_number:K.phone||"",email:K.email||"",date_of_birth:K.date_of_birth||"",client_id:K.medical_id||""})))}function B(){alert("Calculate miles feature coming soon")}async function $(L){L.preventDefault(),k(!0);try{const K={patient_id:E.patient_id,driver_id:E.driver_id||null,vehicle_id:E.vehicle_id||null,pickup_address:E.pickup_address,dropoff_address:E.dropoff_address,scheduled_pickup_time:E.pickup_time,funding_source:E.funding_source,space_type:E.space_type,service_area:E.service_area,status:E.status,trip_type:E.trip_type,notes:E.notes,insurance_id:E.insurance_id,primary_diagnosis:E.primary_diagnosis,ipa_feca_number:E.ipa_feca_number,updated_at:new Date().toISOString()};if(t){const{error:X}=await T.from("trips").update(K).eq("id",t.id);if(X)throw X}else{const{error:X}=await T.from("trips").insert(K);if(X)throw X}r&&r(),s()}catch(K){console.error("Error saving trip:",K),alert("Error saving trip")}finally{k(!1)}}const W=b?a.filter(L=>{var K,X;return((K=L.full_name)==null?void 0:K.toLowerCase().includes(b.toLowerCase()))||((X=L.phone)==null?void 0:X.includes(b))}):a;return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-5xl w-full max-h-[95vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t?"Edit Trip":"Add"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:$,className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Member"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search Member",value:b,onChange:L=>v(L.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),e.jsx("button",{type:"button",onClick:()=>S(!0),className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",title:"Add new member",children:e.jsx(re,{className:"w-4 h-4"})})]}),b&&e.jsx("div",{className:"mt-2 border border-gray-300 rounded-md max-h-40 overflow-y-auto bg-white shadow-lg",children:W.map(L=>e.jsxs("button",{type:"button",onClick:()=>{D(L.id),v("")},className:"w-full text-left px-3 py-2 hover:bg-gray-100 text-sm",children:[L.full_name," - ",L.phone]},L.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Funding Source"}),e.jsxs("select",{value:E.funding_source,onChange:L=>q({...E,funding_source:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"-- Select Funding Source --"}),u.map(L=>e.jsx("option",{value:L.code,children:L.name},L.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Space Type"}),e.jsxs("select",{value:E.space_type,onChange:L=>q({...E,space_type:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"-- Select Space Type --"}),x.map(L=>e.jsx("option",{value:L.level_of_service,children:L.name},L.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Name"}),e.jsx("input",{type:"text",value:E.display_name,onChange:L=>q({...E,display_name:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Number"}),e.jsx("input",{type:"tel",value:E.contact_number,onChange:L=>q({...E,contact_number:L.target.value}),placeholder:"0000000000",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:E.phone_number,onChange:L=>q({...E,phone_number:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Weight"}),e.jsx("input",{type:"text",value:E.weight,onChange:L=>q({...E,weight:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:E.email,onChange:L=>q({...E,email:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),e.jsx("input",{type:"date",value:E.date_of_birth,onChange:L=>q({...E,date_of_birth:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender"}),e.jsxs("select",{value:E.gender,onChange:L=>q({...E,gender:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"-- Select Gender --"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client ID / Member ID / MA# / AHCCCS#"}),e.jsx("input",{type:"text",value:E.client_id,onChange:L=>q({...E,client_id:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Authorization Number"}),e.jsx("input",{type:"text",value:E.authorization_number,onChange:L=>q({...E,authorization_number:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IPA / FECA Number"}),e.jsx("input",{type:"text",value:E.ipa_feca_number,onChange:L=>q({...E,ipa_feca_number:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Insurance ID"}),e.jsx("input",{type:"text",value:E.insurance_id,onChange:L=>q({...E,insurance_id:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Diagnosis"}),e.jsx("input",{type:"text",value:E.primary_diagnosis,onChange:L=>q({...E,primary_diagnosis:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trip ID"}),e.jsx("input",{type:"text",value:E.trip_id,onChange:L=>q({...E,trip_id:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:B,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm font-medium",children:"Get Miles"})}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Pickup"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"datetime-local",value:E.pickup_time,onChange:L=>q({...E,pickup_time:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",required:!0}),e.jsx(ge,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Area"}),e.jsxs("select",{value:E.service_area,onChange:L=>q({...E,service_area:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"-- Select Service Area --"}),f.map(L=>e.jsx("option",{value:L.name,children:L.name},L.id))]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:F,type:"text",value:E.pickup_address,onChange:L=>q({...E,pickup_address:L.target.value}),placeholder:"14852 tierra f",className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",required:!0}),e.jsx(ae,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Floor"}),e.jsx("input",{type:"text",value:E.pickup_floor,onChange:L=>q({...E,pickup_floor:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Room"}),e.jsx("input",{type:"text",value:E.pickup_room,onChange:L=>q({...E,pickup_room:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Home/Facility Name"}),e.jsx("input",{type:"text",value:E.pickup_facility_name,onChange:L=>q({...E,pickup_facility_name:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:E.pickup_phone,onChange:L=>q({...E,pickup_phone:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Dropoff"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:Q,type:"text",value:E.dropoff_address,onChange:L=>q({...E,dropoff_address:L.target.value}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",required:!0}),e.jsx(ae,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Floor"}),e.jsx("input",{type:"text",value:E.dropoff_floor,onChange:L=>q({...E,dropoff_floor:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Room"}),e.jsx("input",{type:"text",value:E.dropoff_room,onChange:L=>q({...E,dropoff_room:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Home/Facility Name"}),e.jsx("input",{type:"text",value:E.dropoff_facility_name,onChange:L=>q({...E,dropoff_facility_name:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:E.dropoff_phone,onChange:L=>q({...E,dropoff_phone:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 px-6 py-4 flex justify-end gap-3 bg-gray-50",children:[e.jsx("button",{type:"button",onClick:s,className:"px-6 py-2 border border-gray-300 rounded-md font-medium text-gray-700 hover:bg-gray-100 transition-colors text-sm",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:N,className:"px-6 py-2 bg-blue-600 text-white rounded-md font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 text-sm",children:[e.jsx(sr,{className:"w-4 h-4"}),N?"Saving...":"Save Trip"]})]})]})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-blue-600 text-white px-6 py-4 flex items-center justify-between flex-shrink-0",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Add Member"}),e.jsx("button",{onClick:()=>S(!1),className:"text-white hover:text-gray-200 transition-colors",children:e.jsx(le,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:j.full_name,onChange:L=>_({...j,full_name:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Enter full name",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Contact Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",value:j.phone,onChange:L=>_({...j,phone:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Enter contact number",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:j.email,onChange:L=>_({...j,email:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Enter email"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),e.jsx("input",{type:"date",value:j.date_of_birth,onChange:L=>_({...j,date_of_birth:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender"}),e.jsxs("select",{value:j.gender,onChange:L=>_({...j,gender:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"-- Select Gender --"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Medical ID"}),e.jsx("input",{type:"text",value:j.medical_id,onChange:L=>_({...j,medical_id:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Enter medical ID"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx("input",{type:"text",value:j.address,onChange:L=>_({...j,address:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Enter a location"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"APT/SUITE/ROOM"}),e.jsx("input",{type:"text",value:j.apt_suite_room,onChange:L=>_({...j,apt_suite_room:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),e.jsx("input",{type:"text",value:j.city,onChange:L=>_({...j,city:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State"}),e.jsx("input",{type:"text",value:j.state,onChange:L=>_({...j,state:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Zip Code"}),e.jsx("input",{type:"text",value:j.zip_code,onChange:L=>_({...j,zip_code:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Funding Source"}),e.jsxs("select",{value:j.funding_source,onChange:L=>_({...j,funding_source:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"-- Select Funding Source --"}),u.map(L=>e.jsx("option",{value:L.code,children:L.name},L.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Member Type"}),e.jsxs("select",{value:j.member_type,onChange:L=>_({...j,member_type:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"regular",children:"Regular"}),e.jsx("option",{value:"vip",children:"VIP"}),e.jsx("option",{value:"special_needs",children:"Special Needs"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Space Type"}),e.jsxs("select",{value:j.space_type,onChange:L=>_({...j,space_type:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"-- Select Space Type --"}),x.map(L=>e.jsx("option",{value:L.level_of_service,children:L.name},L.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Weight"}),e.jsx("input",{type:"text",value:j.weight,onChange:L=>_({...j,weight:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Enter weight"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stairs step/s"}),e.jsx("input",{type:"text",value:j.stairs_steps,onChange:L=>_({...j,stairs_steps:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Covid Status"}),e.jsxs("select",{value:j.covid_status,onChange:L=>_({...j,covid_status:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"negative",children:"Negative"}),e.jsx("option",{value:"positive",children:"Positive"}),e.jsx("option",{value:"recovered",children:"Recovered"}),e.jsx("option",{value:"vaccinated",children:"Vaccinated"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mobility Needs"}),e.jsxs("select",{value:j.mobility_needs,onChange:L=>_({...j,mobility_needs:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"-- Select Mobility --"}),e.jsx("option",{value:"ambulatory",children:"Ambulatory"}),e.jsx("option",{value:"wheelchair",children:"Wheelchair"}),e.jsx("option",{value:"stretcher",children:"Stretcher"}),e.jsx("option",{value:"walker",children:"Walker"}),e.jsx("option",{value:"cane",children:"Cane"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Driver"}),e.jsxs("select",{value:j.preferred_driver,onChange:L=>_({...j,preferred_driver:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"-- Select Preferred Driver --"}),l.map(L=>e.jsx("option",{value:L.id,children:L.full_name},L.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SMS Required"}),e.jsxs("select",{value:j.sms_required?"yes":"no",onChange:L=>_({...j,sms_required:L.target.value==="yes"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"no",children:"No"}),e.jsx("option",{value:"yes",children:"Yes"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Private Note"}),e.jsx("textarea",{value:j.private_note,onChange:L=>_({...j,private_note:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note"}),e.jsx("textarea",{value:j.note,onChange:L=>_({...j,note:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",rows:3})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"not_carpool",checked:j.not_carpool,onChange:L=>_({...j,not_carpool:L.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"not_carpool",className:"text-sm font-medium text-gray-700",children:"Not Carpool"})]})]})}),e.jsxs("div",{className:"border-t border-gray-200 px-6 py-4 flex justify-end gap-3 bg-gray-50 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>S(!1),className:"px-6 py-2 border border-gray-300 rounded-md font-medium text-gray-700 hover:bg-gray-100 transition-colors text-sm",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:P,disabled:M,className:"px-6 py-2 bg-blue-600 text-white rounded-md font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 text-sm",children:[e.jsx(re,{className:"w-4 h-4"}),M?"Creating...":"Create Member"]})]})]})})]})}function cb(){const[t,s]=p.useState("maintenance"),[r,a]=p.useState([]),[n,l]=p.useState([]),[i,d]=p.useState([]),[o,u]=p.useState([]),[c,x]=p.useState("all"),[m,f]=p.useState(!1),[y,N]=p.useState(!0);p.useEffect(()=>{k()},[]);const k=async()=>{N(!0),await Promise.all([b(),v(),h(),g()]),N(!1)},b=async()=>{const{data:I,error:A}=await T.from("vehicles").select("*").order("vehicle_number");!A&&I&&a(I)},v=async()=>{const{data:I,error:A}=await T.from("vehicle_maintenance").select("*, vehicle:vehicles(*)").order("service_date",{ascending:!1});!A&&I&&l(I)},h=async()=>{const{data:I,error:A}=await T.from("vehicle_expenses").select("*, vehicle:vehicles(*)").order("expense_date",{ascending:!1});!A&&I&&d(I)},g=async()=>{const{data:I,error:A}=await T.from("fuel_records").select("*, vehicle:vehicles(*)").order("fuel_date",{ascending:!1});!A&&I&&u(I)},w=c==="all"?n:n.filter(I=>I.vehicle_id===c),S=c==="all"?i:i.filter(I=>I.vehicle_id===c),j=c==="all"?o:o.filter(I=>I.vehicle_id===c),_=w.reduce((I,A)=>I+Number(A.cost),0),M=S.reduce((I,A)=>I+Number(A.amount),0),R=j.reduce((I,A)=>I+Number(A.total_cost),0),O=j.reduce((I,A)=>I+Number(A.gallons),0);return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Fleet Maintenance"}),e.jsxs("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Add Record"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("select",{value:c,onChange:I=>x(I.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Vehicles"}),r.map(I=>e.jsxs("option",{value:I.id,children:[I.vehicle_number," - ",I.make," ",I.model," (",I.license_plate,")"]},I.id))]})}),e.jsxs("div",{className:"flex gap-2 bg-gray-100 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>s("maintenance"),className:`px-4 py-2 rounded-md font-medium transition-colors ${t==="maintenance"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Maintenance"}),e.jsx("button",{onClick:()=>s("expenses"),className:`px-4 py-2 rounded-md font-medium transition-colors ${t==="expenses"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Expenses"}),e.jsx("button",{onClick:()=>s("fuel"),className:`px-4 py-2 rounded-md font-medium transition-colors ${t==="fuel"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Fuel"}),e.jsx("button",{onClick:()=>s("statistics"),className:`px-4 py-2 rounded-md font-medium transition-colors ${t==="statistics"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Statistics"})]})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Fe,{className:"w-6 h-6 text-blue-600"})})}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Maintenance"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",_.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[w.length," records"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Ft,{className:"w-6 h-6 text-green-600"})})}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Expenses"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",M.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[S.length," records"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(tx,{className:"w-6 h-6 text-orange-600"})})}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Fuel Cost"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",R.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[O.toFixed(1)," gallons"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(qa,{className:"w-6 h-6 text-purple-600"})})}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Costs"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",(_+M+R).toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"All categories"})]})]}),t==="statistics"?e.jsx(xb,{vehicles:r,maintenanceRecords:n,expenseRecords:i,fuelRecords:o}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[t==="maintenance"&&e.jsx(db,{records:w,onRefresh:v}),t==="expenses"&&e.jsx(ub,{records:S,onRefresh:h}),t==="fuel"&&e.jsx(mb,{records:j,onRefresh:g})]})]}),m&&e.jsx(hb,{type:t,vehicles:r,onClose:()=>f(!1),onSuccess:()=>{f(!1),k()}})]})}function db({records:t,onRefresh:s}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vehicle"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Odometer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[t.map(r=>{var a;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(r.service_date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(a=r.vehicle)==null?void 0:a.vehicle_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:r.maintenance_type})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:r.description}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.vendor_name}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[r.odometer_reading.toLocaleString()," mi"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["$",r.cost.toFixed(2)]})]},r.id)}),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No maintenance records found"})})]})]})})}function ub({records:t,onRefresh:s}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vehicle"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[t.map(r=>{var a;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(r.expense_date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(a=r.vehicle)==null?void 0:a.vehicle_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:r.expense_type})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:r.description}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.vendor_name||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["$",r.amount.toFixed(2)]})]},r.id)}),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"No expense records found"})})]})]})})}function mb({records:t,onRefresh:s}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vehicle"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gallons"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price/Gal"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Odometer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Cost"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[t.map(r=>{var a;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(r.fuel_date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(a=r.vehicle)==null?void 0:a.vehicle_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-orange-100 text-orange-800 rounded-full capitalize",children:r.fuel_type})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.gallons.toFixed(2)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",r.cost_per_gallon.toFixed(3)]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[r.odometer_reading.toLocaleString()," mi"]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:r.location||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["$",r.total_cost.toFixed(2)]})]},r.id)}),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:"No fuel records found"})})]})]})})}function hb({type:t,vehicles:s,onClose:r,onSuccess:a}){var u;const[n,l]=p.useState({vehicle_id:((u=s[0])==null?void 0:u.id)||"",date:new Date().toISOString().split("T")[0]}),[i,d]=p.useState(!1),o=async c=>{c.preventDefault(),d(!0);try{const{data:{user:x}}=await T.auth.getUser();if(!x)return;t==="maintenance"?await T.from("vehicle_maintenance").insert({...n,service_date:n.date,created_by:x.id}):t==="expenses"?await T.from("vehicle_expenses").insert({...n,expense_date:n.date,created_by:x.id}):await T.from("fuel_records").insert({...n,fuel_date:n.date,total_cost:Number(n.gallons)*Number(n.cost_per_gallon),created_by:x.id}),a()}catch(x){console.error("Error adding record:",x)}finally{d(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Add ",t==="maintenance"?"Maintenance":t==="expenses"?"Expense":"Fuel"," Record"]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vehicle"}),e.jsx("select",{value:n.vehicle_id,onChange:c=>l({...n,vehicle_id:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:s.map(c=>e.jsxs("option",{value:c.id,children:[c.vehicle_number," - ",c.make," ",c.model]},c.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:n.date,onChange:c=>l({...n,date:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),t==="maintenance"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Maintenance Type"}),e.jsxs("select",{value:n.maintenance_type||"",onChange:c=>l({...n,maintenance_type:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"oil_change",children:"Oil Change"}),e.jsx("option",{value:"tire_rotation",children:"Tire Rotation"}),e.jsx("option",{value:"brake_service",children:"Brake Service"}),e.jsx("option",{value:"inspection",children:"Inspection"}),e.jsx("option",{value:"transmission",children:"Transmission Service"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:n.description||"",onChange:c=>l({...n,description:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:2,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Odometer Reading"}),e.jsx("input",{type:"number",value:n.odometer_reading||"",onChange:c=>l({...n,odometer_reading:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost"}),e.jsx("input",{type:"number",step:"0.01",value:n.cost||"",onChange:c=>l({...n,cost:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor Name"}),e.jsx("input",{type:"text",value:n.vendor_name||"",onChange:c=>l({...n,vendor_name:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Number (Optional)"}),e.jsx("input",{type:"text",value:n.invoice_number||"",onChange:c=>l({...n,invoice_number:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),t==="expenses"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expense Type"}),e.jsxs("select",{value:n.expense_type||"",onChange:c=>l({...n,expense_type:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"insurance",children:"Insurance"}),e.jsx("option",{value:"registration",children:"Registration"}),e.jsx("option",{value:"parking",children:"Parking"}),e.jsx("option",{value:"tolls",children:"Tolls"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:n.description||"",onChange:c=>l({...n,description:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:2,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),e.jsx("input",{type:"number",step:"0.01",value:n.amount||"",onChange:c=>l({...n,amount:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor Name (Optional)"}),e.jsx("input",{type:"text",value:n.vendor_name||"",onChange:c=>l({...n,vendor_name:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),t==="fuel"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fuel Type"}),e.jsxs("select",{value:n.fuel_type||"regular",onChange:c=>l({...n,fuel_type:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"regular",children:"Regular"}),e.jsx("option",{value:"premium",children:"Premium"}),e.jsx("option",{value:"diesel",children:"Diesel"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gallons"}),e.jsx("input",{type:"number",step:"0.01",value:n.gallons||"",onChange:c=>l({...n,gallons:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost per Gallon"}),e.jsx("input",{type:"number",step:"0.001",value:n.cost_per_gallon||"",onChange:c=>l({...n,cost_per_gallon:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Odometer Reading"}),e.jsx("input",{type:"number",value:n.odometer_reading||"",onChange:c=>l({...n,odometer_reading:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location (Optional)"}),e.jsx("input",{type:"text",value:n.location||"",onChange:c=>l({...n,location:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Gas station name or address"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),e.jsx("textarea",{value:n.notes||"",onChange:c=>l({...n,notes:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:i,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:i?"Adding...":"Add Record"})]})]})]})})}function xb({vehicles:t,maintenanceRecords:s,expenseRecords:r,fuelRecords:a}){const[n,l]=p.useState([]);p.useEffect(()=>{i()},[]);const i=async()=>{const{data:m,error:f}=await T.from("profiles").select("id, full_name, email").eq("role","driver");!f&&m&&l(m)},d=t.map(m=>{const f=s.filter(_=>_.vehicle_id===m.id),y=r.filter(_=>_.vehicle_id===m.id),N=a.filter(_=>_.vehicle_id===m.id),k=f.reduce((_,M)=>_+(M.cost||0),0),b=y.reduce((_,M)=>_+(M.amount||0),0),v=N.reduce((_,M)=>_+(M.total_cost||0),0),h=v,g=k,w=b,S=k+b+v,j=n.find(_=>_.id===m.driver_id);return{vehicle:m,totalMaintenances:f.length,gasolineCost:h,servicesCost:g,expensesCost:w,maintenanceCost:S,driver:j}}),o=d.reduce((m,f)=>m+f.expensesCost,0),u=d.reduce((m,f)=>m+f.gasolineCost,0),c=d.reduce((m,f)=>m+f.servicesCost,0),x=d.reduce((m,f)=>m+f.totalMaintenances,0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Expense Cost"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["$ ",o.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Gasoline Cost"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["$ ",u.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Service Cost"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:["$ ",c.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Maintenances Count"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$ ",x.toFixed(2)]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(m=>e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 pb-4 border-b border-gray-200",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(Fe,{className:"w-6 h-6 text-gray-600"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:m.vehicle.vehicle_number}),m.driver&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-blue-600",children:m.driver.full_name.charAt(0)})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-blue-600",children:m.driver.full_name}),e.jsx("p",{className:"text-xs text-gray-500",children:m.driver.email})]})]})]})})]}),e.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Maintenance Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center pb-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Maintenances"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:m.totalMaintenances})]}),e.jsxs("div",{className:"flex justify-between items-center pb-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Gasoline"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$ ",m.gasolineCost.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center pb-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Services"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$ ",m.servicesCost.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center pb-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Expenses"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$ ",m.expensesCost.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Maintenance Cost"}),e.jsxs("span",{className:"text-sm font-bold text-gray-900",children:["$ ",m.maintenanceCost.toFixed(2)]})]})]})]},m.vehicle.id))})]})}function hx({onClose:t}){const[s,r]=p.useState({email:"",password:"",full_name:"",phone:""}),[a,n]=p.useState(null),[l,i]=p.useState(""),[d,o]=p.useState(!1),[u,c]=p.useState(""),x=f=>{var N;const y=(N=f.target.files)==null?void 0:N[0];if(y){if(y.size>5*1024*1024){c("Photo size must be less than 5MB");return}if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(y.type)){c("Please upload a JPEG, PNG, or WebP image");return}n(y);const k=new FileReader;k.onloadend=()=>{i(k.result)},k.readAsDataURL(y),c("")}},m=async f=>{f.preventDefault(),o(!0),c("");try{const{data:y,error:N}=await T.auth.signUp({email:s.email,password:s.password,options:{data:{full_name:s.full_name,role:"driver"}}});if(N)throw N;if(y.user){let k="";if(a){const g=a.name.split(".").pop(),w=`${y.user.id}/profile.${g}`,{error:S}=await T.storage.from("driver-photos").upload(w,a,{upsert:!0,contentType:a.type});if(S)throw S;const{data:j}=T.storage.from("driver-photos").getPublicUrl(w);k=j.publicUrl}const{error:b}=await T.from("profiles").upsert({id:y.user.id,full_name:s.full_name,phone:s.phone,email:s.email,role:"driver",status:"active",photo_url:k||null},{onConflict:"id"});if(b)throw b;const v="https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/send-welcome-sms",h={Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"};try{await fetch(v,{method:"POST",headers:h,body:JSON.stringify({phone:s.phone,full_name:s.full_name,email:s.email,password:s.password,role:"driver"})})}catch(g){console.error("SMS send error:",g)}}t()}catch(y){y instanceof Error?c(y.message):c("Failed to create driver")}finally{o(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(ke,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New Driver"})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:m,className:"p-6 space-y-4",children:[u&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:u}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",required:!0,value:s.full_name,onChange:f=>r({...s,full_name:f.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"John Doe"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Qs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"email",required:!0,value:s.email,onChange:f=>r({...s,email:f.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"driver@example.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"tel",required:!0,value:s.phone,onChange:f=>r({...s,phone:f.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"(555) 123-4567"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Profile Photo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[l?e.jsxs("div",{className:"relative w-24 h-24 rounded-full overflow-hidden border-2 border-gray-200",children:[e.jsx("img",{src:l,alt:"Preview",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>{n(null),i("")},className:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:e.jsx(le,{className:"w-3 h-3"})})]}):e.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(By,{className:"w-8 h-8 text-gray-400"})}),e.jsxs("label",{className:"flex-1 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(dx,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:a?"Change Photo":"Upload Photo"})]}),e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:x,className:"hidden"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Max 5MB. Accepts JPEG, PNG, or WebP."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsx("input",{type:"password",required:!0,minLength:6,value:s.password,onChange:f=>r({...s,password:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Min. 6 characters"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Creating...":"Create Driver"})]})]})]})})}function xx({onClose:t,onSuccess:s}){const[r,a]=p.useState({vehicle_number:"",rig_no:"",vehicle_name:"",make:"",model:"",year:new Date().getFullYear(),license_plate:"",type:"sedan",space_type:"",body_type:"",capacity:4,status:"available",vin:"",color:"",fuel_type:"Petrol",gas_card_number:"",current_meter:0,level_of_service:"",service_areas:[],equipments:[],funding_sources:[],limitation:"",notes:"",width_mm:void 0,height_mm:void 0,length_mm:void 0,ground_clearance_mm:void 0,bed_length_mm:void 0,ramp_width_mm:void 0,owner_name:"",owner_address:"",owner_phone:"",owner_business_number:"",owner_license_number:""}),[n,l]=p.useState(!1),[i,d]=p.useState(""),[o,u]=p.useState(!1),[c,x]=p.useState(!1),[m,f]=p.useState([]),[y,N]=p.useState([]),[k,b]=p.useState([]),[v,h]=p.useState([]);p.useEffect(()=>{g()},[]);async function g(){const[j,_,M,R]=await Promise.all([T.from("space_types").select("id, name").eq("status","active"),T.from("equipments").select("id, name").eq("status","active"),T.from("service_areas").select("id, name").eq("status","active"),T.from("funding_sources").select("id, name").eq("status","active")]);j.data&&f(j.data),_.data&&N(_.data),M.data&&b(M.data),R.data&&h(R.data)}const w=async j=>{j.preventDefault(),l(!0),d("");try{const{error:_}=await T.from("vehicles").insert([r]);if(_)throw _;s==null||s(),t()}catch(_){d(_.message)}finally{l(!1)}},S=(j,_)=>j.includes(_)?j.filter(M=>M!==_):[...j,_];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Fe,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add Vehicle"})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:w,className:"p-6 space-y-6",children:[i&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-600",children:i})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Rig No. ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.rig_no,onChange:j=>a({...r,rig_no:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., BatMobile",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Area(s)"}),e.jsx("div",{className:"relative",children:e.jsxs("select",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none",value:"",onChange:j=>{j.target.value&&a({...r,service_areas:S(r.service_areas,j.target.value)})},children:[e.jsx("option",{value:"",children:"Select service areas..."}),k.map(j=>e.jsxs("option",{value:j.name,children:[j.name," ",r.service_areas.includes(j.name)?"":""]},j.id))]})}),r.service_areas.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:r.service_areas.map(j=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded",children:[j,e.jsx("button",{type:"button",onClick:()=>a({...r,service_areas:r.service_areas.filter(_=>_!==j)}),className:"hover:text-blue-900",children:""})]},j))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Level of Service"}),e.jsxs("select",{value:r.level_of_service,onChange:j=>a({...r,level_of_service:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"WAV",children:"WAV"}),e.jsx("option",{value:"AMB",children:"AMB"}),e.jsx("option",{value:"BLS",children:"BLS"}),e.jsx("option",{value:"ALS",children:"ALS"}),e.jsx("option",{value:"CCT",children:"CCT"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Space Type"}),e.jsxs("select",{value:r.space_type,onChange:j=>a({...r,space_type:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select..."}),m.map(j=>e.jsx("option",{value:j.name,children:j.name},j.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Body Type"}),e.jsxs("select",{value:r.body_type,onChange:j=>a({...r,body_type:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"Full Cut",children:"Full Cut"}),e.jsx("option",{value:"Mid Cut",children:"Mid Cut"}),e.jsx("option",{value:"Mini Cut",children:"Mini Cut"}),e.jsx("option",{value:"Standard",children:"Standard"}),e.jsx("option",{value:"Extended",children:"Extended"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Equipments"}),e.jsx("div",{className:"relative",children:e.jsxs("select",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:"",onChange:j=>{j.target.value&&a({...r,equipments:S(r.equipments,j.target.value)})},children:[e.jsx("option",{value:"",children:"Select equipment..."}),y.map(j=>e.jsxs("option",{value:j.name,children:[j.name," ",r.equipments.includes(j.name)?"":""]},j.id))]})}),r.equipments.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:r.equipments.map(j=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 text-xs rounded",children:[j,e.jsx("button",{type:"button",onClick:()=>a({...r,equipments:r.equipments.filter(_=>_!==j)}),className:"hover:text-green-900",children:""})]},j))})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacity"}),e.jsx("input",{type:"number",value:r.capacity,onChange:j=>a({...r,capacity:parseInt(j.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1",max:"20"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Funding Sources"}),e.jsx("div",{className:"relative",children:e.jsxs("select",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:"",onChange:j=>{j.target.value&&a({...r,funding_sources:S(r.funding_sources,j.target.value)})},children:[e.jsx("option",{value:"",children:"Select funding sources..."}),v.map(j=>e.jsxs("option",{value:j.name,children:[j.name," ",r.funding_sources.includes(j.name)?"":""]},j.id))]})}),r.funding_sources.length>0&&e.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[r.funding_sources.slice(0,2).map(j=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded",children:[j,e.jsx("button",{type:"button",onClick:()=>a({...r,funding_sources:r.funding_sources.filter(_=>_!==j)}),className:"hover:text-purple-900",children:""})]},j)),r.funding_sources.length>2&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:["+",r.funding_sources.length-2," more"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"VIN"}),e.jsx("input",{type:"text",value:r.vin,onChange:j=>a({...r,vin:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Vehicle Identification Number"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["License Plate ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.license_plate,onChange:j=>a({...r,license_plate:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., BATMOBILE",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Meter"}),e.jsx("input",{type:"number",value:r.current_meter,onChange:j=>a({...r,current_meter:parseInt(j.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Odometer reading"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Year ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:r.year,onChange:j=>a({...r,year:parseInt(j.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1900",max:new Date().getFullYear()+1,required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Make & Model ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:`${r.make} ${r.model}`.trim(),onChange:j=>{const _=j.target.value.split(" ");a({...r,make:_[0]||"",model:_.slice(1).join(" ")||""})},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Ford Transit Connect",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color"}),e.jsx("input",{type:"text",value:r.color,onChange:j=>a({...r,color:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fuel Type"}),e.jsxs("select",{value:r.fuel_type,onChange:j=>a({...r,fuel_type:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"Petrol",children:"Petrol"}),e.jsx("option",{value:"Diesel",children:"Diesel"}),e.jsx("option",{value:"Electric",children:"Electric"}),e.jsx("option",{value:"Hybrid",children:"Hybrid"}),e.jsx("option",{value:"CNG",children:"CNG"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gas Card Number"}),e.jsx("input",{type:"text",value:r.gas_card_number,onChange:j=>a({...r,gas_card_number:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:r.status,onChange:j=>a({...r,status:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"available",children:"Available"}),e.jsx("option",{value:"in_use",children:"In Use"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vehicle Number"}),e.jsx("input",{type:"text",value:r.vehicle_number,onChange:j=>a({...r,vehicle_number:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Internal ID"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Limitation"}),e.jsx("textarea",{value:r.limitation,onChange:j=>a({...r,limitation:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Any vehicle limitations..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:r.notes,onChange:j=>a({...r,notes:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Additional notes..."})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("button",{type:"button",onClick:()=>u(!o),className:"flex items-center gap-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:[o?e.jsx(cu,{className:"w-4 h-4"}):e.jsx(_o,{className:"w-4 h-4"}),"Dimensions"]}),o&&e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Width (mm)"}),e.jsx("input",{type:"number",value:r.width_mm||"",onChange:j=>a({...r,width_mm:j.target.value?parseInt(j.target.value):void 0}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Height (mm)"}),e.jsx("input",{type:"number",value:r.height_mm||"",onChange:j=>a({...r,height_mm:j.target.value?parseInt(j.target.value):void 0}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Length (mm)"}),e.jsx("input",{type:"number",value:r.length_mm||"",onChange:j=>a({...r,length_mm:j.target.value?parseInt(j.target.value):void 0}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ground Clearance (mm)"}),e.jsx("input",{type:"number",value:r.ground_clearance_mm||"",onChange:j=>a({...r,ground_clearance_mm:j.target.value?parseInt(j.target.value):void 0}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bed Length (mm)"}),e.jsx("input",{type:"number",value:r.bed_length_mm||"",onChange:j=>a({...r,bed_length_mm:j.target.value?parseInt(j.target.value):void 0}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ramp Width (mm)"}),e.jsx("input",{type:"number",value:r.ramp_width_mm||"",onChange:j=>a({...r,ramp_width_mm:j.target.value?parseInt(j.target.value):void 0}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("button",{type:"button",onClick:()=>x(!c),className:"flex items-center gap-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:[c?e.jsx(cu,{className:"w-4 h-4"}):e.jsx(_o,{className:"w-4 h-4"}),"Owner Details"]}),c&&e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),e.jsx("input",{type:"text",value:r.owner_name,onChange:j=>a({...r,owner_name:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx("input",{type:"text",value:r.owner_address,onChange:j=>a({...r,owner_address:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:r.owner_phone,onChange:j=>a({...r,owner_phone:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Number"}),e.jsx("input",{type:"text",value:r.owner_business_number,onChange:j=>a({...r,owner_business_number:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"License Number"}),e.jsx("input",{type:"text",value:r.owner_license_number,onChange:j=>a({...r,owner_license_number:j.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",disabled:n,children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:n,children:n?"Adding Vehicle...":"Add Vehicle"})]})]})]})})}function Ic({patient:t,onClose:s}){const[r,a]=p.useState(!1),[n,l]=p.useState({full_name:(t==null?void 0:t.full_name)||"",phone:(t==null?void 0:t.phone)||"",email:(t==null?void 0:t.email)||"",date_of_birth:(t==null?void 0:t.date_of_birth)||"",medical_id:(t==null?void 0:t.medical_id)||"",insurance_provider:(t==null?void 0:t.insurance_provider)||"",insurance_id:(t==null?void 0:t.insurance_id)||"",mobility_needs:(t==null?void 0:t.mobility_needs)||"ambulatory",special_instructions:(t==null?void 0:t.special_instructions)||""});async function i(d){d.preventDefault(),a(!0);try{const o={...n,email:n.email||null,date_of_birth:n.date_of_birth||null,medical_id:n.medical_id||null,insurance_provider:n.insurance_provider||null,insurance_id:n.insurance_id||null,special_instructions:n.special_instructions||null};if(t){const{error:u}=await T.from("patients").update(o).eq("id",t.id);if(u)throw u}else{const{error:u}=await T.from("patients").insert(o);if(u)throw u}s()}catch(o){console.error("Error saving patient:",o),alert("Error saving patient")}finally{a(!1)}}return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Edit Patient":"New Patient"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:i,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),e.jsx("input",{type:"text",value:n.full_name,onChange:d=>l({...n,full_name:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),e.jsx("input",{type:"tel",value:n.phone,onChange:d=>l({...n,phone:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:n.email,onChange:d=>l({...n,email:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),e.jsx("input",{type:"date",value:n.date_of_birth,onChange:d=>l({...n,date_of_birth:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Medical ID"}),e.jsx("input",{type:"text",value:n.medical_id,onChange:d=>l({...n,medical_id:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Insurance Provider"}),e.jsx("input",{type:"text",value:n.insurance_provider,onChange:d=>l({...n,insurance_provider:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Insurance ID"}),e.jsx("input",{type:"text",value:n.insurance_id,onChange:d=>l({...n,insurance_id:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mobility Needs"}),e.jsxs("select",{value:n.mobility_needs,onChange:d=>l({...n,mobility_needs:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"ambulatory",children:"Ambulatory"}),e.jsx("option",{value:"wheelchair",children:"Wheelchair"}),e.jsx("option",{value:"stretcher",children:"Stretcher"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Special Instructions"}),e.jsx("textarea",{value:n.special_instructions,onChange:d=>l({...n,special_instructions:d.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Any special requirements, allergies, or important notes..."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"submit",disabled:r,className:"flex-1 bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(sr,{className:"w-5 h-5"}),r?"Saving...":"Save Patient"]}),e.jsx("button",{type:"button",onClick:s,className:"px-6 py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})}function pb({onClose:t}){const[s,r]=p.useState({email:"",password:"",full_name:"",phone:""}),[a,n]=p.useState(!1),[l,i]=p.useState(""),[d,o]=p.useState(""),u=async c=>{c.preventDefault(),n(!0),i(""),o("");try{const{data:x,error:m}=await T.auth.signUp({email:s.email,password:s.password,options:{data:{full_name:s.full_name,role:"admin"}}});if(m)throw m;if(x.user){const{error:f}=await T.from("profiles").upsert({id:x.user.id,full_name:s.full_name,phone:s.phone,email:s.email,role:"admin",status:"active"},{onConflict:"id"});if(f)throw f;const y="https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/send-welcome-sms",N={Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"};try{await fetch(y,{method:"POST",headers:N,body:JSON.stringify({phone:s.phone,full_name:s.full_name,email:s.email,password:s.password,role:"admin"})})}catch(k){console.error("SMS send error:",k)}}o("Admin account created successfully!"),setTimeout(()=>{t()},1500)}catch(x){x instanceof Error?i(x.message):i("Failed to create admin account")}finally{n(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(So,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add Admin Account"})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:u,className:"p-6 space-y-4",children:[l&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:l}),d&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg text-sm",children:d}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(So,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",required:!0,value:s.full_name,onChange:c=>r({...s,full_name:c.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"John Doe"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Qs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"email",required:!0,value:s.email,onChange:c=>r({...s,email:c.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"admin@example.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"tel",required:!0,value:s.phone,onChange:c=>r({...s,phone:c.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"(555) 123-4567"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsx("input",{type:"password",required:!0,minLength:6,value:s.password,onChange:c=>r({...s,password:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Min. 6 characters"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:a,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Creating...":"Create Admin"})]})]})]})})}function px(t="main"){const{user:s,profile:r}=qt(),[a,n]=p.useState([]),[l,i]=p.useState(!1),[d,o]=p.useState(null),[u,c]=p.useState(null),[x,m]=p.useState(""),f=p.useCallback(async v=>{if(s)try{const{data:h}=await T.from("user_presence").select("id").eq("user_id",s.id).eq("channel",t).maybeSingle();h?await T.from("user_presence").update({status:v,last_seen:new Date().toISOString()}).eq("id",h.id):await T.from("user_presence").insert({user_id:s.id,status:v,channel:t,last_seen:new Date().toISOString()})}catch(h){console.error("Error updating presence:",h)}},[s,t]),y=async v=>{if(!(!s||!r))try{m("Calling..."),o(v),i(!0);const h=`call_${Date.now()}_${s.id}_${v}`,{data:g}=await T.from("profiles").select("phone, full_name").eq("id",v).maybeSingle();if(!(g!=null&&g.phone)){m("User has no phone number"),setTimeout(()=>N(),2e3);return}await T.from("call_events").insert({from_user_id:s.id,to_user_id:v,event_type:"incoming_call",call_id:h,metadata:{caller_name:r.full_name,caller_phone:r.phone}});const w=void 0,S=void 0,j=void 0;if(!w||!S||!j){m("Twilio not configured"),setTimeout(()=>N(),2e3);return}const _=btoa(`${w}:${S}`);if(!(await fetch(`https://api.twilio.com/2010-04-01/Accounts/${w}/Calls.json`,{method:"POST",headers:{Authorization:`Basic ${_}`,"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({To:g.phone,From:j,Url:`https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/twilio-voice?to=${encodeURIComponent(r.phone||"")}`})})).ok)throw new Error("Failed to initiate call");m("Ringing..."),f("busy")}catch(h){console.error("Error starting call:",h),m("Call failed"),setTimeout(()=>N(),2e3)}},N=p.useCallback(async()=>{i(!1),o(null),c(null),m(""),f("online")},[f]),k=async()=>{u&&(o(u.from_user_id),i(!0),m("Connected"),c(null),f("busy"))},b=async()=>{!u||!s||(await T.from("call_events").insert({from_user_id:s.id,to_user_id:u.from_user_id,event_type:"reject",call_id:u.call_id}),c(null))};return p.useEffect(()=>{if(!s)return;f("online");const v=async()=>{const{data:S}=await T.from("user_presence").select(`
          *,
          profiles:user_id (
            id,
            full_name,
            role,
            photo_url
          )
        `).eq("channel",t).neq("user_id",s.id).gte("last_seen",new Date(Date.now()-3e5).toISOString());S&&n(S)};v();const h=setInterval(v,5e3),g=T.channel(`presence:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"user_presence",filter:`channel=eq.${t}`},()=>{v()}).subscribe(),w=T.channel(`call_events:${s.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"call_events",filter:`to_user_id=eq.${s.id}`},async S=>{const j=S.new;if(j.event_type==="incoming_call"){const{data:_}=await T.from("profiles").select("full_name").eq("id",j.from_user_id).maybeSingle();c({from_user_id:j.from_user_id,to_user_id:s.id,from_name:(_==null?void 0:_.full_name)||"Unknown",call_id:j.call_id||`call_${Date.now()}`})}else j.event_type==="call_ended"||j.event_type==="reject"?N():j.event_type==="call_accepted"&&m("Connected")}).subscribe();return()=>{f("offline"),clearInterval(h),g.unsubscribe(),w.unsubscribe()}},[s,t,f,N]),{onlineUsers:a,isInCall:l,activeCallWith:d,incomingCall:u,callStatus:x,startCall:y,acceptCall:k,rejectCall:b,endCall:N}}function fx(){var m,f;const{onlineUsers:t,isInCall:s,activeCallWith:r,incomingCall:a,callStatus:n,startCall:l,acceptCall:i,rejectCall:d,endCall:o}=px(),u=t.filter(y=>{var N;return((N=y.profiles)==null?void 0:N.role)==="driver"}),c=y=>{switch(y){case"online":return"text-green-500";case"busy":return"text-red-500 animate-pulse";default:return"text-gray-400"}},x=y=>{switch(y){case"online":return"Available";case"busy":return"On Call";default:return"Offline"}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx(Kt,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Walkie Talkie"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Talk to drivers instantly"})]})]}),a&&e.jsx("div",{className:"mb-4 p-4 bg-blue-50 border-2 border-blue-300 rounded-lg animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-blue-900",children:"Incoming Call"}),e.jsx("p",{className:"text-sm text-blue-700",children:a.fromName})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:i,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[e.jsx(hl,{className:"w-4 h-4"}),"Accept"]}),e.jsxs("button",{onClick:d,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx(za,{className:"w-4 h-4"}),"Decline"]})]})]})}),r&&e.jsx("div",{className:"mb-4 p-4 bg-green-50 border-2 border-green-300 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-600 rounded-full flex items-center justify-center",children:e.jsx(Kt,{className:"w-5 h-5 text-white animate-pulse"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-green-900",children:n||"Connected"}),e.jsx("p",{className:"text-sm text-green-700",children:((f=(m=t.find(y=>y.user_id===r))==null?void 0:m.profiles)==null?void 0:f.full_name)||"Driver"})]})]}),e.jsxs("button",{onClick:o,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx(za,{className:"w-4 h-4"}),"End Call"]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Online Drivers"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[u.length," online"]})]}),u.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ke,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No drivers online"})]}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:u.map(y=>{var N,k;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[(N=y.profiles)!=null&&N.photo_url?e.jsx("img",{src:y.profiles.photo_url,alt:y.profiles.full_name,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx(ke,{className:"w-5 h-5 text-white"})}),e.jsx(Yh,{className:`absolute -bottom-1 -right-1 w-4 h-4 fill-current ${c(y.status)}`})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:((k=y.profiles)==null?void 0:k.full_name)||"Unknown Driver"}),e.jsx("p",{className:`text-xs ${c(y.status)}`,children:x(y.status)})]})]}),!r&&y.status==="online"&&e.jsxs("button",{onClick:()=>l(y.user_id),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 text-sm",children:[e.jsx(hl,{className:"w-4 h-4"}),"Call"]}),r===y.user_id&&e.jsxs("span",{className:"px-3 py-2 bg-green-100 text-green-700 rounded-lg text-sm font-medium flex items-center gap-2",children:[e.jsx(Kt,{className:"w-4 h-4 animate-pulse"}),"Active"]})]},y.id)})})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"How to Use"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[e.jsx("li",{children:' Click "Call" to connect via phone call with a driver'}),e.jsx("li",{children:" Drivers must have phone numbers in their profiles"}),e.jsx("li",{children:" Calls are routed through Twilio Voice"}),e.jsx("li",{children:' Click "End Call" to disconnect'})]})]})]})}function fb(){const[t,s]=p.useState([]),[r,a]=p.useState(!0),[n,l]=p.useState(!1);p.useEffect(()=>{i();const c=T.channel("trip_confirmations_changes").on("postgres_changes",{event:"*",schema:"public",table:"trip_confirmations"},()=>{i()}).subscribe();return()=>{c.unsubscribe()}},[]);async function i(){try{const c=new Date;c.setDate(c.getDate()+1),c.setHours(0,0,0,0);const x=new Date(c);x.setDate(x.getDate()+1);const{data:m,error:f}=await T.from("trip_confirmations").select(`
          id,
          trip_id,
          confirmation_sent_at,
          confirmed_at,
          confirmation_status,
          confirmation_method,
          trips (
            id,
            scheduled_pickup_time,
            pickup_address,
            dropoff_address,
            patients (
              id,
              first_name,
              last_name,
              phone
            )
          )
        `).gte("trips.scheduled_pickup_time",c.toISOString()).lt("trips.scheduled_pickup_time",x.toISOString()).order("trips(scheduled_pickup_time)",{ascending:!0});if(f)throw f;s(m||[])}catch(c){console.error("Error loading confirmations:",c)}finally{a(!1)}}async function d(){l(!0);try{const x=await fetch("https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/send-trip-confirmations",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"}}),m=await x.json();if(!x.ok){if(m.error==="Twilio not configured")alert("SMS confirmations require Twilio configuration. Please set up Twilio to use this feature.");else throw new Error(m.error||"Failed to send confirmations");return}alert(m.message||"Confirmations sent successfully!"),await i()}catch(c){console.error("Error sending confirmations:",c),alert("Failed to send confirmations")}finally{l(!1)}}async function o(c,x){try{const{error:m}=await T.from("trip_confirmations").update({confirmation_status:x,confirmed_at:new Date().toISOString(),confirmation_method:"manual"}).eq("id",c);if(m)throw m;await i()}catch(m){console.error("Error updating confirmation:",m),alert("Failed to update confirmation")}}function u(c){switch(c){case"confirmed":return e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(ue,{className:"w-4 h-4 mr-1"}),"Confirmed"]});case"declined":return e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[e.jsx(Gs,{className:"w-4 h-4 mr-1"}),"Declined"]});case"no_response":return e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[e.jsx(Ut,{className:"w-4 h-4 mr-1"}),"No Response"]});default:return e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(Se,{className:"w-4 h-4 mr-1"}),"Pending"]})}}return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading confirmations..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Trip Confirmations"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage confirmations for trips scheduled tomorrow"})]}),e.jsxs("button",{onClick:d,disabled:n,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center gap-2",children:[e.jsx(Mc,{className:"w-5 h-5"}),n?"Sending...":"Send All Confirmations"]})]}),e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Xe,{className:"h-5 w-5 text-blue-400"})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"How it works:"})," Members will receive an SMS reminder the day before their trip asking them to reply YES to confirm. You can also manually mark confirmations using the buttons below."]})})]})}),t.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx(Se,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No trips scheduled for tomorrow"}),e.jsx("p",{className:"text-gray-600",children:"Check back later or schedule some trips!"})]}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pickup Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Route"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Method"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(c=>{const x=c.trips,m=x.patients,f=new Date(x.scheduled_pickup_time);return e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[m.first_name," ",m.last_name]}),e.jsx("div",{className:"text-sm text-gray-500",children:m.phone})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:f.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900",children:x.pickup_address}),e.jsxs("div",{className:"text-sm text-gray-500",children:[" ",x.dropoff_address]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u(c.confirmation_status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900 capitalize",children:c.confirmation_method||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.confirmation_status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>o(c.id,"confirmed"),className:"text-green-600 hover:text-green-800 font-medium",children:"Confirm"}),e.jsx("button",{onClick:()=>o(c.id,"declined"),className:"text-red-600 hover:text-red-800 font-medium",children:"Decline"})]})})]},c.id)})})]})})]})}function gb({tripId:t,onClose:s}){var y,N,k,b,v,h,g,w;const[r,a]=p.useState(null),[n,l]=p.useState(!0),i=p.useRef(null),d=p.useRef(null),{isLoaded:o}=er();p.useEffect(()=>{u()},[t]),p.useEffect(()=>{o&&r&&i.current&&!d.current&&c()},[o,r]);async function u(){try{const{data:S,error:j}=await T.from("trips").select(`
          *,
          patients(full_name, phone, cell_phone, email, date_of_birth, gender, member_id)
        `).eq("id",t).maybeSingle();if(j)throw j;a(S)}catch(S){console.error("Error loading trip details:",S)}finally{l(!1)}}function c(){if(!i.current||!r)return;const S=new google.maps.Map(i.current,{zoom:12,center:{lat:31.7619,lng:-106.485},mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0});d.current=S;const j=new google.maps.DirectionsService,_=new google.maps.DirectionsRenderer({map:S,suppressMarkers:!0,polylineOptions:{strokeColor:"#3B82F6",strokeWeight:4}});r.pickup_address&&r.dropoff_address&&j.route({origin:r.pickup_address,destination:r.dropoff_address,travelMode:google.maps.TravelMode.DRIVING},(M,R)=>{R==="OK"&&M&&(_.setDirections(M),new google.maps.Marker({position:M.routes[0].legs[0].start_location,map:S,icon:{path:google.maps.SymbolPath.CIRCLE,scale:10,fillColor:"#EF4444",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2}}),new google.maps.Marker({position:M.routes[0].legs[0].end_location,map:S,icon:{path:google.maps.SymbolPath.CIRCLE,scale:10,fillColor:"#8B5CF6",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2}}))})}function x(S){return S?new Date(S).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}function m(S){return S?new Date(S).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):""}function f(S){switch(S==null?void 0:S.toLowerCase()){case"unassigned":return"bg-yellow-100 text-yellow-800";case"assigned":return"bg-blue-100 text-blue-800";case"in_progress":return"bg-green-100 text-green-800";case"completed":return"bg-gray-100 text-gray-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}return n?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg p-8",children:e.jsx("p",{className:"text-gray-600",children:"Loading trip details..."})})}):r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl w-full h-[90vh] max-w-7xl flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Details"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col p-6 bg-gray-50",children:[e.jsxs("div",{className:"mb-4 space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.pickup_address}),e.jsx("p",{className:"text-xs text-gray-500",children:x(r.scheduled_pickup_time)})]})]}),e.jsx("div",{className:"flex items-center gap-2 ml-2",children:e.jsx("div",{className:"w-0.5 h-6 bg-gray-300"})}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.dropoff_address}),e.jsx("p",{className:"text-xs text-gray-500",children:x(r.scheduled_pickup_time)})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg flex-1 border border-gray-200",children:[e.jsx("div",{className:"text-center py-4 text-gray-500 text-sm font-medium",children:"Trip Route"}),e.jsx("div",{ref:i,className:"w-full h-[calc(100%-3rem)] rounded-b-lg"})]})]}),e.jsx("div",{className:"w-[500px] overflow-y-auto bg-white p-6 border-l border-gray-200",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Trip Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Trip ID"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:(y=r.id)==null?void 0:y.slice(0,12)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Created At"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:x(r.created_at)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Trip Status"}),e.jsx("span",{className:`text-xs px-2 py-1 rounded font-medium ${f(r.status||"unassigned")}`,children:r.status||"Unassigned"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Funding Source"}),e.jsx("span",{className:"text-xs px-2 py-1 rounded font-medium bg-black text-white",children:r.funding_source||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Miles"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:r.distance_miles?`${r.distance_miles} mi`:"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Level of service"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:r.space_type||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Insurance ID"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:r.insurance_id||""})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"IPA Number"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:r.ipa_feca_number||""})]})]})]}),e.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Passenger Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Passenger Name"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:((N=r.patients)==null?void 0:N.full_name)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Phone Number"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:((k=r.patients)==null?void 0:k.phone)||""})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Cell Phone"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:((b=r.patients)==null?void 0:b.cell_phone)||""})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:((v=r.patients)==null?void 0:v.email)||""})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"DOB"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:m((h=r.patients)==null?void 0:h.date_of_birth)||""})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Gender"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:((g=r.patients)==null?void 0:g.gender)||""})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Client ID"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:((w=r.patients)==null?void 0:w.member_id)||""})]})]})]}),e.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Other Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Primary Diagnosis"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:r.primary_diagnosis||""})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Notes"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:r.notes||""})]})]})]})]})})]})]})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8",children:[e.jsx("p",{className:"text-gray-600",children:"Trip not found"}),e.jsx("button",{onClick:s,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Close"})]})})}function yb(t,s,r,a){const l=_n(r-t),i=_n(a-s),d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(_n(t))*Math.cos(_n(r))*Math.sin(i/2)*Math.sin(i/2),u=3959*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)));return Math.round(u*100)/100}function _n(t){return t*(Math.PI/180)}function bb({trip:t,onClose:s,onAssign:r}){const[a,n]=p.useState([]),[l,i]=p.useState([]),[d,o]=p.useState(""),[u,c]=p.useState(!0),[x,m]=p.useState(null),[f,y]=p.useState(!1),{isLoaded:N}=er(),[k,b]=p.useState(null),[v,h]=p.useState([]);p.useEffect(()=>{w(),g()},[]),p.useEffect(()=>{if(d){const _=d.toLowerCase();i(a.filter(M=>{var R;return M.full_name.toLowerCase().includes(_)||((R=M.vehicle_registration)==null?void 0:R.toLowerCase().includes(_))}))}else i(a)},[d,a]),p.useEffect(()=>{N&&t.pickup_latitude&&t.pickup_longitude&&S()},[N,t.pickup_latitude,t.pickup_longitude,a]);async function g(){if(!N)return;const _=new google.maps.Geocoder;if(!t.pickup_latitude&&t.pickup_address)try{const M=await _.geocode({address:t.pickup_address});if(M.results[0]){const R=M.results[0].geometry.location;await T.from("trips").update({pickup_latitude:R.lat(),pickup_longitude:R.lng()}).eq("id",t.id)}}catch(M){console.error("Error geocoding pickup:",M)}if(!t.dropoff_latitude&&t.dropoff_address)try{const M=await _.geocode({address:t.dropoff_address});if(M.results[0]){const R=M.results[0].geometry.location;await T.from("trips").update({dropoff_latitude:R.lat(),dropoff_longitude:R.lng()}).eq("id",t.id)}}catch(M){console.error("Error geocoding dropoff:",M)}}async function w(){try{const _=new Date().toISOString().split("T")[0],{data:M,error:R}=await T.from("profiles").select("id, full_name, phone, photo_url, current_latitude, current_longitude, last_location_update, vehicle_registration, status").eq("role","driver");if(R)throw R;const{data:O}=await T.from("vehicle_assignments").select(`
          driver_id,
          vehicle:vehicles(vehicle_name, rig_no, model, make)
        `).eq("assigned_date",_).is("unassigned_at",null),I=new Map;if(O&&O.forEach(A=>{A.vehicle&&I.set(A.driver_id,A.vehicle)}),M&&t.pickup_latitude&&t.pickup_longitude){const A=M.map(F=>({...F,assigned_vehicle:I.get(F.id),distance:F.current_latitude&&F.current_longitude?yb(t.pickup_latitude,t.pickup_longitude,F.current_latitude,F.current_longitude):999999}));A.sort((F,Q)=>(F.distance||0)-(Q.distance||0)),n(A),i(A)}else{const A=(M||[]).map(F=>({...F,assigned_vehicle:I.get(F.id)}));n(A),i(A)}}catch(_){console.error("Error loading drivers:",_)}finally{c(!1)}}function S(){if(!N||!t.pickup_latitude||!t.pickup_longitude)return;const _=document.getElementById("assignment-map");if(!_)return;const M=new google.maps.Map(_,{center:{lat:t.pickup_latitude,lng:t.pickup_longitude},zoom:12,mapTypeControl:!1,fullscreenControl:!1,streetViewControl:!1});b(M);const R=[],O=new google.maps.Marker({position:{lat:t.pickup_latitude,lng:t.pickup_longitude},map:M,title:"Pickup Location",icon:{path:google.maps.SymbolPath.CIRCLE,scale:10,fillColor:"#22c55e",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2}});if(R.push(O),t.dropoff_latitude&&t.dropoff_longitude){const I=new google.maps.Marker({position:{lat:t.dropoff_latitude,lng:t.dropoff_longitude},map:M,title:"Dropoff Location",icon:{path:google.maps.SymbolPath.CIRCLE,scale:10,fillColor:"#ef4444",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2}});R.push(I)}a.forEach(I=>{if(I.current_latitude&&I.current_longitude){const A=new google.maps.Marker({position:{lat:I.current_latitude,lng:I.current_longitude},map:M,title:I.full_name,icon:{path:google.maps.SymbolPath.CIRCLE,scale:8,fillColor:"#3b82f6",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2}});A.addListener("click",()=>{m(I)}),R.push(A)}}),h(R)}async function j(){if(x){y(!0);try{await r(x.id),s()}catch(_){console.error("Error assigning driver:",_),alert("Failed to assign driver")}finally{y(!1)}}}return u?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"})})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex z-50",children:e.jsxs("div",{className:"flex w-full h-full",children:[e.jsxs("div",{className:"w-1/3 bg-white overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Assign Trip"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Pickup"}),e.jsx("p",{className:"text-gray-600",children:t.pickup_address}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(t.scheduled_pickup_time).toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-red-600 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Dropoff"}),e.jsx("p",{className:"text-gray-600",children:t.dropoff_address})]})]}),t.patient&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.patient.full_name}),t.patient.mobility_needs&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:t.patient.mobility_needs})]})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Drivers"}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search drivers...",value:d,onChange:_=>o(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsx("div",{className:"space-y-2",children:l.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No drivers available"})}):l.map(_=>e.jsxs("div",{onClick:()=>m(_),className:`p-4 rounded-lg border-2 cursor-pointer transition ${(x==null?void 0:x.id)===_.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("div",{className:"relative",children:[_.photo_url?e.jsx("img",{src:_.photo_url,alt:_.full_name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(ke,{className:"w-6 h-6 text-gray-500"})}),e.jsx("div",{className:`absolute bottom-0 right-0 w-3 h-3 rounded-full border-2 border-white ${_.status==="active"?"bg-green-500":"bg-gray-400"}`,title:_.status==="active"?"Online":"Offline"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:_.full_name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${_.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:_.status==="active"?"Online":"Offline"})]}),_.assigned_vehicle?e.jsxs("div",{className:"mt-1 space-y-0.5",children:[e.jsxs("p",{className:"text-xs font-medium text-blue-600",children:[" ",_.assigned_vehicle.vehicle_name||_.assigned_vehicle.rig_no]}),_.assigned_vehicle.make&&_.assigned_vehicle.model&&e.jsxs("p",{className:"text-xs text-gray-600",children:[_.assigned_vehicle.make," ",_.assigned_vehicle.model]})]}):e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"No vehicle assigned"})]}),_.distance!==void 0&&_.distance!==999999&&e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-600",children:[_.distance.toFixed(2)," mi"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"(Google Miles)"})]})]}),_.last_location_update&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[" Location updated ",new Date(_.last_location_update).toLocaleTimeString()]})]},_.id))}),x&&e.jsx("button",{onClick:j,disabled:f,className:"w-full mt-4 bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Assigning...":"Assign"})]})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{id:"assignment-map",className:"w-full h-full"}),!N&&e.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading map..."})]})})]})]})})}function vb(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(!0),[i,d]=p.useState(""),[o,u]=p.useState("all"),[c,x]=p.useState(new Date().toISOString().split("T")[0]),[m,f]=p.useState(new Date().toISOString().split("T")[0]),[y,N]=p.useState("00:00"),[k,b]=p.useState("23:59"),[v,h]=p.useState(!1),[g,w]=p.useState("grid"),[S,j]=p.useState("all"),[_,M]=p.useState("all"),[R,O]=p.useState("all"),[I,A]=p.useState(null),[F,Q]=p.useState(!1),[E,q]=p.useState(!1),[C,U]=p.useState(null),[P,V]=p.useState([]),[D,B]=p.useState([]),[$,W]=p.useState(!1),[L,K]=p.useState(!1),[X,ie]=p.useState(null),Ee=p.useRef(null),qe=p.useRef(null);p.useEffect(()=>{Be(),Hr(),Dx();const z=T.channel("trips_changes").on("postgres_changes",{event:"*",schema:"public",table:"trips"},()=>{Be()}).subscribe();return()=>{z.unsubscribe()}},[]),p.useEffect(()=>{let z;return v&&(z=setInterval(()=>{Be()},3e4)),()=>{z&&clearInterval(z)}},[v]),p.useEffect(()=>{Ix()},[t,i,o,c,m,y,k,S,_,R]),p.useEffect(()=>{function z(Z){Ee.current&&!Ee.current.contains(Z.target)&&A(null),qe.current&&!qe.current.contains(Z.target)&&W(!1)}return document.addEventListener("mousedown",z),()=>{document.removeEventListener("mousedown",z)}},[]);async function Be(){try{const{data:z,error:Z}=await T.from("trips").select(`
          *,
          patients (*),
          profiles (*)
        `).order("scheduled_pickup_time",{ascending:!0});if(Z)throw Z;s(z||[])}catch(z){console.error("Error loading trips:",z)}finally{l(!1)}}async function Hr(){try{const{data:z,error:Z}=await T.from("patients").select("*").order("full_name");if(Z)throw Z;V(z||[])}catch(z){console.error("Error loading patients:",z)}}async function Dx(){try{const{data:z,error:Z}=await T.from("profiles").select("*").eq("role","driver").order("full_name");if(Z)throw Z;B(z||[])}catch(z){console.error("Error loading drivers:",z)}}function Ix(){let z=[...t];if(i){const oe=i.toLowerCase();z=z.filter(pt=>{var rr,Ts,ss;return((rr=pt.trip_number)==null?void 0:rr.toLowerCase().includes(oe))||((Ts=pt.patients)==null?void 0:Ts.full_name.toLowerCase().includes(oe))||pt.pickup_address.toLowerCase().includes(oe)||pt.dropoff_address.toLowerCase().includes(oe)||((ss=pt.county)==null?void 0:ss.toLowerCase().includes(oe))})}o!=="all"&&(o==="unassigned"?z=z.filter(oe=>!oe.driver_id&&oe.status!=="cancelled"&&oe.status!=="completed"):o==="assigned"?z=z.filter(oe=>oe.driver_id&&oe.status==="assigned"):o==="archived"?z=z.filter(oe=>oe.status==="cancelled"||oe.status==="completed"):z=z.filter(oe=>oe.status===o)),S!=="all"&&(z=z.filter(oe=>oe.patient_id===S)),_!=="all"&&(z=z.filter(oe=>oe.space_type===_)),R!=="all"&&(z=z.filter(oe=>oe.appointment_type===R));const Z=new Date(`${c}T${y}`).getTime(),it=new Date(`${m}T${k}`).getTime();z=z.filter(oe=>{const pt=new Date(oe.scheduled_pickup_time).getTime();return pt>=Z&&pt<=it}),a(z)}function Lx(z,Z){z.preventDefault(),A({x:z.clientX,y:z.clientY,trip:Z})}async function ye(z,Z){A(null);try{switch(z){case"assign":U(Z),Q(!0);break;case"details":U(Z),q(!0);break;case"edit":U(Z),Q(!0);break;case"mark_ready":await Nt(Z.id,{is_ready:!Z.is_ready});break;case"mark_vip":await Nt(Z.id,{is_vip:!Z.is_vip});break;case"mark_no_answer":await Nt(Z.id,{phone_attempt_status:"no_answer"});break;case"mark_bad_number":await Nt(Z.id,{phone_attempt_status:"bad_number"});break;case"mark_confirm":await Nt(Z.id,{confirmation_status:"confirmed"});break;case"mark_voicemail":await Nt(Z.id,{phone_attempt_status:"voicemail"});break;case"mark_multiload":await Nt(Z.id,{is_multiload:!Z.is_multiload});break;case"mark_methadone":await Nt(Z.id,{is_methadone:!Z.is_methadone});break;case"mark_dialysis":await Nt(Z.id,{is_dialysis:!Z.is_dialysis});break;case"mark_last_trip":await Nt(Z.id,{is_last_trip:!Z.is_last_trip});break;case"mark_dead_miles":const it=prompt("Enter dead miles:");it&&await Nt(Z.id,{dead_miles:parseFloat(it)});break;case"clone":await Rx(Z);break;case"remove":confirm("Are you sure you want to delete this trip?")&&await Ox(Z.id);break}}catch(it){console.error("Error handling context action:",it),alert("Failed to perform action")}}async function Nt(z,Z){const{error:it}=await T.from("trips").update({...Z,updated_at:new Date().toISOString()}).eq("id",z);if(it)throw it;await Be()}async function Rx(z){const{id:Z,created_at:it,updated_at:oe,actual_pickup_time:pt,actual_dropoff_time:rr,...Ts}=z,{error:ss}=await T.from("trips").insert({...Ts,status:"scheduled",trip_number:null});if(ss)throw ss;await Be()}async function Ox(z){const{error:Z}=await T.from("trips").delete().eq("id",z);if(Z)throw Z;await Be()}function $x(){return{all:t.length,pending:t.filter(z=>z.status==="pending").length,unassigned:t.filter(z=>!z.driver_id&&z.status!=="cancelled"&&z.status!=="completed"&&z.status!=="pending").length,assigned:t.filter(z=>z.driver_id&&z.status==="assigned").length,in_progress:t.filter(z=>z.status==="in_progress").length,cancelled:t.filter(z=>z.status==="cancelled").length,archived:t.filter(z=>z.status==="cancelled"||z.status==="completed").length,completed:t.filter(z=>z.status==="completed").length}}const Fx=$x();return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading trips..."})}):e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search",value:i,onChange:z=>d(z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),e.jsxs("div",{className:"flex items-center gap-2 border border-gray-300 rounded-md px-3 py-2",children:[e.jsx(ge,{className:"text-gray-400 w-4 h-4"}),e.jsx("input",{type:"date",value:c,onChange:z=>x(z.target.value),className:"border-0 p-0 focus:ring-0 text-sm"}),e.jsx("span",{className:"text-gray-400",children:"-"}),e.jsx("input",{type:"date",value:m,onChange:z=>f(z.target.value),className:"border-0 p-0 focus:ring-0 text-sm"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"time",value:y,onChange:z=>N(z.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 text-sm"}),e.jsx("span",{className:"text-gray-400",children:"-"}),e.jsx("input",{type:"time",value:k,onChange:z=>b(z.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 text-sm"}),e.jsx("button",{onClick:()=>{N("00:00"),b("23:59")},className:"px-3 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors text-sm font-medium",children:"Reset"})]}),e.jsx("button",{onClick:()=>w(g==="grid"?"list":"grid"),className:"p-2 rounded-md bg-gray-100 hover:bg-gray-200 transition-colors",children:g==="grid"?e.jsx(sx,{className:"w-5 h-5"}):e.jsx(ax,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>Be(),className:"p-2 rounded-md bg-blue-600 hover:bg-blue-700 text-white transition-colors",title:"Refresh",children:e.jsx(Ac,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:S,onChange:z=>j(z.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 text-sm text-gray-600",children:[e.jsx("option",{value:"all",children:"-- Select Member --"}),P.map(z=>e.jsx("option",{value:z.id,children:z.full_name},z.id))]}),e.jsxs("select",{value:_,onChange:z=>M(z.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 text-sm text-gray-600",children:[e.jsx("option",{value:"all",children:"-- Select Space Type --"}),e.jsx("option",{value:"ambulatory",children:"Ambulatory"}),e.jsx("option",{value:"wheelchair",children:"Wheelchair"}),e.jsx("option",{value:"stretcher",children:"Stretcher"})]}),e.jsxs("select",{value:R,onChange:z=>O(z.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 text-sm text-gray-600",children:[e.jsx("option",{value:"all",children:"-- Select Appointment Type --"}),e.jsx("option",{value:"medical",children:"Medical"}),e.jsx("option",{value:"dialysis",children:"Dialysis"}),e.jsx("option",{value:"physical_therapy",children:"Physical Therapy"}),e.jsx("option",{value:"dental",children:"Dental"}),e.jsx("option",{value:"other",children:"Other"})]})]})]}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex gap-1 px-4 overflow-x-auto items-center",children:[["all","pending","unassigned","assigned","in_progress","cancelled","archived","completed"].map(z=>e.jsxs("button",{onClick:()=>u(z),className:`px-4 py-3 whitespace-nowrap font-medium transition-colors text-sm rounded-t-md ${o===z?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:[z.split("_").map(Z=>Z.charAt(0).toUpperCase()+Z.slice(1)).join(" "),e.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-semibold ${o===z?"bg-blue-500":"bg-gray-200"}`,children:Fx[z]})]},z)),e.jsxs("div",{className:"relative ml-2",ref:qe,children:[e.jsx("button",{onClick:()=>W(!$),className:"p-2 rounded-md hover:bg-gray-100 transition-colors",children:e.jsx(qs,{className:"w-5 h-5 text-gray-600"})}),$&&e.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50 py-2",children:[e.jsxs("button",{onClick:()=>{U(null),Q(!0),W(!1)},className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center gap-2 text-sm",children:[e.jsx(re,{className:"w-4 h-4"}),"New Trip"]}),e.jsx("div",{className:"border-t border-gray-200 my-2"}),e.jsxs("div",{className:"px-4 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2",children:"FILTERS"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"rounded"}),"Manual Trip"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"rounded"}),"Group By Name"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"rounded"}),"Farmout"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"rounded"}),"Standing Orders"]})]})]}),e.jsx("div",{className:"border-t border-gray-200 my-2"}),e.jsxs("div",{className:"px-4 py-2 space-y-2",children:[e.jsx("button",{className:"w-full px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Select All"}),e.jsx("button",{className:"w-full px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Trips Report"})]}),e.jsx("div",{className:"border-t border-gray-200 my-2"}),e.jsxs("div",{className:"px-4 py-2 space-y-2",children:[e.jsx("button",{className:"w-full px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Drivers Manifest"}),e.jsx("button",{className:"w-full px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Trips Itinerary"})]}),e.jsx("div",{className:"border-t border-gray-200 my-2"}),e.jsxs("div",{className:"px-4 py-2 space-y-2",children:[e.jsx("button",{className:"w-full px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"On Scene Report"}),e.jsx("button",{className:"w-full px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Save Template"})]})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:r.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx(ae,{className:"w-16 h-16 mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"No trips found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters"})]}):e.jsx("div",{className:g==="grid"?"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4":"space-y-3",children:r.map(z=>{var Z,it,oe,pt,rr,Ts,ss,Lc;return e.jsx("div",{onClick:()=>{U(z),q(!0)},className:"bg-white rounded-lg border border-gray-200 hover:shadow-lg transition-shadow cursor-pointer",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-base",children:((it=(Z=z.patients)==null?void 0:Z.full_name)==null?void 0:it.toUpperCase())||"UNKNOWN PATIENT"}),z.is_vip&&e.jsx(mu,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"})]}),e.jsx("p",{className:"text-xs text-gray-500 font-mono",children:z.trip_number||z.id.slice(0,13).toUpperCase()})]}),e.jsx("button",{onClick:Te=>{Te.stopPropagation(),Lx(Te,z)},className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(ix,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-3",children:[z.status==="pending"&&e.jsx("span",{className:"px-2 py-1 bg-yellow-500 text-white text-xs rounded font-medium animate-pulse",children:" PENDING APPROVAL"}),z.status==="scheduled"&&!z.driver_id&&e.jsx("span",{className:"px-2 py-1 bg-blue-600 text-white text-xs rounded font-medium",children:"Offered"}),z.manual_entry&&e.jsx("span",{className:"px-2 py-1 bg-gray-600 text-white text-xs rounded font-medium",children:"Manual"}),z.county&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded font-medium",children:z.county}),z.broker_name&&e.jsx("span",{className:"px-2 py-1 bg-green-600 text-white text-xs rounded font-medium",children:z.broker_name})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-green-600 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-900 font-medium",children:z.pickup_address}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(z.scheduled_pickup_time).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-red-600 mt-1 flex-shrink-0"}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm text-gray-900 font-medium",children:z.dropoff_address})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 text-xs text-gray-600 py-3 border-t border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Fe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-medium uppercase",children:z.space_type||"AMB"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(hs,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:[z.distance_miles||"0"," mi"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Xe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:((oe=z.patients)==null?void 0:oe.phone)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Se,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:"Loaded Time"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(xe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-mono text-xs",children:((pt=z.trip_number)==null?void 0:pt.slice(-6))||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 font-semibold text-gray-900",children:[e.jsx(Ft,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{children:["BSR: $",((rr=z.broker_service_rate)==null?void 0:rr.toFixed(2))||"0.00"]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-semibold",children:((ss=(Ts=z.profiles)==null?void 0:Ts.full_name)==null?void 0:ss.charAt(0))||"U"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:((Lc=z.profiles)==null?void 0:Lc.full_name)||"Unassigned"}),e.jsx("p",{className:"text-gray-500",children:z.broker_name||"No Broker"})]})]}),e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs font-medium",children:"Default"})]}),(z.driver_notes||z.dispatcher_notes)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 space-y-1",children:[z.driver_notes&&e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:"Driver Notes:"})," ",z.driver_notes]}),z.dispatcher_notes&&e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:"Dispatcher Notes:"})," ",z.dispatcher_notes]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 flex flex-wrap gap-2",children:[z.status==="pending"&&e.jsxs("button",{onClick:async Te=>{Te.stopPropagation();try{const{error:en}=await T.from("trips").update({status:"scheduled"}).eq("id",z.id);if(en)throw en;await Be()}catch(en){console.error("Error approving trip:",en),alert("Failed to approve trip. Please try again.")}},className:"px-3 py-1.5 bg-green-600 text-white rounded text-xs font-medium hover:bg-green-700 transition-colors flex items-center gap-1",children:[e.jsx(ue,{className:"w-3 h-3"}),"Approve Trip"]}),z.status!=="pending"&&e.jsx("button",{onClick:Te=>{Te.stopPropagation(),ie(z),K(!0)},className:"px-3 py-1.5 bg-blue-600 text-white rounded text-xs font-medium hover:bg-blue-700 transition-colors",children:z.profiles?"Re-assign":"Assign Driver"}),e.jsx("button",{onClick:Te=>{Te.stopPropagation(),U(z),q(!0)},className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded text-xs font-medium hover:bg-gray-200 transition-colors",children:"Details"}),e.jsx("button",{onClick:Te=>{Te.stopPropagation(),ye("mark_confirm",z)},className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded text-xs font-medium hover:bg-gray-200 transition-colors",children:"Mark Confirm"}),e.jsx("button",{onClick:Te=>{Te.stopPropagation(),ye("mark_voicemail",z)},className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded text-xs font-medium hover:bg-gray-200 transition-colors",children:"Un-Mark Voicemail"}),e.jsx("button",{onClick:Te=>{Te.stopPropagation(),ye("mark_multiload",z)},className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded text-xs font-medium hover:bg-gray-200 transition-colors",children:"Mark Multiload"}),e.jsx("button",{onClick:Te=>{Te.stopPropagation(),ye("mark_ready",z)},className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded text-xs font-medium hover:bg-gray-200 transition-colors",children:"Mark Ready"}),e.jsx("button",{onClick:Te=>{Te.stopPropagation(),ye("mark_dialysis",z)},className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded text-xs font-medium hover:bg-gray-200 transition-colors",children:"Mark Dialysis"}),e.jsx("button",{onClick:Te=>{Te.stopPropagation(),ye("confirmation_text",z)},className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded text-xs font-medium hover:bg-gray-200 transition-colors",children:"Confirmation Text"})]})]})},z.id)})})}),I&&e.jsxs("div",{ref:Ee,className:"fixed bg-white rounded-lg shadow-xl border border-gray-200 py-2 z-50 min-w-[200px]",style:{top:I.y,left:I.x},children:[e.jsxs("button",{onClick:()=>ye("assign",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4"}),"Assign Driver"]}),e.jsxs("button",{onClick:()=>ye("details",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),"Details"]}),e.jsxs("button",{onClick:()=>ye("mark_ready",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4"}),I.trip.is_ready?"Unmark Ready":"Mark Ready"]}),e.jsxs("button",{onClick:()=>ye("mark_vip",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(mu,{className:"w-4 h-4"}),I.trip.is_vip?"Unmark VIP":"Mark VIP"]}),e.jsxs("button",{onClick:()=>ye("mark_no_answer",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(za,{className:"w-4 h-4"}),"Mark No Ph. Answer"]}),e.jsxs("button",{onClick:()=>ye("mark_bad_number",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(Xe,{className:"w-4 h-4"}),"Mark Bad Ph. Number"]}),e.jsxs("button",{onClick:()=>ye("mark_confirm",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4"}),"Mark Confirm"]}),e.jsxs("button",{onClick:()=>ye("mark_voicemail",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(sb,{className:"w-4 h-4"}),"Mark Voicemail"]}),e.jsxs("button",{onClick:()=>ye("mark_multiload",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4"}),I.trip.is_multiload?"Unmark Multiload":"Mark Multiload"]}),e.jsxs("button",{onClick:()=>ye("mark_methadone",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(hs,{className:"w-4 h-4"}),I.trip.is_methadone?"Unmark Methadone":"Mark Methadone"]}),e.jsxs("button",{onClick:()=>ye("mark_dialysis",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(hs,{className:"w-4 h-4"}),I.trip.is_dialysis?"Unmark Dialysis":"Mark Dialysis"]}),e.jsxs("button",{onClick:()=>ye("mark_last_trip",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(Uy,{className:"w-4 h-4"}),I.trip.is_last_trip?"Unmark Last Trip":"Mark Last Trip"]}),e.jsxs("button",{onClick:()=>ye("mark_dead_miles",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(hs,{className:"w-4 h-4"}),"Mark Dead Miles"]}),e.jsxs("button",{onClick:()=>ye("confirmation_text",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(Fr,{className:"w-4 h-4"}),"Confirmation Text"]}),e.jsxs("button",{onClick:()=>ye("clone",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx($y,{className:"w-4 h-4"}),"Clone"]}),e.jsxs("button",{onClick:()=>ye("edit",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(zt,{className:"w-4 h-4"}),"Edit"]}),e.jsx("div",{className:"border-t border-gray-200 my-1"}),e.jsxs("button",{onClick:()=>ye("remove",I.trip),className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2",children:[e.jsx(Za,{className:"w-4 h-4"}),"Remove"]})]}),F&&e.jsx(Ya,{trip:C,onClose:()=>{Q(!1),U(null)},onSave:()=>{Be(),Q(!1),U(null)}}),E&&C&&e.jsx(gb,{tripId:C.id,onClose:()=>{q(!1),U(null)}}),L&&X&&e.jsx(bb,{trip:X,onClose:()=>{K(!1),ie(null)},onAssign:async z=>{try{const{error:Z}=await T.from("trips").update({driver_id:z,status:"assigned"}).eq("id",X.id);if(Z)throw Z;await T.from("notifications").insert({user_id:z,message:`New trip assigned: ${X.pickup_address} to ${X.dropoff_address}`,trip_id:X.id,status:"pending"}),await Be(),K(!1),ie(null)}catch(Z){throw console.error("Error assigning driver:",Z),Z}}})]})}function jb(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(!0),[i,d]=p.useState(""),[o,u]=p.useState("cancelled"),[c,x]=p.useState("all"),[m,f]=p.useState("all"),[y,N]=p.useState("all"),[k,b]=p.useState("list"),[v,h]=p.useState(!1),[g,w]=p.useState(null),[S,j]=p.useState([]),[_,M]=p.useState([]),[R,O]=p.useState([]);p.useEffect(()=>{I();const P=T.channel("operations_changes").on("postgres_changes",{event:"*",schema:"public",table:"trips"},()=>{I()}).subscribe();return()=>{P.unsubscribe()}},[]),p.useEffect(()=>{F(),A()},[t,i,o,c,m,y]);async function I(){try{const{data:P,error:V}=await T.from("trips").select(`
          *,
          patients (*),
          profiles (*)
        `).order("scheduled_pickup_time",{ascending:!0});if(V)throw V;s(P||[])}catch(P){console.error("Error loading trips:",P)}finally{l(!1)}}function A(){const P=new Set,V=new Set,D=new Set;t.forEach(B=>{B.funding_source&&P.add(B.funding_source),B.service_area&&V.add(B.service_area),B.station_manager&&D.add(B.station_manager)}),j(Array.from(P).sort()),M(Array.from(V).sort()),O(Array.from(D).sort())}function F(){let P=[...t];if(P=P.filter(V=>V.status===o.replace("_","-")),i){const V=i.toLowerCase();P=P.filter(D=>{var B,$;return((B=D.trip_number)==null?void 0:B.toLowerCase().includes(V))||(($=D.patients)==null?void 0:$.full_name.toLowerCase().includes(V))||D.pickup_address.toLowerCase().includes(V)||D.dropoff_address.toLowerCase().includes(V)})}c!=="all"&&(P=P.filter(V=>V.funding_source===c)),m!=="all"&&(P=P.filter(V=>V.service_area===m)),y!=="all"&&(P=P.filter(V=>V.station_manager===y)),a(P)}async function Q(P){w(P),h(!0)}async function E(P){try{const{error:V}=await T.from("trips").update({fetch_status:"fetched",updated_at:new Date().toISOString()}).eq("id",P);if(V)throw V;await I()}catch(V){console.error("Error updating fetch status:",V),alert("Failed to update fetch status")}}async function q(P){try{const{error:V}=await T.from("trips").update({loaded_time:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",P);if(V)throw V;await I()}catch(V){console.error("Error updating loaded time:",V),alert("Failed to update loaded time")}}function C(){return{cancelled:t.filter(P=>P.status==="cancelled").length,scheduled:t.filter(P=>P.status==="scheduled").length,assigned:t.filter(P=>P.status==="assigned").length,in_progress:t.filter(P=>P.status==="in-progress").length,completed:t.filter(P=>P.status==="completed").length}}const U=C();return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading operations..."})}):e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:i,onChange:P=>d(P.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("select",{value:c,onChange:P=>x(P.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 min-w-[200px]",children:[e.jsx("option",{value:"all",children:"-- Select Funding Source --"}),S.map(P=>e.jsx("option",{value:P,children:P},P))]}),e.jsxs("select",{value:m,onChange:P=>f(P.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 min-w-[200px]",children:[e.jsx("option",{value:"all",children:"-- Select Service Area --"}),_.map(P=>e.jsx("option",{value:P,children:P},P))]}),e.jsxs("select",{value:y,onChange:P=>N(P.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 min-w-[200px]",children:[e.jsx("option",{value:"all",children:"-- Select Station Manager --"}),R.map(P=>e.jsx("option",{value:P,children:P},P))]}),e.jsx("button",{onClick:()=>b(k==="grid"?"list":"grid"),className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:k==="grid"?e.jsx(ax,{className:"w-5 h-5"}):e.jsx(sx,{className:"w-5 h-5"})})]})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"flex gap-2 px-4 overflow-x-auto",children:["cancelled","scheduled","assigned","in_progress","completed"].map(P=>e.jsxs("button",{onClick:()=>u(P),className:`px-4 py-3 whitespace-nowrap border-b-2 font-medium transition-colors ${o===P?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[P.split("_").map(V=>V.charAt(0).toUpperCase()+V.slice(1)).join(" "),e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-blue-100 text-blue-600 rounded-full text-xs font-semibold",children:U[P]})]},P))})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:r.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx(xe,{className:"w-16 h-16 mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"No trips found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters"})]}):e.jsx("div",{className:"space-y-3",children:r.map(P=>{var V,D,B,$;return e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow p-4",children:e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-blue-600 text-lg",children:((V=P.patients)==null?void 0:V.full_name)||"Unknown Patient"}),e.jsx("span",{className:"text-sm text-gray-500",children:P.trip_number||P.id.slice(0,8)})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 text-xs rounded font-medium",children:o.charAt(0).toUpperCase()+o.slice(1)}),P.manual_entry&&e.jsx("span",{className:"px-2 py-0.5 bg-gray-600 text-white text-xs rounded font-medium",children:"Manual"}),P.time_updated&&e.jsx("span",{className:"px-2 py-0.5 bg-yellow-600 text-white text-xs rounded font-medium",children:"Time Updated"}),P.service_area&&e.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded",children:P.service_area}),P.funding_source&&e.jsx("span",{className:"px-2 py-0.5 bg-purple-600 text-white text-xs rounded font-medium",children:P.funding_source}),P.county&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-600 text-white text-xs rounded font-medium",children:P.county}),P.space_type==="wheelchair"&&e.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 text-xs rounded",children:"III-B 45"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx(ae,{className:"w-4 h-4 text-green-600 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:P.pickup_address}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(P.scheduled_pickup_time).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-red-600 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:P.dropoff_address}),P.actual_dropoff_time&&e.jsx("p",{className:"text-xs text-gray-500",children:new Date(P.actual_dropoff_time).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"font-medium",children:[((D=P.space_type)==null?void 0:D.toUpperCase())||"AMB"," (",((B=P.space_type)==null?void 0:B.slice(0,3).toUpperCase())||"AMB",")"]})]}),P.distance_miles&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{children:[P.distance_miles," mi"]})]}),(($=P.patients)==null?void 0:$.phone)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:P.patients.phone})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-4 pt-4 border-t border-gray-100",children:[e.jsxs("button",{onClick:()=>{w(P),h(!0)},className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded text-sm font-medium transition-colors flex items-center gap-1",children:[e.jsx(xe,{className:"w-3 h-3"}),"Notes"]}),e.jsxs("button",{onClick:()=>E(P.id),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded text-sm font-medium transition-colors flex items-center gap-1",children:[e.jsx(Oy,{className:"w-3 h-3"}),"Fetch"]}),e.jsxs("button",{onClick:()=>q(P.id),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded text-sm font-medium transition-colors flex items-center gap-1",children:[e.jsx(Se,{className:"w-3 h-3"}),"Loaded Time"]}),e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:()=>Q(P),className:"px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm font-medium transition-colors",children:"Assign"}),e.jsx("button",{onClick:()=>{w(P),h(!0)},className:"px-4 py-1.5 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded text-sm font-medium transition-colors",children:"Details"})]})]})})},P.id)})})}),v&&g&&e.jsx(Ya,{trip:g,onClose:()=>{h(!1),w(null)},onSave:()=>{I(),h(!1),w(null)}})]})}function wb(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(!0),[i,d]=p.useState(""),[o,u]=p.useState("");p.useEffect(()=>{c();const f=T.channel("notifications_changes").on("postgres_changes",{event:"*",schema:"public",table:"notifications"},()=>{c()}).subscribe();return()=>{f.unsubscribe()}},[]),p.useEffect(()=>{x()},[t,i,o]);async function c(){try{const{data:f,error:y}=await T.from("notifications").select(`
          *,
          profiles (
            id,
            full_name,
            email,
            photo_url
          )
        `).order("created_at",{ascending:!1});if(y)throw y;s(f||[])}catch(f){console.error("Error loading notifications:",f)}finally{l(!1)}}function x(){let f=[...t];if(i){const y=i.toLowerCase();f=f.filter(N=>{var k;return N.message.toLowerCase().includes(y)||((k=N.profiles)==null?void 0:k.full_name.toLowerCase().includes(y))})}o&&(f=f.filter(y=>new Date(y.created_at).toISOString().split("T")[0]===o)),a(f)}function m(f){return new Date(f).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading notifications..."})}):e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Notifications"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",r.length," ",r.length===1?"entry":"entries"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:o,onChange:f=>u(f.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx(ge,{className:"w-5 h-5 text-gray-400"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:i,onChange:f=>d(f.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:r.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx("p",{className:"text-lg font-medium",children:"No notifications found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search or filters"})]}):e.jsx("div",{className:"space-y-3",children:r.map(f=>{var y,N;return e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:(y=f.profiles)!=null&&y.photo_url?e.jsx("img",{src:f.profiles.photo_url,alt:f.profiles.full_name,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(ke,{className:"w-6 h-6 text-gray-600"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:((N=f.profiles)==null?void 0:N.full_name)||"Unknown User"}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:f.message}),e.jsx("p",{className:"text-xs text-gray-500",children:m(f.created_at)})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"px-3 py-1 bg-blue-600 text-white text-sm font-medium rounded",children:f.status.charAt(0).toUpperCase()+f.status.slice(1)})})]})},f.id)})})})})]})}function Nb({farmoutTrip:t,onClose:s,onFarmOut:r}){var n,l;const a=t.trips;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Details"}),e.jsxs("div",{className:"flex items-center gap-3",children:[r&&e.jsx("button",{onClick:r,className:"px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg font-medium transition-colors",children:"Farm out"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx(le,{className:"w-6 h-6"})})]})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[e.jsx(ae,{className:"w-5 h-5 text-green-600 mt-1 flex-shrink-0"}),e.jsx("div",{children:e.jsx("p",{className:"font-medium text-gray-900",children:(a==null?void 0:a.pickup_address)||"N/A"})})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{className:"w-5 h-5 text-red-600 mt-1 flex-shrink-0"}),e.jsx("div",{children:e.jsx("p",{className:"font-medium text-gray-900",children:(a==null?void 0:a.dropoff_address)||"N/A"})})]})]}),e.jsx("div",{className:"bg-gray-100 rounded-lg h-64 flex items-center justify-center mb-6",children:e.jsx("p",{className:"text-gray-500",children:"Map View"})}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Cancellation Info"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Cancellation Type"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.cancellation_type||"UNKNOWN"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Time Stamp"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.cancellation_time?new Date(t.cancellation_time).toLocaleString():"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Wait Time Minutes"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.wait_time_minutes||0})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Level of Service Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Vehicle Type"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.vehicle_type||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Product ID"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.product_id||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Vehicle Information"}),e.jsxs("div",{className:"space-y-3",children:[t.vehicle_image_url&&e.jsx("div",{className:"bg-gray-100 rounded h-24 flex items-center justify-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Vehicle Image"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"License Plate"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.license_plate||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Vehicle Color"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.vehicle_color||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Vehicle Make"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.vehicle_make||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Vehicle Model"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.vehicle_model||"N/A"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Fare Estimation"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Value"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.trip_fare?`$${t.trip_fare.toFixed(2)}`:"$N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Currency Code"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"USD"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Other Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Distance"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.distance?`${t.distance} mi`:"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Duration"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.duration||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"General Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Request Id"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.request_id||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Request Time"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:a!=null&&a.scheduled_pickup_time?new Date(a.scheduled_pickup_time).toLocaleString():"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.status.replace("_"," ")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Expense Memo"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.expense_memo||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Is Eligible For Refund"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.is_eligible_for_refund?"Yes":"No"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Passenger Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Passenger Name"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:((n=a==null?void 0:a.patients)==null?void 0:n.full_name)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Phone Number"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:((l=a==null?void 0:a.patients)==null?void 0:l.phone)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Guest ID"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.guest_id||"N/A"})]})]})]}),t.driver_name&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Driver Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Driver Name"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.driver_name})]}),t.driver_phone&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Driver Phone"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.driver_phone})]})]})]}),e.jsx("button",{className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"View Receipt"})]})]})})]})})}function _b(){const[t,s]=p.useState("trips"),[r,a]=p.useState([]),[n,l]=p.useState([]),[i,d]=p.useState(!0),[o,u]=p.useState(""),[c,x]=p.useState(new Date().toISOString().split("T")[0]),[m,f]=p.useState(null),[y,N]=p.useState(!1);p.useEffect(()=>{k();const S=T.channel("farmout_changes").on("postgres_changes",{event:"*",schema:"public",table:"farmout_trips"},()=>{k()}).subscribe();return()=>{S.unsubscribe()}},[]),p.useEffect(()=>{b()},[r,o,c]);async function k(){try{const{data:S,error:j}=await T.from("farmout_trips").select(`
          *,
          trips (
            *,
            patients (*)
          )
        `).order("created_at",{ascending:!1});if(j)throw j;a(S||[])}catch(S){console.error("Error loading farmout trips:",S)}finally{d(!1)}}function b(){let S=[...r];if(o){const j=o.toLowerCase();S=S.filter(_=>{var M,R,O,I;return((M=_.request_id)==null?void 0:M.toLowerCase().includes(j))||((O=(R=_.trips)==null?void 0:R.patients)==null?void 0:O.full_name.toLowerCase().includes(j))||((I=_.driver_name)==null?void 0:I.toLowerCase().includes(j))})}c&&(S=S.filter(j=>new Date(j.created_at).toISOString().split("T")[0]===c)),l(S)}function v(){const S=r.filter(j=>c?new Date(j.created_at).toISOString().split("T")[0]===c:!0);return{total:S.length,inProgress:S.filter(j=>j.status==="processing").length,completed:S.filter(j=>j.status==="completed").length,cancelled:S.filter(j=>j.status==="driver_canceled"||j.status==="rider_canceled").length}}function h(){return r.filter(S=>c?new Date(S.created_at).toISOString().split("T")[0]===c&&S.status==="completed":!0).length}function g(){return r.filter(S=>c?new Date(S.created_at).toISOString().split("T")[0]===c&&S.status==="completed":!0).reduce((S,j)=>S+(j.trip_fare||0),0)}const w=v();return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading farmout trips..."})}):e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex gap-1 px-6",children:[e.jsx("button",{onClick:()=>s("trips"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="trips"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Trips"}),e.jsx("button",{onClick:()=>s("receipts"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="receipts"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Receipts"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:o,onChange:S=>u(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:c,onChange:S=>x(S.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx(ge,{className:"w-5 h-5 text-gray-400"})]})]}),t==="trips"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded flex items-center justify-center",children:e.jsx(xe,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Trips"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.total})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded flex items-center justify-center",children:e.jsx(xe,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Inprogress Trips"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.inProgress})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded flex items-center justify-center",children:e.jsx(xe,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed Trips"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.completed})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded flex items-center justify-center",children:e.jsx(xe,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Cancelled Trips"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.cancelled})]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"(7)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Request ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Requested Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pickup Address"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dropoff Address"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Space Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funding Source"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(S=>{var j,_,M,R,O,I;return e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>{f(S),N(!0)},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(xe,{className:"w-5 h-5 text-gray-400"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.id.slice(0,8)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.request_id||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(j=S.trips)!=null&&j.scheduled_pickup_time?new Date(S.trips.scheduled_pickup_time).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}):"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((M=(_=S.trips)==null?void 0:_.patients)==null?void 0:M.full_name)||"N/A"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:((R=S.trips)==null?void 0:R.pickup_address)||"N/A"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:((O=S.trips)==null?void 0:O.dropoff_address)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.vehicle_type||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((I=S.trips)==null?void 0:I.funding_source)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(S.created_at).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.status.replace("_"," ")})]},S.id)})})]})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded flex items-center justify-center",children:e.jsx(xe,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Receipts"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h()})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded flex items-center justify-center",children:e.jsx(xe,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Fare"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g().toFixed(2)})]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"(5)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Request ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Driver"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Distance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trip Fare"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.filter(S=>S.status==="completed").map(S=>{var j,_,M;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>{f(S),N(!0)},className:"text-blue-600 hover:text-blue-800",children:e.jsx(tr,{className:"w-5 h-5"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.id.slice(0,8)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.request_id||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((_=(j=S.trips)==null?void 0:j.patients)==null?void 0:_.full_name)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.driver_name||"Driver 1"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.distance||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.duration||"00:00:00"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(S.created_at).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",((M=S.trip_fare)==null?void 0:M.toFixed(2))||"0.00"]})]},S.id)})})]})})})]})]}),y&&m&&e.jsx(Nb,{farmoutTrip:m,onClose:()=>{N(!1),f(null)}})]})}const kb=[{value:"scheduled",label:"Unassigned",bgColor:"bg-white"},{value:"assigned",label:"Assigned",bgColor:"bg-green-50"},{value:"in-progress",label:"En Route",bgColor:"bg-blue-50"},{value:"arrived",label:"Arrived",bgColor:"bg-yellow-50"},{value:"completed",label:"In Progress",bgColor:"bg-red-50"},{value:"completed",label:"Completed",bgColor:"bg-blue-50"},{value:"cancelled",label:"Cancelled",bgColor:"bg-gray-50"}];function Sb(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(!0),[i,d]=p.useState(""),[o,u]=p.useState(new Date().toISOString().split("T")[0]),[c,x]=p.useState(["scheduled","assigned","in-progress","arrived"]),[m,f]=p.useState("all"),[y,N]=p.useState("all"),[k,b]=p.useState(!1),[v,h]=p.useState(null),[g,w]=p.useState(!1),[S,j]=p.useState([]),[_,M]=p.useState([]),R=p.useRef(null);p.useEffect(()=>{O(),I();const E=T.channel("manifest_changes").on("postgres_changes",{event:"*",schema:"public",table:"trips"},()=>{O()}).subscribe();return()=>{E.unsubscribe()}},[]),p.useEffect(()=>{A()},[t,i,o,c,m,y]),p.useEffect(()=>{function E(q){R.current&&!R.current.contains(q.target)&&b(!1)}return document.addEventListener("mousedown",E),()=>document.removeEventListener("mousedown",E)},[]);async function O(){try{const{data:E,error:q}=await T.from("trips").select(`
          *,
          patients (*),
          profiles (*)
        `).order("scheduled_pickup_time",{ascending:!0});if(q)throw q;s(E||[]);const C=new Set;E==null||E.forEach(U=>{U.station_manager&&C.add(U.station_manager)}),M(Array.from(C).sort())}catch(E){console.error("Error loading trips:",E)}finally{l(!1)}}async function I(){try{const{data:E,error:q}=await T.from("profiles").select("*").eq("role","driver").order("full_name");if(q)throw q;j(E||[])}catch(E){console.error("Error loading drivers:",E)}}function A(){let E=[...t];if(o&&(E=E.filter(q=>new Date(q.scheduled_pickup_time).toISOString().split("T")[0]===o)),c.length>0&&(E=E.filter(q=>c.includes(q.status))),m!=="all"&&(E=E.filter(q=>q.driver_id===m)),y!=="all"&&(E=E.filter(q=>q.station_manager===y)),i){const q=i.toLowerCase();E=E.filter(C=>{var U;return((U=C.patients)==null?void 0:U.full_name.toLowerCase().includes(q))||C.pickup_address.toLowerCase().includes(q)||C.dropoff_address.toLowerCase().includes(q)})}a(E)}function F(E){c.includes(E)?x(c.filter(q=>q!==E)):x([...c,E])}function Q(E){return new Date(E).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading manifest..."})}):e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-xs",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:i,onChange:E=>d(E.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:o,onChange:E=>u(E.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx(ge,{className:"w-5 h-5 text-gray-400"})]}),e.jsxs("div",{className:"relative",ref:R,children:[e.jsxs("button",{onClick:()=>b(!k),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2 min-w-[150px] justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Status"}),c.length>0&&e.jsx(le,{className:"w-4 h-4 text-gray-500 hover:text-gray-700",onClick:E=>{E.stopPropagation(),x([])}})]}),k&&e.jsx("div",{className:"absolute top-full mt-2 left-0 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[200px]",children:kb.map(E=>e.jsxs("label",{className:`flex items-center gap-2 px-4 py-2 hover:bg-gray-50 cursor-pointer ${E.bgColor}`,children:[e.jsx("input",{type:"checkbox",checked:c.includes(E.value),onChange:()=>F(E.value),className:"w-4 h-4 text-blue-600 rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:E.label})]},E.value+E.label))})]}),e.jsxs("select",{value:m,onChange:E=>f(E.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 min-w-[200px]",children:[e.jsx("option",{value:"all",children:"-- Select Driver --"}),S.map(E=>e.jsx("option",{value:E.id,children:E.full_name},E.id))]}),e.jsxs("select",{value:y,onChange:E=>N(E.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 min-w-[200px]",children:[e.jsx("option",{value:"all",children:"-- Select Station Manager --"}),_.map(E=>e.jsx("option",{value:E,children:E},E))]})]})}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Driver"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Funding Source"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Space Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Patient"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phone No."}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Pick-Up"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Drop-off"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Miles"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Escort"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loaded Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"SP. Rate"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(E=>{var q,C,U;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{h(E),w(!0)},className:"text-blue-600 hover:text-blue-800",children:e.jsx(zt,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:e.jsx(tr,{className:"w-4 h-4"})})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 bg-blue-600 text-white text-xs rounded",children:E.status==="completed"?"Completed":E.status})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:((q=E.profiles)==null?void 0:q.full_name)||"N/A"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:E.funding_source||"N/A"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:E.space_type==="wheelchair"?"WAV (WAV)":"AMB (AMB)"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:E.trip_number||E.id.slice(0,8)}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:new Date(E.scheduled_pickup_time).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:Q(E.scheduled_pickup_time)}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:((C=E.patients)==null?void 0:C.full_name)||"N/A"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:((U=E.patients)==null?void 0:U.phone)||"N/A"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:E.pickup_address}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:E.dropoff_address}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:E.distance_miles||"N/A"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:E.escort_required?"Yes":"No"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:E.loaded_time?Q(E.loaded_time):"N/A"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:"N/A"})]},E.id)})})]})})})}),g&&v&&e.jsx(Ya,{trip:v,onClose:()=>{w(!1),h(null)},onSave:()=>{O(),w(!1),h(null)}})]})}function Cb(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(!0),[i,d]=p.useState(""),[o,u]=p.useState("active"),[c,x]=p.useState(!1),[m,f]=p.useState(null),[y,N]=p.useState({name:"",description:"",level_of_service:"",load_time_minutes:15,unload_time_minutes:15,status:"active"});p.useEffect(()=>{k();const w=T.channel("space_types_changes").on("postgres_changes",{event:"*",schema:"public",table:"space_types"},()=>{k()}).subscribe();return()=>{w.unsubscribe()}},[]),p.useEffect(()=>{b()},[t,i,o]);async function k(){try{const{data:w,error:S}=await T.from("space_types").select("*").order("created_at",{ascending:!1});if(S)throw S;s(w||[])}catch(w){console.error("Error loading space types:",w)}finally{l(!1)}}function b(){let w=[...t];if(o!=="all"&&(w=w.filter(S=>S.status===o)),i){const S=i.toLowerCase();w=w.filter(j=>{var _;return j.name.toLowerCase().includes(S)||((_=j.description)==null?void 0:_.toLowerCase().includes(S))||j.level_of_service.toLowerCase().includes(S)})}a(w)}function v(w){w?(f(w),N({name:w.name,description:w.description||"",level_of_service:w.level_of_service,load_time_minutes:w.load_time_minutes,unload_time_minutes:w.unload_time_minutes,status:w.status})):(f(null),N({name:"",description:"",level_of_service:"",load_time_minutes:15,unload_time_minutes:15,status:"active"})),x(!0)}async function h(w){w.preventDefault();try{if(m){const{error:S}=await T.from("space_types").update({...y,updated_at:new Date().toISOString()}).eq("id",m.id);if(S)throw S}else{const{error:S}=await T.from("space_types").insert([y]);if(S)throw S}x(!1),k()}catch(S){console.error("Error saving space type:",S),alert("Failed to save space type")}}function g(w){const S=Math.floor(w/60),j=w%60;return`${S.toString().padStart(2,"0")}:${j.toString().padStart(2,"0")}`}return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading space types..."})}):e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:()=>v(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Add Space Type"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Showing ",r.length," entries"]}),e.jsxs("select",{value:o,onChange:w=>u(w.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"all",children:"All"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:i,onChange:w=>d(w.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Level Of Service"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Load Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unload Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Created At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(w=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>v(w),className:"text-blue-600 hover:text-blue-800",children:e.jsx(zt,{className:"w-4 h-4"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:w.name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:w.description||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:w.level_of_service}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g(w.load_time_minutes)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g(w.unload_time_minutes)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(w.created_at).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded font-medium ${w.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:w.status.charAt(0).toUpperCase()+w.status.slice(1)})})]},w.id))})]})})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:m?"Edit Space Type":"Add Space Type"})}),e.jsxs("form",{onSubmit:h,className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),e.jsx("input",{type:"text",required:!0,value:y.name,onChange:w=>N({...y,name:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Level Of Service"}),e.jsx("input",{type:"text",required:!0,value:y.level_of_service,onChange:w=>N({...y,level_of_service:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("input",{type:"text",value:y.description,onChange:w=>N({...y,description:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Load Time (minutes)"}),e.jsx("input",{type:"number",min:"0",required:!0,value:y.load_time_minutes,onChange:w=>N({...y,load_time_minutes:parseInt(w.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unload Time (minutes)"}),e.jsx("input",{type:"number",min:"0",required:!0,value:y.unload_time_minutes,onChange:w=>N({...y,unload_time_minutes:parseInt(w.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:y.status,onChange:w=>N({...y,status:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:m?"Update":"Create"})]})]})]})})]})}function Eb(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(!0),[i,d]=p.useState(""),[o,u]=p.useState("active"),[c,x]=p.useState(!1),[m,f]=p.useState(null),[y,N]=p.useState({name:"",description:"",status:"active"});p.useEffect(()=>{k();const g=T.channel("equipments_changes").on("postgres_changes",{event:"*",schema:"public",table:"equipments"},()=>{k()}).subscribe();return()=>{g.unsubscribe()}},[]),p.useEffect(()=>{b()},[t,i,o]);async function k(){try{const{data:g,error:w}=await T.from("equipments").select("*").order("created_at",{ascending:!1});if(w)throw w;s(g||[])}catch(g){console.error("Error loading equipments:",g)}finally{l(!1)}}function b(){let g=[...t];if(o!=="all"&&(g=g.filter(w=>w.status===o)),i){const w=i.toLowerCase();g=g.filter(S=>{var j;return S.name.toLowerCase().includes(w)||((j=S.description)==null?void 0:j.toLowerCase().includes(w))})}a(g)}function v(g){g?(f(g),N({name:g.name,description:g.description||"",status:g.status})):(f(null),N({name:"",description:"",status:"active"})),x(!0)}async function h(g){g.preventDefault();try{if(m){const{error:w}=await T.from("equipments").update({...y,updated_at:new Date().toISOString()}).eq("id",m.id);if(w)throw w}else{const{error:w}=await T.from("equipments").insert([y]);if(w)throw w}x(!1),k()}catch(w){console.error("Error saving equipment:",w),alert("Failed to save equipment")}}return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading equipments..."})}):e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:()=>v(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Add Equipment"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Showing ",r.length," entries"]}),e.jsxs("select",{value:o,onChange:g=>u(g.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"all",children:"All"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:i,onChange:g=>d(g.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Created At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(g=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>v(g),className:"text-blue-600 hover:text-blue-800",children:e.jsx(zt,{className:"w-4 h-4"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:g.name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:g.description||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(g.created_at).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded font-medium ${g.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:g.status.charAt(0).toUpperCase()+g.status.slice(1)})})]},g.id))})]})})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:m?"Edit Equipment":"Add Equipment"})}),e.jsxs("form",{onSubmit:h,className:"p-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),e.jsx("input",{type:"text",required:!0,value:y.name,onChange:g=>N({...y,name:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:y.description,onChange:g=>N({...y,description:g.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:y.status,onChange:g=>N({...y,status:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:m?"Update":"Create"})]})]})]})})]})}function Tb(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(!0),[i,d]=p.useState(""),[o,u]=p.useState("active"),[c,x]=p.useState(!1),[m,f]=p.useState(null),[y,N]=p.useState({name:"",zip_codes:"",status:"active"});p.useEffect(()=>{k();const g=T.channel("service_areas_changes").on("postgres_changes",{event:"*",schema:"public",table:"service_areas"},()=>{k()}).subscribe();return()=>{g.unsubscribe()}},[]),p.useEffect(()=>{b()},[t,i,o]);async function k(){try{const{data:g,error:w}=await T.from("service_areas").select("*").order("created_at",{ascending:!1});if(w)throw w;s(g||[])}catch(g){console.error("Error loading service areas:",g)}finally{l(!1)}}function b(){let g=[...t];if(o!=="all"&&(g=g.filter(w=>w.status===o)),i){const w=i.toLowerCase();g=g.filter(S=>S.name.toLowerCase().includes(w)||S.zip_codes.some(j=>j.includes(w)))}a(g)}function v(g){g?(f(g),N({name:g.name,zip_codes:g.zip_codes.join(","),status:g.status})):(f(null),N({name:"",zip_codes:"",status:"active"})),x(!0)}async function h(g){g.preventDefault();try{const w=y.zip_codes.split(",").map(j=>j.trim()).filter(j=>j.length>0),S={name:y.name,zip_codes:w,status:y.status};if(m){const{error:j}=await T.from("service_areas").update({...S,updated_at:new Date().toISOString()}).eq("id",m.id);if(j)throw j}else{const{error:j}=await T.from("service_areas").insert([S]);if(j)throw j}x(!1),k()}catch(w){console.error("Error saving service area:",w),alert("Failed to save service area")}}return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading service areas..."})}):e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:()=>v(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Add Service Area"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Showing ",r.length," entries"]}),e.jsxs("select",{value:o,onChange:g=>u(g.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"all",children:"All"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:i,onChange:g=>d(g.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Zip Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(g=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>v(g),className:"text-blue-600 hover:text-blue-800",children:e.jsx(zt,{className:"w-4 h-4"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:g.name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:e.jsx("div",{className:"max-w-2xl",children:g.zip_codes.length>0?g.zip_codes.slice(0,20).join(", ")+(g.zip_codes.length>20?`... (+${g.zip_codes.length-20} more)`:""):"No zip codes"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded font-medium ${g.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:g.status.charAt(0).toUpperCase()+g.status.slice(1)})})]},g.id))})]})})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:m?"Edit Service Area":"Add Service Area"})}),e.jsxs("form",{onSubmit:h,className:"p-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),e.jsx("input",{type:"text",required:!0,value:y.name,onChange:g=>N({...y,name:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Zip Codes (comma-separated)"}),e.jsx("textarea",{value:y.zip_codes,onChange:g=>N({...y,zip_codes:g.target.value}),rows:4,placeholder:"79821,79836,79838,79849,79853,79901,79902...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Enter zip codes separated by commas"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:y.status,onChange:g=>N({...y,status:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:m?"Update":"Create"})]})]})]})})]})}function Ab(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState([]),[i,d]=p.useState([]),[o,u]=p.useState([]),[c,x]=p.useState(!0),[m,f]=p.useState(""),[y,N]=p.useState(!1),[k,b]=p.useState(null),[v,h]=p.useState({vehicle_id:"",space_type_id:"",equipment_ids:[]});p.useEffect(()=>{g();const A=T.channel("equipment_planning_changes").on("postgres_changes",{event:"*",schema:"public",table:"vehicle_equipment_planning"},()=>{_()}).subscribe();return()=>{A.unsubscribe()}},[]),p.useEffect(()=>{M()},[t,m]);async function g(){await Promise.all([w(),S(),j(),_()]),x(!1)}async function w(){try{const{data:A,error:F}=await T.from("vehicles").select("id, vehicle_number, vehicle_name, make, model").eq("status","active").order("vehicle_name");if(F)throw F;l(A||[])}catch(A){console.error("Error loading vehicles:",A)}}async function S(){try{const{data:A,error:F}=await T.from("space_types").select("id, name").eq("status","active").order("name");if(F)throw F;d(A||[])}catch(A){console.error("Error loading space types:",A)}}async function j(){try{const{data:A,error:F}=await T.from("equipments").select("id, name").eq("status","active").order("name");if(F)throw F;u(A||[])}catch(A){console.error("Error loading equipments:",A)}}async function _(){try{const{data:A,error:F}=await T.from("vehicle_equipment_planning").select(`
          *,
          vehicles (vehicle_number, vehicle_name, make, model),
          space_types (name)
        `).order("created_at",{ascending:!1});if(F)throw F;s(A||[])}catch(A){console.error("Error loading vehicle equipment planning:",A)}}function M(){let A=[...t];if(m){const F=m.toLowerCase();A=A.filter(Q=>{var E,q,C,U,P,V;return((q=(E=Q.vehicles)==null?void 0:E.vehicle_name)==null?void 0:q.toLowerCase().includes(F))||((U=(C=Q.vehicles)==null?void 0:C.vehicle_number)==null?void 0:U.toLowerCase().includes(F))||((V=(P=Q.space_types)==null?void 0:P.name)==null?void 0:V.toLowerCase().includes(F))})}a(A)}function R(A){A?(b(A),h({vehicle_id:A.vehicle_id,space_type_id:A.space_type_id||"",equipment_ids:A.equipment_ids||[]})):(b(null),h({vehicle_id:"",space_type_id:"",equipment_ids:[]})),N(!0)}async function O(A){A.preventDefault();try{if(k){const{error:F}=await T.from("vehicle_equipment_planning").update({...v,updated_at:new Date().toISOString()}).eq("id",k.id);if(F)throw F}else{const{error:F}=await T.from("vehicle_equipment_planning").insert([v]);if(F)throw F}N(!1),_()}catch(F){console.error("Error saving equipment planning:",F),alert("Failed to save equipment planning")}}function I(A){h(F=>({...F,equipment_ids:F.equipment_ids.includes(A)?F.equipment_ids.filter(Q=>Q!==A):[...F.equipment_ids,A]}))}return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading equipment planning..."})}):e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",r.length," entries"]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:m,onChange:A=>f(A.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rig#"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Space Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rig Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"HHT-Driver App"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"NEMT MAX APP"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(A=>{var F,Q,E,q;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:((F=A.vehicles)==null?void 0:F.vehicle_number)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((Q=A.space_types)==null?void 0:Q.name)||"N/A"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:A.vehicles?`${A.vehicles.make} ${A.vehicles.model}`:"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(E=A.equipment_ids)!=null&&E.some(C=>o.find(U=>U.id===C&&U.name==="HHT-Driver App"))?e.jsx("button",{onClick:()=>R(A),className:"text-blue-600 hover:text-blue-800",children:e.jsx(zt,{className:"w-4 h-4"})}):""}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(q=A.equipment_ids)!=null&&q.some(C=>o.find(U=>U.id===C&&U.name==="NEMT MAX APP"))?e.jsx("button",{onClick:()=>R(A),className:"text-blue-600 hover:text-blue-800",children:e.jsx(zt,{className:"w-4 h-4"})}):""})]},A.id)})})]})})]}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:k?"Edit Equipment Planning":"Add Equipment Planning"})}),e.jsxs("form",{onSubmit:O,className:"p-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vehicle"}),e.jsxs("select",{required:!0,disabled:!!k,value:v.vehicle_id,onChange:A=>h({...v,vehicle_id:A.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:"Select Vehicle"}),n.map(A=>e.jsxs("option",{value:A.id,children:[A.vehicle_number," - ",A.vehicle_name]},A.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Space Type"}),e.jsxs("select",{value:v.space_type_id,onChange:A=>h({...v,space_type_id:A.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Space Type"}),i.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Equipments"}),e.jsx("div",{className:"space-y-2",children:o.map(A=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:v.equipment_ids.includes(A.id),onChange:()=>I(A.id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-900",children:A.name})]},A.id))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>N(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:k?"Update":"Create"})]})]})]})})]})}function Pb({fundingSource:t,onClose:s}){const[r,a]=p.useState({name:"",display_name:"",email:"",address:"",contact_number:"",toll_free_number:"",priority:0,billing_name:"",mailing_address:"",odometer:"",code:"",insurance:"",select_broker:"",broker_id:"",time_mode:"Both",status:"active"}),[n,l]=p.useState(!1),[i,d]=p.useState("");p.useEffect(()=>{t&&a({name:t.name||"",display_name:t.display_name||"",email:t.email||"",address:t.address||"",contact_number:t.contact_number||"",toll_free_number:t.toll_free_number||"",priority:t.priority||0,billing_name:t.billing_name||"",mailing_address:t.mailing_address||"",odometer:t.odometer||"",code:t.code||"",insurance:t.insurance||"",select_broker:t.select_broker||"",broker_id:t.broker_id||"",time_mode:t.time_mode||"Both",status:t.status||"active"})},[t]);const o=async u=>{u.preventDefault(),l(!0),d("");try{const c={...r,odometer:r.odometer?parseFloat(r.odometer):null};if(t){const{error:x}=await T.from("funding_sources").update({...c,updated_at:new Date().toISOString()}).eq("id",t.id);if(x)throw x}else{const{error:x}=await T.from("funding_sources").insert([c]);if(x)throw x}s()}catch(c){c instanceof Error?d(c.message):d("Failed to save funding source")}finally{l(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-blue-600 text-white p-6 flex items-center justify-between rounded-t-xl",children:[e.jsx("h2",{className:"text-xl font-bold",children:t?"Edit Funding Source":"Add Funding Source"}),e.jsx("button",{onClick:s,className:"text-white hover:text-gray-200 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:o,className:"p-6",children:[i&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:i}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:r.name,onChange:u=>a({...r,name:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Code"}),e.jsx("input",{type:"text",value:r.code,onChange:u=>a({...r,code:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Unique code"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:r.email,onChange:u=>a({...r,email:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"email@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Number"}),e.jsx("input",{type:"text",value:r.contact_number,onChange:u=>a({...r,contact_number:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Toll-Free Number"}),e.jsx("input",{type:"text",value:r.toll_free_number,onChange:u=>a({...r,toll_free_number:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"1-800-000-0000"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("textarea",{value:r.address,onChange:u=>a({...r,address:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Street address, City, State, ZIP",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Insurance"}),e.jsx("input",{type:"text",value:r.insurance,onChange:u=>a({...r,insurance:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Insurance Provider"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Name"}),e.jsx("input",{type:"text",value:r.display_name,onChange:u=>a({...r,display_name:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter display name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsx("input",{type:"number",value:r.priority,onChange:u=>a({...r,priority:parseInt(u.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Billing Name"}),e.jsx("input",{type:"text",value:r.billing_name,onChange:u=>a({...r,billing_name:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter billing name"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mailing Address"}),e.jsx("textarea",{value:r.mailing_address,onChange:u=>a({...r,mailing_address:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter mailing address",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Broker"}),e.jsx("input",{type:"text",value:r.select_broker,onChange:u=>a({...r,select_broker:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Select broker"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Broker ID"}),e.jsx("input",{type:"text",value:r.broker_id,onChange:u=>a({...r,broker_id:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter broker ID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Mode"}),e.jsxs("select",{value:r.time_mode,onChange:u=>a({...r,time_mode:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"Both",children:"Both"}),e.jsx("option",{value:"Pickup Only",children:"Pickup Only"}),e.jsx("option",{value:"Dropoff Only",children:"Dropoff Only"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:r.status,onChange:u=>a({...r,status:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:s,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:n,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(sr,{className:"w-4 h-4"}),n?"Saving...":"Save"]})]})]})]})})}function Mb(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(!0),[i,d]=p.useState(""),[o,u]=p.useState("active"),[c,x]=p.useState("list"),[m,f]=p.useState(!1),[y,N]=p.useState(null);p.useEffect(()=>{k();const g=T.channel("funding_sources_changes").on("postgres_changes",{event:"*",schema:"public",table:"funding_sources"},()=>{k()}).subscribe();return()=>{g.unsubscribe()}},[]),p.useEffect(()=>{b()},[t,i,o]);async function k(){try{const{data:g,error:w}=await T.from("funding_sources").select("*").order("name",{ascending:!0});if(w)throw w;s(g||[])}catch(g){console.error("Error loading funding sources:",g)}finally{l(!1)}}function b(){let g=[...t];if(o!=="all"&&(g=g.filter(w=>w.status===o)),i){const w=i.toLowerCase();g=g.filter(S=>{var j,_,M,R,O;return((j=S.name)==null?void 0:j.toLowerCase().includes(w))||((_=S.display_name)==null?void 0:_.toLowerCase().includes(w))||((M=S.email)==null?void 0:M.toLowerCase().includes(w))||((R=S.address)==null?void 0:R.toLowerCase().includes(w))||((O=S.code)==null?void 0:O.toLowerCase().includes(w))})}a(g)}function v(g){N(g),f(!0)}function h(){N(null),f(!0)}return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading funding sources..."})}):e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[e.jsxs("div",{className:"bg-white p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:h,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center gap-2 transition-colors",children:[e.jsx(re,{className:"w-5 h-5"}),"Add Funding Source"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Showing ",r.length," entries"]}),e.jsxs("select",{value:o,onChange:g=>u(g.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"all",children:"All"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search",value:i,onChange:g=>d(g.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64 text-sm"})]}),e.jsxs("div",{className:"flex bg-blue-600 rounded-lg overflow-hidden",children:[e.jsx("button",{onClick:()=>x("list"),className:`px-4 py-2 text-sm font-medium transition-colors ${c==="list"?"bg-blue-600 text-white":"bg-white text-blue-600"}`,children:"List"}),e.jsx("button",{onClick:()=>x("mapper"),className:`px-4 py-2 text-sm font-medium transition-colors ${c==="mapper"?"bg-blue-600 text-white":"bg-white text-blue-600"}`,children:"Mapper"})]})]})]}),c==="list"?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"Actions"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"Address"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"Contact No."}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"Odometer"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"Insurance"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(g=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("button",{onClick:()=>v(g),className:"p-1.5 hover:bg-blue-50 rounded transition-colors",title:"Edit",children:e.jsx(zt,{className:"w-4 h-4 text-blue-600"})})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:g.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:g.name}),g.email&&e.jsx("p",{className:"text-xs text-gray-500",children:g.email})]})]})}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-700",children:g.address||"N/A"}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-700",children:g.contact_number||"N/A"}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-700",children:g.odometer||"N/A"}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-700",children:g.code||"N/A"}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-700",children:g.insurance||"N/A"}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${g.status==="active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:g.status==="active"?"Active":"Inactive"})})]},g.id))})]}),r.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx("p",{className:"text-lg font-medium",children:"No funding sources found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters or add a new funding source"})]})]}):e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-8",children:e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx(Hy,{className:"w-16 h-16 mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"Mapper View"}),e.jsx("p",{className:"text-sm",children:"This view is under development"})]})})]}),m&&e.jsx(Pb,{fundingSource:y,onClose:()=>{f(!1),N(null),k()}})]})}var Db=Object.defineProperty,xl=Object.getOwnPropertySymbols,gx=Object.prototype.hasOwnProperty,yx=Object.prototype.propertyIsEnumerable,xu=(t,s,r)=>s in t?Db(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,Co=(t,s)=>{for(var r in s||(s={}))gx.call(s,r)&&xu(t,r,s[r]);if(xl)for(var r of xl(s))yx.call(s,r)&&xu(t,r,s[r]);return t},Eo=(t,s)=>{var r={};for(var a in t)gx.call(t,a)&&s.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&xl)for(var a of xl(t))s.indexOf(a)<0&&yx.call(t,a)&&(r[a]=t[a]);return r};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Ks;(t=>{const s=class ee{constructor(o,u,c,x){if(this.version=o,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],o<ee.MIN_VERSION||o>ee.MAX_VERSION)throw new RangeError("Version value out of range");if(x<-1||x>7)throw new RangeError("Mask value out of range");this.size=o*4+17;let m=[];for(let y=0;y<this.size;y++)m.push(!1);for(let y=0;y<this.size;y++)this.modules.push(m.slice()),this.isFunction.push(m.slice());this.drawFunctionPatterns();const f=this.addEccAndInterleave(c);if(this.drawCodewords(f),x==-1){let y=1e9;for(let N=0;N<8;N++){this.applyMask(N),this.drawFormatBits(N);const k=this.getPenaltyScore();k<y&&(x=N,y=k),this.applyMask(N)}}n(0<=x&&x<=7),this.mask=x,this.applyMask(x),this.drawFormatBits(x),this.isFunction=[]}static encodeText(o,u){const c=t.QrSegment.makeSegments(o);return ee.encodeSegments(c,u)}static encodeBinary(o,u){const c=t.QrSegment.makeBytes(o);return ee.encodeSegments([c],u)}static encodeSegments(o,u,c=1,x=40,m=-1,f=!0){if(!(ee.MIN_VERSION<=c&&c<=x&&x<=ee.MAX_VERSION)||m<-1||m>7)throw new RangeError("Invalid value");let y,N;for(y=c;;y++){const h=ee.getNumDataCodewords(y,u)*8,g=i.getTotalBits(o,y);if(g<=h){N=g;break}if(y>=x)throw new RangeError("Data too long")}for(const h of[ee.Ecc.MEDIUM,ee.Ecc.QUARTILE,ee.Ecc.HIGH])f&&N<=ee.getNumDataCodewords(y,h)*8&&(u=h);let k=[];for(const h of o){r(h.mode.modeBits,4,k),r(h.numChars,h.mode.numCharCountBits(y),k);for(const g of h.getData())k.push(g)}n(k.length==N);const b=ee.getNumDataCodewords(y,u)*8;n(k.length<=b),r(0,Math.min(4,b-k.length),k),r(0,(8-k.length%8)%8,k),n(k.length%8==0);for(let h=236;k.length<b;h^=253)r(h,8,k);let v=[];for(;v.length*8<k.length;)v.push(0);return k.forEach((h,g)=>v[g>>>3]|=h<<7-(g&7)),new ee(y,u,v,m)}getModule(o,u){return 0<=o&&o<this.size&&0<=u&&u<this.size&&this.modules[u][o]}getModules(){return this.modules}drawFunctionPatterns(){for(let c=0;c<this.size;c++)this.setFunctionModule(6,c,c%2==0),this.setFunctionModule(c,6,c%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const o=this.getAlignmentPatternPositions(),u=o.length;for(let c=0;c<u;c++)for(let x=0;x<u;x++)c==0&&x==0||c==0&&x==u-1||c==u-1&&x==0||this.drawAlignmentPattern(o[c],o[x]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(o){const u=this.errorCorrectionLevel.formatBits<<3|o;let c=u;for(let m=0;m<10;m++)c=c<<1^(c>>>9)*1335;const x=(u<<10|c)^21522;n(x>>>15==0);for(let m=0;m<=5;m++)this.setFunctionModule(8,m,a(x,m));this.setFunctionModule(8,7,a(x,6)),this.setFunctionModule(8,8,a(x,7)),this.setFunctionModule(7,8,a(x,8));for(let m=9;m<15;m++)this.setFunctionModule(14-m,8,a(x,m));for(let m=0;m<8;m++)this.setFunctionModule(this.size-1-m,8,a(x,m));for(let m=8;m<15;m++)this.setFunctionModule(8,this.size-15+m,a(x,m));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let o=this.version;for(let c=0;c<12;c++)o=o<<1^(o>>>11)*7973;const u=this.version<<12|o;n(u>>>18==0);for(let c=0;c<18;c++){const x=a(u,c),m=this.size-11+c%3,f=Math.floor(c/3);this.setFunctionModule(m,f,x),this.setFunctionModule(f,m,x)}}drawFinderPattern(o,u){for(let c=-4;c<=4;c++)for(let x=-4;x<=4;x++){const m=Math.max(Math.abs(x),Math.abs(c)),f=o+x,y=u+c;0<=f&&f<this.size&&0<=y&&y<this.size&&this.setFunctionModule(f,y,m!=2&&m!=4)}}drawAlignmentPattern(o,u){for(let c=-2;c<=2;c++)for(let x=-2;x<=2;x++)this.setFunctionModule(o+x,u+c,Math.max(Math.abs(x),Math.abs(c))!=1)}setFunctionModule(o,u,c){this.modules[u][o]=c,this.isFunction[u][o]=!0}addEccAndInterleave(o){const u=this.version,c=this.errorCorrectionLevel;if(o.length!=ee.getNumDataCodewords(u,c))throw new RangeError("Invalid argument");const x=ee.NUM_ERROR_CORRECTION_BLOCKS[c.ordinal][u],m=ee.ECC_CODEWORDS_PER_BLOCK[c.ordinal][u],f=Math.floor(ee.getNumRawDataModules(u)/8),y=x-f%x,N=Math.floor(f/x);let k=[];const b=ee.reedSolomonComputeDivisor(m);for(let h=0,g=0;h<x;h++){let w=o.slice(g,g+N-m+(h<y?0:1));g+=w.length;const S=ee.reedSolomonComputeRemainder(w,b);h<y&&w.push(0),k.push(w.concat(S))}let v=[];for(let h=0;h<k[0].length;h++)k.forEach((g,w)=>{(h!=N-m||w>=y)&&v.push(g[h])});return n(v.length==f),v}drawCodewords(o){if(o.length!=Math.floor(ee.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let c=this.size-1;c>=1;c-=2){c==6&&(c=5);for(let x=0;x<this.size;x++)for(let m=0;m<2;m++){const f=c-m,N=(c+1&2)==0?this.size-1-x:x;!this.isFunction[N][f]&&u<o.length*8&&(this.modules[N][f]=a(o[u>>>3],7-(u&7)),u++)}}n(u==o.length*8)}applyMask(o){if(o<0||o>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let c=0;c<this.size;c++){let x;switch(o){case 0:x=(c+u)%2==0;break;case 1:x=u%2==0;break;case 2:x=c%3==0;break;case 3:x=(c+u)%3==0;break;case 4:x=(Math.floor(c/3)+Math.floor(u/2))%2==0;break;case 5:x=c*u%2+c*u%3==0;break;case 6:x=(c*u%2+c*u%3)%2==0;break;case 7:x=((c+u)%2+c*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][c]&&x&&(this.modules[u][c]=!this.modules[u][c])}}getPenaltyScore(){let o=0;for(let m=0;m<this.size;m++){let f=!1,y=0,N=[0,0,0,0,0,0,0];for(let k=0;k<this.size;k++)this.modules[m][k]==f?(y++,y==5?o+=ee.PENALTY_N1:y>5&&o++):(this.finderPenaltyAddHistory(y,N),f||(o+=this.finderPenaltyCountPatterns(N)*ee.PENALTY_N3),f=this.modules[m][k],y=1);o+=this.finderPenaltyTerminateAndCount(f,y,N)*ee.PENALTY_N3}for(let m=0;m<this.size;m++){let f=!1,y=0,N=[0,0,0,0,0,0,0];for(let k=0;k<this.size;k++)this.modules[k][m]==f?(y++,y==5?o+=ee.PENALTY_N1:y>5&&o++):(this.finderPenaltyAddHistory(y,N),f||(o+=this.finderPenaltyCountPatterns(N)*ee.PENALTY_N3),f=this.modules[k][m],y=1);o+=this.finderPenaltyTerminateAndCount(f,y,N)*ee.PENALTY_N3}for(let m=0;m<this.size-1;m++)for(let f=0;f<this.size-1;f++){const y=this.modules[m][f];y==this.modules[m][f+1]&&y==this.modules[m+1][f]&&y==this.modules[m+1][f+1]&&(o+=ee.PENALTY_N2)}let u=0;for(const m of this.modules)u=m.reduce((f,y)=>f+(y?1:0),u);const c=this.size*this.size,x=Math.ceil(Math.abs(u*20-c*10)/c)-1;return n(0<=x&&x<=9),o+=x*ee.PENALTY_N4,n(0<=o&&o<=2568888),o}getAlignmentPatternPositions(){if(this.version==1)return[];{const o=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(o*2-2))*2;let c=[6];for(let x=this.size-7;c.length<o;x-=u)c.splice(1,0,x);return c}}static getNumRawDataModules(o){if(o<ee.MIN_VERSION||o>ee.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*o+128)*o+64;if(o>=2){const c=Math.floor(o/7)+2;u-=(25*c-10)*c-55,o>=7&&(u-=36)}return n(208<=u&&u<=29648),u}static getNumDataCodewords(o,u){return Math.floor(ee.getNumRawDataModules(o)/8)-ee.ECC_CODEWORDS_PER_BLOCK[u.ordinal][o]*ee.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][o]}static reedSolomonComputeDivisor(o){if(o<1||o>255)throw new RangeError("Degree out of range");let u=[];for(let x=0;x<o-1;x++)u.push(0);u.push(1);let c=1;for(let x=0;x<o;x++){for(let m=0;m<u.length;m++)u[m]=ee.reedSolomonMultiply(u[m],c),m+1<u.length&&(u[m]^=u[m+1]);c=ee.reedSolomonMultiply(c,2)}return u}static reedSolomonComputeRemainder(o,u){let c=u.map(x=>0);for(const x of o){const m=x^c.shift();c.push(0),u.forEach((f,y)=>c[y]^=ee.reedSolomonMultiply(f,m))}return c}static reedSolomonMultiply(o,u){if(o>>>8||u>>>8)throw new RangeError("Byte out of range");let c=0;for(let x=7;x>=0;x--)c=c<<1^(c>>>7)*285,c^=(u>>>x&1)*o;return n(c>>>8==0),c}finderPenaltyCountPatterns(o){const u=o[1];n(u<=this.size*3);const c=u>0&&o[2]==u&&o[3]==u*3&&o[4]==u&&o[5]==u;return(c&&o[0]>=u*4&&o[6]>=u?1:0)+(c&&o[6]>=u*4&&o[0]>=u?1:0)}finderPenaltyTerminateAndCount(o,u,c){return o&&(this.finderPenaltyAddHistory(u,c),u=0),u+=this.size,this.finderPenaltyAddHistory(u,c),this.finderPenaltyCountPatterns(c)}finderPenaltyAddHistory(o,u){u[0]==0&&(o+=this.size),u.pop(),u.unshift(o)}};s.MIN_VERSION=1,s.MAX_VERSION=40,s.PENALTY_N1=3,s.PENALTY_N2=3,s.PENALTY_N3=40,s.PENALTY_N4=10,s.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],s.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=s;function r(d,o,u){if(o<0||o>31||d>>>o)throw new RangeError("Value out of range");for(let c=o-1;c>=0;c--)u.push(d>>>c&1)}function a(d,o){return(d>>>o&1)!=0}function n(d){if(!d)throw new Error("Assertion error")}const l=class Ne{constructor(o,u,c){if(this.mode=o,this.numChars=u,this.bitData=c,u<0)throw new RangeError("Invalid argument");this.bitData=c.slice()}static makeBytes(o){let u=[];for(const c of o)r(c,8,u);return new Ne(Ne.Mode.BYTE,o.length,u)}static makeNumeric(o){if(!Ne.isNumeric(o))throw new RangeError("String contains non-numeric characters");let u=[];for(let c=0;c<o.length;){const x=Math.min(o.length-c,3);r(parseInt(o.substring(c,c+x),10),x*3+1,u),c+=x}return new Ne(Ne.Mode.NUMERIC,o.length,u)}static makeAlphanumeric(o){if(!Ne.isAlphanumeric(o))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],c;for(c=0;c+2<=o.length;c+=2){let x=Ne.ALPHANUMERIC_CHARSET.indexOf(o.charAt(c))*45;x+=Ne.ALPHANUMERIC_CHARSET.indexOf(o.charAt(c+1)),r(x,11,u)}return c<o.length&&r(Ne.ALPHANUMERIC_CHARSET.indexOf(o.charAt(c)),6,u),new Ne(Ne.Mode.ALPHANUMERIC,o.length,u)}static makeSegments(o){return o==""?[]:Ne.isNumeric(o)?[Ne.makeNumeric(o)]:Ne.isAlphanumeric(o)?[Ne.makeAlphanumeric(o)]:[Ne.makeBytes(Ne.toUtf8ByteArray(o))]}static makeEci(o){let u=[];if(o<0)throw new RangeError("ECI assignment value out of range");if(o<128)r(o,8,u);else if(o<16384)r(2,2,u),r(o,14,u);else if(o<1e6)r(6,3,u),r(o,21,u);else throw new RangeError("ECI assignment value out of range");return new Ne(Ne.Mode.ECI,0,u)}static isNumeric(o){return Ne.NUMERIC_REGEX.test(o)}static isAlphanumeric(o){return Ne.ALPHANUMERIC_REGEX.test(o)}getData(){return this.bitData.slice()}static getTotalBits(o,u){let c=0;for(const x of o){const m=x.mode.numCharCountBits(u);if(x.numChars>=1<<m)return 1/0;c+=4+m+x.bitData.length}return c}static toUtf8ByteArray(o){o=encodeURI(o);let u=[];for(let c=0;c<o.length;c++)o.charAt(c)!="%"?u.push(o.charCodeAt(c)):(u.push(parseInt(o.substring(c+1,c+3),16)),c+=2);return u}};l.NUMERIC_REGEX=/^[0-9]*$/,l.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,l.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let i=l;t.QrSegment=l})(Ks||(Ks={}));(t=>{(s=>{const r=class{constructor(n,l){this.ordinal=n,this.formatBits=l}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),s.Ecc=r})(t.QrCode||(t.QrCode={}))})(Ks||(Ks={}));(t=>{(s=>{const r=class{constructor(n,l){this.modeBits=n,this.numBitsCharCount=l}numCharCountBits(n){return this.numBitsCharCount[Math.floor((n+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),s.Mode=r})(t.QrSegment||(t.QrSegment={}))})(Ks||(Ks={}));var _r=Ks;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Ib={L:_r.QrCode.Ecc.LOW,M:_r.QrCode.Ecc.MEDIUM,Q:_r.QrCode.Ecc.QUARTILE,H:_r.QrCode.Ecc.HIGH},bx=128,vx="L",jx="#FFFFFF",wx="#000000",Nx=!1,_x=1,Lb=4,Rb=0,Ob=.1;function kx(t,s=0){const r=[];return t.forEach(function(a,n){let l=null;a.forEach(function(i,d){if(!i&&l!==null){r.push(`M${l+s} ${n+s}h${d-l}v1H${l+s}z`),l=null;return}if(d===a.length-1){if(!i)return;l===null?r.push(`M${d+s},${n+s} h1v1H${d+s}z`):r.push(`M${l+s},${n+s} h${d+1-l}v1H${l+s}z`);return}i&&l===null&&(l=d)})}),r.join("")}function Sx(t,s){return t.slice().map((r,a)=>a<s.y||a>=s.y+s.h?r:r.map((n,l)=>l<s.x||l>=s.x+s.w?n:!1))}function $b(t,s,r,a){if(a==null)return null;const n=t.length+r*2,l=Math.floor(s*Ob),i=n/s,d=(a.width||l)*i,o=(a.height||l)*i,u=a.x==null?t.length/2-d/2:a.x*i,c=a.y==null?t.length/2-o/2:a.y*i,x=a.opacity==null?1:a.opacity;let m=null;if(a.excavate){let y=Math.floor(u),N=Math.floor(c),k=Math.ceil(d+u-y),b=Math.ceil(o+c-N);m={x:y,y:N,w:k,h:b}}const f=a.crossOrigin;return{x:u,y:c,h:o,w:d,excavation:m,opacity:x,crossOrigin:f}}function Fb(t,s){return s!=null?Math.max(Math.floor(s),0):t?Lb:Rb}function Cx({value:t,level:s,minVersion:r,includeMargin:a,marginSize:n,imageSettings:l,size:i,boostLevel:d}){let o=De.useMemo(()=>{const y=(Array.isArray(t)?t:[t]).reduce((N,k)=>(N.push(..._r.QrSegment.makeSegments(k)),N),[]);return _r.QrCode.encodeSegments(y,Ib[s],r,void 0,void 0,d)},[t,s,r,d]);const{cells:u,margin:c,numCells:x,calculatedImageSettings:m}=De.useMemo(()=>{let f=o.getModules();const y=Fb(a,n),N=f.length+y*2,k=$b(f,i,y,l);return{cells:f,margin:y,numCells:N,calculatedImageSettings:k}},[o,i,l,a,n]);return{qrcode:o,margin:c,cells:u,numCells:x,calculatedImageSettings:m}}var Ub=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),zb=De.forwardRef(function(s,r){const a=s,{value:n,size:l=bx,level:i=vx,bgColor:d=jx,fgColor:o=wx,includeMargin:u=Nx,minVersion:c=_x,boostLevel:x,marginSize:m,imageSettings:f}=a,N=Eo(a,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:k}=N,b=Eo(N,["style"]),v=f==null?void 0:f.src,h=De.useRef(null),g=De.useRef(null),w=De.useCallback(F=>{h.current=F,typeof r=="function"?r(F):r&&(r.current=F)},[r]),[S,j]=De.useState(!1),{margin:_,cells:M,numCells:R,calculatedImageSettings:O}=Cx({value:n,level:i,minVersion:c,boostLevel:x,includeMargin:u,marginSize:m,imageSettings:f,size:l});De.useEffect(()=>{if(h.current!=null){const F=h.current,Q=F.getContext("2d");if(!Q)return;let E=M;const q=g.current,C=O!=null&&q!==null&&q.complete&&q.naturalHeight!==0&&q.naturalWidth!==0;C&&O.excavation!=null&&(E=Sx(M,O.excavation));const U=window.devicePixelRatio||1;F.height=F.width=l*U;const P=l/R*U;Q.scale(P,P),Q.fillStyle=d,Q.fillRect(0,0,R,R),Q.fillStyle=o,Ub?Q.fill(new Path2D(kx(E,_))):M.forEach(function(V,D){V.forEach(function(B,$){B&&Q.fillRect($+_,D+_,1,1)})}),O&&(Q.globalAlpha=O.opacity),C&&Q.drawImage(q,O.x+_,O.y+_,O.w,O.h)}}),De.useEffect(()=>{j(!1)},[v]);const I=Co({height:l,width:l},k);let A=null;return v!=null&&(A=De.createElement("img",{src:v,key:v,style:{display:"none"},onLoad:()=>{j(!0)},ref:g,crossOrigin:O==null?void 0:O.crossOrigin})),De.createElement(De.Fragment,null,De.createElement("canvas",Co({style:I,height:l,width:l,ref:w,role:"img"},b)),A)});zb.displayName="QRCodeCanvas";var Ex=De.forwardRef(function(s,r){const a=s,{value:n,size:l=bx,level:i=vx,bgColor:d=jx,fgColor:o=wx,includeMargin:u=Nx,minVersion:c=_x,boostLevel:x,title:m,marginSize:f,imageSettings:y}=a,N=Eo(a,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:k,cells:b,numCells:v,calculatedImageSettings:h}=Cx({value:n,level:i,minVersion:c,boostLevel:x,includeMargin:u,marginSize:f,imageSettings:y,size:l});let g=b,w=null;y!=null&&h!=null&&(h.excavation!=null&&(g=Sx(b,h.excavation)),w=De.createElement("image",{href:y.src,height:h.h,width:h.w,x:h.x+k,y:h.y+k,preserveAspectRatio:"none",opacity:h.opacity,crossOrigin:h.crossOrigin}));const S=kx(g,k);return De.createElement("svg",Co({height:l,width:l,viewBox:`0 0 ${v} ${v}`,ref:r,role:"img"},N),!!m&&De.createElement("title",null,m),De.createElement("path",{fill:d,d:`M0,0 h${v}v${v}H0z`,shapeRendering:"crispEdges"}),De.createElement("path",{fill:o,d:S,shapeRendering:"crispEdges"}),w)});Ex.displayName="QRCodeSVG";function qb({onClose:t}){const[s,r]=p.useState([]),[a,n]=p.useState(!0),[l,i]=p.useState(new Set);p.useEffect(()=>{d()},[]);async function d(){try{const{data:x,error:m}=await T.from("vehicles").select("*").eq("status","active").order("vehicle_name");if(m)throw m;r(x||[])}catch(x){console.error("Error loading vehicles:",x)}finally{n(!1)}}function o(x){const m=new Set(l);m.has(x)?m.delete(x):m.add(x),i(m)}function u(){l.size===s.length?i(new Set):i(new Set(s.map(x=>x.id)))}function c(){const x=window.open("","_blank");if(!x)return;const m=s.filter(y=>l.has(y.id)),f=m.map(y=>(JSON.stringify({type:"vehicle_assignment",vehicleId:y.id,vehicleName:y.vehicle_name||y.rig_no,rigNo:y.rig_no,timestamp:Date.now()}),`
        <div style="page-break-after: always; padding: 40px; text-align: center;">
          <div style="border: 3px solid #000; padding: 30px; display: inline-block; border-radius: 10px;">
            <h1 style="margin: 0 0 20px 0; font-size: 32px; font-weight: bold;">
              ${y.vehicle_name||y.rig_no||"Vehicle"}
            </h1>
            <div style="margin: 20px 0;">
              <svg id="qr-${y.id}" xmlns="http://www.w3.org/2000/svg"></svg>
            </div>
            <p style="margin: 20px 0 10px 0; font-size: 24px; font-weight: 600;">
              Rig #: ${y.rig_no||"N/A"}
            </p>
            <p style="margin: 10px 0 0 0; font-size: 18px; color: #666;">
              ${y.model||""}
            </p>
            <p style="margin: 20px 0 0 0; font-size: 16px; color: #666;">
              Scan to assign this vehicle
            </p>
          </div>
        </div>
      `)).join("");x.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Vehicle QR Codes</title>
          <style>
            @media print {
              @page { margin: 0; }
              body { margin: 0; }
            }
            body {
              font-family: Arial, sans-serif;
              margin: 0;
              padding: 0;
            }
          </style>
        </head>
        <body>
          ${f}
          <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"><\/script>
          <script>
            ${m.map(y=>{const N=JSON.stringify({type:"vehicle_assignment",vehicleId:y.id,vehicleName:y.vehicle_name||y.rig_no,rigNo:y.rig_no,timestamp:Date.now()});return`
                new QRCode(document.getElementById('qr-${y.id}'), {
                  text: '${N.replace(/'/g,"\\'")}',
                  width: 300,
                  height: 300
                });
              `}).join(`
`)}

            setTimeout(() => {
              window.print();
              window.close();
            }, 500);
          <\/script>
        </body>
      </html>
    `),x.document.close()}return a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"})})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-blue-600 text-white px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Vehicle QR Codes"}),e.jsx("button",{onClick:t,className:"text-white hover:text-gray-200 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:u,className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-100 transition-colors text-sm font-medium",children:l.size===s.length?"Deselect All":"Select All"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[l.size," of ",s.length," selected"]})]}),e.jsxs("button",{onClick:c,disabled:l.size===0,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium",children:[e.jsx(Gy,{className:"w-5 h-5"}),"Print QR Codes"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(x=>{const m=JSON.stringify({type:"vehicle_assignment",vehicleId:x.id,vehicleName:x.vehicle_name||x.rig_no,rigNo:x.rig_no,timestamp:Date.now()});return e.jsxs("div",{onClick:()=>o(x.id),className:`border-2 rounded-lg p-4 cursor-pointer transition ${l.has(x.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("input",{type:"checkbox",checked:l.has(x.id),onChange:()=>o(x.id),className:"w-5 h-5 text-blue-600 rounded",onClick:f=>f.stopPropagation()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:x.vehicle_name||x.rig_no||"Unnamed Vehicle"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Rig #: ",x.rig_no]})]})]}),e.jsx("div",{className:"flex justify-center p-4 bg-white rounded-lg",children:e.jsx(Ex,{value:m,size:150,level:"H",includeMargin:!0})}),e.jsx("p",{className:"text-xs text-center text-gray-500 mt-3",children:x.model||"No model"})]},x.id)})})})]})})}function Bb(){const[t,s]=p.useState("vehicles"),[r,a]=p.useState([]),[n,l]=p.useState([]),[i,d]=p.useState(!0),[o,u]=p.useState(""),[c,x]=p.useState("all"),[m,f]=p.useState(!1),[y,N]=p.useState(null),[k,b]=p.useState(!1);p.useEffect(()=>{v();const g=T.channel("fleet_changes").on("postgres_changes",{event:"*",schema:"public",table:"vehicles"},()=>{v()}).subscribe();return()=>{g.unsubscribe()}},[]),p.useEffect(()=>{h()},[r,o,c]);async function v(){try{const{data:g,error:w}=await T.from("vehicles").select("*").order("created_at",{ascending:!1});if(w)throw w;a(g||[])}catch(g){console.error("Error loading vehicles:",g)}finally{d(!1)}}function h(){let g=[...r];if(c!=="all"&&(g=g.filter(w=>w.status===c)),o){const w=o.toLowerCase();g=g.filter(S=>{var j,_,M;return((j=S.vehicle_name)==null?void 0:j.toLowerCase().includes(w))||((_=S.vehicle_number)==null?void 0:_.toLowerCase().includes(w))||((M=S.license_plate)==null?void 0:M.toLowerCase().includes(w))})}l(g)}return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading fleet..."})}):e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex gap-1 px-6",children:[e.jsx("button",{onClick:()=>s("vehicles"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="vehicles"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Vehicles"}),e.jsx("button",{onClick:()=>s("spaceTypes"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="spaceTypes"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Space Types"}),e.jsx("button",{onClick:()=>s("equipments"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="equipments"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Equipments"}),e.jsx("button",{onClick:()=>s("serviceAreas"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="serviceAreas"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Service Areas"}),e.jsx("button",{onClick:()=>s("equipmentPlanning"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="equipmentPlanning"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Equipment Planning"}),e.jsx("button",{onClick:()=>s("fundingSources"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="fundingSources"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Funding Sources"})]})}),t==="vehicles"&&e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>{N(null),f(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Add Vehicle"]}),e.jsxs("button",{onClick:()=>b(!0),className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium flex items-center gap-2",children:[e.jsx(cx,{className:"w-5 h-5"}),"Print QR Codes"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Showing ",n.length," entries"]}),e.jsxs("select",{value:c,onChange:g=>x(g.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"all",children:"All"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:o,onChange:g=>u(g.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name (8)"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rig No."}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Driver"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Model"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Capacity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Vin"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tracking No."}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Source"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Created At"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:n.map(g=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{N(g),f(!0)},className:"text-blue-600 hover:text-blue-800",children:e.jsx(zt,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:e.jsx(ae,{className:"w-4 h-4"})})]})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${g.vehicle_type==="wheelchair"?"bg-blue-500":"bg-green-500"}`,children:g.vehicle_type==="wheelchair"?e.jsx("span",{className:"text-white text-xl",children:""}):e.jsx("span",{className:"text-white text-xl",children:""})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.vehicle_type==="wheelchair"?"WAV (WAV)":"AMB (AMB)"}),e.jsx("p",{className:"text-xs text-gray-500",children:g.vehicle_name||"Unnamed"})]})]})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:g.vehicle_number||"N/A"}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[g.profiles&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-gray-600",children:g.profiles.full_name.charAt(0)})}),e.jsx("span",{className:"text-sm text-gray-900",children:g.profiles.full_name})]}),!g.profiles&&e.jsx("span",{className:"text-sm text-gray-500",children:"N/A"})]})}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:[g.make," ",g.model]}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:g.capacity||"N/A"}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:g.vin||"N/A"}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:g.tracking_device_id||"N/A"}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:"Panel"}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(g.created_at).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded font-medium",children:g.status.charAt(0).toUpperCase()+g.status.slice(1)})})]},g.id))})]})})]})}),t==="spaceTypes"&&e.jsx(Cb,{}),t==="equipments"&&e.jsx(Eb,{}),t==="serviceAreas"&&e.jsx(Tb,{}),t==="equipmentPlanning"&&e.jsx(Ab,{}),t==="fundingSources"&&e.jsx(Mb,{}),m&&e.jsx(xx,{vehicle:y,onClose:()=>{f(!1),N(null)},onSave:()=>{v(),f(!1),N(null)}}),k&&e.jsx(qb,{onClose:()=>b(!1)})]})}function Vb(){const[t,s]=p.useState("playground"),[r,a]=p.useState([]),[n,l]=p.useState([]),[i,d]=p.useState(new Date().toISOString().split("T")[0]),[o,u]=p.useState("all"),[c,x]=p.useState("all"),[m,f]=p.useState("all"),[y,N]=p.useState([]),[k,b]=p.useState(!1),[v,h]=p.useState([]),[g,w]=p.useState(!1),[S,j]=p.useState([]),[_,M]=p.useState(null),[R,O]=p.useState(null),[I,A]=p.useState(!1);p.useEffect(()=>{F(),Q();const D=T.channel("planner_changes").on("postgres_changes",{event:"*",schema:"public",table:"trips"},()=>{F(),Q()}).subscribe();return()=>{D.unsubscribe()}},[i]),p.useEffect(()=>{if(g){const D=setInterval(()=>{C()},3e4);return()=>clearInterval(D)}},[g]),p.useEffect(()=>{t==="violationSets"&&P()},[t]);async function F(){try{const{data:D,error:B}=await T.from("trips").select(`
          *,
          patients (*)
        `).order("scheduled_pickup_time",{ascending:!0});if(B)throw B;const $=(D||[]).filter(L=>new Date(L.scheduled_pickup_time).toISOString().split("T")[0]===i);a($);const W=new Set;D==null||D.forEach(L=>{L.service_area&&W.add(L.service_area)}),N(Array.from(W).sort())}catch(D){console.error("Error loading trips:",D)}}async function Q(){try{const{data:D,error:B}=await T.from("trips").select(`
          *,
          patients (*)
        `).is("driver_id",null).in("status",["scheduled","pending"]).order("scheduled_pickup_time",{ascending:!0}).limit(50);if(B)throw B;l(D||[])}catch(D){console.error("Error loading unscheduled trips:",D)}}function E(D,B,$,W){const K=($-D)*Math.PI/180,X=(W-B)*Math.PI/180,ie=Math.sin(K/2)*Math.sin(K/2)+Math.cos(D*Math.PI/180)*Math.cos($*Math.PI/180)*Math.sin(X/2)*Math.sin(X/2);return 3959*(2*Math.atan2(Math.sqrt(ie),Math.sqrt(1-ie)))}async function q(D){const{data:B}=await T.from("profiles").select("*").eq("role","driver").eq("status","active").not("current_latitude","is",null).not("current_longitude","is",null);if(!B||B.length===0)return null;const{data:$}=await T.from("trips").select("driver_id").not("driver_id","is",null).in("status",["assigned","in-progress","arrived"]),W=new Map;$==null||$.forEach(X=>{const ie=W.get(X.driver_id)||0;W.set(X.driver_id,ie+1)});let L=null,K=-1/0;for(const X of B){const Ee=10-(W.get(X.id)||0);let qe=5;if(D.pickup_lat&&D.pickup_lng&&X.current_latitude&&X.current_longitude){const Hr=E(D.pickup_lat,D.pickup_lng,X.current_latitude,X.current_longitude);qe=Math.max(0,10-Hr/2)}const Be=Ee*.4+qe*.6;Be>K&&(K=Be,L=X)}return L}async function C(){if(n.length===0)return;b(!0);const D=[];for(const B of n.slice(0,10)){const $=await q(B);if($){const{error:W}=await T.from("trips").update({driver_id:$.id,status:"assigned",auto_scheduled:!0}).eq("id",B.id);W?D.push({success:!1,trip_id:B.id,driver_id:"",driver_name:"",message:"Failed to assign"}):D.push({success:!0,trip_id:B.id,driver_id:$.id,driver_name:$.full_name,message:`Assigned to ${$.full_name}`})}else D.push({success:!1,trip_id:B.id,driver_id:"",driver_name:"",message:"No available drivers"})}h(D),await Q(),b(!1)}async function U(D){b(!0);const B=await q(D);if(B){const{error:$}=await T.from("trips").update({driver_id:B.id,status:"assigned",auto_scheduled:!0}).eq("id",D.id);$?h([{success:!1,trip_id:D.id,driver_id:"",driver_name:"",message:"Failed to assign trip"}]):(h([{success:!0,trip_id:D.id,driver_id:B.id,driver_name:B.full_name,message:`Successfully assigned to ${B.full_name}`}]),await Q())}else h([{success:!1,trip_id:D.id,driver_id:"",driver_name:"",message:"No available drivers found"}]);b(!1)}async function P(){try{const{data:D,error:B}=await T.from("violation_sets").select("*").order("name",{ascending:!0});if(B)throw B;if(D){j(D);const $=D.find(L=>L.name==="batch"),W=D.find(L=>L.name==="single");$&&M($),W&&O(W)}}catch(D){console.error("Error loading violation sets:",D)}}async function V(){A(!0);try{const D=[];_&&D.push(T.from("violation_sets").update({pickup_early:_.pickup_early,pickup_late:_.pickup_late,dropoff_early:_.dropoff_early,dropoff_late:_.dropoff_late,max_onboard_time:_.max_onboard_time,overlap_indication:_.overlap_indication,break_cushion:_.break_cushion,max_distance:_.max_distance,max_trips:_.max_trips,allow_onboard_violations:_.allow_onboard_violations,allow_capacity_violations:_.allow_capacity_violations,ab_driver_preference:_.ab_driver_preference,updated_at:new Date().toISOString()}).eq("name","batch")),R&&D.push(T.from("violation_sets").update({pickup_early:R.pickup_early,pickup_late:R.pickup_late,dropoff_early:R.dropoff_early,dropoff_late:R.dropoff_late,max_onboard_time:R.max_onboard_time,overlap_indication:R.overlap_indication,break_cushion:R.break_cushion,max_distance:R.max_distance,max_trips:R.max_trips,allow_onboard_violations:R.allow_onboard_violations,allow_capacity_violations:R.allow_capacity_violations,ab_driver_preference:R.ab_driver_preference,updated_at:new Date().toISOString()}).eq("name","single")),await Promise.all(D),await P()}catch(D){console.error("Error saving violation sets:",D)}finally{A(!1)}}return e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex gap-1 px-6",children:[e.jsx("button",{onClick:()=>s("playground"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="playground"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Playground"}),e.jsx("button",{onClick:()=>s("schedule"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="schedule"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Schedule"}),e.jsx("button",{onClick:()=>s("mapper"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="mapper"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Mapper"}),e.jsx("button",{onClick:()=>s("template"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="template"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Template"}),e.jsx("button",{onClick:()=>s("holidays"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="holidays"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Holidays"}),e.jsx("button",{onClick:()=>s("violationSets"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="violationSets"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Violation Sets"})]})}),t==="playground"&&e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("input",{type:"date",value:i,onChange:D=>d(D.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsxs("select",{value:o,onChange:D=>u(D.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 min-w-[250px]",children:[e.jsx("option",{value:"all",children:"-- Select Service Area --"}),y.map(D=>e.jsx("option",{value:D,children:D},D))]}),e.jsx("select",{value:c,onChange:D=>x(D.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 min-w-[200px]",children:e.jsx("option",{value:"all",children:"-- Select Drivers --"})}),e.jsxs("select",{value:m,onChange:D=>f(D.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 min-w-[150px]",children:[e.jsx("option",{value:"all",children:"Status"}),e.jsx("option",{value:"scheduled",children:"Scheduled"}),e.jsx("option",{value:"assigned",children:"Assigned"}),e.jsx("option",{value:"in-progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"absolute top-2 left-2 z-10 bg-white rounded-lg shadow-md",children:[e.jsx("button",{className:"px-3 py-2 border-r border-gray-200 hover:bg-gray-50",children:"Map"}),e.jsx("button",{className:"px-3 py-2 hover:bg-gray-50",children:"Satellite"})]}),e.jsx("button",{className:"absolute top-2 right-2 z-10 p-2 bg-white rounded-lg shadow-md hover:bg-gray-50",children:e.jsx(lx,{className:"w-5 h-5 text-gray-600"})}),e.jsx("div",{className:"h-96 bg-gradient-to-br from-blue-100 via-green-50 to-blue-50 flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Map View (San Francisco Bay Area)"})})]})}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:e.jsxs("h3",{className:"font-medium text-gray-900",children:["Trips (",r.length,")"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"From Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"To Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Funding Source"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Patient"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Space Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Service Area"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Pickup Address"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Dropoff Address"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Distance"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phone No."}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Notes"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(D=>{var B,$;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:new Date(D.scheduled_pickup_time).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:new Date(D.scheduled_pickup_time).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:D.actual_dropoff_time?new Date(D.actual_dropoff_time).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}):"N/A"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:D.funding_source||"N/A"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:((B=D.patients)==null?void 0:B.full_name)||"N/A"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:D.space_type==="wheelchair"?"WAV":"AMB"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:D.service_area||"N/A"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:D.pickup_address}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:D.dropoff_address}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:D.distance_miles||"N/A"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:(($=D.patients)==null?void 0:$.phone)||"N/A"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:D.trip_number||D.id.slice(0,8)}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:D.status}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:D.dispatcher_notes||"N/A"})]},D.id)})})]})})]})]}),t==="schedule"&&e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Auto Scheduler"}),e.jsx("p",{className:"text-gray-600",children:"Intelligent trip assignment based on driver availability and location"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-3 bg-white px-6 py-3 rounded-lg shadow border border-gray-200",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:D=>w(D.target.checked),className:"w-5 h-5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Auto-Schedule (30s)"})]}),e.jsxs("button",{onClick:C,disabled:k||n.length===0,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all shadow hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(mx,{className:"w-5 h-5"}),"Schedule All"]})]})]}),v.length>0&&e.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow border border-gray-200 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Recent Scheduling Results"}),e.jsx("div",{className:"space-y-2",children:v.map((D,B)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50",children:[D.success?e.jsx(ue,{className:"w-5 h-5 text-green-600 flex-shrink-0"}):e.jsx(Ut,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:D.message})]},B))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-6 bg-gray-50 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Unscheduled Trips"})]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[n.length," trips waiting"]})]})}),e.jsxs("div",{className:"divide-y divide-gray-200",children:[n.map(D=>{var B;return e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-all",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:(B=D.patients)==null?void 0:B.full_name}),e.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-medium",children:D.status}),D.space_type==="wheelchair"&&e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:"Wheelchair"})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4"}),new Date(D.scheduled_pickup_time).toLocaleString()]}),e.jsxs("div",{children:["From: ",D.pickup_address]}),e.jsxs("div",{children:["To: ",D.dropoff_address]})]})]}),e.jsx("button",{onClick:()=>U(D),disabled:k,className:"ml-4 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Schedule Now"})]})},D.id)}),n.length===0&&e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(ue,{className:"w-12 h-12 text-green-600 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"All Trips Scheduled"}),e.jsx("p",{className:"text-gray-600",children:"No trips are waiting to be assigned to drivers"})]})]})]})]})}),t==="violationSets"&&e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[_&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Batch"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Driver Load"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Pickup Early:"}),e.jsx("input",{type:"number",value:_.pickup_early,onChange:D=>M({..._,pickup_early:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Pickup Late:"}),e.jsx("input",{type:"number",value:_.pickup_late,onChange:D=>M({..._,pickup_late:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Dropoff Early:"}),e.jsx("input",{type:"number",value:_.dropoff_early,onChange:D=>M({..._,dropoff_early:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Dropoff Late:"}),e.jsx("input",{type:"number",value:_.dropoff_late,onChange:D=>M({..._,dropoff_late:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Max Onboard Time:"}),e.jsx("input",{type:"number",value:_.max_onboard_time,onChange:D=>M({..._,max_onboard_time:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Planning"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Overlap Indication:"}),e.jsx("input",{type:"text",value:_.overlap_indication,onChange:D=>M({..._,overlap_indication:D.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Break Cushion:"}),e.jsx("input",{type:"number",value:_.break_cushion,onChange:D=>M({..._,break_cushion:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Max Distance:"}),e.jsx("input",{type:"number",value:_.max_distance,onChange:D=>M({..._,max_distance:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"miles"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Max Trips:"}),e.jsx("input",{type:"number",value:_.max_trips,onChange:D=>M({..._,max_trips:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"})]}),e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:_.allow_onboard_violations,onChange:D=>M({..._,allow_onboard_violations:D.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Allow Onboard Violation(s)"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:_.allow_capacity_violations,onChange:D=>M({..._,allow_capacity_violations:D.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Allow Capacity Violation(s)"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:_.ab_driver_preference,onChange:D=>M({..._,ab_driver_preference:D.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"A/B Driver Preference"})]})]})]})]})]})]}),R&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Single"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Driver Load"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Pickup Early:"}),e.jsx("input",{type:"number",value:R.pickup_early,onChange:D=>O({...R,pickup_early:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Pickup Late:"}),e.jsx("input",{type:"number",value:R.pickup_late,onChange:D=>O({...R,pickup_late:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Dropoff Early:"}),e.jsx("input",{type:"number",value:R.dropoff_early,onChange:D=>O({...R,dropoff_early:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Dropoff Late:"}),e.jsx("input",{type:"number",value:R.dropoff_late,onChange:D=>O({...R,dropoff_late:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Max Onboard Time:"}),e.jsx("input",{type:"number",value:R.max_onboard_time,onChange:D=>O({...R,max_onboard_time:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Planning"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Overlap Indication:"}),e.jsx("input",{type:"text",value:R.overlap_indication,onChange:D=>O({...R,overlap_indication:D.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Break Cushion:"}),e.jsx("input",{type:"number",value:R.break_cushion,onChange:D=>O({...R,break_cushion:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Max Distance:"}),e.jsx("input",{type:"number",value:R.max_distance,onChange:D=>O({...R,max_distance:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"miles"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 w-32",children:"Max Trips:"}),e.jsx("input",{type:"number",value:R.max_trips,onChange:D=>O({...R,max_trips:parseInt(D.target.value)||0}),className:"px-3 py-2 border border-gray-300 rounded-lg w-24 text-center"})]}),e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:R.allow_onboard_violations,onChange:D=>O({...R,allow_onboard_violations:D.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Allow Onboard Violation(s)"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:R.allow_capacity_violations,onChange:D=>O({...R,allow_capacity_violations:D.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Allow Capacity Violation(s)"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:R.ab_driver_preference,onChange:D=>O({...R,ab_driver_preference:D.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"A/B Driver Preference"})]})]})]})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:V,disabled:I,className:"flex items-center gap-2 bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition-all shadow hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(sr,{className:"w-5 h-5"}),I?"Saving...":"Save"]})})]})}),t!=="playground"&&t!=="schedule"&&t!=="violationSets"&&e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-gray-500 text-lg",children:[t==="mapper"&&"Mapper configuration coming soon",t==="template"&&"Template management coming soon",t==="holidays"&&"Holidays configuration coming soon"]})})})]})}function Wb({driver:t,onClose:s}){var F,Q,E,q;const[r,a]=p.useState(!1),[n,l]=p.useState(t.signature_url),[i,d]=p.useState(!1),[o,u]=p.useState(t),[c,x]=p.useState(!1),[m,f]=p.useState(""),[y,N]=p.useState(!1),[k,b]=p.useState("auto"),[v,h]=p.useState(""),[g,w]=p.useState(!1),S=C=>{l(C),a(!1)},j=async()=>{x(!0),f("");try{const{error:C}=await T.from("profiles").update({first_name:o.first_name,last_name:o.last_name,phone:o.phone,email:o.email,driver_address:o.driver_address,garage_address:o.garage_address,zip_code:o.zip_code,license_number:o.license_number,employee_id:o.employee_id,employment_type:o.employment_type,start_date:o.start_date,end_date:o.end_date,station_manager:o.station_manager,position:o.position,cost_center:o.cost_center,status:o.status,date_of_birth:o.date_of_birth}).eq("id",t.id);if(C)throw C;d(!1),s()}catch(C){C instanceof Error?f(C.message):f("Failed to save changes")}finally{x(!1)}},_=()=>{u(t),d(!1),f("")},M=async()=>{const C=t.status==="active"?"inactive":"active";if(confirm(C==="inactive"?"Are you sure you want to deactivate this driver? They will no longer appear in active driver lists.":"Are you sure you want to reactivate this driver?")){x(!0),f("");try{const{error:P}=await T.from("profiles").update({status:C}).eq("id",t.id);if(P)throw P;t.status=C,u({...o,status:C})}catch(P){P instanceof Error?f(P.message):f("Failed to update status")}finally{x(!1)}}},R=()=>{const C="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789!@#$%^&*";let U="";for(let P=0;P<12;P++)U+=C.charAt(Math.floor(Math.random()*C.length));return U},O=()=>{b("auto"),h(R()),N(!0)},I=()=>{b("manual"),h(""),N(!0)},A=async()=>{if(!v||v.length<6){f("Password must be at least 6 characters");return}w(!0),f("");try{const C=await fetch("https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/change-user-password",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"},body:JSON.stringify({userId:t.id,newPassword:v})}),U=await C.json();if(!C.ok)throw new Error(U.error||"Failed to change password");N(!1),h(""),alert("Password changed successfully")}catch(C){C instanceof Error?f(C.message):f("Failed to change password")}finally{w(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 flex items-center justify-between rounded-t-xl",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Driver Profile"}),e.jsx("button",{onClick:s,className:"text-white hover:text-gray-200 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[m&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:m}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[t.photo_url?e.jsx("img",{src:t.photo_url,alt:t.full_name,className:"w-20 h-20 rounded-full object-cover border-2 border-gray-200"}):e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(t.full_name||"U")}&background=random&size=80`,alt:t.full_name,className:"w-20 h-20 rounded-full"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:t.full_name}),i?e.jsxs("select",{value:o.status||"active",onChange:C=>u({...o,status:C.target.value}),className:"px-3 py-1 text-sm font-medium border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"on_leave",children:"On Leave"})]}):e.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded capitalize ${t.status==="active"?"bg-green-100 text-green-700":t.status==="inactive"?"bg-gray-100 text-gray-700":"bg-yellow-100 text-yellow-700"}`,children:t.status||"Active"})]}),i?e.jsx("input",{type:"text",value:o.position||"",onChange:C=>u({...o,position:C.target.value}),className:"mt-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"Position"}):e.jsx("p",{className:"text-gray-600",children:t.position||"Driver"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[!i&&e.jsx("button",{onClick:M,disabled:c,className:`px-4 py-2 rounded-lg transition-colors flex items-center gap-2 font-medium disabled:opacity-50 ${t.status==="active"?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:t.status==="active"?e.jsxs(e.Fragment,{children:[e.jsx(tb,{className:"w-4 h-4"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx($n,{className:"w-4 h-4"}),"Activate"]})}),i?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:_,disabled:c,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:c?"Saving...":"Save Changes"})]}):e.jsx("button",{onClick:()=>d(!0),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Edit profile"})]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsx("div",{className:"col-span-2 bg-white border border-gray-200 rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"First Name"}),i?e.jsx("input",{type:"text",value:o.first_name||"",onChange:C=>u({...o,first_name:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.first_name||((F=t.full_name)==null?void 0:F.split(" ")[0])||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Station Manager"}),i?e.jsx("input",{type:"text",value:o.station_manager||"",onChange:C=>u({...o,station_manager:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.station_manager||"Default"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Last Name"}),i?e.jsx("input",{type:"text",value:o.last_name||"",onChange:C=>u({...o,last_name:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.last_name||((Q=t.full_name)==null?void 0:Q.split(" ").slice(1).join(" "))||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Driver Address"}),i?e.jsx("input",{type:"text",value:o.driver_address||"",onChange:C=>u({...o,driver_address:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.driver_address||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Email"}),i?e.jsx("input",{type:"email",value:o.email||"",onChange:C=>u({...o,email:C.target.value}),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium text-xs break-all",children:t.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Garage Address"}),i?e.jsx("input",{type:"text",value:o.garage_address||"",onChange:C=>u({...o,garage_address:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.garage_address||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Phone"}),i?e.jsx("input",{type:"tel",value:o.phone||"",onChange:C=>u({...o,phone:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Zip"}),i?e.jsx("input",{type:"text",value:o.zip_code||"",onChange:C=>u({...o,zip_code:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.zip_code||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"License Number"}),i?e.jsx("input",{type:"text",value:o.license_number||"",onChange:C=>u({...o,license_number:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.license_number||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Employee ID"}),i?e.jsx("input",{type:"text",value:o.employee_id||"",onChange:C=>u({...o,employee_id:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.employee_id||"NA"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Employment Type"}),i?e.jsx("input",{type:"text",value:o.employment_type||"",onChange:C=>u({...o,employment_type:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.employment_type||"fullTime"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Date of Birth"}),i?e.jsx("input",{type:"date",value:o.date_of_birth||"",onChange:C=>u({...o,date_of_birth:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.date_of_birth?new Date(t.date_of_birth).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"End Date"}),i?e.jsx("input",{type:"date",value:o.end_date||"",onChange:C=>u({...o,end_date:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.end_date?new Date(t.end_date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"App"}),e.jsx("p",{className:"text-gray-900 font-medium",children:"Android"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Joining Date"}),i?e.jsx("input",{type:"date",value:o.start_date||"",onChange:C=>u({...o,start_date:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.start_date?new Date(t.start_date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Version"}),e.jsx("p",{className:"text-gray-900 font-medium",children:"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Schedule Shell(s)"}),e.jsx("p",{className:"text-gray-900 font-medium",children:t.schedule_shell||"NA"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Cost Center"}),i?e.jsx("input",{type:"text",value:o.cost_center||"",onChange:C=>u({...o,cost_center:C.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.cost_center||"NA"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Special Requests"}),e.jsx("p",{className:"text-gray-900 font-medium",children:"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Limitation"}),e.jsx("p",{className:"text-gray-900 font-medium",children:"N/A"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500",children:"Proficiency"}),e.jsx("div",{className:"flex gap-1 mt-1 flex-wrap",children:((E=t.proficiency)==null?void 0:E.split(",").map((C,U)=>e.jsx("span",{className:"px-2 py-0.5 bg-blue-600 text-white text-xs rounded",children:C.trim()},U)))||e.jsx("span",{className:"text-gray-900",children:"None"})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500",children:"Service Area"}),e.jsx("div",{className:"flex gap-1 mt-1 flex-wrap",children:t.service_areas&&t.service_areas.length>0?t.service_areas.map((C,U)=>e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-xs rounded",children:C},U)):e.jsx("span",{className:"text-gray-900",children:"No service areas"})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500",children:"Competency"}),e.jsx("div",{className:"flex gap-1 mt-1",children:((q=t.competency)==null?void 0:q.split(",").map((C,U)=>e.jsx("span",{className:"px-2 py-0.5 bg-blue-600 text-white text-xs rounded",children:C.trim()},U)))||e.jsx("span",{className:"text-gray-900",children:"None"})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500",children:"Funding Source"}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 text-xs rounded",children:"Advantage Ir"}),e.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 text-xs rounded",children:"Alicia Partillo"}),e.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 text-xs rounded",children:"Angels of Care"}),e.jsx("span",{className:"px-2 py-0.5 bg-blue-600 text-white text-xs rounded",children:"AVO Transportation"}),e.jsx("span",{className:"px-2 py-0.5 bg-blue-600 text-white text-xs rounded",children:"Dental"}),e.jsx("span",{className:"px-2 py-0.5 bg-blue-600 text-white text-xs rounded",children:"America Logistics"}),e.jsx("span",{className:"px-2 py-0.5 bg-blue-600 text-white text-xs rounded",children:"Access2Care"})]})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Change Password"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:O,className:"flex-1 px-3 py-2 text-sm border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Auto Generate"}),e.jsx("button",{onClick:I,className:"flex-1 px-3 py-2 text-sm border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Manual Generate"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Signature"}),e.jsx("button",{onClick:()=>a(!0),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:n?"Update":"Add/Update"})]}),n?e.jsx("img",{src:n,alt:"Signature",className:"w-full h-24 object-contain border border-gray-200 rounded bg-white"}):e.jsx("div",{className:"w-full h-24 border-2 border-dashed border-gray-300 rounded flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(xe,{className:"w-8 h-8 text-gray-400 mx-auto mb-1"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No signature"})]})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Shift (Day Wise)"}),e.jsx("div",{className:"space-y-2 text-sm",children:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(C=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-blue-600 font-medium",children:C}),e.jsx("span",{className:"text-gray-600",children:"00:00 - 23:59"})]},C))})]})]})]})]})]})}),r&&e.jsx(Hb,{driverId:t.id,driverName:t.full_name,existingSignature:n,onClose:()=>a(!1),onSave:S}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Change Password"}),e.jsx("button",{onClick:()=>{N(!1),h(""),f("")},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[m&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:m}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:k==="auto"?"Generated Password":"New Password"}),e.jsx("input",{type:"text",value:v,onChange:C=>h(C.target.value),readOnly:k==="auto",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono",placeholder:k==="manual"?"Enter new password":""}),k==="auto"&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Copy this password and share it securely with the driver"})]}),k==="auto"&&e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(v),alert("Password copied to clipboard")},className:"w-full px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Copy Password"}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{N(!1),h(""),f("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:A,disabled:g||!v,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Changing...":"Change Password"})]})]})]})]})})]})}function Hb({driverId:t,driverName:s,existingSignature:r,onClose:a,onSave:n}){const l=p.useRef(null),[i,d]=p.useState(!1),[o,u]=p.useState(!1),[c,x]=p.useState(!1),[m,f]=p.useState("");p.useEffect(()=>{const h=l.current;if(!h)return;const g=h.getContext("2d");if(g&&(h.width=h.offsetWidth*2,h.height=h.offsetHeight*2,g.scale(2,2),g.strokeStyle="#000",g.lineWidth=2,g.lineCap="round",g.lineJoin="round",r)){const w=new Image;w.onload=()=>{g.drawImage(w,0,0,h.width/2,h.height/2),u(!0)},w.src=r}},[r]);function y(h){const g=l.current;if(!g)return;d(!0),u(!0);const w=g.getContext("2d");if(!w)return;const S=g.getBoundingClientRect(),j="touches"in h?h.touches[0].clientX-S.left:h.clientX-S.left,_="touches"in h?h.touches[0].clientY-S.top:h.clientY-S.top;w.beginPath(),w.moveTo(j,_)}function N(h){if(!i)return;const g=l.current;if(!g)return;const w=g.getContext("2d");if(!w)return;const S=g.getBoundingClientRect(),j="touches"in h?h.touches[0].clientX-S.left:h.clientX-S.left,_="touches"in h?h.touches[0].clientY-S.top:h.clientY-S.top;w.lineTo(j,_),w.stroke()}function k(){d(!1)}function b(){const h=l.current;if(!h)return;const g=h.getContext("2d");g&&(g.clearRect(0,0,h.width,h.height),u(!1))}async function v(){if(!o){f("Please provide a signature");return}const h=l.current;if(h){x(!0),f("");try{const g=h.toDataURL("image/png"),{error:w}=await T.from("profiles").update({signature_url:g,signature_created_at:new Date().toISOString()}).eq("id",t);if(w)throw w;n(g)}catch(g){g instanceof Error?f(g.message):f("Failed to save signature")}finally{x(!1)}}}return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Driver Signature"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[m&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:m}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Sign Below"}),e.jsxs("button",{onClick:b,className:"flex items-center text-sm text-blue-600 hover:text-blue-700 font-medium",children:[e.jsx(Pc,{className:"w-4 h-4 mr-1"}),"Clear"]})]}),e.jsx("div",{className:"bg-white border-2 border-gray-300 rounded-lg overflow-hidden",style:{height:"300px"},children:e.jsx("canvas",{ref:l,onTouchStart:y,onTouchMove:N,onTouchEnd:k,onMouseDown:y,onMouseMove:N,onMouseUp:k,onMouseLeave:k,className:"w-full h-full touch-none cursor-crosshair",style:{touchAction:"none"}})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),e.jsxs("button",{onClick:v,disabled:c||!o,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:[e.jsx(Tc,{className:"w-5 h-5 mr-2"}),c?"Saving...":"Save Signature"]})]})]})]})]})})}function Jb({staff:t,onClose:s}){var A,F,Q;const[r,a]=p.useState(!1),[n,l]=p.useState(t.signature_url),[i,d]=p.useState(!1),[o,u]=p.useState(t),[c,x]=p.useState(!1),[m,f]=p.useState(""),[y,N]=p.useState(!1),[k,b]=p.useState("auto"),[v,h]=p.useState(""),[g,w]=p.useState(!1),S=E=>{l(E),a(!1)},j=async()=>{x(!0),f("");try{const{error:E}=await T.from("profiles").update({first_name:o.first_name,last_name:o.last_name,phone:o.phone,email:o.email,position:o.position,status:o.status,first_start_date:o.first_start_date,date_of_birth:o.date_of_birth}).eq("id",t.id);if(E)throw E;d(!1),s()}catch(E){E instanceof Error?f(E.message):f("Failed to save changes")}finally{x(!1)}},_=()=>{u(t),d(!1),f("")},M=()=>{const E="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789!@#$%^&*";let q="";for(let C=0;C<12;C++)q+=E.charAt(Math.floor(Math.random()*E.length));return q},R=()=>{b("auto"),h(M()),N(!0)},O=()=>{b("manual"),h(""),N(!0)},I=async()=>{if(!v||v.length<6){f("Password must be at least 6 characters");return}w(!0),f("");try{const E=await fetch("https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/change-user-password",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"},body:JSON.stringify({userId:t.id,newPassword:v})}),q=await E.json();if(!E.ok)throw new Error(q.error||"Failed to change password");N(!1),h(""),alert("Password changed successfully")}catch(E){E instanceof Error?f(E.message):f("Failed to change password")}finally{w(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 flex items-center justify-between rounded-t-xl",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Staff Profile"}),e.jsx("button",{onClick:s,className:"text-white hover:text-gray-200 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[m&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:m}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[t.photo_url?e.jsx("img",{src:t.photo_url,alt:t.full_name,className:"w-20 h-20 rounded-full object-cover border-2 border-gray-200"}):e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(t.full_name||"U")}&background=random&size=80`,alt:t.full_name,className:"w-20 h-20 rounded-full"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:t.full_name}),i?e.jsxs("select",{value:o.status||"active",onChange:E=>u({...o,status:E.target.value}),className:"px-3 py-1 text-sm font-medium border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"on_leave",children:"On Leave"})]}):e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-700 text-sm font-medium rounded capitalize",children:t.status||"Active"})]}),i?e.jsx("input",{type:"text",value:o.position||o.role||"",onChange:E=>u({...o,position:E.target.value}),className:"mt-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"Position"}):e.jsx("p",{className:"text-gray-600",children:t.position||t.role||"Staff"})]})]}),e.jsx("div",{className:"flex gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:_,disabled:c,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:c?"Saving...":"Save Changes"})]}):e.jsx("button",{onClick:()=>d(!0),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Edit profile"})})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsx("div",{className:"col-span-2 bg-white border border-gray-200 rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"First Name"}),i?e.jsx("input",{type:"text",value:o.first_name||"",onChange:E=>u({...o,first_name:E.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.first_name||((A=t.full_name)==null?void 0:A.split(" ")[0])||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Last Name"}),i?e.jsx("input",{type:"text",value:o.last_name||"",onChange:E=>u({...o,last_name:E.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.last_name||((F=t.full_name)==null?void 0:F.split(" ").slice(1).join(" "))||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Email"}),i?e.jsx("input",{type:"email",value:o.email||"",onChange:E=>u({...o,email:E.target.value}),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium text-xs break-all",children:t.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Phone"}),i?e.jsx("input",{type:"tel",value:o.phone||"",onChange:E=>u({...o,phone:E.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Role"}),e.jsx("p",{className:"text-gray-900 font-medium capitalize",children:t.role||"Staff"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Code"}),e.jsx("p",{className:"text-gray-900 font-medium",children:((Q=t.staff)==null?void 0:Q.code)||t.code||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Employee ID"}),e.jsx("p",{className:"text-gray-900 font-medium",children:t.employee_id||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Date of Birth"}),i?e.jsx("input",{type:"date",value:o.date_of_birth||"",onChange:E=>u({...o,date_of_birth:E.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.date_of_birth?new Date(t.date_of_birth).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"First Start Date"}),i?e.jsx("input",{type:"date",value:o.first_start_date||"",onChange:E=>u({...o,first_start_date:E.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.first_start_date?new Date(t.first_start_date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Start Date"}),e.jsx("p",{className:"text-gray-900 font-medium",children:t.start_date?new Date(t.start_date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"N/A"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500",children:"Status"}),e.jsx("p",{className:"text-gray-900 font-medium capitalize",children:t.status||"Active"})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Change Password"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:R,className:"flex-1 px-3 py-2 text-sm border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Auto Generate"}),e.jsx("button",{onClick:O,className:"flex-1 px-3 py-2 text-sm border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Manual Generate"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Signature"}),e.jsx("button",{onClick:()=>a(!0),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:n?"Update":"Add/Update"})]}),n?e.jsx("img",{src:n,alt:"Signature",className:"w-full h-24 object-contain border border-gray-200 rounded bg-white"}):e.jsx("div",{className:"w-full h-24 border-2 border-dashed border-gray-300 rounded flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(xe,{className:"w-8 h-8 text-gray-400 mx-auto mb-1"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No signature"})]})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Shift (Day Wise)"}),e.jsx("div",{className:"space-y-2 text-sm",children:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(E=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-blue-600 font-medium",children:E}),e.jsx("span",{className:"text-gray-600",children:"00:00 - 23:59"})]},E))})]})]})]})]})]})}),r&&e.jsx(Qb,{staffId:t.id,staffName:t.full_name,existingSignature:n,onClose:()=>a(!1),onSave:S}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Change Password"}),e.jsx("button",{onClick:()=>{N(!1),h(""),f("")},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[m&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:m}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:k==="auto"?"Generated Password":"New Password"}),e.jsx("input",{type:"text",value:v,onChange:E=>h(E.target.value),readOnly:k==="auto",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono",placeholder:k==="manual"?"Enter new password":""}),k==="auto"&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Copy this password and share it securely with the staff member"})]}),k==="auto"&&e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(v),alert("Password copied to clipboard")},className:"w-full px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Copy Password"}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{N(!1),h(""),f("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:I,disabled:g||!v,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Changing...":"Change Password"})]})]})]})]})})]})}function Qb({staffId:t,staffName:s,existingSignature:r,onClose:a,onSave:n}){const l=p.useRef(null),[i,d]=p.useState(!1),[o,u]=p.useState(!1),[c,x]=p.useState(!1),[m,f]=p.useState("");p.useEffect(()=>{const h=l.current;if(!h)return;const g=h.getContext("2d");if(g&&(h.width=h.offsetWidth*2,h.height=h.offsetHeight*2,g.scale(2,2),g.strokeStyle="#000",g.lineWidth=2,g.lineCap="round",g.lineJoin="round",r)){const w=new Image;w.onload=()=>{g.drawImage(w,0,0,h.width/2,h.height/2),u(!0)},w.src=r}},[r]);function y(h){const g=l.current;if(!g)return;d(!0),u(!0);const w=g.getContext("2d");if(!w)return;const S=g.getBoundingClientRect(),j="touches"in h?h.touches[0].clientX-S.left:h.clientX-S.left,_="touches"in h?h.touches[0].clientY-S.top:h.clientY-S.top;w.beginPath(),w.moveTo(j,_)}function N(h){if(!i)return;const g=l.current;if(!g)return;const w=g.getContext("2d");if(!w)return;const S=g.getBoundingClientRect(),j="touches"in h?h.touches[0].clientX-S.left:h.clientX-S.left,_="touches"in h?h.touches[0].clientY-S.top:h.clientY-S.top;w.lineTo(j,_),w.stroke()}function k(){d(!1)}function b(){const h=l.current;if(!h)return;const g=h.getContext("2d");g&&(g.clearRect(0,0,h.width,h.height),u(!1))}async function v(){if(!o){f("Please provide a signature");return}const h=l.current;if(h){x(!0),f("");try{const g=h.toDataURL("image/png"),{error:w}=await T.from("profiles").update({signature_url:g,signature_created_at:new Date().toISOString()}).eq("id",t);if(w)throw w;n(g)}catch(g){g instanceof Error?f(g.message):f("Failed to save signature")}finally{x(!1)}}}return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Staff Signature"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[m&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:m}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Sign Below"}),e.jsxs("button",{onClick:b,className:"flex items-center text-sm text-blue-600 hover:text-blue-700 font-medium",children:[e.jsx(Pc,{className:"w-4 h-4 mr-1"}),"Clear"]})]}),e.jsx("div",{className:"bg-white border-2 border-gray-300 rounded-lg overflow-hidden",style:{height:"300px"},children:e.jsx("canvas",{ref:l,onTouchStart:y,onTouchMove:N,onTouchEnd:k,onMouseDown:y,onMouseMove:N,onMouseUp:k,onMouseLeave:k,className:"w-full h-full touch-none cursor-crosshair",style:{touchAction:"none"}})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),e.jsxs("button",{onClick:v,disabled:c||!o,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:[e.jsx(Tc,{className:"w-5 h-5 mr-2"}),c?"Saving...":"Save Signature"]})]})]})]})]})})}function Gb(){const[t,s]=p.useState("drivers");return e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex gap-1 px-6",children:[e.jsx("button",{onClick:()=>s("drivers"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="drivers"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Drivers"}),e.jsx("button",{onClick:()=>s("staff"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="staff"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Staff"}),e.jsx("button",{onClick:()=>s("members"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="members"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Members"}),e.jsx("button",{onClick:()=>s("fundingSources"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="fundingSources"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Funding Sources"})]})}),t==="drivers"&&e.jsx(Kb,{}),t==="staff"&&e.jsx(Xb,{}),t==="members"&&e.jsx(Yb,{}),t==="fundingSources"&&e.jsx(ev,{})]})}function Kb(){const[t,s]=p.useState([]),[r,a]=p.useState(""),[n,l]=p.useState("active"),[i,d]=p.useState(!0),[o,u]=p.useState(!1),[c,x]=p.useState(null),[m,f]=p.useState(!1);p.useEffect(()=>{y()},[]);async function y(){try{const{data:k,error:b}=await T.from("profiles").select("*").eq("role","driver").order("full_name");if(b)throw b;s(k||[])}catch(k){console.error("Error loading drivers:",k)}finally{d(!1)}}const N=t.filter(k=>{var h,g,w;const b=((h=k.full_name)==null?void 0:h.toLowerCase().includes(r.toLowerCase()))||((g=k.email)==null?void 0:g.toLowerCase().includes(r.toLowerCase())),v=n===""||((w=k.status)==null?void 0:w.toLowerCase())===n.toLowerCase();return b&&v});return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading drivers..."})}):e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Add Driver"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",N.length," entries"]}),e.jsxs("select",{value:n,onChange:k=>l(k.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"on_leave",children:"On Leave"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:r,onChange:k=>a(k.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact No."}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:N.map(k=>{var b;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>{x(k),f(!0)},className:"text-blue-600 hover:text-blue-800",title:"View/Edit Driver",children:e.jsx(tr,{className:"w-4 h-4"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(k.full_name||"U")}&background=random`,alt:k.full_name,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:k.full_name}),e.jsx("p",{className:"text-sm text-gray-500",children:k.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.phone_number||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.role||"Driver"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.code||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded font-medium ${((b=k.status)==null?void 0:b.toLowerCase())==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:k.status||"Active"})})]},k.id)})})]})})]}),o&&e.jsx(hx,{onClose:()=>{u(!1),y()}}),m&&c&&e.jsx(Wb,{driver:c,onClose:()=>{f(!1),x(null),y()}})]})}function Xb(){const[t,s]=p.useState([]),[r,a]=p.useState(""),[n,l]=p.useState("Active"),[i,d]=p.useState(!0),[o,u]=p.useState(!1),[c,x]=p.useState(!1),[m,f]=p.useState(null);p.useEffect(()=>{y()},[]);async function y(){try{const{data:k,error:b}=await T.from("profiles").select(`
          *,
          staff(code, status)
        `).in("role",["admin","dispatcher","manager"]).order("full_name");if(b)throw b;s(k||[])}catch(k){console.error("Error loading staff:",k)}finally{d(!1)}}const N=t.filter(k=>{var h,g,w;const b=((h=k.full_name)==null?void 0:h.toLowerCase().includes(r.toLowerCase()))||((g=k.email)==null?void 0:g.toLowerCase().includes(r.toLowerCase())),v=!n||((w=k.status)==null?void 0:w.toLowerCase())===n.toLowerCase();return b&&v});return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading staff..."})}):e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Add Staff"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",N.length," entries"]}),e.jsxs("select",{value:n,onChange:k=>l(k.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:r,onChange:k=>a(k.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact No."}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:N.map(k=>{var b,v;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>{f(k),x(!0)},className:"text-blue-600 hover:text-blue-800",children:e.jsx(tr,{className:"w-4 h-4"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(k.full_name||"U")}&background=random`,alt:k.full_name,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:k.full_name}),e.jsx("p",{className:"text-sm text-gray-500",children:k.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.phone||"(000) 000-0000"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.role==="admin"?"Full Access":k.role}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((b=k.staff)==null?void 0:b.code)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded font-medium bg-green-100 text-green-700",children:((v=k.staff)==null?void 0:v.status)||"Active"})})]},k.id)})})]})})]}),o&&e.jsx(Zb,{onClose:()=>{u(!1),y()}}),c&&m&&e.jsx(Jb,{staff:m,onClose:()=>{x(!1),f(null),y()}})]})}function Zb({onClose:t}){const[s,r]=p.useState({email:"",password:"",full_name:"",phone:"",role:"dispatcher"}),[a,n]=p.useState(!1),[l,i]=p.useState(""),[d,o]=p.useState(""),u=async c=>{c.preventDefault(),n(!0),i("");try{const{data:x,error:m}=await T.auth.signUp({email:s.email,password:s.password,options:{data:{full_name:s.full_name,role:s.role}}});if(m)throw m;if(x.user){const{error:f}=await T.from("profiles").upsert({id:x.user.id,full_name:s.full_name,phone:s.phone,email:s.email,role:s.role,status:"active"},{onConflict:"id"});if(f)throw f;const y="https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/send-welcome-sms",N={Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"};try{const k=await fetch(y,{method:"POST",headers:N,body:JSON.stringify({phone:s.phone,full_name:s.full_name,email:s.email,password:s.password,role:s.role})}),b=await k.json();k.ok?(o("Staff created and welcome SMS sent successfully"),setTimeout(()=>t(),2e3)):(console.error("SMS send failed:",b),o("Staff created but SMS notification failed to send"),setTimeout(()=>t(),2500))}catch(k){console.error("SMS send error:",k),o("Staff created but SMS notification failed to send"),setTimeout(()=>t(),2500)}}else t()}catch(x){x instanceof Error?i(x.message):i("Failed to create staff member")}finally{n(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New Staff Member"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(re,{className:"w-6 h-6 rotate-45"})})]}),e.jsxs("form",{onSubmit:u,className:"p-6 space-y-4",children:[l&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:l}),d&&e.jsx("div",{className:`border px-4 py-3 rounded-lg text-sm ${d.includes("failed")?"bg-yellow-50 border-yellow-200 text-yellow-700":"bg-green-50 border-green-200 text-green-700"}`,children:d}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),e.jsx("input",{type:"text",required:!0,value:s.full_name,onChange:c=>r({...s,full_name:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"John Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",required:!0,value:s.email,onChange:c=>r({...s,email:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"staff@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",required:!0,value:s.phone,onChange:c=>r({...s,phone:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"(555) 123-4567"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsxs("select",{value:s.role,onChange:c=>r({...s,role:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"dispatcher",children:"Dispatcher"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsx("input",{type:"password",required:!0,minLength:6,value:s.password,onChange:c=>r({...s,password:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Min. 6 characters"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:a,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Creating...":"Create Staff"})]})]})]})})}function Yb(){const[t,s]=p.useState([]),[r,a]=p.useState(""),[n,l]=p.useState("Active"),[i,d]=p.useState(!0),[o,u]=p.useState(!1);p.useEffect(()=>{c()},[]);async function c(){try{const{data:m,error:f}=await T.from("patients").select("*").order("full_name");if(f)throw f;s(m||[])}catch(m){console.error("Error loading members:",m)}finally{d(!1)}}const x=t.filter(m=>{var N,k,b;const f=((N=m.full_name)==null?void 0:N.toLowerCase().includes(r.toLowerCase()))||((k=m.phone)==null?void 0:k.toLowerCase().includes(r.toLowerCase())),y=!n||((b=m.status)==null?void 0:b.toLowerCase())===n.toLowerCase();return f&&y});return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading members..."})}):e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Add Member"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",x.length," entries"]}),e.jsxs("select",{value:n,onChange:m=>l(m.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search Member",value:r,onChange:m=>a(m.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:e.jsx("input",{type:"checkbox",className:"rounded"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact No."}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Address"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Member Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Source"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Created At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Updated At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:x.map(m=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("input",{type:"checkbox",className:"rounded"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:e.jsx(Wr,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:e.jsx(tr,{className:"w-4 h-4"})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Ze,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:m.full_name}),e.jsx("p",{className:"text-sm text-gray-500",children:m.email||"No email"})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.phone||"(000) 000-0000"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:m.address||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.member_type||"Patient"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.source||"Panel"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(m.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(m.updated_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded font-medium bg-green-100 text-green-700",children:m.status||"Active"})})]},m.id))})]})})]}),o&&e.jsx(Ic,{onClose:()=>{u(!1),c()}})]})}function ev(){const[t,s]=p.useState([]),[r,a]=p.useState(""),[n,l]=p.useState("Active"),[i,d]=p.useState(!0),[o,u]=p.useState(!1);p.useEffect(()=>{c()},[]);async function c(){try{const{data:m,error:f}=await T.from("funding_sources").select("*").order("name");if(f)throw f;s(m||[])}catch(m){console.error("Error loading funding sources:",m)}finally{d(!1)}}const x=t.filter(m=>{var N,k;const f=((N=m.name)==null?void 0:N.toLowerCase().includes(r.toLowerCase()))||((k=m.email)==null?void 0:k.toLowerCase().includes(r.toLowerCase())),y=!n||m.status===n.toLowerCase();return f&&y});return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading funding sources..."})}):e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Add Funding Source"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",x.length," entries"]}),e.jsxs("select",{value:n,onChange:m=>l(m.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:r,onChange:m=>a(m.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Address"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact No."}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Odometer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Insurance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:x.map(m=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:e.jsx(Wr,{className:"w-4 h-4"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(m.name||"U")}&background=random`,alt:m.name,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:m.name}),e.jsx("p",{className:"text-sm text-gray-500",children:m.email||"No email"})]})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:m.address||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.contact_number||"0"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.odometer||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.insurance||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded font-medium bg-green-100 text-green-700",children:m.status==="active"?"Active":"Inactive"})})]},m.id))})]})})]}),o&&e.jsx(tv,{onClose:()=>{u(!1),c()}})]})}function tv({onClose:t}){const[s,r]=p.useState({name:"",code:"",email:"",contact_number:"",address:"",insurance:"",odometer:""}),[a,n]=p.useState(!1),[l,i]=p.useState(""),d=async o=>{o.preventDefault(),n(!0),i("");try{const{error:u}=await T.from("funding_sources").insert({...s,status:"active"});if(u)throw u;t()}catch(u){u instanceof Error?i(u.message):i("Failed to create funding source")}finally{n(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add Funding Source"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(re,{className:"w-6 h-6 rotate-45"})})]}),e.jsxs("form",{onSubmit:d,className:"p-6 space-y-4",children:[l&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:l}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),e.jsx("input",{type:"text",required:!0,value:s.name,onChange:o=>r({...s,name:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Funding Source Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Code"}),e.jsx("input",{type:"text",required:!0,value:s.code,onChange:o=>r({...s,code:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"FS001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:s.email,onChange:o=>r({...s,email:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"contact@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Number"}),e.jsx("input",{type:"tel",value:s.contact_number,onChange:o=>r({...s,contact_number:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"(555) 123-4567"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx("textarea",{value:s.address,onChange:o=>r({...s,address:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"123 Main St, City, State",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Insurance"}),e.jsx("input",{type:"text",value:s.insurance,onChange:o=>r({...s,insurance:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Insurance Provider"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:a,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Creating...":"Create"})]})]})]})})}function sv(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(null),[i,d]=p.useState(!0),[o,u]=p.useState(""),[c,x]=p.useState({start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]});p.useEffect(()=>{m()},[c]),p.useEffect(()=>{f()},[t,o]);async function m(){try{d(!0);const{data:y,error:N}=await T.from("trips").select(`
          id,
          trip_date,
          pickup_address,
          dropoff_address,
          distance_miles,
          driver_id,
          profiles!trips_driver_id_fkey (
            id,
            full_name,
            email
          )
        `).eq("status","completed").gte("trip_date",c.start).lte("trip_date",c.end).not("driver_id","is",null);if(N)throw N;const k=new Map;y==null||y.forEach(b=>{const v=b.driver_id,h=b.profiles;if(!h)return;k.has(v)||k.set(v,{driver_id:v,driver_name:h.full_name,email:h.email,trips:[],total_amount:0,total_miles:0});const g=k.get(v),w=15;g.trips.push({id:b.id,trip_date:b.trip_date,pickup_address:b.pickup_address,dropoff_address:b.dropoff_address,distance_miles:b.distance_miles||0,amount:w}),g.total_amount+=w,g.total_miles+=b.distance_miles||0}),s(Array.from(k.values()))}catch(y){console.error("Error loading driver earnings:",y)}finally{d(!1)}}function f(){let y=[...t];if(o){const N=o.toLowerCase();y=y.filter(k=>k.driver_name.toLowerCase().includes(N)||k.email.toLowerCase().includes(N))}a(y)}return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading driver earnings..."})}):e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-96 bg-white border-r border-gray-200 overflow-y-auto",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:o,onChange:y=>u(y.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:r.map(y=>e.jsx("button",{onClick:()=>l(y),className:`w-full p-4 text-left hover:bg-gray-50 transition-colors ${(n==null?void 0:n.driver_id)===y.driver_id?"bg-blue-50":""}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-600",children:y.driver_name.charAt(0)})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:y.driver_name}),e.jsx("p",{className:"text-xs text-gray-500",children:y.email})]})]})},y.driver_id))})]}),e.jsx("div",{className:"flex-1 overflow-auto bg-gray-50",children:n?e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6 flex items-center gap-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-gray-400"}),e.jsx("input",{type:"date",value:c.start,onChange:y=>x({...c,start:y.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-500",children:"-"}),e.jsx("input",{type:"date",value:c.end,onChange:y=>x({...c,end:y.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trip ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Pickup Address"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Dropoff Address"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Miles"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:n.trips.map(y=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:y.id.substring(0,8)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(y.trip_date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:y.pickup_address}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:y.dropoff_address}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:y.distance_miles.toFixed(1)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["$",y.amount.toFixed(2)]})]},y.id))}),e.jsx("tfoot",{className:"bg-gray-50 border-t border-gray-200",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"px-6 py-4 text-right text-sm font-medium text-gray-900",children:"Total:"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[n.total_miles.toFixed(1)," mi"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900",children:["$",n.total_amount.toFixed(2)]})]})})]})})]}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-gray-500",children:"Select a driver to view earnings"})})})})]})}function rv(){const[t,s]=p.useState([]),[r,a]=p.useState(!0),[n,l]=p.useState({start:new Date(new Date().setDate(1)).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[i,d]=p.useState("pickup"),[o,u]=p.useState("all");p.useEffect(()=>{c()},[n]);async function c(){try{a(!0);const{data:h,error:g}=await T.from("trips").select(`
          id,
          driver_id,
          status,
          pickup_time,
          actual_pickup_time,
          profiles!trips_driver_id_fkey (
            id,
            full_name
          )
        `).eq("status","completed").gte("trip_date",n.start).lte("trip_date",n.end).not("driver_id","is",null);if(g)throw g;const w=new Map;h==null||h.forEach(S=>{const j=S.driver_id,_=S.profiles;if(!_)return;w.has(j)||w.set(j,{driver_id:j,driver_name:_.full_name,completed_trips:0,early_trips:0,on_time_trips:0,late_trips:0,early_time_score:0,on_time_score:0,late_time_score:0,actual_on_time_score:0});const M=w.get(j);if(M.completed_trips++,S.pickup_time&&S.actual_pickup_time){const R=new Date(S.pickup_time),I=(new Date(S.actual_pickup_time).getTime()-R.getTime())/(1e3*60);I<-5?M.early_trips++:I>=-5&&I<=5?M.on_time_trips++:M.late_trips++}}),w.forEach(S=>{S.completed_trips>0&&(S.early_time_score=S.early_trips/S.completed_trips*100,S.on_time_score=S.on_time_trips/S.completed_trips*100,S.late_time_score=S.late_trips/S.completed_trips*100,S.actual_on_time_score=(S.early_trips+S.on_time_trips)/S.completed_trips*100)}),s(Array.from(w.values()))}catch(h){console.error("Error loading driver scores:",h)}finally{a(!1)}}const x=t.reduce((h,g)=>h+g.completed_trips,0),m=t.reduce((h,g)=>h+g.early_trips,0),f=t.reduce((h,g)=>h+g.on_time_trips,0),y=t.reduce((h,g)=>h+g.late_trips,0),N=x>0?m/x*100:0,k=x>0?f/x*100:0,b=x>0?y/x*100:0,v=x>0?(m+f)/x*100:0;return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading driver scores..."})}):e.jsx("div",{className:"flex-1 overflow-auto bg-gray-50",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center gap-4 flex-wrap",children:[e.jsx("select",{value:o,onChange:h=>u(h.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:e.jsx("option",{value:"all",children:"-- Select Funding Source --"})}),e.jsxs("select",{value:i,onChange:h=>d(h.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"pickup",children:"Pickup Wise"}),e.jsx("option",{value:"dropoff",children:"Dropoff Wise"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:n.start,onChange:h=>l({...n,start:h.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-500",children:"-"}),e.jsx("input",{type:"date",value:n.end,onChange:h=>l({...n,end:h.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(Ua,{className:"w-4 h-4"}),"Download"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(ct,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed Trips"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ct,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Early Trips"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(ct,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"On Time Trips"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(ct,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Late Trips"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:y})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ct,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Early Time Score"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[N.toFixed(2),"%"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(ct,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"On Time Score"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[k.toFixed(2),"%"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(ct,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Late Time Score"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[b.toFixed(2),"%"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(ct,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Actual On Time Score"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[v.toFixed(2),"%"]})]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Driver"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Completed"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Early"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"On Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Late"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Early Time Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"On Time Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Late Time Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actual On Time Score"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(h=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:h.driver_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.completed_trips}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.early_trips}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.on_time_trips}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.late_trips}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[h.early_time_score.toFixed(0),"%"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[h.on_time_score.toFixed(0),"%"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[h.late_time_score.toFixed(0),"%"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[h.actual_on_time_score.toFixed(0),"%"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:e.jsx(tr,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:e.jsx(Ua,{className:"w-4 h-4"})})]})})]},h.driver_id))})]})})]})})}function av(){const[t,s]=p.useState([]),[r,a]=p.useState(!0);p.useEffect(()=>{n();const d=T.channel("grievances_changes").on("postgres_changes",{event:"*",schema:"public",table:"grievances"},()=>{n()}).subscribe();return()=>{d.unsubscribe()}},[]);async function n(){try{const{data:d,error:o}=await T.from("grievances").select(`
          *,
          driver:profiles!grievances_driver_id_fkey(full_name),
          patient:patients!grievances_patient_id_fkey(full_name)
        `).order("reported_at",{ascending:!1});if(o)throw o;const u=d==null?void 0:d.map(c=>{var x,m;return{...c,driver_name:((x=c.driver)==null?void 0:x.full_name)||"N/A",patient_name:((m=c.patient)==null?void 0:m.full_name)||"N/A"}});s(u||[])}catch(d){console.error("Error loading grievances:",d)}finally{a(!1)}}const l=t.filter(d=>d.type==="item_lost").length,i=t.filter(d=>d.type==="grievance").length;return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading grievances..."})}):e.jsx("div",{className:"flex-1 overflow-auto bg-gray-50",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",t.length," entries"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg p-8 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ox,{className:"w-8 h-8 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Item Lost"}),e.jsx("p",{className:"text-4xl font-bold text-gray-900",children:l})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-8 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(xe,{className:"w-8 h-8 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Grievance"}),e.jsx("p",{className:"text-4xl font-bold text-gray-900",children:i})]})]})})]}),t.length===0?e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No grievances or items lost reported"})}):e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trip ID."}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Driver"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Member"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Report"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(d=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.trip_id?d.trip_id.substring(0,8):"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.driver_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.patient_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(d.reported_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded font-medium ${d.type==="item_lost"?"bg-blue-100 text-blue-700":"bg-orange-100 text-orange-700"}`,children:d.type==="item_lost"?"Item Lost":"Grievance"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:d.description||"No description"})]},d.id))})]})})]})})}function nv(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(!0),[i,d]=p.useState("");p.useEffect(()=>{o();const c=T.channel("accident_reports_changes").on("postgres_changes",{event:"*",schema:"public",table:"accident_reports"},()=>{o()}).subscribe();return()=>{c.unsubscribe()}},[]),p.useEffect(()=>{u()},[t,i]);async function o(){try{const{data:c,error:x}=await T.from("accident_reports").select(`
          *,
          driver:profiles!accident_reports_driver_id_fkey(full_name)
        `).order("reported_at",{ascending:!1});if(x)throw x;const m=c==null?void 0:c.map(f=>{var y;return{...f,driver_name:((y=f.driver)==null?void 0:y.full_name)||"Unknown Driver"}});s(m||[])}catch(c){console.error("Error loading accident reports:",c)}finally{l(!1)}}function u(){let c=[...t];if(i){const x=i.toLowerCase();c=c.filter(m=>{var f,y;return m.track_id.toLowerCase().includes(x)||((f=m.driver_name)==null?void 0:f.toLowerCase().includes(x))||((y=m.location)==null?void 0:y.toLowerCase().includes(x))})}a(c)}return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading accident reports..."})}):e.jsx("div",{className:"flex-1 overflow-auto bg-gray-50",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",r.length," entries"]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:i,onChange:c=>d(c.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]}),r.length===0?e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No accident reports found"})}):e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Track ID."}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Driver"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Location"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Severity"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Report"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(c=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:c.track_id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:c.driver_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(c.reported_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:c.location}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded font-medium ${c.severity==="severe"?"bg-red-100 text-red-700":c.severity==="moderate"?"bg-orange-100 text-orange-700":"bg-yellow-100 text-yellow-700"}`,children:c.severity.charAt(0).toUpperCase()+c.severity.slice(1)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{className:"px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 flex items-center gap-1",children:[e.jsx(Ua,{className:"w-3 h-3"}),"Modivcare"]}),e.jsxs("button",{className:"px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 flex items-center gap-1",children:[e.jsx(xe,{className:"w-3 h-3"}),"Nemt"]})]})})]},c.id))})]})})]})})}function lv(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(!0),[i,d]=p.useState(""),[o,u]=p.useState("");p.useEffect(()=>{c();const m=T.channel("outbound_messages_changes").on("postgres_changes",{event:"*",schema:"public",table:"outbound_messages"},()=>{c()}).subscribe();return()=>{m.unsubscribe()}},[o]),p.useEffect(()=>{x()},[t,i]);async function c(){try{let m=T.from("outbound_messages").select("*").order("created_at",{ascending:!1});if(o){const N=new Date(o);N.setHours(0,0,0,0);const k=new Date(o);k.setHours(23,59,59,999),m=m.gte("created_at",N.toISOString()).lte("created_at",k.toISOString())}const{data:f,error:y}=await m;if(y)throw y;s(f||[])}catch(m){console.error("Error loading outbound messages:",m)}finally{l(!1)}}function x(){let m=[...t];if(i){const f=i.toLowerCase();m=m.filter(y=>{var N,k,b,v;return((N=y.message)==null?void 0:N.toLowerCase().includes(f))||((k=y.from_number)==null?void 0:k.toLowerCase().includes(f))||((b=y.to_number)==null?void 0:b.toLowerCase().includes(f))||((v=y.status)==null?void 0:v.toLowerCase().includes(f))})}a(m)}return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading outbound messages..."})}):e.jsx("div",{className:"flex-1 overflow-auto bg-gray-50",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-gray-400"}),e.jsx("input",{type:"date",value:o,onChange:m=>u(m.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"relative ml-auto",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:i,onChange:m=>d(m.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]}),r.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx(Fy,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"No Data to show"}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["No outbound messages found",o?" for the selected date":""]})]}):e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Message"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"From"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"To"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Error"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Sent Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Created Date"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(m=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:e.jsx("div",{className:"max-w-xs truncate",children:m.message})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.from_number||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.to_number}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:m.error_message||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded font-medium ${m.status==="sent"?"bg-green-100 text-green-700":m.status==="failed"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:m.status.charAt(0).toUpperCase()+m.status.slice(1)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.sent_at?new Date(m.sent_at).toLocaleString():"Not sent"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(m.created_at).toLocaleString()})]},m.id))})]})})]})})}function iv(){const[t,s]=p.useState("driverEarnings");return e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex gap-1 px-6 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>s("business"),className:`px-6 py-4 font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-2 ${t==="business"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(ct,{className:"w-4 h-4"}),"Business Reports"]}),e.jsxs("button",{onClick:()=>s("statistics"),className:`px-6 py-4 font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-2 ${t==="statistics"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(qa,{className:"w-4 h-4"}),"Statistics"]}),e.jsxs("button",{onClick:()=>s("vehicleInspection"),className:`px-6 py-4 font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-2 ${t==="vehicleInspection"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(xe,{className:"w-4 h-4"}),"Vehicle Inspection"]}),e.jsxs("button",{onClick:()=>s("outbounding"),className:`px-6 py-4 font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-2 ${t==="outbounding"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Fr,{className:"w-4 h-4"}),"Outbounding"]}),e.jsxs("button",{onClick:()=>s("accidental"),className:`px-6 py-4 font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-2 ${t==="accidental"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Ut,{className:"w-4 h-4"}),"Accidental Reports"]}),e.jsxs("button",{onClick:()=>s("grievance"),className:`px-6 py-4 font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-2 ${t==="grievance"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Ze,{className:"w-4 h-4"}),"Grievance / Item Lost"]}),e.jsxs("button",{onClick:()=>s("driverScore"),className:`px-6 py-4 font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-2 ${t==="driverScore"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(qa,{className:"w-4 h-4"}),"Driver Score"]}),e.jsxs("button",{onClick:()=>s("driverEarnings"),className:`px-6 py-4 font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-2 ${t==="driverEarnings"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(ct,{className:"w-4 h-4"}),"Driver Earnings"]})]})}),t==="driverEarnings"&&e.jsx(sv,{}),t==="driverScore"&&e.jsx(rv,{}),t==="grievance"&&e.jsx(av,{}),t==="accidental"&&e.jsx(nv,{}),t==="outbounding"&&e.jsx(lv,{}),(t==="business"||t==="statistics"||t==="vehicleInspection")&&e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-gray-500 text-lg",children:[t==="business"&&"Business Reports coming soon",t==="statistics"&&"Statistics coming soon",t==="vehicleInspection"&&"Vehicle Inspection reports coming soon"]})})})]})}function ov({rate:t,onClose:s}){const[r,a]=p.useState({funding_source_id:"",los:"",space_type:"",days:[],start_time:"00:00",end_time:"23:59",base_fare:0,for_miles:0,per_mile:0,per_minute:0,wait_time:0,every_minutes:0,free_quota_minutes:0,minimum_fare:0,cancel_charge:0,no_show_charge:0,calculate_zone_per_mile:!1,zones:[],code:"",per_mile_code:"",dry_run_code:"",base_fare_code:"",wait_time_code:"",weekend_night_code:"",response_night_code:"",status:"active"}),[n,l]=p.useState([]),[i,d]=p.useState([]),[o,u]=p.useState(!1),[c,x]=p.useState(""),m=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];p.useEffect(()=>{f(),t&&a({funding_source_id:t.funding_source_id||"",los:t.los||"",space_type:t.space_type||"",days:t.days||[],start_time:t.start_time||"00:00",end_time:t.end_time||"23:59",base_fare:t.base_fare||0,for_miles:t.for_miles||0,per_mile:t.per_mile||0,per_minute:t.per_minute||0,wait_time:t.wait_time||0,every_minutes:t.every_minutes||0,free_quota_minutes:t.free_quota_minutes||0,minimum_fare:t.minimum_fare||0,cancel_charge:t.cancel_charge||0,no_show_charge:t.no_show_charge||0,calculate_zone_per_mile:t.calculate_zone_per_mile||!1,zones:t.zones||[],code:t.code||"",per_mile_code:t.per_mile_code||"",dry_run_code:t.dry_run_code||"",base_fare_code:t.base_fare_code||"",wait_time_code:t.wait_time_code||"",weekend_night_code:t.weekend_night_code||"",response_night_code:t.response_night_code||"",status:t.status||"active"})},[t]);async function f(){try{const[h,g]=await Promise.all([T.from("funding_sources").select("id, name").eq("status","active").order("name"),T.from("space_types").select("name, level_of_service").eq("status","active").order("name")]);h.data&&l(h.data),g.data&&d(g.data)}catch(h){console.error("Error loading data:",h)}}const y=h=>{a(g=>({...g,days:g.days.includes(h)?g.days.filter(w=>w!==h):[...g.days,h]}))},N=()=>{a(h=>({...h,zones:[...h.zones,{id:crypto.randomUUID(),name:"",rate:0}]}))},k=h=>{a(g=>({...g,zones:g.zones.filter(w=>w.id!==h)}))},b=(h,g,w)=>{a(S=>({...S,zones:S.zones.map(j=>j.id===h?{...j,[g]:w}:j)}))},v=async h=>{h.preventDefault(),u(!0),x("");try{if(!r.funding_source_id)throw new Error("Please select a funding source");if(!r.los)throw new Error("Please select a level of service");if(!r.space_type)throw new Error("Please select a space type");if(r.days.length===0)throw new Error("Please select at least one day");if(t){const{error:g}=await T.from("rates").update({...r,updated_at:new Date().toISOString()}).eq("id",t.id);if(g)throw g}else{const{error:g}=await T.from("rates").insert([r]);if(g)throw g}s()}catch(g){g instanceof Error?x(g.message):x("Failed to save rate")}finally{u(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-[1024px] max-h-[90vh] flex flex-col m-8",children:[e.jsxs("div",{className:"bg-blue-600 text-white p-6 flex items-center justify-between rounded-t-xl flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold",children:t?"Edit":"Add Rate"}),e.jsx("button",{onClick:s,className:"text-white hover:text-gray-200 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"overflow-y-auto flex-1",children:e.jsxs("form",{id:"rate-form",onSubmit:v,className:"p-6",children:[c&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:c}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Funding Source ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{required:!0,value:r.funding_source_id,onChange:h=>a({...r,funding_source_id:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select..."}),n.map(h=>e.jsx("option",{value:h.id,children:h.name},h.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Level of Service ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{required:!0,value:r.los,onChange:h=>a({...r,los:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select..."}),Array.from(new Set(i.map(h=>h.level_of_service))).map(h=>e.jsx("option",{value:h,children:h},h))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Space Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{required:!0,value:r.space_type,onChange:h=>a({...r,space_type:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select..."}),i.map(h=>e.jsx("option",{value:h.name,children:h.name},h.name))]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),e.jsx("input",{type:"time",value:r.start_time,onChange:h=>a({...r,start_time:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),e.jsx("input",{type:"time",value:r.end_time,onChange:h=>a({...r,end_time:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Day(s) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:`flex flex-wrap gap-1 p-2 border rounded-lg ${r.days.length===0?"border-red-300 bg-red-50":"border-gray-300"}`,children:m.map(h=>e.jsx("button",{type:"button",onClick:()=>y(h),className:`px-2 py-1 text-xs rounded font-medium transition-colors ${r.days.includes(h)?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:h},h))}),r.days.length===0&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:"Please select at least one day"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Base Fare"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),e.jsx("input",{type:"number",step:"0.01",value:r.base_fare,onChange:h=>a({...r,base_fare:parseFloat(h.target.value)||0}),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"For"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",step:"0.01",value:r.for_miles,onChange:h=>a({...r,for_miles:parseFloat(h.target.value)||0}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{className:"px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-sm text-gray-600",children:"Mile"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Per Mile"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),e.jsx("input",{type:"number",step:"0.01",value:r.per_mile,onChange:h=>a({...r,per_mile:parseFloat(h.target.value)||0}),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Per Minute"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),e.jsx("input",{type:"number",step:"0.01",value:r.per_minute,onChange:h=>a({...r,per_minute:parseFloat(h.target.value)||0}),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Fare"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),e.jsx("input",{type:"number",step:"0.01",value:r.minimum_fare,onChange:h=>a({...r,minimum_fare:parseFloat(h.target.value)||0}),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wait Time"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),e.jsx("input",{type:"number",step:"0.01",value:r.wait_time,onChange:h=>a({...r,wait_time:parseFloat(h.target.value)||0}),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Every"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",value:r.every_minutes,onChange:h=>a({...r,every_minutes:parseFloat(h.target.value)||0}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{className:"px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-sm text-gray-600",children:"Minutes"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Free Quota"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",value:r.free_quota_minutes,onChange:h=>a({...r,free_quota_minutes:parseFloat(h.target.value)||0}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{className:"px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-sm text-gray-600",children:"Minutes"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cancel Charges"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),e.jsx("input",{type:"number",step:"0.01",value:r.cancel_charge,onChange:h=>a({...r,cancel_charge:parseFloat(h.target.value)||0}),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"No Show Charges"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),e.jsx("input",{type:"number",step:"0.01",value:r.no_show_charge,onChange:h=>a({...r,no_show_charge:parseFloat(h.target.value)||0}),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Zones"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.calculate_zone_per_mile,onChange:h=>a({...r,calculate_zone_per_mile:h.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Calculate Zone Per Mile"})]})]}),e.jsxs("button",{type:"button",onClick:N,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 text-sm font-medium mb-3",children:[e.jsx(re,{className:"w-4 h-4"}),"Zone"]}),e.jsx("div",{className:"space-y-2",children:r.zones.map(h=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Zone name",value:h.name,onChange:g=>b(h.id,"name",g.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Rate",value:h.rate,onChange:g=>b(h.id,"rate",parseFloat(g.target.value)||0),className:"w-32 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("button",{type:"button",onClick:()=>k(h.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(Za,{className:"w-4 h-4"})})]},h.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Code"}),e.jsx("input",{type:"text",value:r.code,onChange:h=>a({...r,code:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Per Mile Code"}),e.jsx("input",{type:"text",value:r.per_mile_code,onChange:h=>a({...r,per_mile_code:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dry Run Code"}),e.jsx("input",{type:"text",value:r.dry_run_code,onChange:h=>a({...r,dry_run_code:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Base Fare Code"}),e.jsx("input",{type:"text",value:r.base_fare_code,onChange:h=>a({...r,base_fare_code:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wait Time Code"}),e.jsx("input",{type:"text",value:r.wait_time_code,onChange:h=>a({...r,wait_time_code:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weekend Night Code"}),e.jsx("input",{type:"text",value:r.weekend_night_code,onChange:h=>a({...r,weekend_night_code:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Response Night Code"}),e.jsx("input",{type:"text",value:r.response_night_code,onChange:h=>a({...r,response_night_code:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:r.status,onChange:h=>a({...r,status:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200 bg-white rounded-b-xl flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:s,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",form:"rate-form",disabled:o,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Saving...":"Update"})]})]})})}function Tx(){const[t,s]=p.useState("rates");return e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex gap-1 px-6",children:[e.jsx("button",{onClick:()=>s("rates"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="rates"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Rates"}),e.jsx("button",{onClick:()=>s("addons"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="addons"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Addons"}),e.jsx("button",{onClick:()=>s("appointmentTypes"),className:`px-6 py-4 font-medium border-b-2 transition-colors ${t==="appointmentTypes"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Appointment Types"})]})}),t==="rates"&&e.jsx(cv,{}),t==="addons"&&e.jsx(dv,{}),t==="appointmentTypes"&&e.jsx(uv,{})]})}function cv(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(""),[i,d]=p.useState("Active"),[o,u]=p.useState(""),[c,x]=p.useState(!0),[m,f]=p.useState(!1),[y,N]=p.useState(null);p.useEffect(()=>{k()},[]);async function k(){try{const[h,g]=await Promise.all([T.from("rates").select("*, funding_source:funding_sources(name)").order("id"),T.from("funding_sources").select("id, name").order("name")]);h.data&&s(h.data),g.data&&a(g.data)}catch(h){console.error("Error loading rates:",h)}finally{x(!1)}}const b=t.filter(h=>{var j,_;const g=(_=(j=h.funding_source)==null?void 0:j.name)==null?void 0:_.toLowerCase().includes(n.toLowerCase()),w=!i||h.status===i.toLowerCase(),S=!o||h.funding_source_id===o;return g&&w&&S}),v=h=>["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(w=>{const S=h.includes(w);return e.jsx("span",{className:`px-2 py-1 text-xs rounded font-medium ${S?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-400"}`,children:w},w)});return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading rates..."})}):e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>{N(null),f(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Add Rate"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",b.length," entries"]}),e.jsxs("select",{value:o,onChange:h=>u(h.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"-- Select Funding Source --"}),r.map(h=>e.jsx("option",{value:h.id,children:h.name},h.id))]}),e.jsxs("select",{value:i,onChange:h=>d(h.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:n,onChange:h=>l(h.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"#"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Funding Source"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"LOS"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Space Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Day(s)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Start Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"End Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Base Fare"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Per Mile"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Per Minute"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Minimum Fare"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cancel Charge"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"No Show Charge"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:b.map((h,g)=>{var w,S,j,_,M,R,O;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>{N(h),f(!0)},className:"text-blue-600 hover:text-blue-800",children:e.jsx(Wr,{className:"w-4 h-4"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g+1}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((w=h.funding_source)==null?void 0:w.name)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.los}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.space_type}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex gap-1",children:v(h.days||[])})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.start_time}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.end_time}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",((S=h.base_fare)==null?void 0:S.toFixed(1))||"0.0"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",((j=h.per_mile)==null?void 0:j.toFixed(1))||"0.0"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",((_=h.per_minute)==null?void 0:_.toFixed(1))||"0.0"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",((M=h.minimum_fare)==null?void 0:M.toFixed(1))||"0.0"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",((R=h.cancel_charge)==null?void 0:R.toFixed(1))||"0.0"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",((O=h.no_show_charge)==null?void 0:O.toFixed(1))||"0.0"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded font-medium bg-green-100 text-green-700",children:h.status==="active"?"Active":"Inactive"})})]},h.id)})})]})})]}),m&&e.jsx(ov,{rate:y,onClose:()=>{f(!1),N(null),k()}})]})}function dv(){const[t,s]=p.useState([]),[r,a]=p.useState(""),[n,l]=p.useState("Active"),[i,d]=p.useState(!0);p.useEffect(()=>{o()},[]);async function o(){try{const{data:c,error:x}=await T.from("rate_addons").select("*").order("name");if(x)throw x;s(c||[])}catch(c){console.error("Error loading addons:",c)}finally{d(!1)}}const u=t.filter(c=>{var f;const x=(f=c.name)==null?void 0:f.toLowerCase().includes(r.toLowerCase()),m=!n||c.status===n.toLowerCase();return x&&m});return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading addons..."})}):e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Add Addon"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",u.length," entries"]}),e.jsxs("select",{value:n,onChange:c=>l(c.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:r,onChange:c=>a(c.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:u.map(c=>{var x;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:e.jsx(Wr,{className:"w-4 h-4"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:c.name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:c.description||"N/A"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",((x=c.price)==null?void 0:x.toFixed(2))||"0.00"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded font-medium bg-green-100 text-green-700",children:c.status==="active"?"Active":"Inactive"})})]},c.id)})})]})})]})})}function uv(){const[t,s]=p.useState([]),[r,a]=p.useState(""),[n,l]=p.useState("Active"),[i,d]=p.useState(!0);p.useEffect(()=>{o()},[]);async function o(){try{const{data:c,error:x}=await T.from("appointment_types").select("*").order("name");if(x)throw x;s(c||[])}catch(c){console.error("Error loading appointment types:",c)}finally{d(!1)}}const u=t.filter(c=>{var f;const x=(f=c.name)==null?void 0:f.toLowerCase().includes(r.toLowerCase()),m=!n||c.status===n.toLowerCase();return x&&m});return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading appointment types..."})}):e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Add Appointment Type"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",u.length," entries"]}),e.jsxs("select",{value:n,onChange:c=>l(c.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search",value:r,onChange:c=>a(c.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Duration (min)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Color"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:u.map(c=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:e.jsx(Wr,{className:"w-4 h-4"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:c.name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:c.description||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:c.duration_minutes}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:c.color}}),e.jsx("span",{className:"text-sm text-gray-900",children:c.color})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded font-medium bg-green-100 text-green-700",children:c.status==="active"?"Active":"Inactive"})})]},c.id))})]})})]})})}function Ax(){return e.jsx("div",{className:"flex-1 overflow-auto bg-white",children:e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"User Manual"}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Getting Started"}),e.jsx("div",{className:"prose text-gray-600",children:e.jsx("p",{className:"mb-4",children:"Welcome to Helping Hands Transport Management System. This comprehensive platform helps you manage all aspects of your transportation business including drivers, staff, patients, trips, and billing."})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Profiling Section"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Drivers"}),e.jsx("p",{className:"text-gray-600",children:"Manage your driver roster, including contact information, employment details, and status tracking."})]}),e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Staff"}),e.jsx("p",{className:"text-gray-600",children:"Manage administrative staff, dispatchers, and managers with role-based access control."})]}),e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Members"}),e.jsx("p",{className:"text-gray-600",children:"Track patient and member information, including contact details, addresses, and service preferences."})]}),e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Funding Sources"}),e.jsx("p",{className:"text-gray-600",children:"Manage insurance companies, brokers, and other funding sources for billing purposes."})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Rates Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-l-4 border-green-500 pl-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Rates"}),e.jsx("p",{className:"text-gray-600",children:"Configure pricing rates based on funding sources, level of service, space types, and time of day."})]}),e.jsxs("div",{className:"border-l-4 border-green-500 pl-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Addons"}),e.jsx("p",{className:"text-gray-600",children:"Manage additional services and their pricing that can be added to trips."})]}),e.jsxs("div",{className:"border-l-4 border-green-500 pl-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Appointment Types"}),e.jsx("p",{className:"text-gray-600",children:"Define different types of appointments with custom durations and visual indicators."})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The dispatch dashboard provides a real-time overview of your operations including:"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-2 text-gray-600",children:[e.jsx("li",{children:"Active trips and driver locations on an interactive map"}),e.jsx("li",{children:"Recent activity feed showing trip assignments and updates"}),e.jsx("li",{children:"Quick access to add new trips, drivers, and vehicles"}),e.jsx("li",{children:"Operations management for trip planning and coordination"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Fleet Management"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Manage your vehicle fleet including:"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-2 text-gray-600",children:[e.jsx("li",{children:"Vehicle information and specifications"}),e.jsx("li",{children:"Maintenance schedules and history"}),e.jsx("li",{children:"Fuel tracking and expenses"}),e.jsx("li",{children:"Vehicle assignment to drivers"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Trip Management"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Efficiently manage patient transportation:"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-2 text-gray-600",children:[e.jsx("li",{children:"Create and schedule trips"}),e.jsx("li",{children:"Assign drivers and vehicles"}),e.jsx("li",{children:"Track trip status in real-time"}),e.jsx("li",{children:"Manage trip confirmations and signatures"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Support"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"For additional help or support, please contact:"}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-gray-700",children:[e.jsx("strong",{children:"Email:"})," support@helpinghandstransport.com",e.jsx("br",{}),e.jsx("strong",{children:"Phone:"})," (555) 123-4567",e.jsx("br",{}),e.jsx("strong",{children:"Hours:"})," Monday - Friday, 8:00 AM - 6:00 PM"]})})]})]})]})})}function mv(){const[t,s]=p.useState([]),[r,a]=p.useState(!0);p.useEffect(()=>{n()},[]);const n=async()=>{try{const{data:i,error:d}=await T.from("profiles").select("id, full_name, date_of_birth, role, photo_url").not("date_of_birth","is",null).eq("status","active");if(d)throw d;const o=new Date,u=o.getFullYear(),c=o.getMonth(),x=o.getDate(),m=i.map(f=>{const y=new Date(f.date_of_birth),N=new Date(u,y.getMonth(),y.getDate());let k=Math.floor((N.getTime()-o.getTime())/(1e3*60*60*24));if(k<0){const v=new Date(u+1,y.getMonth(),y.getDate());k=Math.floor((v.getTime()-o.getTime())/(1e3*60*60*24))}const b=y.getMonth()===c&&y.getDate()===x;return{...f,daysUntil:k,isToday:b}}).filter(f=>f.daysUntil<=30).sort((f,y)=>f.daysUntil-y.daysUntil);s(m)}catch(i){console.error("Error loading birthdays:",i)}finally{a(!1)}},l=i=>new Date(i).toLocaleDateString("en-US",{month:"long",day:"numeric"});return r?e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Nn,{className:"w-5 h-5 text-pink-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Upcoming Birthdays"})]}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Loading..."})]}):t.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Nn,{className:"w-5 h-5 text-pink-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Upcoming Birthdays"})]}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No upcoming birthdays in the next 30 days"})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Nn,{className:"w-5 h-5 text-pink-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Upcoming Birthdays"})]}),e.jsx("div",{className:"space-y-3",children:t.map(i=>e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg transition-colors ${i.isToday?"bg-pink-50 border-2 border-pink-300":"bg-gray-50 hover:bg-gray-100"}`,children:[i.photo_url?e.jsx("img",{src:i.photo_url,alt:i.full_name,className:"w-10 h-10 rounded-full object-cover border-2 border-white"}):e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(i.full_name)}&background=random&size=40`,alt:i.full_name,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 truncate",children:i.full_name}),e.jsx("p",{className:"text-sm text-gray-500 capitalize",children:i.role})]}),e.jsx("div",{className:"text-right",children:i.isToday?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Nn,{className:"w-4 h-4 text-pink-500"}),e.jsx("span",{className:"text-sm font-semibold text-pink-600",children:"Today!"})]}):i.daysUntil===1?e.jsx("span",{className:"text-sm font-medium text-orange-600",children:"Tomorrow"}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs text-gray-500",children:l(i.date_of_birth)}),e.jsxs("p",{className:"text-xs text-gray-400",children:["in ",i.daysUntil," days"]})]})})]},i.id))})]})}function hv(){const[t,s]=p.useState("dashboard"),[r,a]=p.useState([]),[n,l]=p.useState([]),[i,d]=p.useState([]),[o,u]=p.useState(new Date().toISOString().split("T")[0]),[c,x]=p.useState(!1),[m,f]=p.useState("all"),[y,N]=p.useState(!1),[k,b]=p.useState("roadmap"),[v,h]=p.useState(!1),[g,w]=p.useState(!1),[S,j]=p.useState(!1),[_,M]=p.useState(!1),[R,O]=p.useState(!1),I=p.useRef(null),A=p.useRef(null),F=p.useRef([]),Q=p.useRef(null);p.useEffect(()=>{E(),q(),C();const B=setInterval(()=>{E(),C()},3e4),$=W=>{Q.current&&!Q.current.contains(W.target)&&h(!1)};return document.addEventListener("mousedown",$),()=>{clearInterval(B),document.removeEventListener("mousedown",$)}},[o]),p.useEffect(()=>{window.google&&I.current&&!A.current&&U()},[r]),p.useEffect(()=>{A.current&&A.current.setMapTypeId(k)},[k]);const E=async()=>{const{data:B}=await T.from("profiles").select("*").eq("role","driver");B&&(a(B),P(B))},q=async()=>{const{data:B}=await T.from("trips").select(`
        *,
        patient:patients(full_name, phone),
        driver:profiles(id, full_name)
      `).gte("scheduled_pickup_time",`${o}T00:00:00`).lt("scheduled_pickup_time",`${o}T23:59:59`).order("scheduled_pickup_time",{ascending:!1}).limit(10);B&&l(B)},C=async()=>{const{data:B,error:$}=await T.from("trips").select(`
        *,
        patient:patients(full_name, phone),
        driver:profiles(id, full_name, email)
      `).eq("status","accepted").not("driver_id","is",null).gte("scheduled_pickup_time",`${o}T00:00:00`).lt("scheduled_pickup_time",`${o}T23:59:59`).order("scheduled_pickup_time",{ascending:!1}).limit(10);if(B){const W=B.map(L=>{var K,X;return{id:L.id,type:"trip_accepted",message:`Trip assigned to ${((K=L.driver)==null?void 0:K.full_name)||"Unknown Driver"}`,status:"Accepted",timestamp:L.scheduled_pickup_time,user_name:((X=L.driver)==null?void 0:X.full_name)||"Unknown Driver"}});d(W)}},U=()=>{if(!I.current||!window.google)return;const B=r.length>0&&r[0].current_latitude&&r[0].current_longitude?{lat:r[0].current_latitude,lng:r[0].current_longitude}:{lat:39.8283,lng:-98.5795};A.current=new google.maps.Map(I.current,{zoom:5,center:B,mapTypeId:k,disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1})},P=B=>{if(!A.current||!window.google)return;F.current.forEach(W=>W.setMap(null)),F.current=[];const $=n.filter(W=>W.status==="in_progress"&&W.driver_id).map(W=>W.driver_id);B.forEach(W=>{if(W.current_latitude&&W.current_longitude){const L=`https://ui-avatars.com/api/?name=${encodeURIComponent(W.full_name)}&background=random&size=80`,K=$.includes(W.id);let X="#6b7280",ie="Offline";W.status==="active"&&(K?(X="#9333ea",ie="In Progress"):(X="#10b981",ie="Available"));const Ee={url:`data:image/svg+xml;charset=UTF-8,${encodeURIComponent(`
            <svg width="60" height="60" xmlns="http://www.w3.org/2000/svg">
              <defs>
                <clipPath id="circle-clip-${W.id}">
                  <circle cx="30" cy="30" r="26"/>
                </clipPath>
              </defs>
              <circle cx="30" cy="30" r="28" fill="white"/>
              <circle cx="30" cy="30" r="26" fill="#e5e7eb"/>
              <image href="${L}" x="4" y="4" width="52" height="52" clip-path="url(#circle-clip-${W.id})"/>
              <circle cx="30" cy="30" r="28" fill="none" stroke="white" stroke-width="4"/>
              <circle cx="48" cy="48" r="8" fill="${X}" stroke="white" stroke-width="2"/>
            </svg>
          `)}`,scaledSize:new google.maps.Size(60,60),anchor:new google.maps.Point(30,30)},qe=new google.maps.Marker({position:{lat:W.current_latitude,lng:W.current_longitude},map:A.current,title:W.full_name,icon:Ee}),Be=new google.maps.InfoWindow({content:`
            <div class="p-3">
              <div class="flex items-center gap-3 mb-2">
                <img
                  src="${L}"
                  alt="${W.full_name}"
                  class="w-12 h-12 rounded-full"
                />
                <div>
                  <strong class="text-lg">${W.full_name}</strong><br/>
                  <span class="text-sm" style="color: ${X}">
                    ${ie}
                  </span>
                </div>
              </div>
              ${W.phone_number?`<div class="text-sm text-gray-600"> ${W.phone_number}</div>`:""}
            </div>
          `});qe.addListener("click",()=>{Be.open(A.current,qe)}),F.current.push(qe)}})},V=n.filter(B=>B.status==="in_progress"&&B.driver_id).map(B=>B.driver_id),D={available:r.filter(B=>B.status==="active"&&!V.includes(B.id)).length,busy:0,offline:r.filter(B=>B.status!=="active").length,inProgress:V.length};return e.jsxs("div",{className:"h-screen flex bg-gray-50 overflow-hidden",children:[e.jsxs("aside",{className:"w-48 md:w-64 bg-gradient-to-b from-slate-800 to-slate-900 text-white flex flex-col",children:[e.jsx("div",{className:"p-3 md:p-6 border-b border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsx("div",{className:"w-8 h-8 md:w-12 md:h-12 bg-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(Fe,{className:"w-4 h-4 md:w-7 md:h-7"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-sm md:text-lg",children:"Helping Hands"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Transport"})]})]})}),e.jsxs("nav",{className:"flex-1 py-3 md:py-6",children:[e.jsxs("button",{onClick:()=>s("dashboard"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="dashboard"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(rx,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Dashboard"})]}),e.jsxs("button",{onClick:()=>s("operations"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="operations"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(xe,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Operations"})]}),e.jsxs("button",{onClick:()=>s("trips"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="trips"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(ae,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Trips"})]}),e.jsxs("button",{onClick:()=>s("confirmations"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="confirmations"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(ou,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Confirmations"})]}),e.jsxs("button",{onClick:()=>s("farmout"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="farmout"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(Ze,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Farmout"})]}),e.jsxs("button",{onClick:()=>s("manifest"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="manifest"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(xe,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Manifest"})]}),e.jsxs("button",{onClick:()=>s("profiling"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="profiling"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx($n,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Profiling"})]}),e.jsxs("button",{onClick:()=>s("fleet"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="fleet"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(Fe,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Fleet"})]}),e.jsxs("button",{onClick:()=>s("maintenance"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="maintenance"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(qs,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Maintenance"})]}),e.jsxs("button",{onClick:()=>s("planner"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="planner"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(ge,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Planner"})]}),e.jsxs("button",{onClick:()=>s("reports"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="reports"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(ct,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Reports"})]}),e.jsxs("button",{onClick:()=>s("rates"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="rates"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(Ft,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Rates"})]}),e.jsxs("button",{onClick:()=>s("manual"),className:`w-full px-3 py-2 md:px-6 md:py-3 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors ${t==="manual"?"bg-slate-700/50 border-l-4 border-blue-500 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(ul,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Manual"})]})]}),e.jsx("div",{className:"p-2 md:p-4 border-t border-slate-700",children:e.jsxs("button",{onClick:()=>s("settings"),className:`w-full px-3 py-2 md:px-4 md:py-2 flex items-center gap-2 md:gap-3 text-sm md:text-base transition-colors rounded-lg ${t==="settings"?"bg-slate-700/50 text-white":"hover:bg-slate-700/30 text-slate-300 hover:text-white"}`,children:[e.jsx(qs,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"font-medium",children:"Settings"})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsx("span",{children:new Date().toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>s("notifications"),className:"p-2 hover:bg-gray-100 rounded-lg relative",children:[e.jsx(ou,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),e.jsxs("div",{className:"relative",ref:Q,children:[e.jsx("button",{onClick:()=>h(!v),className:"w-10 h-10 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors flex items-center justify-center shadow-lg",children:e.jsx(re,{className:"w-6 h-6"})}),v&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-xl border border-gray-200 py-2 z-50",children:[e.jsxs("button",{onClick:()=>{x(!0),h(!1)},className:"w-full px-4 py-2.5 text-left text-gray-700 hover:bg-blue-50 flex items-center gap-3 transition-colors",children:[e.jsx(re,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"New Trip"})]}),e.jsxs("button",{onClick:()=>{alert("Import file functionality - Upload CSV/Excel files for bulk trip import"),h(!1)},className:"w-full px-4 py-2.5 text-left text-gray-700 hover:bg-blue-50 flex items-center gap-3 transition-colors",children:[e.jsx(xe,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Import File"})]}),e.jsxs("button",{onClick:()=>{w(!0),h(!1)},className:"w-full px-4 py-2.5 text-left text-gray-700 hover:bg-blue-50 flex items-center gap-3 transition-colors",children:[e.jsx(ke,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Add Driver"})]}),e.jsxs("button",{onClick:()=>{O(!0),h(!1)},className:"w-full px-4 py-2.5 text-left text-gray-700 hover:bg-blue-50 flex items-center gap-3 transition-colors",children:[e.jsx(So,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Add Admin"})]}),e.jsxs("button",{onClick:()=>{j(!0),h(!1)},className:"w-full px-4 py-2.5 text-left text-gray-700 hover:bg-blue-50 flex items-center gap-3 transition-colors",children:[e.jsx(Fe,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Add Vehicle"})]}),e.jsxs("button",{onClick:()=>{s("profiling"),h(!1)},className:"w-full px-4 py-2.5 text-left text-gray-700 hover:bg-blue-50 flex items-center gap-3 transition-colors",children:[e.jsx(Ze,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Add Staff"})]}),e.jsxs("button",{onClick:()=>{M(!0),h(!1)},className:"w-full px-4 py-2.5 text-left text-gray-700 hover:bg-blue-50 flex items-center gap-3 transition-colors",children:[e.jsx($n,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Add Member"})]}),e.jsxs("button",{onClick:()=>{alert("Add Funding Source - Navigate to Fleet > Funding Sources to add a new funding source"),h(!1)},className:"w-full px-4 py-2.5 text-left text-gray-700 hover:bg-blue-50 flex items-center gap-3 transition-colors",children:[e.jsx(Ft,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Add Funding Source"})]}),e.jsxs("button",{onClick:()=>{s("rates"),h(!1)},className:"w-full px-4 py-2.5 text-left text-gray-700 hover:bg-blue-50 flex items-center gap-3 transition-colors",children:[e.jsx(xe,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Add Rate"})]})]})]}),e.jsx("button",{onClick:()=>alert("Open messaging center - View all conversations and send messages"),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(Fr,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{className:"flex items-center gap-3 pl-3 border-l border-gray-200",children:[e.jsx("img",{src:"https://ui-avatars.com/api/?name=Helping+Hands&background=1e40af&color=fff",alt:"Profile",className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Helping Hands Transport..."}),e.jsx("p",{className:"text-xs text-blue-600",children:"Full Access"})]})]})]})]})}),e.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-6 overflow-x-auto",children:[i.slice(0,4).map((B,$)=>e.jsxs("div",{className:"flex items-center gap-3 min-w-max",children:[e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(B.user_name)}&background=random`,alt:B.user_name,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:B.user_name}),e.jsx("p",{className:"text-xs text-gray-600",children:B.message}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(B.timestamp).toLocaleString()})]}),e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:B.status})]},$)),i.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No recent activity"}),e.jsxs("button",{onClick:()=>s("reports"),className:"ml-auto px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 flex items-center gap-2",children:["See All",e.jsx(ct,{className:"w-4 h-4"})]})]})}),e.jsx("div",{className:"flex-1 flex overflow-hidden",children:t==="maintenance"?e.jsx(cb,{}):t==="confirmations"?e.jsx(fb,{}):t==="trips"?e.jsx(vb,{}):t==="operations"?e.jsx(jb,{}):t==="farmout"?e.jsx(_b,{}):t==="notifications"?e.jsx(wb,{}):t==="manifest"?e.jsx(Sb,{}):t==="profiling"?e.jsx(Gb,{}):t==="fleet"?e.jsx(Bb,{}):t==="planner"?e.jsx(Vb,{}):t==="reports"?e.jsx(iv,{}):t==="rates"?e.jsx(Tx,{}):t==="manual"?e.jsx(Ax,{}):t!=="dashboard"?e.jsx("div",{className:"flex-1 flex items-center justify-center bg-white",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:[t==="operations"&&e.jsx(xe,{className:"w-8 h-8 text-blue-600"}),t==="trips"&&e.jsx(ae,{className:"w-8 h-8 text-blue-600"}),t==="farmout"&&e.jsx(Ze,{className:"w-8 h-8 text-blue-600"}),t==="manifest"&&e.jsx(xe,{className:"w-8 h-8 text-blue-600"}),t==="profiling"&&e.jsx($n,{className:"w-8 h-8 text-blue-600"}),t==="fleet"&&e.jsx(Fe,{className:"w-8 h-8 text-blue-600"}),t==="planner"&&e.jsx(ge,{className:"w-8 h-8 text-blue-600"}),t==="reports"&&e.jsx(ct,{className:"w-8 h-8 text-blue-600"}),t==="rates"&&e.jsx(Ft,{className:"w-8 h-8 text-blue-600"}),t==="manual"&&e.jsx(ul,{className:"w-8 h-8 text-blue-600"}),t==="settings"&&e.jsx(qs,{className:"w-8 h-8 text-blue-600"})]}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2 capitalize",children:t}),e.jsx("p",{className:"text-gray-600",children:"This section is under development"}),e.jsx("button",{onClick:()=>s("dashboard"),className:"mt-6 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Back to Dashboard"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col",children:[e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-green-700",children:"Available"}),e.jsx(ke,{className:"w-4 h-4 text-green-600"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:D.available})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-3 border border-red-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-red-700",children:"Busy"}),e.jsx(ke,{className:"w-4 h-4 text-red-600"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-700",children:D.busy})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Offline"}),e.jsx(ke,{className:"w-4 h-4 text-gray-600"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-700",children:D.offline})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-purple-700",children:"In Progress"}),e.jsx(ke,{className:"w-4 h-4 text-purple-600"})]}),e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:D.inProgress})]})]}),e.jsx(mv,{}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:m,onChange:B=>f(B.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg appearance-none bg-white text-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"-- Select Service Area --"}),e.jsx("option",{value:"north",children:"North Region"}),e.jsx("option",{value:"south",children:"South Region"}),e.jsx("option",{value:"east",children:"East Region"}),e.jsx("option",{value:"west",children:"West Region"})]}),e.jsx(_o,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(fx,{})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[r.map(B=>{const $=V.includes(B.id);let W="bg-gray-500",L="Offline";return B.status==="active"&&($?(W="bg-purple-500",L="In Progress"):(W="bg-green-500",L="Available")),e.jsx("div",{className:"px-4 py-4 border-b border-gray-100 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(B.full_name)}&background=random`,alt:B.full_name,className:"w-12 h-12 rounded-full"}),e.jsx("span",{className:`absolute bottom-0 right-0 w-3 h-3 ${W} border-2 border-white rounded-full`})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 truncate",children:B.full_name}),e.jsx("p",{className:"text-xs text-gray-500",children:L})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[B.email&&e.jsx("button",{className:"p-1.5 hover:bg-gray-200 rounded transition-colors",title:"Email",children:e.jsx(Qs,{className:"w-4 h-4 text-gray-600"})}),B.phone_number&&e.jsx("button",{className:"p-1.5 hover:bg-gray-200 rounded transition-colors",title:"Call",children:e.jsx(Xe,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{className:"p-1.5 hover:bg-gray-200 rounded transition-colors",title:"Message",children:e.jsx(Fr,{className:"w-4 h-4 text-gray-600"})})]})]})},B.id)}),r.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-32 text-gray-500",children:[e.jsx(ke,{className:"w-8 h-8 mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No drivers available"})]})]})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsxs("div",{className:"absolute top-4 left-4 z-10 bg-white rounded-lg shadow-lg border border-gray-200",children:[e.jsx("button",{onClick:()=>b("roadmap"),className:`px-4 py-2 text-sm font-medium border-r border-gray-200 ${k==="roadmap"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"} rounded-l-lg transition-colors`,children:"Map"}),e.jsx("button",{onClick:()=>b("satellite"),className:`px-4 py-2 text-sm font-medium ${k==="satellite"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"} rounded-r-lg transition-colors`,children:"Satellite"})]}),e.jsx("button",{onClick:()=>N(!y),className:"absolute top-4 right-4 z-10 p-2 bg-white rounded-lg shadow-lg border border-gray-200 hover:bg-gray-50 transition-colors",title:"Toggle Fullscreen",children:e.jsx(lx,{className:"w-5 h-5 text-gray-700"})}),e.jsx("button",{onClick:()=>alert("Toggle map layers - Switch between traffic, transit, and bike layers"),className:"absolute top-16 right-4 z-10 p-2 bg-white rounded-lg shadow-lg border border-gray-200 hover:bg-gray-50 transition-colors",title:"Layers",children:e.jsx(Vy,{className:"w-5 h-5 text-gray-700"})}),e.jsx("div",{ref:I,className:"w-full h-full",children:!window.google&&e.jsx("div",{className:"flex items-center justify-center h-full bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ae,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Loading map..."})]})})})]})]})})]}),c&&e.jsx(Ya,{onClose:()=>{x(!1),q(),C()}}),g&&e.jsx(hx,{onClose:()=>{w(!1),E()}}),S&&e.jsx(xx,{onClose:()=>{j(!1)},onSuccess:()=>{j(!1)}}),_&&e.jsx(Ic,{patient:null,onClose:()=>{M(!1)}}),R&&e.jsx(pb,{onClose:()=>{O(!1)}})]})}function Px(){var x,m;const{onlineUsers:t,isInCall:s,activeCallWith:r,incomingCall:a,callStatus:n,startCall:l,acceptCall:i,rejectCall:d,endCall:o}=px(),u=t.filter(f=>{var y,N;return((y=f.profiles)==null?void 0:y.role)==="dispatcher"||((N=f.profiles)==null?void 0:N.role)==="admin"}),c=f=>{switch(f){case"online":return"text-green-500";case"talking":return"text-red-500 animate-pulse";case"listening":return"text-yellow-500";default:return"text-gray-400"}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx(Kt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Radio"}),e.jsxs("p",{className:"text-xs text-gray-600",children:[u.length," dispatchers online"]})]})]}),a&&e.jsx("div",{className:"mb-4 p-4 bg-blue-50 border-2 border-blue-300 rounded-lg animate-pulse",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-blue-900",children:"Incoming Call"}),e.jsx("p",{className:"text-sm text-blue-700",children:a.fromName})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:i,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2 font-semibold",children:[e.jsx(hl,{className:"w-5 h-5"}),"Accept"]}),e.jsxs("button",{onClick:d,className:"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center gap-2 font-semibold",children:[e.jsx(za,{className:"w-5 h-5"}),"Decline"]})]})]})}),r&&e.jsxs("div",{className:"mb-4 p-4 bg-green-50 border-2 border-green-300 rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-600 rounded-full flex items-center justify-center",children:e.jsx(Kt,{className:"w-6 h-6 text-white animate-pulse"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-green-900 text-lg",children:n||"Connected"}),e.jsx("p",{className:"text-sm text-green-700",children:((m=(x=t.find(f=>f.user_id===r))==null?void 0:x.profiles)==null?void 0:m.full_name)||"Dispatcher"})]})]})}),e.jsxs("button",{onClick:o,className:"w-full mt-3 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center gap-2 font-semibold",children:[e.jsx(za,{className:"w-5 h-5"}),"End Call"]})]}),!r&&!a&&e.jsx("div",{className:"space-y-2",children:u.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:e.jsx("p",{className:"text-sm",children:"No dispatchers online"})}):e.jsx("div",{className:"space-y-2",children:u.map(f=>{var y,N;return e.jsxs("button",{onClick:()=>l(f.user_id),className:"w-full flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-blue-50 transition-colors border border-gray-200 hover:border-blue-300",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[(y=f.profiles)!=null&&y.photo_url?e.jsx("img",{src:f.profiles.photo_url,alt:f.profiles.full_name,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx(ke,{className:"w-5 h-5 text-white"})}),e.jsx(Yh,{className:`absolute -bottom-1 -right-1 w-4 h-4 fill-current ${c(f.status)}`})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-gray-900",children:((N=f.profiles)==null?void 0:N.full_name)||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-600",children:f.status==="busy"?"On another call":"Available"})]})]}),f.status==="online"&&e.jsxs("div",{className:"px-3 py-1 bg-blue-600 text-white rounded-full text-sm font-medium flex items-center gap-2",children:[e.jsx(hl,{className:"w-4 h-4"}),"Call"]})]},f.id)})})})]})}function xv({driverId:t,onClose:s,onAssigned:r}){const[a,n]=p.useState(!1),[l,i]=p.useState(null),[d,o]=p.useState(!1),[u,c]=p.useState(!1),[x,m]=p.useState(""),f=p.useRef(null),y=p.useRef(null),N=p.useRef(null),k=p.useRef(null);p.useEffect(()=>()=>{v()},[]);async function b(){try{const _=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});f.current&&(f.current.srcObject=_,N.current=_,c(!0),h())}catch(_){console.error("Camera error:",_),i("Unable to access camera. Please check permissions or use manual entry.")}}function v(){k.current&&(clearInterval(k.current),k.current=null),N.current&&(N.current.getTracks().forEach(_=>_.stop()),N.current=null),f.current&&(f.current.srcObject=null),c(!1)}function h(){k.current||(k.current=window.setInterval(()=>{g()},500))}async function g(){if(!f.current||!y.current)return;const _=f.current,M=y.current;if(_.readyState!==_.HAVE_ENOUGH_DATA)return;M.width=_.videoWidth,M.height=_.videoHeight;const R=M.getContext("2d");if(R&&(R.drawImage(_,0,0,M.width,M.height),"BarcodeDetector"in window))try{const I=await new window.BarcodeDetector({formats:["qr_code"]}).detect(M);I.length>0&&await w(I[0].rawValue)}catch(O){console.error("Barcode detection error:",O)}}async function w(_){if(!a){n(!0),i(null);try{const M=JSON.parse(_);if(M.type!=="vehicle_assignment")throw new Error("Invalid QR code type");await S(M.vehicleId)}catch(M){console.error("QR processing error:",M),i("Invalid QR code. Please try again."),n(!1)}}}async function S(_){try{const M=new Date().toISOString().split("T")[0],{data:R}=await T.from("vehicle_assignments").select("id").eq("driver_id",t).eq("assigned_date",M).is("unassigned_at",null);R&&R.length>0&&await T.from("vehicle_assignments").update({unassigned_at:new Date().toISOString()}).eq("driver_id",t).eq("assigned_date",M).is("unassigned_at",null);const{error:O}=await T.from("vehicle_assignments").insert({vehicle_id:_,driver_id:t,assigned_date:M,assigned_by:t,assignment_method:"qr_scan"});if(O)throw O;o(!0),v(),setTimeout(()=>{r(),s()},2e3)}catch(M){console.error("Assignment error:",M),i(M.message||"Failed to assign vehicle"),n(!1)}}async function j(){if(!x.trim()){i("Please enter a vehicle ID or scan QR code");return}n(!0),i(null);try{let _=x.trim();const{data:M}=await T.from("vehicles").select("id").or(`id.eq.${_},rig_no.eq.${_},vehicle_name.ilike.%${_}%`).single();if(!M)throw new Error("Vehicle not found");await S(M.id)}catch(_){i(_.message||"Vehicle not found"),n(!1)}}return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-2xl w-full overflow-hidden",children:[e.jsxs("div",{className:"bg-blue-600 text-white px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Scan Vehicle QR Code"}),e.jsx("button",{onClick:s,className:"text-white hover:text-gray-200 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-6",children:d?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ue,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Vehicle Assigned!"}),e.jsx("p",{className:"text-gray-600",children:"Your vehicle has been assigned successfully."})]}):e.jsxs(e.Fragment,{children:[u?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative bg-black rounded-lg overflow-hidden",children:[e.jsx("video",{ref:f,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-96 object-cover"}),e.jsx("canvas",{ref:y,className:"hidden"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("div",{className:"w-64 h-64 border-4 border-blue-500 rounded-lg"})}),a&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg px-6 py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Processing..."})]})})]}),e.jsx("button",{onClick:v,className:"w-full py-3 bg-gray-600 text-white rounded-lg font-semibold hover:bg-gray-700 transition-colors",children:"Stop Camera"}),e.jsx("p",{className:"text-sm text-center text-gray-600",children:"Position the QR code within the frame"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:b,className:"w-full py-4 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center justify-center gap-3",children:[e.jsx(Fa,{className:"w-6 h-6"}),"Start Camera to Scan"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-4 bg-white text-gray-500",children:"Or enter manually"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",value:x,onChange:_=>m(_.target.value),placeholder:"Enter Vehicle Rig # or Name",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onKeyPress:_=>{_.key==="Enter"&&j()}}),e.jsx("button",{onClick:j,disabled:a,className:"w-full py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Assigning...":"Assign Vehicle"})]})]}),l&&e.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[e.jsx(Ut,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-800",children:l})]})]})})]})})}let yi=null;function pv(){return yi||(yi=new(window.AudioContext||window.webkitAudioContext)),yi}function Ba(){try{const t=pv();for(let s=0;s<3;s++)setTimeout(()=>{const r=t.currentTime,a=t.createOscillator(),n=t.createGain();a.connect(n),n.connect(t.destination),a.frequency.value=1200,a.type="sawtooth",n.gain.setValueAtTime(.4,r),n.gain.exponentialRampToValueAtTime(.01,r+.2),a.start(r),a.stop(r+.2)},s*200)}catch(t){console.error("Error playing urgent alert sound:",t)}}function Mx(){"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission()}function pl(t,s,r){if("Notification"in window&&Notification.permission==="granted"){const a=new Notification(t,{body:s,icon:"/icon-192.svg",badge:"/icon-192.svg",requireInteraction:!0,...r});return Ba(),a}return null}function To(t,s,r){const a=/iPad|iPhone|iPod/.test(navigator.userAgent),n=/Macintosh/.test(navigator.userAgent);if(s&&r)a||n?window.open(`https://maps.apple.com/?daddr=${s},${r}&dirflg=d`,"_blank"):window.open(`https://www.google.com/maps/dir/?api=1&destination=${s},${r}`,"_blank");else{const l=encodeURIComponent(t);a||n?window.open(`https://maps.apple.com/?daddr=${l}&dirflg=d`,"_blank"):window.open(`https://www.google.com/maps/dir/?api=1&destination=${l}`,"_blank")}}function fv(){var F,Q,E,q;const{user:t}=qt(),[s,r]=p.useState([]),[a,n]=p.useState(!0),[l,i]=p.useState("trips"),[d,o]=p.useState([]),[u,c]=p.useState(!1),[x,m]=p.useState("fuel"),[f,y]=p.useState(""),[N,k]=p.useState(!1),[b,v]=p.useState(null),[h,g]=p.useState(!0),[w,S]=p.useState(!1),j=p.useRef(0),_=p.useRef(!0);p.useEffect(()=>{t&&(Mx(),O(),M(),R())},[t]),p.useEffect(()=>{t&&O()},[w]),p.useEffect(()=>{if(!t)return;const C=T.channel("driver-trips-notifications").on("postgres_changes",{event:"UPDATE",schema:"public",table:"trips"},U=>{const P=U.new,V=U.old;P.driver_id===t.id&&P.status==="assigned"&&V.status!=="assigned"&&(h&&!_.current&&(Ba(),pl(" New Trip Assigned!",`Pickup: ${P.pickup_address||"See details"}`,{requireInteraction:!0})),O())}).on("postgres_changes",{event:"INSERT",schema:"public",table:"trips"},U=>{const P=U.new;P.driver_id===t.id&&(h&&!_.current&&(Ba(),pl(" New Trip Assigned!",`Pickup: ${P.pickup_address||"See details"}`,{requireInteraction:!0})),O())}).subscribe();return()=>{C.unsubscribe()}},[t,h]),p.useEffect(()=>{_.current?(_.current=!1,j.current=s.length):s.length>j.current&&(j.current=s.length)},[s]);async function M(){if(t)try{const{data:C,error:U}=await T.from("trips").select("vehicle:vehicles(*)").eq("driver_id",t.id).not("vehicle_id","is",null);if(U)throw U;const P=Array.from(new Map(C.map(V=>{var D;return[(D=V.vehicle)==null?void 0:D.id,V.vehicle]})).values()).filter(Boolean);o(P),P.length>0&&y(P[0].id)}catch(C){console.error("Error loading vehicles:",C)}}async function R(){if(t)try{const C=new Date().toISOString().split("T")[0],{data:U,error:P}=await T.from("vehicle_assignments").select(`
          *,
          vehicle:vehicles(*)
        `).eq("driver_id",t.id).eq("assigned_date",C).is("unassigned_at",null).order("assigned_at",{ascending:!1}).limit(1).single();if(P&&P.code!=="PGRST116")throw P;v(U)}catch(C){console.error("Error loading assigned vehicle:",C)}}async function O(){if(t){n(!0);try{const C=w?["scheduled","assigned","in_progress","completed"]:["scheduled","assigned","in_progress"],{data:U,error:P}=await T.from("trips").select(`
          *,
          patient:patients(*),
          vehicle:vehicles(*)
        `).eq("driver_id",t.id).in("status",C).order("scheduled_pickup_time",{ascending:!0});if(P)throw P;r(U||[])}catch(C){console.error("Error loading trips:",C)}finally{n(!1)}}}async function I(){if(!(!t||!b))try{const{error:C}=await T.from("vehicle_assignments").update({unassigned_at:new Date().toISOString()}).eq("id",b.id);if(C)throw C;v(null)}catch(C){console.error("Error unassigning vehicle:",C),alert("Failed to unassign vehicle")}}async function A(C,U){try{const P={status:U};U==="in_progress"?P.actual_pickup_time=new Date().toISOString():U==="completed"&&(P.actual_dropoff_time=new Date().toISOString());const{error:V}=await T.from("trips").update(P).eq("id",C);if(V)throw V;await T.from("trip_logs").insert({trip_id:C,user_id:t==null?void 0:t.id,action:`Status changed to ${U}`,details:"Driver updated trip status"}),O()}catch(P){console.error("Error updating trip:",P),alert("Error updating trip status")}}return a?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsxs("div",{className:"bg-blue-600 text-white",children:[e.jsx("div",{className:"p-6 pb-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Driver Dashboard"}),e.jsx("p",{className:"text-blue-100 mt-1",children:"Manage your trips and vehicle"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>g(!h),className:`px-4 py-2 rounded-lg font-medium flex items-center gap-2 transition-colors ${h?"bg-green-500 hover:bg-green-400 text-white":"bg-gray-500 hover:bg-gray-400 text-white"}`,title:h?"Sound Notifications: ON":"Sound Notifications: OFF",children:[e.jsx(ux,{className:"w-5 h-5"}),h?"Sound ON":"Sound OFF"]}),e.jsxs("button",{onClick:()=>{window.history.pushState({},"","/driver-mobile"),window.location.reload()},className:"bg-blue-500 hover:bg-blue-400 text-white px-4 py-2 rounded-lg font-medium flex items-center gap-2",children:[e.jsx(Dc,{className:"w-5 h-5"}),"Mobile App"]})]})]})}),e.jsxs("div",{className:"flex gap-2 px-6 pt-4",children:[e.jsx("button",{onClick:()=>i("trips"),className:`flex-1 py-3 px-4 rounded-t-lg font-medium transition-colors ${l==="trips"?"bg-white text-blue-600":"bg-blue-500 text-white hover:bg-blue-400"}`,children:"My Trips"}),e.jsx("button",{onClick:()=>i("maintenance"),className:`flex-1 py-3 px-4 rounded-t-lg font-medium transition-colors ${l==="maintenance"?"bg-white text-blue-600":"bg-blue-500 text-white hover:bg-blue-400"}`,children:"Fleet Maintenance"})]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(Px,{}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-5",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("h3",{className:"font-semibold text-lg text-gray-900 flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5 text-blue-600"}),"Today's Vehicle"]})}),b?e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:((F=b.vehicle)==null?void 0:F.vehicle_name)||((Q=b.vehicle)==null?void 0:Q.rig_no)}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Rig #: ",((E=b.vehicle)==null?void 0:E.rig_no)||"N/A"]}),((q=b.vehicle)==null?void 0:q.model)&&e.jsx("p",{className:"text-sm text-gray-600",children:b.vehicle.model}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Assigned at ",new Date(b.assigned_at).toLocaleTimeString(),b.assignment_method==="qr_scan"&&" via QR Scan"]})]}),e.jsx("button",{onClick:I,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-medium",children:"Unassign"})]})}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"No vehicle assigned for today"}),e.jsxs("button",{onClick:()=>k(!0),className:"w-full py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(cx,{className:"w-5 h-5"}),"Scan Vehicle QR Code"]})]})]})]}),l==="trips"?e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between bg-white rounded-lg shadow-sm p-4",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Show Completed Trips"}),e.jsx("button",{onClick:()=>S(!w),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${w?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${w?"translate-x-6":"translate-x-1"}`})})]}),s.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[e.jsx(ue,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No active trips assigned"})]}):s.map(C=>{var U,P,V;return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[C.status==="assigned"?e.jsx(Ut,{className:"w-5 h-5 text-yellow-600"}):C.status==="completed"?e.jsx(ue,{className:"w-5 h-5 text-blue-600"}):e.jsx(Se,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-semibold text-lg text-gray-900",children:(U=C.patient)==null?void 0:U.full_name})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${C.status==="assigned"?"bg-yellow-100 text-yellow-800":C.status==="completed"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:C.status==="assigned"?"New":C.status==="completed"?"Completed":"In Progress"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pickup Time"}),e.jsx("p",{className:"font-medium text-gray-900",children:new Date(C.scheduled_pickup_time).toLocaleString()})]})]}),e.jsxs("button",{onClick:()=>To(C.pickup_address,C.pickup_latitude,C.pickup_longitude),className:"flex items-start gap-2 w-full text-left hover:bg-blue-50 p-2 rounded-lg transition-colors group",children:[e.jsx(ae,{className:"w-4 h-4 text-green-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pickup Location"}),e.jsx("p",{className:"font-medium text-gray-900 group-hover:text-blue-600",children:C.pickup_address})]}),e.jsx(_s,{className:"w-4 h-4 text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity mt-1"})]}),e.jsxs("button",{onClick:()=>To(C.dropoff_address,C.dropoff_latitude,C.dropoff_longitude),className:"flex items-start gap-2 w-full text-left hover:bg-red-50 p-2 rounded-lg transition-colors group",children:[e.jsx(ae,{className:"w-4 h-4 text-red-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Dropoff Location"}),e.jsx("p",{className:"font-medium text-gray-900 group-hover:text-red-600",children:C.dropoff_address})]}),e.jsx(_s,{className:"w-4 h-4 text-red-600 opacity-0 group-hover:opacity-100 transition-opacity mt-1"})]}),((P=C.patient)==null?void 0:P.mobility_needs)&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["Mobility: ",C.patient.mobility_needs]})}),((V=C.patient)==null?void 0:V.special_instructions)&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm font-medium text-amber-900",children:"Special Instructions"}),e.jsx("p",{className:"text-sm text-amber-800 mt-1",children:C.patient.special_instructions})]}),C.notes&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-gray-700",children:C.notes})})]}),e.jsxs("div",{className:"flex gap-2",children:[C.status==="assigned"&&e.jsx("button",{onClick:()=>A(C.id,"in_progress"),className:"flex-1 bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Start Trip"}),C.status==="in_progress"&&e.jsx("button",{onClick:()=>A(C.id,"completed"),className:"flex-1 bg-green-600 text-white py-3 rounded-lg font-medium hover:bg-green-700 transition-colors",children:"Complete Trip"})]})]},C.id)})]}):e.jsx(gv,{vehicles:d,currentVehicleId:f,setCurrentVehicleId:y,onAddRecord:C=>{m(C),c(!0)}}),u&&e.jsx(yv,{type:x,vehicleId:f,vehicles:d,onClose:()=>c(!1),onSuccess:()=>{c(!1)}}),N&&t&&e.jsx(xv,{driverId:t.id,onClose:()=>k(!1),onAssigned:()=>{R(),k(!1)}})]})}function gv({vehicles:t,currentVehicleId:s,setCurrentVehicleId:r,onAddRecord:a}){const n=t.find(l=>l.id===s);return t.length===0?e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[e.jsx(Fe,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No vehicles assigned yet"})]})}):e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Vehicle"}),e.jsx("select",{value:s,onChange:l=>r(l.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:t.map(l=>e.jsxs("option",{value:l.id,children:[l.vehicle_number," - ",l.make," ",l.model," (",l.license_plate,")"]},l.id))})]}),n&&e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Fe,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-lg text-gray-900",children:[n.make," ",n.model]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[n.year,"  ",n.license_plate]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx("button",{onClick:()=>a("fuel"),className:"bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow text-left",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(tx,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Add Fuel Record"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Log fuel purchases and mileage"})]}),e.jsx(re,{className:"w-5 h-5 text-gray-400"})]})}),e.jsx("button",{onClick:()=>a("maintenance"),className:"bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow text-left",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ab,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Report Maintenance"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Log service and repairs"})]}),e.jsx(re,{className:"w-5 h-5 text-gray-400"})]})}),e.jsx("button",{onClick:()=>a("expense"),className:"bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow text-left",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Ft,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Add Expense"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Report tolls, parking, etc."})]}),e.jsx(re,{className:"w-5 h-5 text-gray-400"})]})})]})]})}function yv({type:t,vehicleId:s,vehicles:r,onClose:a,onSuccess:n}){const{user:l}=qt(),[i,d]=p.useState({vehicle_id:s,date:new Date().toISOString().split("T")[0],fuel_type:"regular"}),[o,u]=p.useState(!1),c=async m=>{m.preventDefault(),u(!0);try{if(!l)return;t==="fuel"?await T.from("fuel_records").insert({vehicle_id:i.vehicle_id,gallons:i.gallons,cost_per_gallon:i.cost_per_gallon,total_cost:Number(i.gallons)*Number(i.cost_per_gallon),odometer_reading:i.odometer_reading,fuel_date:i.date,location:i.location,fuel_type:i.fuel_type,notes:i.notes,created_by:l.id}):t==="maintenance"?await T.from("vehicle_maintenance").insert({vehicle_id:i.vehicle_id,maintenance_type:i.maintenance_type,description:i.description,cost:i.cost||0,odometer_reading:i.odometer_reading,service_date:i.date,vendor_name:i.vendor_name||"Self-reported",notes:i.notes,created_by:l.id}):await T.from("vehicle_expenses").insert({vehicle_id:i.vehicle_id,expense_type:i.expense_type,description:i.description,amount:i.amount,expense_date:i.date,vendor_name:i.vendor_name,notes:i.notes,created_by:l.id}),n()}catch(f){console.error("Error adding record:",f)}finally{u(!1)}},x={fuel:"Add Fuel Record",maintenance:"Report Maintenance",expense:"Add Expense"};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:x[t]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:c,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vehicle"}),e.jsx("select",{value:i.vehicle_id,onChange:m=>d({...i,vehicle_id:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:r.map(m=>e.jsxs("option",{value:m.id,children:[m.vehicle_number," - ",m.make," ",m.model]},m.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:i.date,onChange:m=>d({...i,date:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),t==="fuel"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fuel Type"}),e.jsxs("select",{value:i.fuel_type,onChange:m=>d({...i,fuel_type:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"regular",children:"Regular"}),e.jsx("option",{value:"premium",children:"Premium"}),e.jsx("option",{value:"diesel",children:"Diesel"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gallons"}),e.jsx("input",{type:"number",step:"0.01",value:i.gallons||"",onChange:m=>d({...i,gallons:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"$/Gallon"}),e.jsx("input",{type:"number",step:"0.001",value:i.cost_per_gallon||"",onChange:m=>d({...i,cost_per_gallon:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Odometer"}),e.jsx("input",{type:"number",value:i.odometer_reading||"",onChange:m=>d({...i,odometer_reading:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Current mileage",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:i.location||"",onChange:m=>d({...i,location:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Gas station name"})]})]}),t==="maintenance"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsxs("select",{value:i.maintenance_type||"",onChange:m=>d({...i,maintenance_type:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"oil_change",children:"Oil Change"}),e.jsx("option",{value:"tire_rotation",children:"Tire Rotation"}),e.jsx("option",{value:"brake_service",children:"Brake Service"}),e.jsx("option",{value:"inspection",children:"Inspection"}),e.jsx("option",{value:"issue_reported",children:"Issue Reported"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:i.description||"",onChange:m=>d({...i,description:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Odometer"}),e.jsx("input",{type:"number",value:i.odometer_reading||"",onChange:m=>d({...i,odometer_reading:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost (if known)"}),e.jsx("input",{type:"number",step:"0.01",value:i.cost||"",onChange:m=>d({...i,cost:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),t==="expense"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsxs("select",{value:i.expense_type||"",onChange:m=>d({...i,expense_type:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"tolls",children:"Tolls"}),e.jsx("option",{value:"parking",children:"Parking"}),e.jsx("option",{value:"car_wash",children:"Car Wash"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:i.description||"",onChange:m=>d({...i,description:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),e.jsx("input",{type:"number",step:"0.01",value:i.amount||"",onChange:m=>d({...i,amount:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor (Optional)"}),e.jsx("input",{type:"text",value:i.vendor_name||"",onChange:m=>d({...i,vendor_name:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),e.jsx("textarea",{value:i.notes||"",onChange:m=>d({...i,notes:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:2})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:o,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:o?"Saving...":"Save"})]})]})]})})}function bv({invoice:t,onClose:s}){var m;const[r,a]=p.useState([]),[n,l]=p.useState([]),[i,d]=p.useState(!1),[o,u]=p.useState({trip_id:(t==null?void 0:t.trip_id)||"",patient_id:(t==null?void 0:t.patient_id)||"",invoice_number:(t==null?void 0:t.invoice_number)||`INV-${Date.now()}`,amount:((m=t==null?void 0:t.amount)==null?void 0:m.toString())||"",status:(t==null?void 0:t.status)||"pending",billing_date:(t==null?void 0:t.billing_date)||new Date().toISOString().split("T")[0],due_date:(t==null?void 0:t.due_date)||"",paid_date:(t==null?void 0:t.paid_date)||"",payment_method:(t==null?void 0:t.payment_method)||"",notes:(t==null?void 0:t.notes)||""});p.useEffect(()=>{c()},[]);async function c(){try{const[f,y]=await Promise.all([T.from("trips").select("*, patient:patients(*)").eq("status","completed").order("created_at",{ascending:!1}),T.from("patients").select("*").order("full_name")]);f.data&&a(f.data),y.data&&l(y.data)}catch(f){console.error("Error loading data:",f)}}async function x(f){f.preventDefault(),d(!0);try{const y={...o,amount:parseFloat(o.amount),due_date:o.due_date||null,paid_date:o.paid_date||null,payment_method:o.payment_method||null,notes:o.notes||null},N=(t==null?void 0:t.status)!=="paid",k=o.status==="paid";if(t){const{error:b}=await T.from("invoices").update(y).eq("id",t.id);if(b)throw b}else{const{error:b}=await T.from("invoices").insert(y);if(b)throw b}if(N&&k&&o.patient_id)try{await fetch("https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/send-invoice-notification",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"},body:JSON.stringify({invoice_number:o.invoice_number,amount:o.amount,patient_id:o.patient_id,payment_method:o.payment_method,paid_date:o.paid_date})})}catch(b){console.error("Error sending notification:",b)}s()}catch(y){console.error("Error saving invoice:",y),alert("Error saving invoice")}finally{d(!1)}}return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Edit Invoice":"New Invoice"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:x,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Invoice Number *"}),e.jsx("input",{type:"text",value:o.invoice_number,onChange:f=>u({...o,invoice_number:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),e.jsx("input",{type:"number",step:"0.01",value:o.amount,onChange:f=>u({...o,amount:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trip"}),e.jsxs("select",{value:o.trip_id,onChange:f=>{const y=r.find(N=>N.id===f.target.value);u({...o,trip_id:f.target.value,patient_id:(y==null?void 0:y.patient_id)||o.patient_id})},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a trip"}),r.map(f=>{var y;return e.jsxs("option",{value:f.id,children:[new Date(f.scheduled_pickup_time).toLocaleDateString()," -"," ",(y=f.patient)==null?void 0:y.full_name," - ",f.pickup_address]},f.id)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patient *"}),e.jsxs("select",{value:o.patient_id,onChange:f=>u({...o,patient_id:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Select a patient"}),n.map(f=>e.jsx("option",{value:f.id,children:f.full_name},f.id))]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:o.status,onChange:f=>u({...o,status:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"overdue",children:"Overdue"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),e.jsxs("select",{value:o.payment_method,onChange:f=>u({...o,payment_method:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select method"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"check",children:"Check"}),e.jsx("option",{value:"credit_card",children:"Credit Card"}),e.jsx("option",{value:"cash_app",children:"Cash App"}),e.jsx("option",{value:"apple_pay",children:"Apple Pay"}),e.jsx("option",{value:"zelle",children:"Zelle"}),e.jsx("option",{value:"paypal",children:"PayPal"}),e.jsx("option",{value:"insurance",children:"Insurance"}),e.jsx("option",{value:"medicaid",children:"Medicaid"}),e.jsx("option",{value:"medicare",children:"Medicare"})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Billing Date *"}),e.jsx("input",{type:"date",value:o.billing_date,onChange:f=>u({...o,billing_date:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date"}),e.jsx("input",{type:"date",value:o.due_date,onChange:f=>u({...o,due_date:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Paid Date"}),e.jsx("input",{type:"date",value:o.paid_date,onChange:f=>u({...o,paid_date:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:o.notes,onChange:f=>u({...o,notes:f.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"submit",disabled:i,className:"flex-1 bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(sr,{className:"w-5 h-5"}),i?"Saving...":"Save Invoice"]}),e.jsx("button",{type:"button",onClick:s,className:"px-6 py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})}function vv(){const[t,s]=p.useState([]),[r,a]=p.useState(!0),[n,l]=p.useState(!1),[i,d]=p.useState(null),[o,u]=p.useState("all"),[c,x]=p.useState({total:0,pending:0,paid:0,overdue:0});p.useEffect(()=>{m()},[o]);async function m(){a(!0);try{let N=T.from("invoices").select(`
          *,
          trip:trips(*),
          patient:patients(*)
        `).order("billing_date",{ascending:!1});o!=="all"&&(N=N.eq("status",o));const{data:k,error:b}=await N;if(b)throw b;const v=k||[];s(v);const h=v.reduce((j,_)=>j+Number(_.amount),0),g=v.filter(j=>j.status==="pending").reduce((j,_)=>j+Number(_.amount),0),w=v.filter(j=>j.status==="paid").reduce((j,_)=>j+Number(_.amount),0),S=v.filter(j=>j.status==="overdue").reduce((j,_)=>j+Number(_.amount),0);x({total:h,pending:g,paid:w,overdue:S})}catch(N){console.error("Error loading invoices:",N)}finally{a(!1)}}function f(N){switch(N){case"paid":return e.jsx(ue,{className:"w-5 h-5 text-green-600"});case"pending":return e.jsx(Se,{className:"w-5 h-5 text-yellow-600"});case"overdue":return e.jsx(Gs,{className:"w-5 h-5 text-red-600"});default:return e.jsx(xe,{className:"w-5 h-5 text-gray-600"})}}function y(N){switch(N){case"paid":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"overdue":return"bg-red-100 text-red-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}return e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Billing Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage invoices and payments"})]}),e.jsxs("button",{onClick:()=>{d(null),l(!0)},className:"bg-brand-pink text-white px-6 py-3 rounded-lg font-medium hover:bg-brand-red transition-colors flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"New Invoice"]})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Ft,{className:"w-8 h-8 text-brand-pink"}),e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",c.total.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ue,{className:"w-8 h-8 text-green-600"}),e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Paid"})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",c.paid.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Se,{className:"w-8 h-8 text-yellow-600"}),e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Pending"})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",c.pending.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Gs,{className:"w-8 h-8 text-red-600"}),e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Overdue"})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",c.overdue.toFixed(2)]})]})]}),e.jsx("div",{className:"mb-6 flex gap-2 overflow-x-auto pb-2",children:["all","pending","paid","overdue"].map(N=>e.jsx("button",{onClick:()=>u(N),className:`px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-colors ${o===N?"bg-brand-pink text-white":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-300"}`,children:N.charAt(0).toUpperCase()+N.slice(1)},N))}),r?e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[e.jsx(xe,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No invoices found"})]}):e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoice #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(N=>{var k;return e.jsxs("tr",{onClick:()=>{d(N),l(!0)},className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[f(N.status),e.jsx("span",{className:"font-medium text-gray-900",children:N.invoice_number})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-gray-900",children:(k=N.patient)==null?void 0:k.full_name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"font-semibold text-gray-900",children:["$",Number(N.amount).toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${y(N.status)}`,children:N.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-600",children:new Date(N.billing_date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-600",children:N.due_date?new Date(N.due_date).toLocaleDateString():"-"})]},N.id)})})]})})}),n&&e.jsx(bv,{invoice:i,onClose:()=>{l(!1),d(null),m()}})]})}function jv(){const[t,s]=p.useState([{role:"assistant",content:`Hello! I'm your bilingual AI receptionist for Helping Hands Transportation. I can help you book a medical transportation trip and provide price quotes. I speak English and Spanish!

Hola! Soy su recepcionista de IA bilinge para Helping Hands Transportation. Puedo ayudarle a reservar un viaje de transporte mdico y proporcionarle cotizaciones de precios. Hablo ingls y espaol!

How can I help you today?`}]),[r,a]=p.useState(""),[n,l]=p.useState(!1);async function i(d){if(d.preventDefault(),!r.trim()||n)return;const o=r.trim();a(""),s(u=>[...u,{role:"user",content:o}]),l(!0);try{const u=await fetch("https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/ai-receptionist",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"},body:JSON.stringify({message:o,conversation:t})});if(!u.ok)throw new Error("Failed to get response");const c=await u.json();s(x=>[...x,{role:"assistant",content:c.response}]),c.tripCreated&&s(x=>[...x,{role:"assistant",content:"Trip has been successfully scheduled! A dispatcher will assign a driver shortly."}])}catch(u){console.error("Error:",u),s(c=>[...c,{role:"assistant",content:"I apologize, but I encountered an error. Please try again or contact our dispatch team directly."}])}finally{l(!1)}}return e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx(Zh,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"AI Receptionist"}),e.jsx("p",{className:"text-gray-600",children:"Book trips and get instant quotes in English or Spanish"})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"h-[500px] overflow-y-auto p-6 space-y-4",children:[t.map((d,o)=>e.jsx("div",{className:`flex ${d.role==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] rounded-lg px-4 py-3 ${d.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:d.content})})},o)),n&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gray-100 rounded-lg px-4 py-3",children:e.jsx(Wy,{className:"w-5 h-5 text-gray-600 animate-spin"})})})]}),e.jsx("form",{onSubmit:i,className:"border-t border-gray-200 p-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:r,onChange:d=>a(d.target.value),placeholder:"Type your message...",className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:n}),e.jsxs("button",{type:"submit",disabled:n||!r.trim(),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(Mc,{className:"w-5 h-5"}),"Send"]})]})})]}),e.jsxs("div",{className:"mt-6 grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Booking Tips / Consejos:"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:" Speak in English or Spanish - I understand both!"}),e.jsx("li",{children:" Provide patient name and phone number"}),e.jsx("li",{children:" Include complete pickup and dropoff addresses"}),e.jsx("li",{children:" Specify date and time for pickup"}),e.jsx("li",{children:" Ask for a price quote anytime!"})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"Pricing Structure:"}),e.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[e.jsx("li",{children:" Base rate: $50"}),e.jsx("li",{children:" Per mile: $3.50"}),e.jsx("li",{children:" Wheelchair accessible: +$20"}),e.jsx("li",{children:" Stretcher service: +$35"}),e.jsx("li",{children:" After hours (6PM-6AM): +$30"})]})]})]})]})}function wv(){const[t,s]=p.useState([]),[r,a]=p.useState(!0),[n,l]=p.useState(!1),[i,d]=p.useState(null);p.useEffect(()=>{o()},[]);async function o(){a(!0);try{const{data:u,error:c}=await T.from("patients").select("*").order("full_name");if(c)throw c;s(u||[])}catch(u){console.error("Error loading patients:",u)}finally{a(!1)}}return e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Patients"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage patient information"})]}),e.jsxs("button",{onClick:()=>{d(null),l(!0)},className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Add Patient"]})]}),r?e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[e.jsx(Ze,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No patients found"})]}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(u=>e.jsxs("div",{onClick:()=>{d(u),l(!0)},className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-pointer p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:u.full_name}),u.mobility_needs!=="ambulatory"&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded",children:u.mobility_needs})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Xe,{className:"w-4 h-4"}),e.jsx("span",{children:u.phone})]}),u.email&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Qs,{className:"w-4 h-4"}),e.jsx("span",{children:u.email})]}),u.date_of_birth&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(u.date_of_birth).toLocaleDateString()})]}),u.insurance_provider&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Insurance"}),e.jsx("p",{className:"font-medium text-gray-700",children:u.insurance_provider}),u.insurance_id&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["ID: ",u.insurance_id]})]}),u.special_instructions&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ut,{className:"w-4 h-4 text-amber-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-gray-700",children:u.special_instructions})]})})]})]},u.id))}),n&&e.jsx(Ic,{patient:i,onClose:()=>{l(!1),d(null),o()}})]})}function Nv(){const[t,s]=p.useState([]),[r,a]=p.useState(!1),[n,l]=p.useState(!1),[i,d]=p.useState({organization_name:"",organization_type:"nursing_home",contact_name:"",contact_email:"",contact_phone:"",address:"",billing_address:""});p.useEffect(()=>{o()},[]);const o=async()=>{const{data:m,error:f}=await T.from("client_portals").select("*").order("created_at",{ascending:!1});!f&&m&&s(m)},u=async m=>{m.preventDefault(),l(!0);const{error:f}=await T.from("client_portals").insert([i]);f||(a(!1),d({organization_name:"",organization_type:"nursing_home",contact_name:"",contact_email:"",contact_phone:"",address:"",billing_address:""}),o()),l(!1)},c=async(m,f)=>{const y=f==="active"?"inactive":"active";await T.from("client_portals").update({status:y}).eq("id",m),o()},x=m=>{navigator.clipboard.writeText(m),alert("API Key copied to clipboard!")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Client Portal Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage self-service portals for nursing homes and private clients"})]}),e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all shadow-lg hover:shadow-xl",children:[e.jsx(re,{className:"w-5 h-5"}),"Add Portal"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(m=>e.jsxs("div",{className:"bg-white rounded-xl shadow-lg hover:shadow-xl transition-all p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:e.jsx(ml,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:m.organization_name}),e.jsx("span",{className:"text-sm text-gray-500 capitalize",children:m.organization_type.replace("_"," ")})]})]}),e.jsx("button",{onClick:()=>c(m.id,m.status),className:`px-3 py-1 rounded-full text-xs font-medium ${m.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:m.status})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Qs,{className:"w-4 h-4"}),m.contact_name]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Qs,{className:"w-4 h-4"}),m.contact_email]}),m.contact_phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Xe,{className:"w-4 h-4"}),m.contact_phone]}),m.address&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(ae,{className:"w-4 h-4"}),m.address]})]}),e.jsxs("div",{className:"pt-4 border-t space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"API Key"}),e.jsxs("button",{onClick:()=>x(m.api_key),className:"flex items-center gap-1 text-blue-600 hover:text-blue-700 text-xs",children:[e.jsx(du,{className:"w-3 h-3"}),"Copy Key"]})]}),e.jsx("div",{className:"bg-gray-50 p-2 rounded text-xs font-mono truncate",children:m.api_key})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Portal Login URL"}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/client-portal`),alert("Portal URL copied to clipboard!")},className:"flex items-center gap-1 text-blue-600 hover:text-blue-700 text-xs",children:[e.jsx(du,{className:"w-3 h-3"}),"Copy URL"]})]}),e.jsxs("div",{className:"bg-blue-50 p-2 rounded text-xs font-mono truncate text-blue-800",children:[window.location.origin,"/client-portal"]})]})]})]},m.id))}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Add Client Portal"}),e.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:u,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization Name"}),e.jsx("input",{type:"text",required:!0,value:i.organization_name,onChange:m=>d({...i,organization_name:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization Type"}),e.jsxs("select",{value:i.organization_type,onChange:m=>d({...i,organization_type:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"nursing_home",children:"Nursing Home"}),e.jsx("option",{value:"private_pay",children:"Private Pay"}),e.jsx("option",{value:"medical_facility",children:"Medical Facility"}),e.jsx("option",{value:"dialysis_center",children:"Dialysis Center"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Name"}),e.jsx("input",{type:"text",required:!0,value:i.contact_name,onChange:m=>d({...i,contact_name:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Email"}),e.jsx("input",{type:"email",required:!0,value:i.contact_email,onChange:m=>d({...i,contact_email:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Phone"}),e.jsx("input",{type:"tel",value:i.contact_phone,onChange:m=>d({...i,contact_phone:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx("input",{type:"text",value:i.address,onChange:m=>d({...i,address:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Billing Address"}),e.jsx("input",{type:"text",value:i.billing_address,onChange:m=>d({...i,billing_address:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:n,className:"flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-all disabled:opacity-50 font-medium",children:n?"Creating...":"Create Portal"}),e.jsx("button",{type:"button",onClick:()=>a(!1),className:"px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all",children:"Cancel"})]})]})]})})]})})}function _v(){const[t,s]=p.useState([]),[r,a]=p.useState(!0),[n,l]=p.useState("all"),i=async()=>{a(!0);try{let c=T.from("sms_logs").select("*").order("created_at",{ascending:!1}).limit(100);n!=="all"&&(c=c.eq("status",n));const{data:x,error:m}=await c;if(m)throw m;s(x||[])}catch(c){console.error("Error fetching SMS logs:",c)}finally{a(!1)}};p.useEffect(()=>{i()},[n]);const d=c=>{switch(c){case"sent":return e.jsx(ue,{className:"w-5 h-5 text-green-600"});case"failed":return e.jsx(Gs,{className:"w-5 h-5 text-red-600"});case"pending":return e.jsx(Se,{className:"w-5 h-5 text-yellow-600"});default:return null}},o=c=>{const x="px-2 py-1 rounded-full text-xs font-medium";switch(c){case"sent":return e.jsx("span",{className:`${x} bg-green-100 text-green-700`,children:"Sent"});case"failed":return e.jsx("span",{className:`${x} bg-red-100 text-red-700`,children:"Failed"});case"pending":return e.jsx("span",{className:`${x} bg-yellow-100 text-yellow-700`,children:"Pending"});default:return null}},u={total:t.length,sent:t.filter(c=>c.status==="sent").length,failed:t.filter(c=>c.status==="failed").length};return e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"SMS Delivery Logs"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Track all SMS notifications sent from the system"})]}),e.jsxs("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(Ac,{className:"w-4 h-4"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg border-2 border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Sent"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.total})]}),e.jsx(Fr,{className:"w-8 h-8 text-blue-600"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border-2 border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Delivered"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:u.sent})]}),e.jsx(ue,{className:"w-8 h-8 text-green-600"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border-2 border-red-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Failed"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:u.failed})]}),e.jsx(Gs,{className:"w-8 h-8 text-red-600"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>l("all"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All"}),e.jsx("button",{onClick:()=>l("sent"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n==="sent"?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Sent"}),e.jsx("button",{onClick:()=>l("failed"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n==="failed"?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Failed"})]})}),e.jsx("div",{className:"overflow-x-auto",children:r?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading logs..."}):t.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No SMS logs found"}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Recipient"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phone"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Role"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Details"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(c=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[d(c.status),o(c.status)]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:c.recipient_name}),e.jsx("div",{className:"text-sm text-gray-500",children:c.recipient_email})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:c.phone_number}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs font-medium",children:c.recipient_role})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 capitalize",children:c.message_type}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:new Date(c.created_at).toLocaleString()}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[c.twilio_sid&&e.jsx("div",{className:"text-xs text-gray-500 font-mono",children:c.twilio_sid}),c.error_message&&e.jsx("div",{className:"text-xs text-red-600 max-w-xs truncate",title:c.error_message,children:c.error_message})]})]},c.id))})]})})]})]})})}function kv(){const{isLoaded:t}=er(),[s,r]=p.useState([]),[a,n]=p.useState([]),[l,i]=p.useState(null),[d,o]=p.useState(null),u=p.useRef(null),c=p.useRef(null),x=p.useRef([]);p.useEffect(()=>{m(),f();const h=setInterval(()=>{m()},1e4);return()=>clearInterval(h)},[]),p.useEffect(()=>{t&&u.current&&!c.current&&y()},[t,s]);const m=async()=>{const{data:h,error:g}=await T.from("profiles").select("id, full_name, status, current_latitude, current_longitude, last_location_update").eq("role","driver").eq("status","active").not("current_latitude","is",null).not("current_longitude","is",null);!g&&h&&(r(h),N(h))},f=async()=>{const{data:h,error:g}=await T.from("trips").select(`
        *,
        patients (
          full_name
        )
      `).in("status",["scheduled","pending"]).not("pickup_lat","is",null).not("pickup_lng","is",null).order("scheduled_pickup_time",{ascending:!0}).limit(20);!g&&h&&n(h)},y=()=>{if(!u.current||!window.google)return;const h=s.length>0&&s[0].current_latitude&&s[0].current_longitude?{lat:s[0].current_latitude,lng:s[0].current_longitude}:{lat:34.0522,lng:-118.2437};c.current=new google.maps.Map(u.current,{zoom:11,center:h,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]}),N(s)},N=h=>{!c.current||!window.google||(x.current.forEach(g=>g.setMap(null)),x.current=[],h.forEach(g=>{if(g.current_latitude&&g.current_longitude){const w=new google.maps.Marker({position:{lat:g.current_latitude,lng:g.current_longitude},map:c.current,title:g.full_name,icon:{path:google.maps.SymbolPath.CIRCLE,scale:10,fillColor:"#2563eb",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2}}),S=new google.maps.InfoWindow({content:`<div style="padding: 8px;"><strong>${g.full_name}</strong><br/>Status: ${g.status}</div>`});w.addListener("click",()=>{S.open(c.current,w)}),x.current.push(w)}}))},k=(h,g,w,S)=>{const _=(w-h)*Math.PI/180,M=(S-g)*Math.PI/180,R=Math.sin(_/2)*Math.sin(_/2)+Math.cos(h*Math.PI/180)*Math.cos(w*Math.PI/180)*Math.sin(M/2)*Math.sin(M/2);return 3959*(2*Math.atan2(Math.sqrt(R),Math.sqrt(1-R)))},b=h=>{if(!h.pickup_lat||!h.pickup_lng)return null;let g=null,w=1/0;return s.forEach(S=>{if(S.current_latitude&&S.current_longitude){const j=k(h.pickup_lat,h.pickup_lng,S.current_latitude,S.current_longitude);j<w&&(w=j,g=S)}}),{driver:g,distance:w}},v=async h=>{const g=b(h);if(g&&g.driver){o(g.driver),i(h);const{error:w}=await T.from("trips").update({driver_id:g.driver.id,status:"assigned"}).eq("id",h.id);w||(alert(`Assigned ${g.driver.full_name} to trip (${g.distance.toFixed(1)} miles away)`),f())}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Driver Tracking & Dispatch"}),e.jsx("p",{className:"text-gray-600",children:"Real-time driver locations and automated dispatch"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-gray-50 border-b flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5 text-blue-600"}),e.jsx("h2",{className:"font-semibold text-gray-900",children:"Live Driver Map"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Ze,{className:"w-4 h-4"}),s.length," Active Drivers"]})]}),e.jsx("div",{ref:u,className:"w-full h-[600px]",children:!t&&e.jsx("div",{className:"flex items-center justify-center h-full bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ae,{className:"w-12 h-12 text-gray-400 mx-auto mb-2 animate-pulse"}),e.jsx("p",{className:"text-gray-500",children:"Loading map..."}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Initializing Google Maps"})]})})})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_s,{className:"w-5 h-5 text-blue-600"}),e.jsx("h2",{className:"font-semibold text-gray-900",children:"Pending Trips"})]}),e.jsxs("div",{className:"space-y-3 max-h-[560px] overflow-y-auto",children:[a.map(h=>{const g=b(h);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:h.patients.full_name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:h.pickup_address})]}),e.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 rounded text-xs font-medium",children:h.status})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-3",children:[e.jsx(Se,{className:"w-3 h-3"}),new Date(h.scheduled_pickup_time).toLocaleString()]}),g&&g.driver&&e.jsxs("div",{className:"bg-blue-50 rounded p-2 mb-2 text-sm",children:[e.jsx("div",{className:"font-medium text-blue-900",children:"Closest Driver:"}),e.jsx("div",{className:"text-blue-700",children:g.driver.full_name}),e.jsxs("div",{className:"text-blue-600 text-xs",children:[g.distance.toFixed(1)," miles away"]})]}),e.jsx("button",{onClick:()=>v(h),disabled:!g||!g.driver,className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Auto-Assign Driver"})]},h.id)}),a.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(_s,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No pending trips"})]})]})]})})]})]})})}function Sv(){const[t,s]=p.useState([]),[r,a]=p.useState(!1),[n,l]=p.useState([]),[i,d]=p.useState(!1);p.useEffect(()=>{o();const f=T.channel("trips-changes").on("postgres_changes",{event:"*",schema:"public",table:"trips"},()=>{o()}).subscribe();return()=>{T.removeChannel(f)}},[]),p.useEffect(()=>{if(i){const f=setInterval(()=>{x()},3e4);return()=>clearInterval(f)}},[i]);const o=async()=>{const{data:f,error:y}=await T.from("trips").select(`
        *,
        patients (
          full_name,
          mobility_needs
        )
      `).is("driver_id",null).in("status",["scheduled","pending"]).order("scheduled_pickup_time",{ascending:!0}).limit(50);!y&&f&&s(f)},u=(f,y,N,k)=>{const v=(N-f)*Math.PI/180,h=(k-y)*Math.PI/180,g=Math.sin(v/2)*Math.sin(v/2)+Math.cos(f*Math.PI/180)*Math.cos(N*Math.PI/180)*Math.sin(h/2)*Math.sin(h/2);return 3959*(2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g)))},c=async f=>{const{data:y}=await T.from("profiles").select("*").eq("role","driver").eq("status","active").not("current_latitude","is",null).not("current_longitude","is",null);if(!y||y.length===0)return null;const{data:N}=await T.from("trips").select("driver_id, scheduled_pickup_time, actual_dropoff_time").not("driver_id","is",null).in("status",["assigned","active","picked_up"]),k=new Map;N==null||N.forEach(h=>{const g=k.get(h.driver_id)||0;k.set(h.driver_id,g+1)});let b=null,v=-1/0;for(const h of y){const w=10-(k.get(h.id)||0);let S=5;if(f.pickup_lat&&f.pickup_lng&&h.current_latitude&&h.current_longitude){const _=u(f.pickup_lat,f.pickup_lng,h.current_latitude,h.current_longitude);S=Math.max(0,10-_/2)}const j=w*.4+S*.6;j>v&&(v=j,b=h)}return b},x=async()=>{if(t.length===0)return;a(!0);const f=[];for(const y of t.slice(0,10)){const N=await c(y);if(N){const{error:k}=await T.from("trips").update({driver_id:N.id,status:"assigned",auto_scheduled:!0}).eq("id",y.id);k?f.push({success:!1,trip_id:y.id,driver_id:"",driver_name:"",message:"Failed to assign"}):f.push({success:!0,trip_id:y.id,driver_id:N.id,driver_name:N.full_name,message:`Assigned to ${N.full_name}`})}else f.push({success:!1,trip_id:y.id,driver_id:"",driver_name:"",message:"No available drivers"})}l(f),await o(),a(!1)},m=async f=>{a(!0);const y=await c(f);if(y){const{error:N}=await T.from("trips").update({driver_id:y.id,status:"assigned",auto_scheduled:!0}).eq("id",f.id);N||(alert(`Successfully assigned trip to ${y.full_name}`),o())}else alert("No available drivers found");a(!1)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Auto Scheduler"}),e.jsx("p",{className:"text-gray-600",children:"Intelligent trip assignment based on driver availability and location"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-3 bg-white px-6 py-3 rounded-lg shadow-lg border border-gray-200",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:f=>d(f.target.checked),className:"w-5 h-5 text-brand-pink rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Auto-Schedule (30s)"})]}),e.jsxs("button",{onClick:x,disabled:r||t.length===0,className:"flex items-center gap-2 bg-brand-pink text-white px-6 py-3 rounded-lg hover:bg-brand-red transition-all shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(mx,{className:"w-5 h-5"}),"Schedule All"]})]})]}),n.length>0&&e.jsxs("div",{className:"mb-6 bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"font-semibold text-gray-900 mb-4",children:"Recent Scheduling Results"}),e.jsx("div",{className:"space-y-2",children:n.map((f,y)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50",children:[f.success?e.jsx(ue,{className:"w-5 h-5 text-green-600 flex-shrink-0"}):e.jsx(Ut,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:f.message})]},y))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"p-6 bg-gray-50 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-brand-pink"}),e.jsx("h2",{className:"font-semibold text-gray-900",children:"Unscheduled Trips"})]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.length," trips waiting"]})]})}),e.jsxs("div",{className:"divide-y divide-gray-200",children:[t.map(f=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-all",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:f.patients.full_name}),e.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-medium",children:f.status}),f.patients.mobility_needs==="wheelchair"&&e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:"Wheelchair"})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4"}),new Date(f.scheduled_pickup_time).toLocaleString()]}),e.jsxs("div",{children:["From: ",f.pickup_address]}),e.jsxs("div",{children:["To: ",f.dropoff_address]})]})]}),e.jsx("button",{onClick:()=>m(f),disabled:r,className:"ml-4 bg-brand-pink text-white px-6 py-2 rounded-lg hover:bg-brand-red transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Schedule Now"})]})},f.id)),t.length===0&&e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(ue,{className:"w-12 h-12 text-green-600 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"All Trips Scheduled"}),e.jsx("p",{className:"text-gray-600",children:"No trips are waiting to be assigned to drivers"})]})]})]})]})})}function Cv({tripId:t,onComplete:s,onCancel:r}){const a=p.useRef(null),[n,l]=p.useState(!1),[i,d]=p.useState(""),[o,u]=p.useState("member"),[c,x]=p.useState(!1),[m,f]=p.useState(!1);p.useEffect(()=>{const h=a.current;if(!h)return;const g=h.getContext("2d");g&&(h.width=h.offsetWidth,h.height=h.offsetHeight,g.strokeStyle="#000",g.lineWidth=2,g.lineCap="round",g.lineJoin="round")},[]);function y(h){const g=a.current;if(!g)return;l(!0),f(!0);const w=g.getContext("2d");if(!w)return;const S=g.getBoundingClientRect(),j="touches"in h?h.touches[0].clientX-S.left:h.clientX-S.left,_="touches"in h?h.touches[0].clientY-S.top:h.clientY-S.top;w.beginPath(),w.moveTo(j,_)}function N(h){if(!n)return;const g=a.current;if(!g)return;const w=g.getContext("2d");if(!w)return;const S=g.getBoundingClientRect(),j="touches"in h?h.touches[0].clientX-S.left:h.clientX-S.left,_="touches"in h?h.touches[0].clientY-S.top:h.clientY-S.top;w.lineTo(j,_),w.stroke()}function k(){l(!1)}function b(){const h=a.current;if(!h)return;const g=h.getContext("2d");g&&(g.clearRect(0,0,h.width,h.height),f(!1))}async function v(){if(!i.trim()){alert("Please enter the name of the person signing");return}if(!m){alert("Please provide a signature");return}const h=a.current;if(h){x(!0);try{const g=h.toDataURL("image/png"),{error:w}=await T.from("trip_signatures").insert({trip_id:t,signature_data:g,signed_by:i,signature_type:o,signed_at:new Date().toISOString()});if(w)throw w;s()}catch(g){console.error("Error saving signature:",g),alert("Failed to save signature")}finally{x(!1)}}}return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"bg-blue-600 text-white p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Capture Signature"}),e.jsx("button",{onClick:r,className:"p-2",children:e.jsx(le,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"flex-1 p-4 flex flex-col",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Who is signing?"}),e.jsxs("select",{value:o,onChange:h=>u(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"member",children:"Member (Patient)"}),e.jsx("option",{value:"facility",children:"Facility Representative"}),e.jsx("option",{value:"driver",children:"Driver"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name of Person Signing"}),e.jsx("input",{type:"text",value:i,onChange:h=>d(h.target.value),placeholder:"Enter full name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Sign Below"}),e.jsxs("button",{onClick:b,className:"flex items-center text-sm text-blue-600 font-medium",children:[e.jsx(Pc,{className:"w-4 h-4 mr-1"}),"Clear"]})]}),e.jsx("div",{className:"flex-1 bg-white border-2 border-gray-300 rounded-lg overflow-hidden",style:{minHeight:"300px"},children:e.jsx("canvas",{ref:a,onTouchStart:y,onTouchMove:N,onTouchEnd:k,onMouseDown:y,onMouseMove:N,onMouseUp:k,onMouseLeave:k,className:"w-full h-full touch-none",style:{touchAction:"none"}})})]}),e.jsxs("button",{onClick:v,disabled:c,className:"mt-4 w-full bg-green-600 text-white py-4 rounded-lg font-semibold flex items-center justify-center disabled:opacity-50",children:[e.jsx(Tc,{className:"w-5 h-5 mr-2"}),c?"Saving...":"Save Signature"]})]})]})}function Ev({tripId:t,onComplete:s,onCancel:r}){const{user:a}=qt(),[n,l]=p.useState("vehicle_condition"),[i,d]=p.useState(""),[o,u]=p.useState(!1),[c,x]=p.useState(null),[m,f]=p.useState(null),y=p.useRef(null);function N(b){var g;const v=(g=b.target.files)==null?void 0:g[0];if(!v)return;const h=new FileReader;h.onloadend=()=>{x(h.result)},h.readAsDataURL(v),navigator.geolocation&&navigator.geolocation.getCurrentPosition(w=>{f({lat:w.coords.latitude,lng:w.coords.longitude})},w=>{console.error("Error getting location:",w)})}async function k(){if(!c){alert("Please select a photo");return}u(!0);try{const v=await(await fetch(c)).blob(),h=`${t}-${Date.now()}.jpg`,{data:g,error:w}=await T.storage.from("trip-photos").upload(h,v,{contentType:"image/jpeg",cacheControl:"3600"});if(w)throw console.error("Upload error:",w),new Error("Failed to upload photo");const{data:{publicUrl:S}}=T.storage.from("trip-photos").getPublicUrl(h),{error:j}=await T.from("trip_photos").insert({trip_id:t,photo_url:S,photo_type:n,description:i,latitude:m==null?void 0:m.lat,longitude:m==null?void 0:m.lng,created_by:a==null?void 0:a.id});if(j)throw j;s()}catch(b){console.error("Error uploading photo:",b),alert("Failed to upload photo. The photo will be saved locally for offline use.")}finally{u(!1)}}return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"bg-blue-600 text-white p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Upload Photo"}),e.jsx("button",{onClick:r,className:"p-2",children:e.jsx(le,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"flex-1 p-4 flex flex-col",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Photo Type"}),e.jsxs("select",{value:n,onChange:b=>l(b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"vehicle_condition",children:"Vehicle Condition"}),e.jsx("option",{value:"patient",children:"Patient"}),e.jsx("option",{value:"incident",children:"Incident"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:i,onChange:b=>d(b.target.value),placeholder:"Add a description...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]}),c?e.jsxs("div",{className:"flex-1 flex flex-col mb-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2",children:"Preview"}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-lg overflow-hidden",style:{minHeight:"300px"},children:e.jsx("img",{src:c,alt:"Preview",className:"w-full h-full object-contain"})}),m&&e.jsxs("div",{className:"mt-2 flex items-center text-sm text-gray-600",children:[e.jsx(ae,{className:"w-4 h-4 mr-1"}),"Location captured: ",m.lat.toFixed(6),", ",m.lng.toFixed(6)]}),e.jsx("button",{onClick:()=>{x(null),y.current&&(y.current.value="")},className:"mt-4 w-full bg-gray-600 text-white py-3 rounded-lg font-medium",children:"Take Another Photo"})]}):e.jsxs("div",{className:"flex-1 flex flex-col justify-center items-center border-2 border-dashed border-gray-300 rounded-lg mb-4",style:{minHeight:"300px"},children:[e.jsx(Fa,{className:"w-16 h-16 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Take a photo"}),e.jsx("input",{ref:y,type:"file",accept:"image/*",capture:"environment",onChange:N,className:"hidden"}),e.jsxs("button",{onClick:()=>{var b;return(b=y.current)==null?void 0:b.click()},className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium flex items-center",children:[e.jsx(Fa,{className:"w-5 h-5 mr-2"}),"Open Camera"]})]}),c&&e.jsxs("button",{onClick:k,disabled:o,className:"w-full bg-green-600 text-white py-4 rounded-lg font-semibold flex items-center justify-center disabled:opacity-50",children:[e.jsx(dx,{className:"w-5 h-5 mr-2"}),o?"Uploading...":"Upload Photo"]})]})]})}function Tv({tripId:t,vehicleId:s,onComplete:r,onCancel:a}){const[n,l]=p.useState(""),[i,d]=p.useState(""),[o,u]=p.useState(null),[c,x]=p.useState(!1),[m,f]=p.useState(!0);p.useEffect(()=>{y()},[t]);async function y(){try{const{data:v,error:h}=await T.from("trip_mileage").select("*").eq("trip_id",t).maybeSingle();if(h)throw h;v&&(u(v),l(v.start_odometer.toString()),v.end_odometer&&d(v.end_odometer.toString()))}catch(v){console.error("Error loading mileage:",v)}finally{f(!1)}}async function N(){if(!n){alert("Please enter the starting odometer reading");return}x(!0);try{const{data:v}=await T.from("vehicles").select("id").eq("vehicle_number",s).maybeSingle();if(!v)throw new Error("Vehicle not found");const{data:h,error:g}=await T.from("trip_mileage").insert({trip_id:t,vehicle_id:v.id,start_odometer:parseInt(n),start_time:new Date().toISOString()}).select().single();if(g)throw g;u(h),alert("Mileage tracking started")}catch(v){console.error("Error starting tracking:",v),alert("Failed to start tracking")}finally{x(!1)}}async function k(){if(!i){alert("Please enter the ending odometer reading");return}const v=parseInt(n),h=parseInt(i);if(h<v){alert("End odometer must be greater than start odometer");return}x(!0);try{const g=h-v,{error:w}=await T.from("trip_mileage").update({end_odometer:h,calculated_miles:g,end_time:new Date().toISOString()}).eq("id",o.id);if(w)throw w;r()}catch(g){console.error("Error ending tracking:",g),alert("Failed to end tracking")}finally{x(!1)}}if(m)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const b=n&&i?parseInt(i)-parseInt(n):0;return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"bg-blue-600 text-white p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Mileage Tracker"}),e.jsx("button",{onClick:a,className:"p-2",children:e.jsx(le,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx(zy,{className:"w-16 h-16 text-blue-600"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Starting Odometer"}),e.jsx("input",{type:"number",value:n,onChange:v=>l(v.target.value),disabled:!!o,placeholder:"Enter starting miles",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-lg disabled:bg-gray-100"})]}),o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ending Odometer"}),e.jsx("input",{type:"number",value:i,onChange:v=>d(v.target.value),disabled:!!(o!=null&&o.end_odometer),placeholder:"Enter ending miles",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-lg disabled:bg-gray-100"})]}),b>0&&e.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Miles"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:[b," miles"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Started"}),e.jsx("span",{className:"font-medium",children:new Date(o.start_time).toLocaleString()})]}),o.end_time&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Ended"}),e.jsx("span",{className:"font-medium",children:new Date(o.end_time).toLocaleString()})]})]})]})]}),e.jsx("div",{className:"mt-6",children:o?o.end_odometer?e.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-green-800 font-medium",children:"Tracking Complete"}),e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[o.calculated_miles," miles recorded"]})]}):e.jsxs("button",{onClick:k,disabled:c,className:"w-full bg-red-600 text-white py-4 rounded-lg font-semibold flex items-center justify-center disabled:opacity-50",children:[e.jsx(Zy,{className:"w-5 h-5 mr-2"}),c?"Ending...":"End Tracking"]}):e.jsxs("button",{onClick:N,disabled:c,className:"w-full bg-green-600 text-white py-4 rounded-lg font-semibold flex items-center justify-center disabled:opacity-50",children:[e.jsx(Jy,{className:"w-5 h-5 mr-2"}),c?"Starting...":"Start Tracking"]})})]}),e.jsxs("div",{className:"mt-4 bg-blue-50 border-l-4 border-blue-400 p-4 rounded",children:[e.jsx("p",{className:"text-sm text-blue-800 font-medium mb-1",children:"Tip"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Enter your vehicle's odometer reading at the start of the trip, then enter it again when the trip is complete."})]})]})]})}function Av(){var j,_,M,R,O,I,A,F,Q,E,q,C,U;const{user:t,profile:s}=qt(),[r,a]=p.useState([]),[n,l]=p.useState(null),[i,d]=p.useState(!0),[o,u]=p.useState("menu"),[c,x]=p.useState(!1),[m,f]=p.useState(!1);p.useState(new Date),p.useState(null);const[y,N]=p.useState(!0),k=p.useRef(!0);p.useEffect(()=>{t&&Mx()},[t]),p.useEffect(()=>{if(!t)return;const P=T.channel("driver-mobile-notifications").on("postgres_changes",{event:"UPDATE",schema:"public",table:"trips"},V=>{const D=V.new,B=V.old;D.driver_id===t.id&&D.status==="assigned"&&B.status!=="assigned"&&y&&!k.current&&(Ba(),pl(" New Trip Assigned!",`Pickup: ${D.pickup_location||"See details"}`,{requireInteraction:!0}))}).on("postgres_changes",{event:"INSERT",schema:"public",table:"trips"},V=>{const D=V.new;D.driver_id===t.id&&y&&!k.current&&(Ba(),pl(" New Trip Assigned!",`Pickup: ${D.pickup_location||"See details"}`,{requireInteraction:!0}))}).subscribe();return()=>{P.unsubscribe()}},[t,y]),p.useEffect(()=>{k.current&&(k.current=!1)},[r]),p.useEffect(()=>{b();const P=T.channel("driver_trips").on("postgres_changes",{event:"*",schema:"public",table:"trips"},b).subscribe();let V=null;if("geolocation"in navigator){const D=async()=>{navigator.geolocation.getCurrentPosition(async B=>{try{await fetch("https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/update-driver-location",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"},body:JSON.stringify({latitude:B.coords.latitude,longitude:B.coords.longitude,accuracy:B.coords.accuracy,speed:B.coords.speed,heading:B.coords.heading})})}catch($){console.error("Failed to update location:",$)}},B=>{console.error("Location error:",B)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})};D(),V=setInterval(D,6e4)}return()=>{P.unsubscribe(),V&&clearInterval(V)}},[t]);async function b(){try{const{data:P,error:V}=await T.from("trips").select(`
          *,
          patients (first_name, last_name, phone, medical_id, mobility_requirements),
          vehicles (vehicle_number, type, make, model)
        `).eq("driver_id",t==null?void 0:t.id).in("status",["scheduled","assigned","en_route_pickup","arrived_pickup","patient_onboard","en_route_dropoff","arrived_dropoff"]).order("scheduled_pickup_time",{ascending:!0});if(V)throw V;a(P||[])}catch(P){console.error("Error loading trips:",P)}finally{d(!1)}}async function v(P,V){x(!0);try{const D={status:V};V==="completed"&&(D.actual_dropoff_time=new Date().toISOString());const{error:B}=await T.from("trips").update(D).eq("id",P);if(B)throw B;if(await b(),(n==null?void 0:n.id)===P){const $=r.find(W=>W.id===P);$&&l({...$,status:V})}}catch(D){console.error("Error updating status:",D),alert("Failed to update status")}finally{x(!1)}}async function h(P,V){x(!0);try{const{error:D}=await T.from("trips").update({forwarded_to:V,forwarded_at:new Date().toISOString(),status:"forwarded"}).eq("id",P);if(D)throw D;V==="farmout"&&await T.from("farmout_trips").insert({trip_id:P,status:"processing"}),alert(`Trip forwarded to ${V==="marketplace"?"Marketplace":"Farmout Drivers"} successfully`),await b(),u("assigned")}catch(D){console.error("Error forwarding trip:",D),alert("Failed to forward trip")}finally{x(!1)}}async function g(P,V){try{const{error:D}=await T.from("trips").update({driver_notes:V}).eq("id",P);if(D)throw D;alert("Notes saved successfully")}catch(D){console.error("Error saving notes:",D),alert("Failed to save notes")}}async function w(P,V){f(!0);try{const{data:D,error:B}=await T.from("profiles").select("phone").eq("id",t==null?void 0:t.id).maybeSingle();if(B||!(D!=null&&D.phone)){alert("Your phone number is not set in your profile. Please contact dispatch.");return}const W=await fetch("https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/masked-call",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"},body:JSON.stringify({driverPhone:D.phone,memberPhone:P,tripId:V})}),L=await W.json();if(!W.ok){if(L.error==="Twilio not configured")alert("Masked calling is not configured. You can call the member directly using the regular call button.");else throw new Error(L.error||"Failed to initiate call");return}alert("Call initiated! You will receive a call shortly that will connect you to the member.")}catch(D){console.error("Error initiating call:",D),alert("Failed to initiate call. You can use the regular call button to call directly.")}finally{f(!1)}}function S(P,V,D){To(P,V,D)}return i?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o==="walkie"?e.jsxs("div",{className:"min-h-screen bg-gray-900",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 p-4",children:e.jsxs("button",{onClick:()=>u("menu"),className:"flex items-center text-white",children:[e.jsx(Rs,{className:"w-5 h-5 mr-2"}),"Back"]})}),e.jsx(Px,{})]}):o==="signature"&&n?e.jsx(Cv,{tripId:n.id,onComplete:()=>{u("detail"),alert("Signature saved successfully")},onCancel:()=>u("detail")}):o==="photo"&&n?e.jsx(Ev,{tripId:n.id,onComplete:()=>{u("detail"),alert("Photo uploaded successfully")},onCancel:()=>u("detail")}):o==="mileage"&&n?e.jsx(Tv,{tripId:n.id,vehicleId:((j=n.vehicles)==null?void 0:j.vehicle_number)||"",onComplete:()=>{u("detail"),alert("Mileage recorded successfully")},onCancel:()=>u("detail")}):o==="forward"&&n?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-white p-4 sticky top-0 z-10 shadow-sm",children:[e.jsxs("button",{onClick:()=>u("detail"),className:"flex items-center text-gray-700 mb-3",children:[e.jsx(Rs,{className:"w-5 h-5 mr-2"}),"Forward Trip"]}),n.trip_fare&&e.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 text-center",children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Trip Fare: "}),e.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["$",n.trip_fare.toFixed(2)]})]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(ke,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900",children:[(_=n.patients)==null?void 0:_.first_name," ",(M=n.patients)==null?void 0:M.last_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Reg: ",(R=n.patients)==null?void 0:R.medical_id]})]})]}),e.jsx("div",{className:"text-sm text-gray-600",children:"1.87 miles away"})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[((I=(O=n.patients)==null?void 0:O.mobility_requirements)==null?void 0:I.includes("wheelchair"))&&e.jsx("span",{className:"px-2 py-1 bg-blue-500 text-white text-xs rounded",children:"WAV (WAV)"}),e.jsx("span",{className:"px-2 py-1 bg-red-500 text-white text-xs rounded",children:"N/A"}),e.jsx("button",{className:"ml-auto text-blue-600 text-sm font-medium",children:"See Manifest"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Pickup Difference"}),e.jsxs("p",{className:"text-gray-900 font-medium",children:[n.pickup_difference||0," min"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Dropoff Difference"}),e.jsxs("p",{className:"text-gray-900 font-medium",children:[n.dropoff_difference||0," min"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Onboard Violation"}),e.jsx("p",{className:`font-medium ${n.onboard_violation?"text-red-600":"text-green-600"}`,children:n.onboard_violation?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Distance Violation"}),e.jsx("p",{className:`font-medium ${n.distance_violation?"text-red-600":"text-green-600"}`,children:n.distance_violation?"Yes":"No"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Pre Dist."}),e.jsx("p",{className:"text-gray-900 font-medium",children:((A=n.pre_distance)==null?void 0:A.toFixed(2))||"0.00"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"New Dist."}),e.jsx("p",{className:"text-gray-900 font-medium",children:((F=n.new_distance)==null?void 0:F.toFixed(2))||"0.00"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Dist. Difference"}),e.jsx("p",{className:"text-gray-900 font-medium",children:((Q=n.distance_difference)==null?void 0:Q.toFixed(2))||"0.00"})]})]})]}),e.jsx("button",{onClick:()=>h(n.id,"marketplace"),disabled:c,className:"w-full bg-blue-500 text-white py-4 rounded-lg font-semibold disabled:opacity-50",children:"Forward to Marketplace"}),e.jsx("button",{onClick:()=>h(n.id,"farmout"),disabled:c,className:"w-full bg-gray-900 text-white py-4 rounded-lg font-semibold disabled:opacity-50",children:"Forward to Farmout Drivers"})]})]}):o==="detail"&&n?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-blue-600 text-white p-4 sticky top-0 z-10",children:[e.jsxs("button",{onClick:()=>u("assigned"),className:"flex items-center mb-3",children:[e.jsx(Rs,{className:"w-5 h-5 mr-2"}),"Trip Details"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${n.status==="assigned"?"bg-yellow-400":"bg-green-400"} mr-2`}),e.jsx("span",{className:"text-sm",children:n.status.replace("_"," ").toUpperCase()})]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[(E=n.patients)==null?void 0:E.first_name," ",(q=n.patients)==null?void 0:q.last_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",(C=n.patients)==null?void 0:C.medical_id]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>{var P;return w((P=n.patients)==null?void 0:P.phone,n.id)},disabled:m,className:"bg-blue-500 text-white p-3 rounded-full disabled:opacity-50",title:"Masked call",children:e.jsx(Xe,{className:"w-5 h-5"})})})]}),((U=n.patients)==null?void 0:U.mobility_requirements)&&e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-3 mb-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ut,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Special Requirements"}),e.jsx("p",{className:"text-sm text-yellow-700",children:n.patients.mobility_requirements})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Pickup Location"}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-sm text-gray-900 flex-1",children:n.pickup_location}),e.jsx("button",{onClick:()=>S(n.pickup_location,n.pickup_latitude,n.pickup_longitude),className:"ml-2 bg-blue-500 text-white p-2 rounded-lg hover:bg-blue-600 active:bg-blue-700 transition-colors",title:"Open in Maps",children:e.jsx(_s,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Dropoff Location"}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-sm text-gray-900 flex-1",children:n.dropoff_location}),e.jsx("button",{onClick:()=>S(n.dropoff_location,n.dropoff_latitude,n.dropoff_longitude),className:"ml-2 bg-blue-500 text-white p-2 rounded-lg hover:bg-blue-600 active:bg-blue-700 transition-colors",title:"Open in Maps",children:e.jsx(_s,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Pickup Time"}),e.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),new Date(n.pickup_time).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("button",{onClick:()=>u("photo"),className:"bg-white border-2 border-gray-300 text-gray-700 py-3 rounded-lg font-medium flex flex-col items-center justify-center",children:[e.jsx(Fa,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"text-xs",children:"Photo"})]}),e.jsxs("button",{onClick:()=>u("mileage"),className:"bg-white border-2 border-gray-300 text-gray-700 py-3 rounded-lg font-medium flex flex-col items-center justify-center",children:[e.jsx(qa,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"text-xs",children:"Mileage"})]}),e.jsxs("button",{onClick:()=>u("walkie"),className:"bg-white border-2 border-gray-300 text-gray-700 py-3 rounded-lg font-medium flex flex-col items-center justify-center",children:[e.jsx(Kt,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"text-xs",children:"Radio"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Trip Status"}),e.jsxs("div",{className:"space-y-2",children:[n.status==="assigned"&&e.jsxs("button",{onClick:()=>v(n.id,"en_route_pickup"),disabled:c,className:"w-full bg-green-600 text-white py-3 rounded-lg font-semibold flex items-center justify-center disabled:opacity-50",children:[e.jsx(ue,{className:"w-5 h-5 mr-2"}),"En Route to Pickup"]}),n.status==="en_route_pickup"&&e.jsxs("button",{onClick:()=>v(n.id,"arrived_pickup"),disabled:c,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold flex items-center justify-center disabled:opacity-50",children:[e.jsx(ue,{className:"w-5 h-5 mr-2"}),"Arrived at Pickup"]}),n.status==="arrived_pickup"&&e.jsxs("button",{onClick:()=>v(n.id,"patient_onboard"),disabled:c,className:"w-full bg-purple-600 text-white py-3 rounded-lg font-semibold flex items-center justify-center disabled:opacity-50",children:[e.jsx(ue,{className:"w-5 h-5 mr-2"}),"Patient Onboard"]}),n.status==="patient_onboard"&&e.jsxs("button",{onClick:()=>v(n.id,"en_route_dropoff"),disabled:c,className:"w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold flex items-center justify-center disabled:opacity-50",children:[e.jsx(ue,{className:"w-5 h-5 mr-2"}),"En Route to Dropoff"]}),n.status==="en_route_dropoff"&&e.jsxs("button",{onClick:()=>v(n.id,"arrived_dropoff"),disabled:c,className:"w-full bg-orange-600 text-white py-3 rounded-lg font-semibold flex items-center justify-center disabled:opacity-50",children:[e.jsx(ue,{className:"w-5 h-5 mr-2"}),"Arrived at Dropoff"]}),n.status==="arrived_dropoff"&&e.jsxs("button",{onClick:()=>u("signature"),className:"w-full bg-gray-900 text-white py-3 rounded-lg font-semibold flex items-center justify-center",children:[e.jsx(xe,{className:"w-5 h-5 mr-2"}),"Capture Signature & Complete"]})]})]}),e.jsxs("button",{onClick:()=>u("forward"),className:"w-full bg-gray-600 text-white py-4 rounded-lg font-semibold flex items-center justify-center",children:[e.jsx(Mc,{className:"w-5 h-5 mr-2"}),"Forward Trip"]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Driver Notes"}),e.jsx("textarea",{value:n.driver_notes||"",onChange:P=>l({...n,driver_notes:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:4,placeholder:"Add any notes about this trip..."}),e.jsx("button",{onClick:()=>g(n.id,n.driver_notes),className:"mt-2 w-full bg-blue-600 text-white py-2 rounded-lg font-medium",children:"Save Notes"})]})]})]}):o==="menu"?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-white p-6",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[s!=null&&s.photo_url?e.jsx("img",{src:s.photo_url,alt:s.full_name,className:"w-20 h-20 rounded-full object-cover border-4 border-blue-500 mb-3"}):e.jsx("div",{className:"w-20 h-20 rounded-full bg-blue-500 flex items-center justify-center border-4 border-blue-600 mb-3",children:e.jsx(ke,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:s==null?void 0:s.full_name}),e.jsx("p",{className:"text-sm text-gray-500",children:"Today's Shift: 00:00 - 23:59"})]}),r.length>0&&r[0].vehicles&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Fe,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[r[0].vehicles.make," ",r[0].vehicles.model]}),e.jsx("p",{className:"text-xs text-gray-500",children:r[0].vehicles.vehicle_number})]})]}),e.jsxs("button",{onClick:()=>N(!y),className:`w-full rounded-lg p-4 flex items-center justify-between transition ${y?"bg-green-100 border-2 border-green-500":"bg-gray-100 border-2 border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ux,{className:`w-6 h-6 ${y?"text-green-600":"text-gray-500"}`}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:`font-semibold ${y?"text-green-900":"text-gray-700"}`,children:"Trip Notifications"}),e.jsx("p",{className:`text-sm ${y?"text-green-700":"text-gray-500"}`,children:y?" Sound ON":" Sound OFF"})]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${y?"bg-green-500 text-white":"bg-gray-300 text-gray-600"}`,children:y?"ON":"OFF"})]})]}),e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx("div",{children:e.jsx("button",{onClick:()=>u("menu"),className:"w-full bg-white rounded-lg shadow p-4 flex items-center justify-between hover:bg-gray-50 transition",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ko,{className:"w-6 h-6 text-gray-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"HOME"})]})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 mb-2 px-2",children:"TRIPS"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>u("assigned"),className:"w-full bg-white rounded-lg shadow p-4 flex items-center justify-between hover:bg-gray-50 transition",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"w-6 h-6 text-gray-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"ASSIGNED"})]}),r.length>0&&e.jsx("span",{className:"bg-blue-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center",children:r.length})]}),e.jsx("button",{onClick:()=>u("assists"),className:"w-full bg-white rounded-lg shadow p-4 flex items-center justify-between hover:bg-gray-50 transition",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ze,{className:"w-6 h-6 text-gray-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"ASSISTS"})]})}),e.jsx("button",{onClick:()=>u("history"),className:"w-full bg-white rounded-lg shadow p-4 flex items-center justify-between hover:bg-gray-50 transition",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qy,{className:"w-6 h-6 text-gray-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"HISTORY"})]})})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 mb-2 px-2",children:"VEHICLES"}),e.jsx("div",{className:"space-y-2",children:e.jsx("button",{onClick:()=>u("expenses"),className:"w-full bg-white rounded-lg shadow p-4 flex items-center justify-between hover:bg-gray-50 transition",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{className:"w-6 h-6 text-gray-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"EXPENSES"})]})})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 mb-2 px-2",children:"OTHERS"}),e.jsx("div",{className:"space-y-2",children:e.jsx("button",{onClick:()=>u("material"),className:"w-full bg-white rounded-lg shadow p-4 flex items-center justify-between hover:bg-gray-50 transition",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ul,{className:"w-6 h-6 text-gray-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"HELPING MATERIAL"})]})})})]}),e.jsx("div",{children:e.jsx("button",{onClick:()=>u("settings"),className:"w-full bg-white rounded-lg shadow p-4 flex items-center justify-between hover:bg-gray-50 transition",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qs,{className:"w-6 h-6 text-gray-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"SETTINGS"})]})})}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:()=>window.location.href="/",className:"w-full bg-gray-200 rounded-lg p-4 flex items-center justify-center gap-3 hover:bg-gray-300 transition",children:[e.jsx(Ol,{className:"w-6 h-6 text-gray-700"}),e.jsx("span",{className:"font-medium text-gray-700",children:"LOGOUT"})]})}),e.jsx("div",{className:"text-center text-xs text-gray-400 py-4",children:"Version: 1.0.26 (1)"})]})]}):o==="assigned"?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-blue-600 text-white p-4 sticky top-0 z-10",children:[e.jsxs("button",{onClick:()=>u("menu"),className:"flex items-center mb-3",children:[e.jsx(Rs,{className:"w-5 h-5 mr-2"}),"Assigned Trips"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"My Trips"}),e.jsx("button",{onClick:()=>u("walkie"),className:"bg-blue-700 p-2 rounded-lg",children:e.jsx(Kt,{className:"w-6 h-6"})})]})]}),e.jsx("div",{className:"p-4 space-y-3",children:r.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx(ue,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No trips assigned"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Check back later for new assignments"})]}):r.map(P=>{var V,D,B;return e.jsxs("div",{onClick:()=>{l(P),u("detail")},className:"bg-white rounded-lg shadow p-4 cursor-pointer active:bg-gray-50 transition",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900",children:[(V=P.patients)==null?void 0:V.first_name," ",(D=P.patients)==null?void 0:D.last_name]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${P.status==="assigned"?"bg-yellow-400":"bg-green-400"} mr-2`}),e.jsx("span",{className:"text-xs text-gray-600",children:P.status.replace("_"," ").toUpperCase()})]})]})}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start text-gray-600",children:[e.jsx(ae,{className:"w-4 h-4 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"line-clamp-1",children:P.pickup_location})]}),e.jsxs("div",{className:"flex items-start text-gray-600",children:[e.jsx(ae,{className:"w-4 h-4 mr-2 flex-shrink-0 mt-0.5 text-blue-500"}),e.jsx("span",{className:"line-clamp-1",children:P.dropoff_location})]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:new Date(P.pickup_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),((B=P.patients)==null?void 0:B.mobility_requirements)&&e.jsx("div",{className:"mt-3 bg-yellow-50 border-l-4 border-yellow-400 p-2",children:e.jsxs("p",{className:"text-xs text-yellow-800 flex items-center",children:[e.jsx(Ut,{className:"w-3 h-3 mr-1"}),P.patients.mobility_requirements]})})]},P.id)})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-blue-600 text-white p-4 sticky top-0 z-10",children:e.jsxs("button",{onClick:()=>u("menu"),className:"flex items-center mb-3",children:[e.jsx(Rs,{className:"w-5 h-5 mr-2"}),o==="assists"&&"Assists",o==="history"&&"History",o==="expenses"&&"Expenses",o==="settings"&&"Settings",o==="material"&&"Helping Material"]})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx(ox,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Coming Soon"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This feature is under development"})]})})]})}function Pv(){var j,_;qt();const[t,s]=p.useState("trips"),[r,a]=p.useState([]),[n,l]=p.useState([]),[i,d]=p.useState(null),[o,u]=p.useState(null),[c,x]=p.useState(!0),[m,f]=p.useState(!1),[y,N]=p.useState("all");p.useEffect(()=>{k();const M=T.channel("dispatcher_trips").on("postgres_changes",{event:"*",schema:"public",table:"trips"},b).subscribe(),R=T.channel("dispatcher_drivers").on("postgres_changes",{event:"*",schema:"public",table:"profiles"},v).subscribe();return()=>{M.unsubscribe(),R.unsubscribe()}},[]);async function k(){await Promise.all([b(),v()]),x(!1)}async function b(){try{const{data:M,error:R}=await T.from("trips").select(`
          *,
          patients (first_name, last_name, phone),
          profiles:driver_id (full_name)
        `).in("status",["scheduled","assigned","unassigned","en_route_pickup","arrived_pickup","patient_onboard","en_route_dropoff"]).order("scheduled_pickup_time",{ascending:!0});if(R)throw R;a(M||[])}catch(M){console.error("Error loading trips:",M)}}async function v(){try{const{data:M,error:R}=await T.from("profiles").select("*").eq("role","driver").order("full_name");if(R)throw R;l(M||[])}catch(M){console.error("Error loading drivers:",M)}}async function h(M,R){try{const{error:O}=await T.from("trips").update({driver_id:R,status:"assigned"}).eq("id",M);if(O)throw O;await b(),s("trips"),d(null),u(null)}catch(O){console.error("Error assigning trip:",O),alert("Failed to assign trip")}}function g(M){return{unassigned:"bg-yellow-500",scheduled:"bg-blue-500",assigned:"bg-green-500",en_route_pickup:"bg-purple-500",arrived_pickup:"bg-orange-500",patient_onboard:"bg-indigo-500",en_route_dropoff:"bg-cyan-500",completed:"bg-gray-500"}[M]||"bg-gray-400"}function w(M){return{available:"bg-green-500",on_trip:"bg-blue-500",break:"bg-yellow-500",offline:"bg-gray-400"}[M]||"bg-gray-400"}const S=y==="all"?r:r.filter(M=>M.status===y);return c?e.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:e.jsx(Ac,{className:"w-8 h-8 animate-spin text-blue-600"})}):t==="walkie"?e.jsxs("div",{className:"flex flex-col h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-blue-600 text-white p-4 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>s("trips"),children:e.jsx(Rs,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-xl font-bold",children:"Walkie Talkie"})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(fx,{})})]}):t==="assign"&&i?e.jsxs("div",{className:"flex flex-col h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-blue-600 text-white p-4 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{s("trips"),d(null)},children:e.jsx(Rs,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-xl font-bold",children:"Assign Driver"})]}),e.jsxs("div",{className:"p-4 bg-white border-b",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Trip Details"}),e.jsxs("div",{className:"font-semibold mt-1",children:[(j=i.patients)==null?void 0:j.first_name," ",(_=i.patients)==null?void 0:_.last_name]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-2 flex items-start gap-2",children:[e.jsx(ae,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{children:i.pickup_location}),e.jsx("div",{className:"text-gray-400",children:"to"}),e.jsx("div",{children:i.dropoff_location})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("div",{className:"space-y-3",children:n.map(M=>e.jsx("button",{onClick:()=>u(M.id),className:`w-full p-4 bg-white rounded-lg shadow-sm border-2 transition-colors ${o===M.id?"border-blue-600":"border-transparent"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${w(M.status)}`}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:M.full_name}),e.jsx("div",{className:"text-sm text-gray-600 capitalize",children:M.status.replace("_"," ")})]})]}),M.phone_number&&e.jsx("a",{href:`tel:${M.phone_number}`,onClick:R=>R.stopPropagation(),className:"p-2 rounded-full bg-green-500 text-white",children:e.jsx(Xe,{className:"w-4 h-4"})})]})},M.id))})}),e.jsx("div",{className:"p-4 bg-white border-t",children:e.jsx("button",{onClick:()=>o&&h(i.id,o),disabled:!o,className:"w-full py-3 bg-blue-600 text-white rounded-lg font-semibold disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Assign Trip"})})]}):t==="drivers"?e.jsxs("div",{className:"flex flex-col h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-blue-600 text-white p-4",children:e.jsx("h1",{className:"text-xl font-bold",children:"Drivers"})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("div",{className:"space-y-3",children:n.map(M=>e.jsx("div",{className:"p-4 bg-white rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full ${w(M.status)}`}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:M.full_name}),e.jsx("div",{className:"text-sm text-gray-600 capitalize",children:M.status.replace("_"," ")})]})]}),M.phone_number&&e.jsx("a",{href:`tel:${M.phone_number}`,className:"p-2 rounded-full bg-green-500 text-white",children:e.jsx(Xe,{className:"w-4 h-4"})})]})},M.id))})}),e.jsxs("div",{className:"bg-white border-t p-2 flex justify-around",children:[e.jsxs("button",{onClick:()=>s("trips"),className:"flex flex-col items-center p-2 text-gray-600",children:[e.jsx(hs,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs mt-1",children:"Trips"})]}),e.jsxs("button",{className:"flex flex-col items-center p-2 text-blue-600",children:[e.jsx(Ze,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs mt-1",children:"Drivers"})]}),e.jsxs("button",{onClick:()=>s("walkie"),className:"flex flex-col items-center p-2 text-gray-600",children:[e.jsx(Kt,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs mt-1",children:"Walkie"})]})]})]}):e.jsxs("div",{className:"flex flex-col h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-blue-600 text-white p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Dispatch"}),e.jsx("button",{onClick:()=>window.location.href="/",className:"text-sm px-3 py-1 bg-white text-blue-600 rounded-md font-medium",children:"Desktop Mode"})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto",children:["all","unassigned","assigned","en_route_pickup","patient_onboard"].map(M=>e.jsx("button",{onClick:()=>N(M),className:`px-3 py-1.5 rounded-full whitespace-nowrap text-sm font-medium transition-colors ${y===M?"bg-white text-blue-600":"bg-blue-500 text-white"}`,children:M==="all"?"All":M.split("_").map(R=>R.charAt(0).toUpperCase()+R.slice(1)).join(" ")},M))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("div",{className:"space-y-3",children:S.map(M=>{var R,O,I;return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold",children:[(R=M.patients)==null?void 0:R.first_name," ",(O=M.patients)==null?void 0:O.last_name]}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1 mt-1",children:[e.jsx(Se,{className:"w-4 h-4"}),new Date(M.scheduled_pickup_time).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})]})]}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-semibold text-white ${g(M.status)}`,children:M.status.split("_").map(A=>A.charAt(0).toUpperCase()+A.slice(1)).join(" ")})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-gray-700",children:M.pickup_location})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-gray-700",children:M.dropoff_location})]})]}),M.profiles&&e.jsxs("div",{className:"flex items-center gap-2 mt-3 text-sm",children:[e.jsx(Fe,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-gray-700",children:M.profiles.full_name})]})]}),e.jsxs("div",{className:"border-t bg-gray-50 p-2 flex gap-2",children:[((I=M.patients)==null?void 0:I.phone)&&e.jsxs("a",{href:`tel:${M.patients.phone}`,className:"flex-1 py-2 px-3 bg-green-500 text-white rounded-md flex items-center justify-center gap-2 text-sm font-medium",children:[e.jsx(Xe,{className:"w-4 h-4"}),"Call Patient"]}),!M.driver_id&&e.jsxs("button",{onClick:()=>{d(M),s("assign")},className:"flex-1 py-2 px-3 bg-blue-600 text-white rounded-md flex items-center justify-center gap-2 text-sm font-medium",children:[e.jsx(ke,{className:"w-4 h-4"}),"Assign"]})]})]},M.id)})})}),e.jsx("button",{onClick:()=>f(!0),className:"fixed bottom-20 right-4 w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center",children:e.jsx(re,{className:"w-6 h-6"})}),e.jsxs("div",{className:"bg-white border-t p-2 flex justify-around",children:[e.jsxs("button",{className:"flex flex-col items-center p-2 text-blue-600",children:[e.jsx(hs,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs mt-1",children:"Trips"})]}),e.jsxs("button",{onClick:()=>s("drivers"),className:"flex flex-col items-center p-2 text-gray-600",children:[e.jsx(Ze,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs mt-1",children:"Drivers"})]}),e.jsxs("button",{onClick:()=>s("walkie"),className:"flex flex-col items-center p-2 text-gray-600",children:[e.jsx(Kt,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs mt-1",children:"Walkie"})]})]}),m&&e.jsx(Ya,{onClose:()=>{f(!1),b()}})]})}function Mv(){var O,I;const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState([]),[i,d]=p.useState(null),[o,u]=p.useState([]),[c,x]=p.useState(!1),[m,f]=p.useState(""),[y,N]=p.useState(""),[k,b]=p.useState(null);p.useEffect(()=>{v(),h(),g()},[]),p.useEffect(()=>{i&&w(i.id)},[i]);async function v(){const{data:A}=await T.from("profiles").select("*").eq("role","driver").order("full_name");A&&s(A)}async function h(){const{data:A}=await T.from("driver_pay_rates").select("*").order("effective_date",{ascending:!1});A&&a(A)}async function g(){const{data:A}=await T.from("payroll_periods").select("*").order("start_date",{ascending:!1});A&&l(A)}async function w(A){const{data:F}=await T.from("payroll_entries").select(`
        *,
        profiles!payroll_entries_driver_id_fkey(full_name)
      `).eq("payroll_period_id",A);if(F){const Q=F.map(E=>{var q;return{...E,driver_name:((q=E.profiles)==null?void 0:q.full_name)||"Unknown"}});u(Q)}}async function S(A,F,Q){const E=r.find(q=>q.driver_id===A);E?await T.from("driver_pay_rates").update({[F]:Q,updated_at:new Date().toISOString()}).eq("id",E.id):await T.from("driver_pay_rates").insert({driver_id:A,[F]:Q}),await h()}async function j(){if(!m||!y){alert("Please select start and end dates");return}x(!0);try{const{data:A}=await T.from("payroll_periods").insert({start_date:m,end_date:y,status:"draft"}).select().single();if(!A)throw new Error("Failed to create payroll period");const{data:F}=await T.from("trips").select("*").eq("status","completed").gte("actual_pickup_time",m).lte("actual_dropoff_time",y).not("driver_id","is",null).not("actual_pickup_time","is",null).not("actual_dropoff_time","is",null);if(!F||F.length===0){alert("No completed trips found for this period"),x(!1);return}const Q=new Map;F.forEach(q=>{const C=new Date(q.actual_pickup_time),P=(new Date(q.actual_dropoff_time).getTime()-C.getTime())/1e3/60,V=Q.get(q.driver_id)||{trips:0,activeMinutes:0,miles:0,wheelchairMinutes:0,ambulatoryMinutes:0};V.trips+=1,V.activeMinutes+=P,V.miles+=q.distance_miles||0,q.space_type==="wheelchair"?V.wheelchairMinutes+=P:V.ambulatoryMinutes+=P,Q.set(q.driver_id,V)});let E=0;for(const[q,C]of Q){const U=r.find(Ee=>Ee.driver_id===q),P=(U==null?void 0:U.hourly_rate)||18,V=(U==null?void 0:U.wheelchair_bonus)||2,D=(U==null?void 0:U.mileage_rate)||.67,B=C.activeMinutes/60,$=C.wheelchairMinutes/60,W=C.ambulatoryMinutes/60,L=B*P,K=$*V,X=C.miles*D,ie=L+K+X;E+=ie,await T.from("payroll_entries").insert({payroll_period_id:A.id,driver_id:q,total_trips:C.trips,active_hours:B,total_miles:C.miles,wheelchair_hours:$,ambulatory_hours:W,hourly_pay:L,mileage_pay:X,bonus_pay:K,total_pay:ie})}await T.from("payroll_periods").update({total_amount:E}).eq("id",A.id),await g(),d(A)}catch(A){console.error("Error calculating payroll:",A),alert("Failed to calculate payroll")}finally{x(!1)}}function _(){if(!i||o.length===0)return;const A=["Driver Name","Total Trips","Active Hours","Total Miles","WAV Hours","AMB Hours","Hourly Pay","Mileage Pay","Bonus Pay","Total Pay"],F=o.map(U=>[U.driver_name,U.total_trips,U.active_hours.toFixed(2),U.total_miles.toFixed(2),U.wheelchair_hours.toFixed(2),U.ambulatory_hours.toFixed(2),`$${U.hourly_pay.toFixed(2)}`,`$${U.mileage_pay.toFixed(2)}`,`$${U.bonus_pay.toFixed(2)}`,`$${U.total_pay.toFixed(2)}`]),Q=[A,...F].map(U=>U.join(",")).join(`
`),E=new Blob([Q],{type:"text/csv"}),q=URL.createObjectURL(E),C=document.createElement("a");C.href=q,C.download=`payroll_${i.start_date}_${i.end_date}.csv`,C.click()}function M(A){const F=new Date,Q=F.getDay(),E=new Date(F);Q===3?E.setDate(F.getDate()-7):Q<3?E.setDate(F.getDate()-(Q+4)):E.setDate(F.getDate()-(Q-3));const q=new Date(E),C=new Date(E);A==="week"?C.setDate(q.getDate()-6):C.setDate(q.getDate()-13),f(C.toISOString().split("T")[0]),N(q.toISOString().split("T")[0])}const R=A=>r.find(F=>F.driver_id===A);return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payroll Management"}),e.jsx("p",{className:"text-gray-600",children:"Calculate driver pay based on active trip time only"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Ze,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Drivers"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ge,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Payroll Periods"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Ft,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Selected Period Total"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",((O=i==null?void 0:i.total_amount)==null?void 0:O.toFixed(2))||"0.00"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Driver Pay Rates"})}),e.jsx("div",{className:"p-6 overflow-auto max-h-96",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Driver"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Hourly"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"WAV Bonus"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Mileage"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(A=>{var E,q,C;const F=R(A.id),Q=k===A.id;return e.jsxs("tr",{onClick:()=>b(A.id),className:"cursor-pointer hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:A.full_name}),e.jsx("td",{className:"px-4 py-3",children:Q?e.jsx("input",{type:"number",step:"0.01",defaultValue:(F==null?void 0:F.hourly_rate)||18,onBlur:U=>S(A.id,"hourly_rate",parseFloat(U.target.value)),className:"w-20 px-2 py-1 border border-gray-300 rounded",autoFocus:!0}):e.jsxs("span",{className:"text-sm text-gray-900",children:["$",((E=F==null?void 0:F.hourly_rate)==null?void 0:E.toFixed(2))||"18.00","/hr"]})}),e.jsx("td",{className:"px-4 py-3",children:Q?e.jsx("input",{type:"number",step:"0.01",defaultValue:(F==null?void 0:F.wheelchair_bonus)||2,onBlur:U=>S(A.id,"wheelchair_bonus",parseFloat(U.target.value)),className:"w-20 px-2 py-1 border border-gray-300 rounded"}):e.jsxs("span",{className:"text-sm text-gray-900",children:["$",((q=F==null?void 0:F.wheelchair_bonus)==null?void 0:q.toFixed(2))||"2.00","/hr"]})}),e.jsx("td",{className:"px-4 py-3",children:Q?e.jsx("input",{type:"number",step:"0.01",defaultValue:(F==null?void 0:F.mileage_rate)||.67,onBlur:U=>S(A.id,"mileage_rate",parseFloat(U.target.value)),className:"w-20 px-2 py-1 border border-gray-300 rounded"}):e.jsxs("span",{className:"text-sm text-gray-900",children:["$",((C=F==null?void 0:F.mileage_rate)==null?void 0:C.toFixed(2))||"0.67","/mi"]})})]},A.id)})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Create Payroll Period"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>M("week"),className:"px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 text-sm",children:"Last Week"}),e.jsx("button",{onClick:()=>M("biweek"),className:"px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 text-sm",children:"Last 2 Weeks"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:m,onChange:A=>f(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:y,onChange:A=>N(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),e.jsxs("button",{onClick:j,disabled:c||!m||!y,className:"w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5"}),c?"Processing...":"Calculate Payroll"]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Recent Periods"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-auto",children:n.map(A=>{var F;return e.jsx("button",{onClick:()=>d(A),className:`w-full text-left px-4 py-3 rounded-lg border transition-all ${(i==null?void 0:i.id)===A.id?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[new Date(A.start_date).toLocaleDateString()," - ",new Date(A.end_date).toLocaleDateString()]}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:A.status})]}),e.jsxs("p",{className:"text-sm font-bold text-gray-900",children:["$",(F=A.total_amount)==null?void 0:F.toFixed(2)]})]})},A.id)})})]})]})]})]}),i&&o.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Payroll Details: ",new Date(i.start_date).toLocaleDateString()," - ",new Date(i.end_date).toLocaleDateString()]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Active time only - downtime excluded"})]}),e.jsxs("button",{onClick:_,className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:[e.jsx(Ua,{className:"w-4 h-4"}),"Export CSV"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Driver"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trips"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Active Hours"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Miles"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"WAV Hours"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"AMB Hours"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hourly Pay"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Mileage Pay"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Bonus Pay"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Pay"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:o.map(A=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:A.driver_name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:A.total_trips}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:A.active_hours.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:A.total_miles.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:A.wheelchair_hours.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:A.ambulatory_hours.toFixed(2)}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",A.hourly_pay.toFixed(2)]}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",A.mileage_pay.toFixed(2)]}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",A.bonus_pay.toFixed(2)]}),e.jsxs("td",{className:"px-4 py-3 text-sm font-bold text-gray-900",children:["$",A.total_pay.toFixed(2)]})]},A.id))}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:9,className:"px-4 py-3 text-right text-sm font-semibold text-gray-900",children:"Total:"}),e.jsxs("td",{className:"px-4 py-3 text-sm font-bold text-gray-900",children:["$",(I=i.total_amount)==null?void 0:I.toFixed(2)]})]})})]})})]})]})}function Dv(){const[t,s]=p.useState([]),[r,a]=p.useState({}),[n,l]=p.useState(!0),[i,d]=p.useState(!1),[o,u]=p.useState(!1),[c,x]=p.useState("unknown"),[m,f]=p.useState(!1);p.useEffect(()=>{y(),N(),k()},[]);async function y(){try{const{data:g,error:w}=await T.from("vehicles").select("id, vehicle_number, vehicle_name, make, model, year").order("vehicle_number");if(w)throw w;s(g||[])}catch(g){console.error("Error loading vehicles:",g)}finally{l(!1)}}async function N(){try{const{data:g,error:w}=await T.from("vehicle_camera_config").select("*");if(w)throw w;const S={};g==null||g.forEach(j=>{S[j.vehicle_id]=j}),a(S)}catch(g){console.error("Error loading camera configs:",g)}}async function k(){try{const j=await(await fetch("https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/raven-connected-sync",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"},body:JSON.stringify({action:"check_api_key"})})).json();f(j.configured||!1)}catch{f(!1)}}function b(g,w){a(S=>({...S,[g]:{...S[g],vehicle_id:g,raven_device_id:w,status:"active",last_sync:new Date().toISOString()}}))}async function v(){d(!0);try{for(const g of Object.values(r))g.raven_device_id&&(g.id?await T.from("vehicle_camera_config").update({raven_device_id:g.raven_device_id,status:"active",updated_at:new Date().toISOString()}).eq("id",g.id):await T.from("vehicle_camera_config").insert({vehicle_id:g.vehicle_id,raven_device_id:g.raven_device_id,camera_model:"Raven Connected",status:"active",installation_date:new Date().toISOString().split("T")[0]}));alert("Configuration saved successfully!"),N()}catch(g){console.error("Error saving configuration:",g),alert("Failed to save configuration")}finally{d(!1)}}async function h(){u(!0),x("unknown");try{const g=Object.values(r).find(_=>_.raven_device_id);if(!g){alert("Please configure at least one vehicle first"),x("error");return}const j=await fetch("https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/raven-connected-sync",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"},body:JSON.stringify({action:"sync_events",vehicleId:g.vehicle_id,startDate:new Date(Date.now()-24*60*60*1e3).toISOString(),endDate:new Date().toISOString()})});if(j.ok){const _=await j.json();x("success"),alert(`Connection successful! Found ${_.eventsImported||0} events.`)}else{const _=await j.json();x("error"),alert(`Connection failed: ${_.error||"Unknown error"}`)}}catch(g){console.error("Connection test error:",g),x("error"),alert("Connection test failed. Please check your configuration.")}finally{u(!1)}}return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading configuration..."})}):e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(qs,{className:"w-7 h-7 text-blue-600"}),"Raven Connected Configuration"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Map your vehicles to Raven device IDs"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[c==="success"&&e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(ue,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Connected"})]}),c==="error"&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600",children:[e.jsx(Gs,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Connection Failed"})]})]})]})}),e.jsxs("div",{className:"p-6",children:[!m&&e.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"API Key Not Configured"}),e.jsx("p",{className:"text-yellow-700 text-sm mb-3",children:"Your Raven API key needs to be configured in Supabase secrets."}),e.jsxs("ol",{className:"text-sm text-yellow-700 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Go to your Raven dashboard at ravenconnected.com"}),e.jsx("li",{children:"Navigate to Settings  API Keys or Developer Settings"}),e.jsx("li",{children:"Copy your API key"}),e.jsx("li",{children:"Contact your administrator to add it as RAVEN_API_KEY in Supabase secrets"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Vehicle Device Mapping"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Vehicle"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Details"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Raven Device ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(g=>{const w=r[g.id];return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-medium text-gray-900",children:g.vehicle_number}),g.vehicle_name&&e.jsx("div",{className:"text-sm text-gray-500",children:g.vehicle_name})]}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-600",children:[g.year," ",g.make," ",g.model]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"text",value:(w==null?void 0:w.raven_device_id)||"",onChange:S=>b(g.id,S.target.value),placeholder:"Enter Raven Device ID",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),e.jsx("td",{className:"px-4 py-3",children:w!=null&&w.raven_device_id?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[e.jsx(ue,{className:"w-3 h-3"}),"Configured"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full",children:[e.jsx(Gs,{className:"w-3 h-3"}),"Not Set"]})})]},g.id)})})]})})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"How to find your Raven Device IDs:"}),e.jsxs("ol",{className:"text-sm text-blue-800 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Log in to your Raven dashboard at ravenconnected.com"}),e.jsx("li",{children:"Click on each vehicle (BatMobile, Fiona, Luna, Mike, Scarlette, Smurf, Terminator)"}),e.jsx("li",{children:"Look for the Device ID, Serial Number, or IMEI"}),e.jsx("li",{children:"Copy and paste it into the corresponding vehicle row above"})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:h,disabled:o||!m,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx(uu,{className:"w-4 h-4 animate-spin"}),"Testing..."]}):"Test Connection"}),e.jsx("button",{onClick:v,disabled:i,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx(uu,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(sr,{className:"w-4 h-4"}),"Save Configuration"]})})]})]})]})})}function Iv(){const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,l]=p.useState(!0),[i,d]=p.useState("events"),[o,u]=p.useState(null),[c,x]=p.useState(!1),[m,f]=p.useState("all"),[y,N]=p.useState("all");p.useState(new Date().toISOString().split("T")[0]);const[k,b]=p.useState(""),[v,h]=p.useState(!1);p.useEffect(()=>{g(),w();const O=T.channel("dash_camera_changes").on("postgres_changes",{event:"*",schema:"public",table:"dash_camera_events"},()=>{g()}).on("postgres_changes",{event:"*",schema:"public",table:"driver_safety_scores"},()=>{w()}).subscribe();return()=>{O.unsubscribe()}},[]);async function g(){try{const{data:O,error:I}=await T.from("dash_camera_events").select(`
          *,
          vehicles (vehicle_name, vehicle_number),
          profiles (full_name)
        `).order("event_timestamp",{ascending:!1}).limit(100);if(I)throw I;s(O||[])}catch(O){console.error("Error loading events:",O)}finally{l(!1)}}async function w(){try{const{data:O,error:I}=await T.from("driver_safety_scores").select(`
          *,
          profiles (full_name)
        `).order("date",{ascending:!1}).limit(50);if(I)throw I;a(O||[])}catch(O){console.error("Error loading safety scores:",O)}}async function S(O){h(!0);try{const F=await fetch("https://vnyebfjpkgqurgqxoqyv.supabase.co/functions/v1/raven-connected-sync",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWViZmpwa2dxdXJncXhvcXl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyOTU3MTMsImV4cCI6MjA4Mjg3MTcxM30.t1ubqDglst6Ie30asZsdKmqK24yciwNtETyUufEJhWo","Content-Type":"application/json"},body:JSON.stringify({action:"sync_events",vehicleId:O,startDate:new Date(Date.now()-7*24*60*60*1e3).toISOString(),endDate:new Date().toISOString()})});if(!F.ok)throw new Error("Sync failed");const Q=await F.json();alert(`Successfully synced ${Q.eventsImported} events`),g()}catch(I){console.error("Sync error:",I),alert("Failed to sync with Raven Connected")}finally{h(!1)}}async function j(O){var F;const I=prompt("Add review notes (optional):"),{data:A}=await T.auth.getUser();await T.from("dash_camera_events").update({reviewed:!0,reviewed_by:(F=A.user)==null?void 0:F.id,reviewed_at:new Date().toISOString(),notes:I||""}).eq("id",O),g()}function _(O){switch(O){case"critical":return"bg-red-100 text-red-700 border-red-300";case"high":return"bg-orange-100 text-orange-700 border-orange-300";case"medium":return"bg-yellow-100 text-yellow-700 border-yellow-300";default:return"bg-blue-100 text-blue-700 border-blue-300"}}function M(O){return O>=90?"text-green-600":O>=75?"text-yellow-600":O>=60?"text-orange-600":"text-red-600"}const R=t.filter(O=>{var I,A,F;if(m!=="all"&&O.severity!==m||y!=="all"&&!O.event_type.includes(y))return!1;if(k){const Q=k.toLowerCase();return((I=O.profiles)==null?void 0:I.full_name.toLowerCase().includes(Q))||((F=(A=O.vehicles)==null?void 0:A.vehicle_name)==null?void 0:F.toLowerCase().includes(Q))||O.event_type.toLowerCase().includes(Q)}return!0});return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading dash camera data..."})}):e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Raven Connected Dash Cameras"}),e.jsx("p",{className:"text-gray-600",children:"Monitor safety events and driver performance"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>d("events"),className:`px-6 py-2 rounded-lg font-medium transition-colors ${i==="events"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(hu,{className:"w-4 h-4 inline mr-2"}),"Events"]}),e.jsxs("button",{onClick:()=>d("scores"),className:`px-6 py-2 rounded-lg font-medium transition-colors ${i==="scores"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(hs,{className:"w-4 h-4 inline mr-2"}),"Safety Scores"]}),e.jsxs("button",{onClick:()=>d("setup"),className:`px-6 py-2 rounded-lg font-medium transition-colors ${i==="setup"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(qs,{className:"w-4 h-4 inline mr-2"}),"Setup"]})]})]}),i==="events"&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search driver or vehicle...",value:k,onChange:O=>b(O.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("select",{value:m,onChange:O=>f(O.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{value:y,onChange:O=>N(O.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Event Types"}),e.jsx("option",{value:"braking",children:"Harsh Braking"}),e.jsx("option",{value:"acceleration",children:"Harsh Acceleration"}),e.jsx("option",{value:"cornering",children:"Harsh Cornering"}),e.jsx("option",{value:"distraction",children:"Driver Distraction"}),e.jsx("option",{value:"speeding",children:"Speeding"})]}),e.jsx("button",{onClick:()=>{var O;return S((O=t[0])==null?void 0:O.vehicle_id)},disabled:v,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Sync Data"})]})]}),i==="events"&&e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:R.map(O=>{var I,A;return e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"relative",children:[O.thumbnail_url?e.jsx("img",{src:O.thumbnail_url,alt:"Event thumbnail",className:"w-full h-48 object-cover"}):e.jsx("div",{className:"w-full h-48 bg-gray-200 flex items-center justify-center",children:e.jsx(hu,{className:"w-12 h-12 text-gray-400"})}),e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${_(O.severity)}`,children:O.severity.toUpperCase()})}),O.reviewed&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx(ue,{className:"w-6 h-6 text-green-600 bg-white rounded-full"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:O.event_type.replace(/_/g," ").replace(/\b\w/g,F=>F.toUpperCase())}),e.jsx("span",{className:"text-xs text-gray-500",children:O.speed_mph?`${O.speed_mph} mph`:"N/A"})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Driver:"}),((I=O.profiles)==null?void 0:I.full_name)||"Unknown"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Vehicle:"}),((A=O.vehicles)==null?void 0:A.vehicle_name)||"Unknown"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),new Date(O.event_timestamp).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[O.video_url&&e.jsxs("button",{onClick:()=>{u(O),x(!0)},className:"flex-1 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2",children:[e.jsx(tr,{className:"w-4 h-4"}),"View Video"]}),!O.reviewed&&e.jsx("button",{onClick:()=>j(O.id),className:"flex-1 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Mark Reviewed"})]})]})]},O.id)})}),R.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ue,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Events Found"}),e.jsx("p",{className:"text-gray-600",children:"No dash camera events match your filters"})]})]}),i==="scores"&&e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Driver"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Safety Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Harsh Braking"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Harsh Accel"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cornering"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Distraction"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Speeding"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Miles Driven"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(O=>{var I;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-medium text-gray-900",children:(I=O.profiles)==null?void 0:I.full_name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(O.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-2xl font-bold ${M(O.overall_score)}`,children:O.overall_score}),O.overall_score>=90?e.jsx(qa,{className:"w-5 h-5 text-green-600"}):e.jsx(Yy,{className:"w-5 h-5 text-red-600"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-sm ${O.harsh_braking_count>0?"bg-red-100 text-red-700":"text-gray-600"}`,children:O.harsh_braking_count})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-sm ${O.harsh_acceleration_count>0?"bg-red-100 text-red-700":"text-gray-600"}`,children:O.harsh_acceleration_count})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-sm ${O.harsh_cornering_count>0?"bg-red-100 text-red-700":"text-gray-600"}`,children:O.harsh_cornering_count})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-sm ${O.distraction_count>0?"bg-red-100 text-red-700":"text-gray-600"}`,children:O.distraction_count})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-sm ${O.speeding_count>0?"bg-red-100 text-red-700":"text-gray-600"}`,children:O.speeding_count})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O.miles_driven||"N/A"})]},O.id)})})]})})}),r.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(hs,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Safety Scores Yet"}),e.jsx("p",{className:"text-gray-600",children:"Safety scores will appear here once events are processed"})]})]}),i==="setup"&&e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx(Dv,{})}),c&&o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Event Video"}),e.jsx("button",{onClick:()=>{x(!1),u(null)},className:"text-gray-500 hover:text-gray-700",children:""})]}),e.jsx("div",{className:"p-6",children:o.video_url?e.jsx("video",{controls:!0,className:"w-full rounded-lg",src:o.video_url,children:"Your browser does not support video playback."}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ry,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Video not available"})]})})]})})]})}const kn={cash_app:{label:"Cash App",placeholder:"$cashtag (e.g., $YourCompany)",icon:""},apple_pay:{label:"Apple Pay",placeholder:"Phone number or email",icon:""},zelle:{label:"Zelle",placeholder:"Email or phone number",icon:""},paypal:{label:"PayPal",placeholder:"Email or PayPal.me link",icon:""}};function Lv(){var k;const[t,s]=p.useState([]),[r,a]=p.useState(!0),[n,l]=p.useState(!1),[i,d]=p.useState(null),[o,u]=p.useState({payment_type:"cash_app",account_identifier:"",display_name:"",is_active:!0,instructions:""});p.useEffect(()=>{c()},[]);async function c(){a(!0);try{const{data:b,error:v}=await T.from("payment_settings").select("*").order("payment_type");if(v)throw v;s(b||[])}catch(b){console.error("Error loading payment settings:",b)}finally{a(!1)}}function x(b){b?(d(b),u({payment_type:b.payment_type,account_identifier:b.account_identifier,display_name:b.display_name,is_active:b.is_active,instructions:b.instructions||""})):(d(null),u({payment_type:"cash_app",account_identifier:"",display_name:"",is_active:!0,instructions:""})),l(!0)}function m(){l(!1),d(null)}async function f(b){b.preventDefault(),a(!0);try{const v={...o,instructions:o.instructions||null,updated_at:new Date().toISOString()};if(i){const{error:h}=await T.from("payment_settings").update(v).eq("id",i.id);if(h)throw h}else{const{error:h}=await T.from("payment_settings").insert(v);if(h)throw h}await c(),m()}catch(v){console.error("Error saving payment setting:",v),alert("Error saving payment setting")}finally{a(!1)}}async function y(b){if(confirm("Are you sure you want to delete this payment method?"))try{const{error:v}=await T.from("payment_settings").delete().eq("id",b);if(v)throw v;await c()}catch(v){console.error("Error deleting payment setting:",v),alert("Error deleting payment setting")}}async function N(b,v){try{const{error:h}=await T.from("payment_settings").update({is_active:!v}).eq("id",b);if(h)throw h;await c()}catch(h){console.error("Error updating payment setting:",h),alert("Error updating payment setting")}}return r&&t.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading payment settings..."})}):e.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Payment Settings"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configure your payment accounts for private pay invoices"})]}),e.jsxs("button",{onClick:()=>x(),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Add Payment Method"]})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:t.map(b=>{var v,h;return e.jsxs("div",{className:`bg-white rounded-xl shadow-md p-6 border-2 ${b.is_active?"border-green-200":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-3xl",children:(v=kn[b.payment_type])==null?void 0:v.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:b.display_name}),e.jsx("p",{className:"text-sm text-gray-500",children:(h=kn[b.payment_type])==null?void 0:h.label})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>N(b.id,b.is_active),className:`px-3 py-1 rounded-full text-xs font-medium ${b.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:b.is_active?"Active":"Inactive"})})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Account"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:b.account_identifier})]}),b.instructions&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Instructions"}),e.jsx("p",{className:"text-sm text-gray-700",children:b.instructions})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>x(b),className:"flex-1 bg-gray-100 text-gray-700 py-2 rounded-lg font-medium hover:bg-gray-200 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Wr,{className:"w-4 h-4"}),"Edit"]}),e.jsx("button",{onClick:()=>y(b.id),className:"bg-red-100 text-red-700 py-2 px-4 rounded-lg font-medium hover:bg-red-200 transition-colors flex items-center justify-center gap-2",children:e.jsx(Za,{className:"w-4 h-4"})})]})]},b.id)})}),t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ex,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No payment methods configured"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Add your payment accounts to start accepting private payments"}),e.jsxs("button",{onClick:()=>x(),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors inline-flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Add Your First Payment Method"]})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between rounded-t-xl",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:i?"Edit Payment Method":"Add Payment Method"}),e.jsx("button",{onClick:m,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:f,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Type *"}),e.jsx("select",{value:o.payment_type,onChange:b=>u({...o,payment_type:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:!!i,children:Object.entries(kn).map(([b,v])=>e.jsxs("option",{value:b,children:[v.icon," ",v.label]},b))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Name *"}),e.jsx("input",{type:"text",value:o.display_name,onChange:b=>u({...o,display_name:b.target.value}),placeholder:"e.g., Company Cash App",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Identifier *"}),e.jsx("input",{type:"text",value:o.account_identifier,onChange:b=>u({...o,account_identifier:b.target.value}),placeholder:(k=kn[o.payment_type])==null?void 0:k.placeholder,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Instructions (Optional)"}),e.jsx("textarea",{value:o.instructions,onChange:b=>u({...o,instructions:b.target.value}),rows:3,placeholder:"e.g., Send payment to this account and include your invoice number in the memo",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:o.is_active,onChange:b=>u({...o,is_active:b.target.checked}),className:"w-5 h-5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"is_active",className:"text-sm text-gray-700",children:"Active (show this payment method to customers)"})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[e.jsxs("button",{type:"submit",disabled:r,className:"flex-1 bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(sr,{className:"w-5 h-5"}),r?"Saving...":"Save Payment Method"]}),e.jsx("button",{type:"button",onClick:m,className:"px-6 py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})]})}function Rv(){const[t,s]=p.useState(!1),[r,a]=p.useState(""),[n,l]=p.useState(""),[i,d]=p.useState(null),[o,u]=p.useState([]),[c,x]=p.useState([]),[m,f]=p.useState(null),[y,N]=p.useState(!1),[k,b]=p.useState("upcoming");p.useEffect(()=>{if(t&&i){h();const I=T.channel("member-trips").on("postgres_changes",{event:"*",schema:"public",table:"trips",filter:`patient_id=eq.${i.id}`},()=>{h()}).subscribe(),A=setInterval(()=>{m!=null&&m.driver_id&&g(m.driver_id)},1e4);return()=>{I.unsubscribe(),clearInterval(A)}}},[t,i,m]);async function v(I){I.preventDefault(),l(""),N(!0);try{const A=r.replace(/\D/g,""),{data:F,error:Q}=await T.from("patients").select("*").eq("phone",A).eq("status","active").maybeSingle();if(Q)throw Q;if(!F){l("No active account found with this phone number");return}d(F),s(!0),localStorage.setItem("member_portal_patient",JSON.stringify(F))}catch(A){console.error("Login error:",A),l("Error logging in. Please try again.")}finally{N(!1)}}async function h(){if(i)try{const I=new Date().toISOString(),{data:A}=await T.from("trips").select(`
          *,
          driver:drivers(full_name, phone, current_latitude, current_longitude),
          vehicle:vehicles(make, model, year, color, license_plate)
        `).eq("patient_id",i.id).gte("scheduled_pickup_time",I).order("scheduled_pickup_time",{ascending:!0}),{data:F}=await T.from("trips").select(`
          *,
          driver:drivers(full_name, phone, current_latitude, current_longitude),
          vehicle:vehicles(make, model, year, color, license_plate)
        `).eq("patient_id",i.id).lt("scheduled_pickup_time",I).order("scheduled_pickup_time",{ascending:!1}).limit(20);u(A||[]),x(F||[])}catch(I){console.error("Error loading trips:",I)}}async function g(I){try{const{data:A}=await T.from("drivers").select("current_latitude, current_longitude").eq("id",I).maybeSingle();A&&m&&f({...m,driver:{...m.driver,current_latitude:A.current_latitude,current_longitude:A.current_longitude}})}catch(A){console.error("Error loading driver location:",A)}}async function w(I,A){if(A.stopPropagation(),!!confirm("Are you sure you want to cancel this ride?"))try{const{error:F}=await T.from("trips").update({status:"cancelled"}).eq("id",I).eq("patient_id",i==null?void 0:i.id);if(F)throw F;await h()}catch(F){console.error("Error cancelling trip:",F),alert("Failed to cancel ride. Please try again.")}}function S(){s(!1),d(null),u([]),x([]),f(null),localStorage.removeItem("member_portal_patient")}function j(I){return new Date(I).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}function _(I){return new Date(I).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}function M(I){switch(I){case"completed":return"bg-green-100 text-green-800 border-green-200";case"in_progress":return"bg-blue-100 text-blue-800 border-blue-200";case"assigned":return"bg-purple-100 text-purple-800 border-purple-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}}function R(I){switch(I){case"completed":return e.jsx(ue,{className:"w-5 h-5"});case"in_progress":return e.jsx(_s,{className:"w-5 h-5"});case"assigned":return e.jsx(Se,{className:"w-5 h-5"});default:return e.jsx(Ut,{className:"w-5 h-5"})}}function O(I,A,F){/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?window.open(`https://maps.google.com/?q=${I},${A}`):window.open(`https://www.google.com/maps/search/?api=1&query=${I},${A}`)}return t?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-blue-600 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Welcome, ",i==null?void 0:i.full_name]}),e.jsx("p",{className:"text-blue-100 text-sm",children:i==null?void 0:i.phone})]}),e.jsxs("button",{onClick:S,className:"flex items-center gap-2 bg-blue-700 hover:bg-blue-800 px-4 py-2 rounded-lg transition-colors",children:[e.jsx(Ol,{className:"w-4 h-4"}),"Logout"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex gap-4 border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>b("upcoming"),className:`pb-4 px-2 font-semibold transition-colors relative ${k==="upcoming"?"text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Upcoming Rides",o.length>0&&e.jsx("span",{className:"ml-2 bg-blue-600 text-white text-xs rounded-full px-2 py-1",children:o.length}),k==="upcoming"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600"})]}),e.jsxs("button",{onClick:()=>b("history"),className:`pb-4 px-2 font-semibold transition-colors relative ${k==="history"?"text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Ride History",k==="history"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600"})]})]})}),k==="upcoming"?e.jsx("div",{className:"space-y-4",children:o.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-12 text-center",children:[e.jsx(ge,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Upcoming Rides"}),e.jsx("p",{className:"text-gray-600",children:"You don't have any scheduled rides at the moment."})]}):o.map(I=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>f(I),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ge,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"font-semibold text-gray-900",children:j(I.scheduled_pickup_time)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"text-lg font-bold text-blue-600",children:_(I.scheduled_pickup_time)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full border ${M(I.status)}`,children:[R(I.status),e.jsx("span",{className:"text-sm font-medium capitalize",children:I.status.replace("_"," ")})]}),I.status!=="cancelled"&&I.status!=="completed"&&e.jsx("button",{onClick:A=>w(I.id,A),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Cancel ride",children:e.jsx(Za,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mt-1.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Pickup"}),e.jsx("p",{className:"font-medium text-gray-900",children:I.pickup_address})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mt-1.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Dropoff"}),e.jsx("p",{className:"font-medium text-gray-900",children:I.dropoff_address})]})]})]}),I.driver&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(ke,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Driver"}),e.jsx("p",{className:"font-semibold text-gray-900",children:I.driver.full_name})]})]}),I.vehicle&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Vehicle"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[I.vehicle.color," ",I.vehicle.make," ",I.vehicle.model]})]})]})})]},I.id))}):e.jsx("div",{className:"space-y-4",children:c.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-12 text-center",children:[e.jsx(ge,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Ride History"}),e.jsx("p",{className:"text-gray-600",children:"Your completed rides will appear here."})]}):c.map(I=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ge,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"font-semibold text-gray-900",children:j(I.scheduled_pickup_time)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"text-gray-700",children:_(I.scheduled_pickup_time)})]})]}),e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full border ${M(I.status)}`,children:[R(I.status),e.jsx("span",{className:"text-sm font-medium capitalize",children:I.status.replace("_"," ")})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mt-1.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pickup"}),e.jsx("p",{className:"text-gray-900",children:I.pickup_address})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mt-1.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Dropoff"}),e.jsx("p",{className:"text-gray-900",children:I.dropoff_address})]})]})]})]},I.id))})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-blue-600 text-white px-6 py-4 flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Ride Details"}),e.jsx("button",{onClick:()=>f(null),className:"text-white hover:text-gray-200 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 text-lg",children:"Trip Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"text-gray-900",children:j(m.scheduled_pickup_time)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Se,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"text-gray-900",children:_(m.scheduled_pickup_time)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 text-lg",children:"Locations"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Pickup Location"}),e.jsx("p",{className:"font-medium text-gray-900",children:m.pickup_address})]})]}),m.pickup_latitude&&m.pickup_longitude&&e.jsxs("button",{onClick:()=>O(m.pickup_latitude,m.pickup_longitude,m.pickup_address),className:"ml-7 text-blue-600 hover:text-blue-700 text-sm font-medium flex items-center gap-1",children:[e.jsx(ae,{className:"w-4 h-4"}),"Open in Maps"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Dropoff Location"}),e.jsx("p",{className:"font-medium text-gray-900",children:m.dropoff_address})]})]}),m.dropoff_latitude&&m.dropoff_longitude&&e.jsxs("button",{onClick:()=>O(m.dropoff_latitude,m.dropoff_longitude,m.dropoff_address),className:"ml-7 text-blue-600 hover:text-blue-700 text-sm font-medium flex items-center gap-1",children:[e.jsx(ae,{className:"w-4 h-4"}),"Open in Maps"]})]})]})]}),m.driver&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 text-lg",children:"Driver Information"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx(ke,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 text-lg",children:m.driver.full_name}),e.jsxs("a",{href:`tel:${m.driver.phone}`,className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(Xe,{className:"w-4 h-4"}),m.driver.phone]})]})]}),m.driver.current_latitude&&m.driver.current_longitude&&e.jsxs("button",{onClick:()=>O(m.driver.current_latitude,m.driver.current_longitude),className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(_s,{className:"w-4 h-4"}),"Track Driver Location"]})]})]}),m.vehicle&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 text-lg",children:"Vehicle Information"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Fe,{className:"w-6 h-6 text-gray-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-semibold text-gray-900 text-lg mb-1",children:[m.vehicle.year," ",m.vehicle.make," ",m.vehicle.model]}),e.jsxs("p",{className:"text-gray-700 mb-1",children:[e.jsx("span",{className:"font-medium",children:"Color:"})," ",m.vehicle.color]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"License Plate:"})," ",e.jsx("span",{className:"font-mono bg-white px-2 py-1 rounded border border-gray-300",children:m.vehicle.license_plate})]})]})]})})]})]}),e.jsx("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50",children:e.jsx("button",{onClick:()=>f(null),className:"w-full bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition-colors font-semibold",children:"Close"})})]})})]}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-blue-600 text-white rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4",children:e.jsx(ke,{className:"w-10 h-10"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Member Portal"}),e.jsx("p",{className:"text-gray-600",children:"Track your rides in real-time"})]}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:r,onChange:I=>a(I.target.value),placeholder:"(555) 123-4567",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg",required:!0})]}),n&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg text-sm",children:n}),e.jsx("button",{type:"submit",disabled:y,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-lg",children:y?"Logging in...":"Login"})]}),e.jsx("div",{className:"mt-6 text-center text-sm text-gray-600",children:e.jsx("p",{children:"Enter your registered phone number to access your rides"})})]})})}function bi({value:t,onChange:s,onPlaceSelect:r,placeholder:a="Enter address",required:n=!1,className:l="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}){const{isLoaded:i}=er(),d=p.useRef(null),o=p.useRef(null);return p.useEffect(()=>{if(!(!i||!d.current)){try{o.current=new google.maps.places.Autocomplete(d.current,{fields:["formatted_address","geometry","name","address_components"],types:["address"]}),o.current.addListener("place_changed",()=>{var c;const u=(c=o.current)==null?void 0:c.getPlace();u!=null&&u.formatted_address&&(s(u.formatted_address),r&&r(u))})}catch(u){console.error("Error initializing autocomplete:",u)}return()=>{o.current&&google.maps.event.clearInstanceListeners(o.current)}}},[i,s,r]),e.jsx("input",{ref:d,type:"text",value:t,onChange:u=>s(u.target.value),placeholder:a,required:n,className:l})}function Ov(){er();const[t,s]=p.useState(!1),[r,a]=p.useState(""),[n,l]=p.useState(""),[i,d]=p.useState(!1),[o,u]=p.useState(null),[c,x]=p.useState([]),[m,f]=p.useState([]),[y,N]=p.useState("trips"),[k,b]=p.useState(!1),[v,h]=p.useState(!1),[g,w]=p.useState(null),[S,j]=p.useState(null),[_,M]=p.useState({patient_id:"",pickup_time:"",pickup_address:"",dropoff_address:"",notes:"",mobility_needs:"",is_roundtrip:!1,is_will_call:!1,return_pickup_time:""}),[R,O]=p.useState({full_name:"",phone:"",email:"",date_of_birth:"",medical_id:"",mobility_needs:"",special_instructions:"",address:""});p.useEffect(()=>{const $=localStorage.getItem("client_portal_auth");if($){const W=JSON.parse($);u(W),s(!0)}},[]),p.useEffect(()=>{t&&o&&(A(),F())},[t,o]);async function I($){$.preventDefault(),l(""),d(!0);try{const{data:W,error:L}=await T.from("client_portals").select("*").eq("api_key",r.trim()).eq("status","active").maybeSingle();if(L)throw L;if(!W){l("Invalid API key or inactive account");return}u(W),s(!0),localStorage.setItem("client_portal_auth",JSON.stringify(W))}catch(W){console.error("Login error:",W),l("Error logging in. Please try again.")}finally{d(!1)}}async function A(){if(o)try{const{data:$}=await T.from("patients").select("*").eq("client_portal_id",o.id).order("full_name",{ascending:!0});x($||[])}catch($){console.error("Error loading patients:",$)}}async function F(){if(o)try{const{data:$}=await T.from("patients").select("id").eq("client_portal_id",o.id);if(!$||$.length===0){f([]);return}const W=$.map(K=>K.id),{data:L}=await T.from("trips").select(`
          *,
          patient:patients(*)
        `).in("patient_id",W).order("scheduled_pickup_time",{ascending:!1}).limit(100);f(L||[])}catch($){console.error("Error loading trips:",$)}}async function Q($,W){var L,K,X,ie;try{if(!((L=window.google)!=null&&L.maps))return console.warn("Google Maps not loaded, skipping distance calculation"),0;const qe=await new google.maps.DistanceMatrixService().getDistanceMatrix({origins:[$],destinations:[W],travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.IMPERIAL});if((ie=(X=(K=qe.rows[0])==null?void 0:K.elements[0])==null?void 0:X.distance)!=null&&ie.value){const Hr=qe.rows[0].elements[0].distance.value*621371e-9;return Math.round(Hr*100)/100}return 0}catch(Ee){return console.error("Error calculating distance:",Ee),0}}async function E($){$.preventDefault(),d(!0);try{const W=await Q(_.pickup_address,_.dropoff_address),{error:L}=await T.from("trips").insert([{patient_id:_.patient_id,pickup_address:_.pickup_address,dropoff_address:_.dropoff_address,scheduled_pickup_time:_.pickup_time,notes:_.notes,is_roundtrip:_.is_roundtrip,is_will_call:_.is_will_call,return_pickup_time:_.is_roundtrip&&!_.is_will_call?_.return_pickup_time:null,broker_name:"Helping Hands Donation",distance_miles:W,status:"pending"}]);if(L)throw L;b(!1),M({patient_id:"",pickup_time:"",pickup_address:"",dropoff_address:"",notes:"",mobility_needs:"",is_roundtrip:!1,is_will_call:!1,return_pickup_time:""}),F(),alert("Trip booked successfully!")}catch(W){console.error("Error booking trip:",W),alert("Failed to book trip. Please try again.")}finally{d(!1)}}async function q($){$.preventDefault(),d(!0);try{if(S){const{error:W}=await T.from("patients").update({...R,updated_at:new Date().toISOString()}).eq("id",S.id);if(W)throw W;alert("Patient updated successfully!")}else{const{error:W}=await T.from("patients").insert([{...R,client_portal_id:o==null?void 0:o.id,status:"active"}]);if(W)throw W;alert("Patient added successfully!")}h(!1),j(null),O({full_name:"",phone:"",email:"",date_of_birth:"",medical_id:"",mobility_needs:"",special_instructions:"",address:""}),A()}catch(W){console.error("Error saving patient:",W),alert("Failed to save patient. Please try again.")}finally{d(!1)}}async function C($){if(confirm("Are you sure you want to delete this patient?")){d(!0);try{const{error:W}=await T.from("patients").delete().eq("id",$);if(W)throw W;alert("Patient deleted successfully!"),A()}catch(W){console.error("Error deleting patient:",W),alert("Failed to delete patient. Please try again.")}finally{d(!1)}}}function U($){$?(j($),O({full_name:$.full_name,phone:$.phone,email:$.email||"",date_of_birth:$.date_of_birth||"",medical_id:$.medical_id||"",mobility_needs:$.mobility_needs||"",special_instructions:$.special_instructions||"",address:$.address||""})):(j(null),O({full_name:"",phone:"",email:"",date_of_birth:"",medical_id:"",mobility_needs:"",special_instructions:"",address:""})),h(!0)}function P(){s(!1),u(null),x([]),f([]),localStorage.removeItem("client_portal_auth")}function V($){return new Date($).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function D($){return new Date($).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}function B($){switch($){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"assigned":return"bg-purple-100 text-purple-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}return t?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-blue-600 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:o==null?void 0:o.organization_name}),e.jsx("p",{className:"text-blue-100 text-sm capitalize",children:o==null?void 0:o.organization_type.replace("_"," ")})]}),e.jsxs("button",{onClick:P,className:"flex items-center gap-2 bg-blue-700 hover:bg-blue-800 px-4 py-2 rounded-lg transition-colors",children:[e.jsx(Ol,{className:"w-4 h-4"}),"Logout"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex gap-4 border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>N("trips"),className:`pb-4 px-4 font-semibold transition-colors relative ${y==="trips"?"text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(ge,{className:"w-5 h-5 inline-block mr-2"}),"Trips",y==="trips"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600"})]}),e.jsxs("button",{onClick:()=>N("patients"),className:`pb-4 px-4 font-semibold transition-colors relative ${y==="patients"?"text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Ze,{className:"w-5 h-5 inline-block mr-2"}),"Patients",y==="patients"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600"})]})]}),y==="trips"&&e.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all shadow-lg hover:shadow-xl",children:[e.jsx(re,{className:"w-5 h-5"}),"Book Trip"]}),y==="patients"&&e.jsxs("button",{onClick:()=>U(),className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all shadow-lg hover:shadow-xl",children:[e.jsx(re,{className:"w-5 h-5"}),"Add Patient"]})]}),y==="trips"?e.jsx("div",{className:"space-y-4",children:m.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-12 text-center",children:[e.jsx(ge,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Trips"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"You haven't booked any trips yet."}),e.jsxs("button",{onClick:()=>b(!0),className:"inline-flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all",children:[e.jsx(re,{className:"w-5 h-5"}),"Book Your First Trip"]})]}):m.map($=>{var W;return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ke,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"font-semibold text-gray-900 text-lg",children:(W=$.patient)==null?void 0:W.full_name})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{children:V($.scheduled_pickup_time)}),e.jsx(Se,{className:"w-4 h-4 ml-2"}),e.jsx("span",{className:"font-semibold",children:D($.scheduled_pickup_time)})]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${B($.status)}`,children:$.status.replace("_"," ")})]}),e.jsxs("div",{className:"space-y-3 border-t pt-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mt-1.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pickup"}),e.jsx("p",{className:"font-medium text-gray-900",children:$.pickup_address})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mt-1.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Dropoff"}),e.jsx("p",{className:"font-medium text-gray-900",children:$.dropoff_address})]})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ml,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:$.broker_name||"Helping Hands Donation"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:$.distance_miles?`${$.distance_miles} mi`:"0 mi"})]})]}),$.is_roundtrip&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),e.jsx("span",{className:"font-medium",children:"Roundtrip"}),$.is_will_call?e.jsx("span",{className:"text-sm text-gray-600",children:"(Will Call)"}):$.return_pickup_time?e.jsxs("span",{className:"text-sm text-gray-600",children:["Return: ",D($.return_pickup_time)]}):null]})}),$.notes&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Notes"}),e.jsx("p",{className:"text-gray-900",children:$.notes})]})]},$.id)})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.length===0?e.jsxs("div",{className:"col-span-full bg-white rounded-lg shadow-md p-12 text-center",children:[e.jsx(Ze,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Patients"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No patients have been added to your portal yet."}),e.jsxs("button",{onClick:()=>U(),className:"inline-flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all",children:[e.jsx(re,{className:"w-5 h-5"}),"Add Your First Patient"]})]}):c.map($=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(ke,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:$.full_name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${$.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:$.status})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>U($),className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit patient",children:e.jsx(zt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>C($.id),className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete patient",children:e.jsx(Za,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[$.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Xe,{className:"w-4 h-4"}),$.phone]}),$.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Qs,{className:"w-4 h-4"}),$.email]}),$.mobility_needs&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Ly,{className:"w-4 h-4"}),$.mobility_needs]}),$.address&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(ae,{className:"w-4 h-4"}),$.address]})]}),e.jsx("button",{onClick:()=>{w($),M({..._,patient_id:$.id,pickup_address:$.address||"",mobility_needs:$.mobility_needs||""}),b(!0)},className:"w-full mt-4 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Book Trip"})]},$.id))})]}),k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Book New Trip"}),e.jsx("button",{onClick:()=>{b(!1),w(null)},className:"text-gray-400 hover:text-gray-600",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:E,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patient"}),e.jsxs("select",{required:!0,value:_.patient_id,onChange:$=>{const W=c.find(L=>L.id===$.target.value);M({..._,patient_id:$.target.value,pickup_address:(W==null?void 0:W.address)||"",mobility_needs:(W==null?void 0:W.mobility_needs)||""})},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a patient"}),c.filter($=>$.status==="active").map($=>e.jsx("option",{value:$.id,children:$.full_name},$.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pickup Date & Time"}),e.jsx("input",{type:"datetime-local",required:!0,value:_.pickup_time,onChange:$=>M({..._,pickup_time:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pickup Address"}),e.jsx(bi,{required:!0,value:_.pickup_address,onChange:$=>M({..._,pickup_address:$}),placeholder:"Enter pickup address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dropoff Address"}),e.jsx(bi,{required:!0,value:_.dropoff_address,onChange:$=>M({..._,dropoff_address:$}),placeholder:"Enter dropoff address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mobility Needs"}),e.jsxs("select",{value:_.mobility_needs,onChange:$=>M({..._,mobility_needs:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"None"}),e.jsx("option",{value:"ambulatory",children:"Ambulatory"}),e.jsx("option",{value:"wheelchair",children:"Wheelchair"}),e.jsx("option",{value:"stretcher",children:"Stretcher"}),e.jsx("option",{value:"walker",children:"Walker"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_roundtrip",checked:_.is_roundtrip,onChange:$=>M({..._,is_roundtrip:$.target.checked,is_will_call:$.target.checked?_.is_will_call:!1,return_pickup_time:$.target.checked?_.return_pickup_time:""}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"is_roundtrip",className:"ml-2 text-sm font-medium text-gray-700",children:"Roundtrip (Need return ride)"})]}),_.is_roundtrip&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center ml-6",children:[e.jsx("input",{type:"checkbox",id:"is_will_call",checked:_.is_will_call,onChange:$=>M({..._,is_will_call:$.target.checked,return_pickup_time:$.target.checked?"":_.return_pickup_time}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"is_will_call",className:"ml-2 text-sm font-medium text-gray-700",children:"Will Call (Patient will call when ready for return)"})]}),!_.is_will_call&&e.jsxs("div",{className:"ml-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Return Pickup Time"}),e.jsx("input",{type:"datetime-local",required:_.is_roundtrip&&!_.is_will_call,value:_.return_pickup_time,onChange:$=>M({..._,return_pickup_time:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Special Instructions"}),e.jsx("textarea",{value:_.notes,onChange:$=>M({..._,notes:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Any special instructions or notes"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-all disabled:opacity-50 font-medium",children:i?"Booking...":"Book Trip"}),e.jsx("button",{type:"button",onClick:()=>{b(!1),w(null)},className:"px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all",children:"Cancel"})]})]})]})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:S?"Edit Patient":"Add New Patient"}),e.jsx("button",{onClick:()=>{h(!1),j(null)},className:"text-gray-400 hover:text-gray-600",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:q,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),e.jsx("input",{type:"text",required:!0,value:R.full_name,onChange:$=>O({...R,full_name:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"John Doe"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),e.jsx("input",{type:"tel",required:!0,value:R.phone,onChange:$=>O({...R,phone:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"(555) 123-4567"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:R.email,onChange:$=>O({...R,email:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"john@example.com"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),e.jsx("input",{type:"date",value:R.date_of_birth,onChange:$=>O({...R,date_of_birth:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Medical ID"}),e.jsx("input",{type:"text",value:R.medical_id,onChange:$=>O({...R,medical_id:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"MED-12345"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx(bi,{value:R.address,onChange:$=>O({...R,address:$}),placeholder:"123 Main St, City, State 12345"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mobility Needs"}),e.jsxs("select",{value:R.mobility_needs,onChange:$=>O({...R,mobility_needs:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"None"}),e.jsx("option",{value:"ambulatory",children:"Ambulatory"}),e.jsx("option",{value:"wheelchair",children:"Wheelchair"}),e.jsx("option",{value:"stretcher",children:"Stretcher"}),e.jsx("option",{value:"walker",children:"Walker"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Special Instructions"}),e.jsx("textarea",{value:R.special_instructions,onChange:$=>O({...R,special_instructions:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Any special care instructions or notes"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-all disabled:opacity-50 font-medium",children:i?"Saving...":S?"Update Patient":"Add Patient"}),e.jsx("button",{type:"button",onClick:()=>{h(!1),j(null)},className:"px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all",children:"Cancel"})]})]})]})})]}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-blue-600 text-white rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4",children:e.jsx(ml,{className:"w-10 h-10"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Client Portal"}),e.jsx("p",{className:"text-gray-600",children:"Book and manage transportation for your facility"})]}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key"}),e.jsx("input",{type:"text",value:r,onChange:$=>a($.target.value),placeholder:"Enter your API key",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-mono",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Contact your administrator if you don't have an API key"})]}),n&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg text-sm",children:n}),e.jsx("button",{type:"submit",disabled:i,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-lg",children:i?"Logging in...":"Login"})]})]})})}function $v(){const{user:t,profile:s,loading:r}=qt();er();const[a,n]=p.useState(""),[l,i]=p.useState(window.location.pathname);if(p.useEffect(()=>{const u=()=>{i(window.location.pathname)};return window.addEventListener("popstate",u),()=>window.removeEventListener("popstate",u)},[]),p.useEffect(()=>{s&&(s.role==="driver"?n("driver"):n("dispatch"))},[s]),r)return e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(l==="/member-portal"||l.startsWith("/member-portal"))return e.jsx(Rv,{});if(l==="/client-portal"||l.startsWith("/client-portal"))return e.jsx(Ov,{});if(!t||!s)return l==="/driver-login"||l.startsWith("/driver-login")?e.jsx(ib,{}):e.jsx(nb,{});const d=s.role==="dispatcher"||s.role==="admin",o=s.role==="driver";return l==="/driver-mobile"&&o?e.jsx(Av,{}):l==="/dispatcher-mobile"&&d?e.jsx(Pv,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ob,{currentView:a,onNavigate:n}),d&&a==="dispatch"&&e.jsx(hv,{}),d&&a==="billing"&&e.jsx(vv,{}),d&&a==="payments"&&e.jsx(Lv,{}),d&&a==="payroll"&&e.jsx(Mv,{}),d&&a==="receptionist"&&e.jsx(jv,{}),d&&a==="patients"&&e.jsx(wv,{}),d&&a==="portals"&&e.jsx(Nv,{}),d&&a==="tracking"&&e.jsx(kv,{}),d&&a==="scheduler"&&e.jsx(Sv,{}),d&&a==="rates"&&e.jsx(Tx,{}),d&&a==="manual"&&e.jsx(Ax,{}),d&&a==="raven"&&e.jsx(Iv,{}),d&&a==="sms-logs"&&e.jsx(_v,{}),a==="driver"&&e.jsx(fv,{})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(t=>{console.log("Service Worker registered:",t)}).catch(t=>{console.log("Service Worker registration failed:",t)})});Ch(document.getElementById("root")).render(e.jsx(p.StrictMode,{children:e.jsx(My,{children:e.jsx($v,{})})}));
